webpackJsonp([1],{"4koi":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("i/rw"),a=n.n(i),o=n("y0YP"),s=n("2iX2"),d=n("hyli"),l=n("Vo7i"),c=n("UGLA"),r=n("0ecl"),u=n("aIbl"),m=n("UNbi"),p={name:"sentences",components:{Modal:s.a,SearchInput:r.a,Pagination:u.a,TabMenu:d.a},filters:{DateTimeFilter:m.a},data:function(){return{menus:[{label:"全部",id:"all"},{label:"草稿",id:"draft"},{label:"已发布",id:"online"},{label:"已下线",id:"downline"}],activeMenuId:"all",statusObj:{draft:"草稿",online:"已发布",downline:"已下线"},searchKey:"",dataList:[],page:1,totalPage:0,pageSize:20,isShowAddModal:!1,addModalCommitTip:"",addForm:{id:"",content:"",imgs:"",origin:""},isShowDelConfirmModal:!1,delTitle:"",delId:""}},created:function(){var t=this.$store.state.currRouter.query;this.activeMenuId=t.status||"all",this.page=t.page||1,this.searchKey=t.key?decodeURIComponent(t.key):"",this.queryDataList(),Object(o.a)(!1)},methods:{doSwitchMenu:function(t){this.activeMenuId!=t&&(this.activeMenuId=t,this.queryDataList(1))},doSwitchPage:function(t){this.queryDataList(t)},queryDataList:function(t){var e=this;t=t||e.page;var n=e.searchKey.trim(),i={fields:{},limit:e.pageSize,where:{},skip:(t-1)*e.pageSize,order:"createdAt DESC"},s={fields:{id:!0},limit:1e4,where:{}};"all"!=e.activeMenuId&&(i.where.status=e.activeMenuId,s.where.status=e.activeMenuId),n&&(i.where.content={like:n},s.where.content={like:n}),e.$router.replace({name:"sentences",query:{status:e.activeMenuId,key:encodeURIComponent(e.searchKey),page:t}}),Object(l.a)({url:"https://d.apicloud.com/mcm/api/sentences",params:{filter:a()(s)}}).then(function(t){e.totalPage=Math.ceil(t.length/e.pageSize)}),Object(l.a)({url:"https://d.apicloud.com/mcm/api/sentences",params:{filter:a()(i)}}).then(function(n){e.dataList=n||[],e.page=t,Object(o.a)(!1)})},doDel:function(t){this.delTitle=t.content,this.delId=t.id,this.isShowDelConfirmModal=!0},doCommitDel:function(){var t=this;Object(o.a)(!0),Object(l.a)({url:"https://d.apicloud.com/mcm/api/sentences/{id}",method:"DELETE",params:{id:t.delId}}).then(function(){Object(c.a)("删除成功！"),Object(o.a)(!1),t.queryDataList(),t.isShowDelConfirmModal=!1})},doChangeStatus:function(t,e){var n=this;Object(o.a)(!0),Object(l.a)({url:"https://d.apicloud.com/mcm/api/sentences/{id}",method:"put",params:{id:t.id},data:{$set:{status:e}}}).then(function(){Object(c.a)("操作成功！"),Object(o.a)(!1),n.queryDataList()})},doEdit:function(t){var e=this.addForm;e.content=t.content,e.origin=t.origin,e.id=t.id,e.imgs=t.imgs.join(";"),this.isShowAddModal=!0},doAdd:function(){var t=this.addForm;t.content="",t.origin="",t.id="",t.imgs="",this.isShowAddModal=!0},doAddModalCommit:function(){var t=this,e=t.addForm;e.content=e.content.trim(),e.origin=e.origin.trim(),e.imgs=e.imgs.trim(),Object(o.a)(!0),e.id?Object(l.a)({url:"https://d.apicloud.com/mcm/api/sentences/"+e.id,method:"PUT",data:{content:e.content,origin:e.origin,imgs:e.imgs.split(";")}}).then(function(e){e.id?(t.isShowAddModal=!1,t.queryDataList(),Object(c.a)("修改成功！",!0)):t.addModalCommitTip=e.error.message||"修改失败！",Object(o.a)(!1)}):Object(l.a)({url:"https://d.apicloud.com/mcm/api/sentences",method:"post",data:{content:e.content,origin:e.origin,imgs:e.imgs.split(";"),status:"draft"}}).then(function(e){e.id?(t.isShowAddModal=!1,t.queryDataList(),Object(c.a)("添加成功！",!0)):t.addModalCommitTip=e.error.message||"添加失败！",Object(o.a)(!1)})}}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-page",class:{"pagination-page":t.totalPage>1},attrs:{id:"sentences-page"}},[n("div",{staticClass:"panel"},[n("div",{staticClass:"panel-title"},[n("h3",[t._v("短语列表")]),n("button",{staticClass:"add-btn",on:{click:t.doAdd}},[t._v("添加")])]),t._v(" "),n("TabMenu",{attrs:{list:t.menus,"active-id":t.activeMenuId},on:{switch:t.doSwitchMenu}}),t._v(" "),n("SearchInput",{attrs:{placeholderText:"输入关键字","search-key":t.searchKey},on:{submit:function(e){t.queryDataList()},"update:searchKey":function(e){t.searchKey=e}}}),t._v(" "),n("div",{staticClass:"panel-content"},[n("table",{staticClass:"data-table"},[t._m(0),t._v(" "),t.dataList.length>0?n("tbody",t._l(t.dataList,function(e,i){return n("tr",{key:e.id},[n("td",[t._v(t._s(i+1+(t.page-1)*t.pageSize))]),t._v(" "),n("td",[t._v(t._s(e.content))]),t._v(" "),n("td",[t._v(t._s(e.origin))]),t._v(" "),n("td",[t._v(t._s(t._f("DateTimeFilter")(e.updatedAt)))]),t._v(" "),n("td",[t._v(t._s(t.statusObj[e.status]))]),t._v(" "),n("td",{staticClass:"ope-btns"},["online"!=e.status?n("a",{staticClass:"tool-btn-delete",on:{click:function(n){t.doDel(e)}}},[t._v("删除")]):t._e(),t._v(" "),"online"!=e.status?n("a",{staticClass:"tool-btn-detail",on:{click:function(n){t.doEdit(e)}}},[t._v("修改")]):t._e(),t._v(" "),"online"!=e.status?n("a",{staticClass:"tool-btn-online",on:{click:function(n){t.doChangeStatus(e,"online")}}},[t._v("发布")]):t._e(),t._v(" "),"online"==e.status?n("a",{staticClass:"tool-btn-downline",on:{click:function(n){t.doChangeStatus(e,"downline")}}},[t._v("下线")]):t._e()])])})):t._e(),t._v(" "),0==t.dataList.length?n("tbody",{staticClass:"data-table-null-data"},[t._m(1)]):t._e()])])],1),t._v(" "),n("Pagination",{attrs:{curr:t.page,total:t.totalPage},on:{switch:t.doSwitchPage}}),t._v(" "),n("Modal",{staticClass:"add-modal",attrs:{title:"添加","is-show":t.isShowAddModal,tip:t.addModalCommitTip},on:{"update:isShow":function(e){t.isShowAddModal=e},"update:tip":function(e){t.addModalCommitTip=e},commit:function(e){t.doAddModalCommit()}}},[n("div",{staticClass:"modal-form form"},[n("div",{staticClass:"form-item"},[n("label",[t._v("内容：")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.addForm.content,expression:"addForm.content"}],ref:"contentInput",attrs:{type:"text",placeholder:"请输入内容",maxlength:"900"},domProps:{value:t.addForm.content},on:{input:function(e){e.target.composing||t.$set(t.addForm,"content",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"form-item"},[n("label",[t._v("图片：")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.addForm.imgs,expression:"addForm.imgs"}],ref:"imgsInput",attrs:{type:"text",placeholder:"请输入图片地址，分号间隔",maxlength:"9000"},domProps:{value:t.addForm.imgs},on:{input:function(e){e.target.composing||t.$set(t.addForm,"imgs",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"form-item"},[n("label",[t._v("来源：")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.addForm.origin,expression:"addForm.origin"}],ref:"typeInput",attrs:{type:"text",placeholder:"请输入来源",maxlength:"150"},domProps:{value:t.addForm.origin},on:{input:function(e){e.target.composing||t.$set(t.addForm,"origin",e.target.value)}}})])])]),t._v(" "),n("Modal",{attrs:{title:"账号删除确认","is-show":t.isShowDelConfirmModal,"is-show-close-btn":!1},on:{"update:isShow":function(e){t.isShowDelConfirmModal=e},commit:t.doCommitDel}},[n("div",{staticClass:"modal-confirm"},[t._v("确认要删除这条短语？")])])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",{staticStyle:{width:"5%"}},[t._v("序号")]),t._v(" "),n("th",{staticStyle:{width:"35%"}},[t._v("内容")]),t._v(" "),n("th",{staticStyle:{width:"12%"}},[t._v("来源")]),t._v(" "),n("th",{staticStyle:{width:"15%"}},[t._v("添加时间")]),t._v(" "),n("th",{staticStyle:{width:"10%"}},[t._v("状态")]),t._v(" "),n("th",{staticStyle:{width:"15%"}},[t._v("操作")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",{attrs:{colspan:"6"}})])}]};var v=n("rAbc")(p,h,!1,function(t){n("rbJd")},null,null);e.default=v.exports},"6csB":function(t,e,n){(t.exports=n("iQ/U")(!1)).push([t.i,"\n.tab-menus {\n  position: relative;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  height: 54px;\n  -webkit-box-pack: end;\n      -ms-flex-pack: end;\n          justify-content: flex-end;\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n  border-bottom: 2px solid #646f86;\n  padding: 0 10px;\n}\n.tab-menus > canvas:not(:last-child) {\n    margin-right: -20px;\n}\n.tab-menus > canvas {\n    cursor: pointer;\n}\n.tab-menus > div {\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    width: 500px;\n}\n",""])},AagG:function(t,e,n){var i=n("6csB");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n("vK0y")("5b903d98",i,!0,{})},Srqs:function(t,e,n){(t.exports=n("iQ/U")(!1)).push([t.i,"\n#sentences-page .panel {\n  position: relative;\n}\n#sentences-page .panel-title {\n  position: relative;\n}\n#sentences-page .add-btn {\n  position: absolute;\n  top: 55px;\n  right: 15px;\n  z-index: 3;\n}\n#sentences-page .tab-menus {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n}\n#sentences-page .search-input {\n  padding-top: 12px;\n  padding-bottom: 10px;\n}\n#sentences-page .add-modal .modal-form .form-item label {\n  width: 70px;\n}\n#sentences-page .add-modal .modal-form .form-item input, #sentences-page .add-modal .modal-form .form-item textarea {\n  width: 450px;\n  padding: 6px 12px;\n}\n#sentences-page .add-modal .modal-form .form-item textarea {\n  height: 100px;\n  background: #fafafa;\n}\n",""])},UNbi:function(t,e,n){"use strict";var i=n("VSB1");e.a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd hh:mm:ss";return Object(i.b)(new Date(t),e)}},hyli:function(t,e,n){"use strict";var i={name:"tabMenuItem",watch:{isActive:function(){this.doDraw(this.isActive)}},data:function(){return{zIndex:1}},props:{w:{type:Number,default:130},h:{type:Number,default:40},text:{type:String,default:""},isActive:{type:Boolean,default:!1},menuIndex:{type:Number}},mounted:function(){var t=this;t.$nextTick(function(){t.doDraw(t.isActive)})},methods:{doDraw:function(t,e){var n=this.$el.getContext("2d"),i=this.w,a=this.h,o=a-0,s=18,d="#646f86",l="#646f86",c="#fff";t?e&&(d="rgba(100, 111, 134, 0.6)"):(d="#eef1f5",l="#ccc",c="#646f86"),n.clearRect(0,0,i,a),n.beginPath(),n.fillStyle=d,n.strokeStyle=l,n.lineWidth=1,n.moveTo(36,1),n.bezierCurveTo(6,1,s,o,0,o),n.lineTo(i,o),n.bezierCurveTo(i-s,o,i-s+12,1,i-36,1),n.lineTo(36,1),t||n.stroke(),n.fill(),n.font="normal 16px 微软雅黑",n.textAlign="center",n.textBaseline="middle",n.fillStyle=c,n.fillText(this.text,i/2,a/2),this.zIndex=t?10:10-this.menuIndex},doHover:function(){this.doDraw(!0,!0)},doOut:function(){this.doDraw(this.isActive)},doClickMenu:function(){this.isActive||this.$emit("switch",this.menuIndex)}}},a={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("canvas",{style:{"z-index":t.zIndex},attrs:{width:t.w,height:t.h},on:{mouseover:function(e){t.doHover()},mouseleave:function(e){t.doOut()},click:function(e){t.doClickMenu()}}})},staticRenderFns:[]},o={name:"tabMenu",components:{TabMenuItem:n("rAbc")(i,a,!1,null,null,null).exports},props:{activeId:{type:[String,Number],default:""},list:{type:Array,default:[],require:!0}},methods:{doSwitch:function(t){this.$emit("switch",this.list[t].id)}}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tab-menus"},[t._t("default"),t._v(" "),t._l(t.list,function(e,i){return n("TabMenuItem",{key:e.id,attrs:{text:e.label,"is-active":e.id==t.activeId,"menu-index":i},on:{switch:t.doSwitch}})})],2)},staticRenderFns:[]};var d=n("rAbc")(o,s,!1,function(t){n("AagG")},null,null);e.a=d.exports},rbJd:function(t,e,n){var i=n("Srqs");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n("vK0y")("4a2ecee2",i,!0,{})}});