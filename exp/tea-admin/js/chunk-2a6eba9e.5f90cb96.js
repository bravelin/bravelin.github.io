(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a6eba9e"],{"7edf":function(e,a,t){},"98c9":function(e,a,t){"use strict";t("3b80")("trim",function(e){return function(){return e(this,3)}})},cb6f:function(e,a,t){"use strict";a["a"]=[{featureType:"water",elementType:"all",stylers:{color:"#241c43"}},{featureType:"highway",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"highway",elementType:"geometry.stroke",stylers:{color:"#147a92"}},{featureType:"arterial",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"arterial",elementType:"geometry.stroke",stylers:{color:"#0b3d51"}},{featureType:"local",elementType:"geometry",stylers:{color:"#000000"}},{featureType:"land",elementType:"all",stylers:{color:"#102d56"}},{featureType:"railway",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"railway",elementType:"geometry.stroke",stylers:{color:"#08304b"}},{featureType:"subway",elementType:"geometry",stylers:{lightness:-70}},{featureType:"building",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"all",elementType:"labels.text.fill",stylers:{color:"#857f7f"}},{featureType:"all",elementType:"labels.text.stroke",stylers:{color:"#000000"}},{featureType:"building",elementType:"geometry",stylers:{color:"#022338"}},{featureType:"green",elementType:"geometry",stylers:{color:"#062032"}},{featureType:"boundary",elementType:"all",stylers:{color:"#1e1c1c"}},{featureType:"manmade",elementType:"geometry",stylers:{color:"#022338"}},{featureType:"poi",elementType:"all",stylers:{visibility:"off"}},{featureType:"all",elementType:"labels.icon",stylers:{visibility:"off"}},{featureType:"all",elementType:"labels.text.fill",stylers:{color:"#ffffff",visibility:"on"}}]},db2a:function(e,a,t){"use strict";t.r(a);var l,r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"page iot-page"},[t("div",{staticClass:"plane"},[e._m(0),t("div",{staticClass:"plane-content padding"},[t("div",{staticClass:"plane-search-form"},[t("VillageTownSelector",{attrs:{"curr-selector":e.villageSelector},on:{change:e.doVillageSelectorChange}}),t("el-select",{attrs:{placeholder:"摄像头类型",clearable:""},model:{value:e.cameraTypeInput,callback:function(a){e.cameraTypeInput=a},expression:"cameraTypeInput"}},e._l(e.cameraTypes,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),t("el-input",{attrs:{placeholder:"茶园名称",maxlength:50,clearable:!0},model:{value:e.gardenNameInput,callback:function(a){e.gardenNameInput=a},expression:"gardenNameInput"}}),t("el-input",{attrs:{placeholder:"摄像头名称",maxlength:50,clearable:!0},model:{value:e.cameraNameInput,callback:function(a){e.cameraNameInput=a},expression:"cameraNameInput"}}),t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.queryData}},[e._v("搜索")])],1),t("div",{staticClass:"table-wrap"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.dataList,border:"",stripe:"","element-loading-text":"数据加载中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"}},[t("el-table-column",{attrs:{label:"序号",width:"90",type:"index",align:"center",index:e.getIndex}}),t("el-table-column",{attrs:{prop:"cameraName",label:"摄像头名称",align:"center"}}),t("el-table-column",{attrs:{prop:"cameraId",width:"200",label:"摄像头编号",align:"center"}}),t("el-table-column",{attrs:{prop:"address",label:"地址",align:"center"}}),t("el-table-column",{attrs:{prop:"path",label:"路径",align:"center"}}),t("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{plain:"",type:"primary",size:"small"},on:{click:function(t){return e.doViewDetail(a.row)}}},[e._v("详情")])]}}])})],1),t("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total,expression:"total"}],attrs:{"current-page":e.currentPage,"page-sizes":[20,40,60,100],"page-size":e.currentPageSize,background:"",layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentPageChange}})],1)])]),t("Detail")],1)},i=[function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"plane-title"},[t("h3",[e._v("摄像头管理")])])}],n=(t("f91a"),t("98c9"),t("5fa9")),o=t.n(n),s=t("d4fd"),c=t("a98d"),p=t("52c1"),u=t("0706"),d=t("eb57"),m=t("84c8"),g=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("el-dialog",{attrs:{title:"摄像头详情",visible:e.detailFormVisible},on:{close:e.doClose}},[t("el-form",{attrs:{model:e.detail,"label-width":"85px","label-position":"right"}},[t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"设备名称："}},[t("el-input",{attrs:{maxlength:"100",disabled:e.disabledStatus},model:{value:e.detail.cameraName,callback:function(a){e.$set(e.detail,"cameraName",a)},expression:"detail.cameraName"}})],1)],1)],1),t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"设备类型："}},[t("el-select",{attrs:{placeholder:"摄像头类型",clearable:"",disabled:e.disabledStatus},model:{value:e.detail.cameraType,callback:function(a){e.$set(e.detail,"cameraType",a)},expression:"detail.cameraType"}},e._l(e.cameraTypes,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"茶园名称："}},[t("el-input",{attrs:{disabled:e.disabledStatus},model:{value:e.detail.gardenName,callback:function(a){e.$set(e.detail,"gardenName",a)},expression:"detail.gardenName"}})],1)],1)],1),t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"序列号："}},[t("el-input",{attrs:{disabled:e.disabledStatus},model:{value:e.detail.serialNo,callback:function(a){e.$set(e.detail,"serialNo",a)},expression:"detail.serialNo"}})],1)],1)],1),t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"基地名称："}},[t("el-input",{attrs:{disabled:e.disabledStatus},model:{value:e.detail.baseName,callback:function(a){e.$set(e.detail,"baseName",a)},expression:"detail.baseName"}})],1)],1)],1),t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"验证码："}},[t("el-input",{attrs:{disabled:e.disabledStatus},model:{value:e.detail.verificationCode,callback:function(a){e.$set(e.detail,"verificationCode",a)},expression:"detail.verificationCode"}})],1)],1)],1),t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"开发查询："}},[t("el-select",{attrs:{placeholder:"请选择",clearable:"",disabled:e.disabledStatus},model:{value:e.detail.developOption,callback:function(a){e.$set(e.detail,"developOption",a)},expression:"detail.developOption"}},e._l(e.developOptions,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{staticClass:"pics-list",attrs:{label:"封面："}},[t("el-upload",{staticClass:"disable-upload",attrs:{action:e.uploadAction,disabled:!0,"file-list":e.detail.coverPics,"list-type":"picture-card","on-preview":e.doPreview}},[t("i",{staticClass:"el-icon-plus"})])],1)],1)],1),t("div",{staticClass:"map-container",attrs:{id:"map-container"}})],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.doConfirm}},[e._v("确定")])],1)],1),t("Preview",{attrs:{"is-show":e.showPreview,list:e.previewList,index:e.previewIndex},on:{"update:isShow":function(a){e.showPreview=a},"update:is-show":function(a){e.showPreview=a}}})],1)},f=[],v=(t("44a2"),t("7ffc")),y=[{label:"普通摄像头",value:"1"},{label:"高清球机",value:"2"},{label:"全景摄像头",value:"3"}],b=t("cb6f"),h=t("f00d"),w=u["a"].IOT_CAMERA,T=Object(p["a"])(w).mapState,I="$store.state.".concat(w,".detail.coverPics"),C="$store.state.".concat(w,".detailFormVisible"),N=null,S={name:"iot-camera-detail",components:{Preview:v["a"]},computed:Object(c["a"])({},T(["detail","detailFormVisible"])),watch:(l={},Object(s["a"])(l,I,function(){console.log("pics change...."),this.refreshPics()}),Object(s["a"])(l,C,function(){var e=this;e.detailFormVisible&&e.ready&&(e.map?e.addMarkers():setTimeout(function(){e.initMap()},500))}),l),mounted:function(){var e=this;e.$nextTick(function(){e.ready=!0,e.detailFormVisible&&!e.map&&setTimeout(function(){e.initMap()},500)})},data:function(){return{map:null,marker:null,ready:!1,cameraTypes:y,disabledStatus:!0,uploadAction:"/api/upload",showPreview:!1,previewList:[],previewIndex:0,pics:[],developOptions:[{label:"选项一",value:"o1"},{label:"选项二",value:"o2"}]}},methods:{initMap:function(){var e=this,a=new BMap.Map("map-container"),t=new BMap.Point(h["a"].map.center[0],h["a"].map.center[1]);a.centerAndZoom(t,h["a"].map.zoom),a.enableScrollWheelZoom(!0),a.setMapStyle({styleJson:b["a"]}),e.map=a;var l=new BMap.Size(32,32);N=new BMap.Icon(h["a"].map.markerIconUrl,l,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),e.addMarkers()},doCancel:function(){var e=this;e.doClose()},doConfirm:function(){var e=this;e.doClose()},addMarkers:function(){var e=this,a=e.map,t=e.detail;if(a){e.marker&&a.removeOverlay(e.marker);var l=new BMap.Point(t.position.lng,t.position.lat),r=new BMap.Marker(l,{icon:N});a.addOverlay(r),e.marker=r}},refreshPics:function(){console.log("refresh pics.......");var e=this,a=e.$store.state[w].detail;e.pics=a.coverPics,console.log("pics....",e.pics),e.previewList=[],e.getImageSize(0)},doPreview:function(e){var a=this;a.previewIndex=0,console.log("that.previewList......",a.previewList);for(var t=0;t<a.previewList.length;t++)if(a.previewList[t].src==e.url){a.previewIndex=t;break}a.showPreview=!0},getImageSize:function(e){var a=this,t=a.pics[e],l=new Image;l.onload=function(){a.previewList.push({src:t.url,w:this.width,h:this.height}),e<a.pics.length-1&&a.getImageSize(e+1)},l.src=t.url},doClose:function(){var e=this;e.$store.commit(w+"/"+d["a"].IOT_CAMERA_SWITCH_DETAIL_DIALOG,!1)}}},k=S,x=t("17cc"),P=Object(x["a"])(k,g,f,!1,null,null,null),_=P.exports,O=u["a"].IOT_CAMERA,z=Object(p["a"])(O).mapState,M="$store.state.".concat(O,".dataList"),$={name:"iot-camera-page",components:{VillageTownSelector:m["a"],Detail:_},computed:Object(c["a"])({},z(["loading","dataList","currentPage","currentPageSize","total"])),watch:Object(s["a"])({},M,function(){this.refreshUrl()}),data:function(){return{gardenNameInput:"",villageName:"",cameraTypes:y,villageSelector:[],cameraTypeInput:"",cameraNameInput:""}},created:function(){var e=this,a=e.$store,t=e.$route,l=t.query;if(l.gardenName&&(e.gardenNameInput=decodeURIComponent(l.gardenName)),l.cameraName&&(e.cameraNameInput=decodeURIComponent(l.cameraName)),l.town){var r=decodeURIComponent(l.town);e.villageName=r,e.villageSelector.push(r)}if(l.village){var i=decodeURIComponent(l.village);e.villageName+=i,e.villageSelector.push(i)}l.cameraType&&(e.cameraTypeInput=l.cameraType),e.queryData({currentPage:o()(l.page||1),currentPageSize:o()(l.size||20)}),a.commit(d["a"].SWITCH_LOADING,!1)},methods:{queryData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=this;e.gardenName=a.gardenNameInput.trim(),e.villageName=a.villageName,e.cameraType=a.cameraTypeInput,e.cameraName=a.cameraNameInput.trim(),a.$store.dispatch(O+"/"+d["a"].IOT_CAMERA_GET_DATA_LIST,e)},handleSizeChange:function(e){this.queryData({currentPage:1,currentPageSize:e})},handleCurrentPageChange:function(e){this.queryData({currentPage:e})},doVillageSelectorChange:function(e){var a=this;a.villageSelector=e,2==e.length?a.villageName=e[0]+e[1]:a.villageName=""},getIndex:function(e){return(this.currentPage-1)*this.currentPageSize+e+1},doViewDetail:function(e){console.log("查看详情。。。",e);var a=this;a.$store.commit(d["a"].SWITCH_LOADING,!0),this.$store.dispatch(O+"/"+d["a"].IOT_CAMERA_GET_DETAIL)},refreshUrl:function(){var e=this,a=e.gardenNameInput.trim(),t=e.cameraTypeInput.trim(),l=e.villageSelector[0],r=e.villageSelector[1];e.$router.replace({name:"iot-camera",query:{page:e.currentPage,size:e.currentPageSize,gardenName:a?encodeURIComponent(a):"",town:l?encodeURIComponent(l):"",village:r?encodeURIComponent(r):"",cameraType:e.cameraTypeInput,cameraName:t?encodeURIComponent(t):""}})}}},A=$,L=(t("f88d"),Object(x["a"])(A,r,i,!1,null,null,null));a["default"]=L.exports},f00d:function(e,a,t){"use strict";a["a"]={routerBase:"./",map:{center:[114.9,25.807761],zoom:9,markerIconUrl:"./icons/1.png"}}},f88d:function(e,a,t){"use strict";var l=t("7edf"),r=t.n(l);r.a}}]);