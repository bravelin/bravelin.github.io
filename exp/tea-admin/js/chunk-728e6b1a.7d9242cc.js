(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-728e6b1a"],{"82b6":function(e,t,a){"use strict";var l=a("ca48"),r=a.n(l);r.a},"98c9":function(e,t,a){"use strict";a("3b80")("trim",function(e){return function(){return e(this,3)}})},a0db:function(e,t,a){"use strict";a.r(t);var l,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page iot-page"},[a("div",{staticClass:"plane"},[e._m(0),a("div",{staticClass:"plane-content padding"},[a("div",{staticClass:"plane-search-form"},[a("VillageTownSelector",{attrs:{"curr-selector":e.villageSelector},on:{change:e.doVillageSelectorChange}}),a("el-input",{attrs:{placeholder:"茶园名称",maxlength:50,clearable:!0},model:{value:e.gardenNameInput,callback:function(t){e.gardenNameInput=t},expression:"gardenNameInput"}}),a("el-input",{attrs:{placeholder:"监测站名称",maxlength:50,clearable:!0},model:{value:e.monitorNameInput,callback:function(t){e.monitorNameInput=t},expression:"monitorNameInput"}}),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.queryData}},[e._v("搜索")])],1),a("div",{staticClass:"table-wrap"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.dataList,border:"",stripe:"","element-loading-text":"数据加载中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.5)"}},[a("el-table-column",{attrs:{label:"序号",width:"90",type:"index",align:"center",index:e.getIndex}}),a("el-table-column",{attrs:{prop:"monitorName",label:"监测站名称",align:"center"}}),a("el-table-column",{attrs:{prop:"monitorId",width:"200",label:"监测站编号",align:"center"}}),a("el-table-column",{attrs:{prop:"address",label:"地址",align:"center"}}),a("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{plain:"",type:"primary",size:"small"},on:{click:function(a){return e.doViewDetail(t.row)}}},[e._v("详情")])]}}])})],1),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total,expression:"total"}],attrs:{"current-page":e.currentPage,"page-sizes":[20,40,60,100],"page-size":e.currentPageSize,background:"",layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentPageChange}})],1)])]),a("Detail")],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"plane-title"},[a("h3",[e._v("监测站管理")])])}],o=(a("f91a"),a("98c9"),a("5fa9")),n=a.n(o),s=a("d4fd"),c=a("a98d"),d=a("52c1"),p=a("0706"),u=a("eb57"),m=a("84c8"),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"监测站详情",visible:e.detailFormVisible},on:{close:e.doClose}},[a("el-form",{attrs:{model:e.detail,"label-width":"85px","label-position":"right"}},[a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"设备名称："}},[a("el-input",{attrs:{maxlength:"100",disabled:e.disabledStatus},model:{value:e.detail.monitorName,callback:function(t){e.$set(e.detail,"monitorName",t)},expression:"detail.monitorName"}})],1)],1)],1),a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"茶园名称："}},[a("el-input",{attrs:{disabled:e.disabledStatus},model:{value:e.detail.gardenName,callback:function(t){e.$set(e.detail,"gardenName",t)},expression:"detail.gardenName"}})],1)],1)],1),a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"序列号："}},[a("el-input",{attrs:{disabled:e.disabledStatus},model:{value:e.detail.serialNo,callback:function(t){e.$set(e.detail,"serialNo",t)},expression:"detail.serialNo"}})],1)],1)],1),a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"基地名称："}},[a("el-input",{attrs:{disabled:e.disabledStatus},model:{value:e.detail.baseName,callback:function(t){e.$set(e.detail,"baseName",t)},expression:"detail.baseName"}})],1)],1)],1),a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"验证码："}},[a("el-input",{attrs:{disabled:e.disabledStatus},model:{value:e.detail.verificationCode,callback:function(t){e.$set(e.detail,"verificationCode",t)},expression:"detail.verificationCode"}})],1)],1)],1),a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"开发查询："}},[a("el-select",{attrs:{placeholder:"请选择",clearable:"",disabled:e.disabledStatus},model:{value:e.detail.developOption,callback:function(t){e.$set(e.detail,"developOption",t)},expression:"detail.developOption"}},e._l(e.developOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{staticClass:"pics-list",attrs:{label:"封面："}},[a("el-upload",{staticClass:"disable-upload",attrs:{action:e.uploadAction,disabled:!0,"file-list":e.detail.coverPics,"list-type":"picture-card","on-preview":e.doPreview}},[a("i",{staticClass:"el-icon-plus"})])],1)],1)],1),a("div",{staticClass:"map-container",attrs:{id:"map-container"}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.doConfirm}},[e._v("确定")])],1)],1),a("Preview",{attrs:{"is-show":e.showPreview,list:e.previewList,index:e.previewIndex},on:{"update:isShow":function(t){e.showPreview=t},"update:is-show":function(t){e.showPreview=t}}})],1)},f=[],v=(a("44a2"),a("7ffc")),y=a("cb6f"),b=a("f00d"),h=p["a"].IOT_MONITOR,w=Object(d["a"])(h).mapState,T="$store.state.".concat(h,".detail.coverPics"),I="$store.state.".concat(h,".detailFormVisible"),N=null,S={name:"iot-monitor-detail",components:{Preview:v["a"]},computed:Object(c["a"])({},w(["detail","detailFormVisible"])),watch:(l={},Object(s["a"])(l,T,function(){console.log("pics change...."),this.refreshPics()}),Object(s["a"])(l,I,function(){var e=this;e.detailFormVisible&&e.ready&&(e.map?e.addMarkers():setTimeout(function(){e.initMap()},500))}),l),mounted:function(){var e=this;e.$nextTick(function(){e.ready=!0,e.detailFormVisible&&!e.map&&setTimeout(function(){e.initMap()},500)})},data:function(){return{ready:!1,map:null,marker:null,disabledStatus:!0,uploadAction:"/api/upload",showPreview:!1,previewList:[],previewIndex:0,pics:[],developOptions:[{label:"选项一",value:"o1"},{label:"选项二",value:"o2"}]}},methods:{initMap:function(){var e=this,t=new BMap.Map("map-container"),a=new BMap.Point(b["a"].map.center[0],b["a"].map.center[1]);t.centerAndZoom(a,b["a"].map.zoom),t.enableScrollWheelZoom(!0),t.setMapStyle({styleJson:y["a"]}),e.map=t;var l=new BMap.Size(32,32);N=new BMap.Icon(b["a"].map.markerIconUrl,l,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),e.addMarkers()},doCancel:function(){var e=this;e.doClose()},doConfirm:function(){var e=this;e.doClose()},addMarkers:function(){var e=this,t=e.map,a=e.detail;if(t){e.marker&&t.removeOverlay(e.marker);var l=new BMap.Point(a.position.lng,a.position.lat),r=new BMap.Marker(l,{icon:N});t.addOverlay(r),e.marker=r}},refreshPics:function(){console.log("refresh pics.......");var e=this,t=e.$store.state[h].detail;e.pics=t.coverPics,console.log("pics....",e.pics),e.previewList=[],e.getImageSize(0)},doPreview:function(e){var t=this;t.previewIndex=0,console.log("that.previewList......",t.previewList);for(var a=0;a<t.previewList.length;a++)if(t.previewList[a].src==e.url){t.previewIndex=a;break}t.showPreview=!0},getImageSize:function(e){var t=this,a=t.pics[e],l=new Image;l.onload=function(){t.previewList.push({src:a.url,w:this.width,h:this.height}),e<t.pics.length-1&&t.getImageSize(e+1)},l.src=a.url},doClose:function(){var e=this;e.$store.commit(h+"/"+u["a"].IOT_MONITOR_SWITCH_DETAIL_DIALOG,!1)}}},C=S,O=a("17cc"),k=Object(O["a"])(C,g,f,!1,null,null,null),x=k.exports,P=p["a"].IOT_MONITOR,_=Object(d["a"])(P).mapState,z="$store.state.".concat(P,".dataList"),M={name:"iot-monitor-page",components:{VillageTownSelector:m["a"],Detail:x},computed:Object(c["a"])({},_(["loading","dataList","currentPage","currentPageSize","total"])),watch:Object(s["a"])({},z,function(){this.refreshUrl()}),data:function(){return{gardenNameInput:"",villageName:"",villageSelector:[],monitorNameInput:""}},created:function(){var e=this,t=e.$store,a=e.$route,l=a.query;if(l.gardenName&&(e.gardenNameInput=decodeURIComponent(l.gardenName)),l.monitorName&&(e.monitorNameInput=decodeURIComponent(l.monitorName)),l.town){var r=decodeURIComponent(l.town);e.villageName=r,e.villageSelector.push(r)}if(l.village){var i=decodeURIComponent(l.village);e.villageName+=i,e.villageSelector.push(i)}e.queryData({currentPage:n()(l.page||1),currentPageSize:n()(l.size||20)}),t.commit(u["a"].SWITCH_LOADING,!1)},methods:{queryData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.gardenName=t.gardenNameInput.trim(),e.villageName=t.villageName,e.monitorName=t.monitorNameInput.trim(),t.$store.dispatch(P+"/"+u["a"].IOT_MONITOR_GET_DATA_LIST,e)},handleSizeChange:function(e){this.queryData({currentPage:1,currentPageSize:e})},handleCurrentPageChange:function(e){this.queryData({currentPage:e})},doVillageSelectorChange:function(e){var t=this;t.villageSelector=e,2==e.length?t.villageName=e[0]+e[1]:t.villageName=""},getIndex:function(e){return(this.currentPage-1)*this.currentPageSize+e+1},doViewDetail:function(e){console.log("查看详情。。。",e);var t=this;t.$store.commit(u["a"].SWITCH_LOADING,!0),this.$store.dispatch(P+"/"+u["a"].IOT_MONITOR_GET_DETAIL)},refreshUrl:function(){var e=this,t=e.gardenNameInput.trim(),a=e.monitorNameInput.trim(),l=e.villageSelector[0],r=e.villageSelector[1];e.$router.replace({name:"iot-monitor",query:{page:e.currentPage,size:e.currentPageSize,gardenName:t?encodeURIComponent(t):"",town:l?encodeURIComponent(l):"",village:r?encodeURIComponent(r):"",monitorName:a?encodeURIComponent(a):""}})}}},$=M,L=(a("82b6"),Object(O["a"])($,r,i,!1,null,null,null));t["default"]=L.exports},ca48:function(e,t,a){},cb6f:function(e,t,a){"use strict";t["a"]=[{featureType:"water",elementType:"all",stylers:{color:"#241c43"}},{featureType:"highway",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"highway",elementType:"geometry.stroke",stylers:{color:"#147a92"}},{featureType:"arterial",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"arterial",elementType:"geometry.stroke",stylers:{color:"#0b3d51"}},{featureType:"local",elementType:"geometry",stylers:{color:"#000000"}},{featureType:"land",elementType:"all",stylers:{color:"#102d56"}},{featureType:"railway",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"railway",elementType:"geometry.stroke",stylers:{color:"#08304b"}},{featureType:"subway",elementType:"geometry",stylers:{lightness:-70}},{featureType:"building",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"all",elementType:"labels.text.fill",stylers:{color:"#857f7f"}},{featureType:"all",elementType:"labels.text.stroke",stylers:{color:"#000000"}},{featureType:"building",elementType:"geometry",stylers:{color:"#022338"}},{featureType:"green",elementType:"geometry",stylers:{color:"#062032"}},{featureType:"boundary",elementType:"all",stylers:{color:"#1e1c1c"}},{featureType:"manmade",elementType:"geometry",stylers:{color:"#022338"}},{featureType:"poi",elementType:"all",stylers:{visibility:"off"}},{featureType:"all",elementType:"labels.icon",stylers:{visibility:"off"}},{featureType:"all",elementType:"labels.text.fill",stylers:{color:"#ffffff",visibility:"on"}}]},f00d:function(e,t,a){"use strict";t["a"]={routerBase:"./",map:{center:[114.9,25.807761],zoom:9,markerIconUrl:"./icons/1.png"}}}}]);