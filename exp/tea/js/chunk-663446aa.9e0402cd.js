(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-663446aa"],{"001b":function(t,e,i){"use strict";var n=Object.prototype.toString;t.exports=function(t){var e=n.call(t),i="[object Arguments]"===e;return i||(i="[object Array]"!==e&&null!==t&&"object"===typeof t&&"number"===typeof t.length&&t.length>=0&&"[object Function]"===n.call(t.callee)),i}},"011f":function(t,e,i){"use strict";function n(){}i.r(e),i.d(e,"WebGLMultisampleRenderTarget",function(){return Ze}),i.d(e,"WebGLRenderTargetCube",function(){return Je}),i.d(e,"WebGLRenderTarget",function(){return $e}),i.d(e,"WebGLRenderer",function(){return ns}),i.d(e,"ShaderLib",function(){return xr}),i.d(e,"UniformsLib",function(){return Tr}),i.d(e,"UniformsUtils",function(){return _r}),i.d(e,"ShaderChunk",function(){return gr}),i.d(e,"FogExp2",function(){return rs}),i.d(e,"Fog",function(){return as}),i.d(e,"Scene",function(){return os}),i.d(e,"Sprite",function(){return us}),i.d(e,"LOD",function(){return hs}),i.d(e,"SkinnedMesh",function(){return ds}),i.d(e,"Skeleton",function(){return ps}),i.d(e,"Bone",function(){return fs}),i.d(e,"Mesh",function(){return aa}),i.d(e,"LineSegments",function(){return vs}),i.d(e,"LineLoop",function(){return ys}),i.d(e,"Line",function(){return gs}),i.d(e,"Points",function(){return bs}),i.d(e,"Group",function(){return Yo}),i.d(e,"VideoTexture",function(){return ws}),i.d(e,"DataTexture",function(){return Ke}),i.d(e,"DataTexture2DArray",function(){return ya}),i.d(e,"DataTexture3D",function(){return _a}),i.d(e,"CompressedTexture",function(){return Ts}),i.d(e,"CubeTexture",function(){return va}),i.d(e,"CanvasTexture",function(){return xs}),i.d(e,"DepthTexture",function(){return Ss}),i.d(e,"Texture",function(){return Ye}),i.d(e,"AnimationLoader",function(){return xl}),i.d(e,"CompressedTextureLoader",function(){return Sl}),i.d(e,"DataTextureLoader",function(){return El}),i.d(e,"CubeTextureLoader",function(){return Cl}),i.d(e,"TextureLoader",function(){return Al}),i.d(e,"ObjectLoader",function(){return bu}),i.d(e,"MaterialLoader",function(){return gu}),i.d(e,"BufferGeometryLoader",function(){return yu}),i.d(e,"DefaultLoadingManager",function(){return bl}),i.d(e,"LoadingManager",function(){return _l}),i.d(e,"ImageLoader",function(){return Ml}),i.d(e,"ImageBitmapLoader",function(){return Eu}),i.d(e,"FontLoader",function(){return Lu}),i.d(e,"FileLoader",function(){return Tl}),i.d(e,"Loader",function(){return Pu}),i.d(e,"LoaderUtils",function(){return vu}),i.d(e,"Cache",function(){return yl}),i.d(e,"AudioLoader",function(){return Ru}),i.d(e,"SpotLightShadow",function(){return cu}),i.d(e,"SpotLight",function(){return lu}),i.d(e,"PointLight",function(){return uu}),i.d(e,"RectAreaLight",function(){return mu}),i.d(e,"HemisphereLight",function(){return ou}),i.d(e,"DirectionalLightShadow",function(){return du}),i.d(e,"DirectionalLight",function(){return pu}),i.d(e,"AmbientLight",function(){return fu}),i.d(e,"LightShadow",function(){return su}),i.d(e,"Light",function(){return au}),i.d(e,"StereoCamera",function(){return Iu}),i.d(e,"PerspectiveCamera",function(){return $o}),i.d(e,"OrthographicCamera",function(){return hu}),i.d(e,"CubeCamera",function(){return Du}),i.d(e,"ArrayCamera",function(){return Zo}),i.d(e,"Camera",function(){return Xo}),i.d(e,"AudioListener",function(){return Nu}),i.d(e,"PositionalAudio",function(){return Fu}),i.d(e,"AudioContext",function(){return Ou}),i.d(e,"AudioAnalyser",function(){return zu}),i.d(e,"Audio",function(){return Bu}),i.d(e,"VectorKeyframeTrack",function(){return fl}),i.d(e,"StringKeyframeTrack",function(){return pl}),i.d(e,"QuaternionKeyframeTrack",function(){return dl}),i.d(e,"NumberKeyframeTrack",function(){return ul}),i.d(e,"ColorKeyframeTrack",function(){return ll}),i.d(e,"BooleanKeyframeTrack",function(){return cl}),i.d(e,"PropertyMixer",function(){return ju}),i.d(e,"PropertyBinding",function(){return qu}),i.d(e,"KeyframeTrack",function(){return sl}),i.d(e,"AnimationUtils",function(){return il}),i.d(e,"AnimationObjectGroup",function(){return Yu}),i.d(e,"AnimationMixer",function(){return $u}),i.d(e,"AnimationClip",function(){return ml}),i.d(e,"Uniform",function(){return Zu}),i.d(e,"InstancedBufferGeometry",function(){return Ju}),i.d(e,"BufferGeometry",function(){return qr}),i.d(e,"Geometry",function(){return Or}),i.d(e,"InterleavedBufferAttribute",function(){return cs}),i.d(e,"InstancedInterleavedBuffer",function(){return Ku}),i.d(e,"InterleavedBuffer",function(){return ss}),i.d(e,"InstancedBufferAttribute",function(){return Qu}),i.d(e,"Face3",function(){return Mr}),i.d(e,"Object3D",function(){return Lr}),i.d(e,"Raycaster",function(){return th}),i.d(e,"Layers",function(){return Ar}),i.d(e,"EventDispatcher",function(){return n}),i.d(e,"Clock",function(){return Uu}),i.d(e,"QuaternionLinearInterpolant",function(){return hl}),i.d(e,"LinearInterpolant",function(){return al}),i.d(e,"DiscreteInterpolant",function(){return ol}),i.d(e,"CubicInterpolant",function(){return rl}),i.d(e,"Interpolant",function(){return nl}),i.d(e,"Triangle",function(){return na}),i.d(e,"Math",function(){return ze}),i.d(e,"Spherical",function(){return nh}),i.d(e,"Cylindrical",function(){return rh}),i.d(e,"Plane",function(){return ei}),i.d(e,"Frustum",function(){return ii}),i.d(e,"Sphere",function(){return ti}),i.d(e,"Ray",function(){return ia}),i.d(e,"Matrix4",function(){return ni}),i.d(e,"Matrix3",function(){return Ve}),i.d(e,"Box3",function(){return Qe}),i.d(e,"Box2",function(){return ah}),i.d(e,"Line3",function(){return oh}),i.d(e,"Euler",function(){return Cr}),i.d(e,"Vector4",function(){return Xe}),i.d(e,"Vector3",function(){return Ge}),i.d(e,"Vector2",function(){return je}),i.d(e,"Quaternion",function(){return He}),i.d(e,"Color",function(){return wr}),i.d(e,"ImmediateRenderObject",function(){return sh}),i.d(e,"VertexNormalsHelper",function(){return ch}),i.d(e,"SpotLightHelper",function(){return lh}),i.d(e,"SkeletonHelper",function(){return hh}),i.d(e,"PointLightHelper",function(){return dh}),i.d(e,"RectAreaLightHelper",function(){return ph}),i.d(e,"HemisphereLightHelper",function(){return fh}),i.d(e,"GridHelper",function(){return mh}),i.d(e,"PolarGridHelper",function(){return gh}),i.d(e,"PositionalAudioHelper",function(){return vh}),i.d(e,"FaceNormalsHelper",function(){return yh}),i.d(e,"DirectionalLightHelper",function(){return _h}),i.d(e,"CameraHelper",function(){return bh}),i.d(e,"BoxHelper",function(){return wh}),i.d(e,"Box3Helper",function(){return Th}),i.d(e,"PlaneHelper",function(){return xh}),i.d(e,"ArrowHelper",function(){return Sh}),i.d(e,"AxesHelper",function(){return Eh}),i.d(e,"Shape",function(){return ru}),i.d(e,"Path",function(){return nu}),i.d(e,"ShapePath",function(){return Mu}),i.d(e,"Font",function(){return Cu}),i.d(e,"CurvePath",function(){return iu}),i.d(e,"Curve",function(){return kl}),i.d(e,"ImageUtils",function(){return We}),i.d(e,"ShapeUtils",function(){return _c}),i.d(e,"WebGLUtils",function(){return qo}),i.d(e,"WireframeGeometry",function(){return Es}),i.d(e,"ParametricGeometry",function(){return Ms}),i.d(e,"ParametricBufferGeometry",function(){return Cs}),i.d(e,"TetrahedronGeometry",function(){return Ls}),i.d(e,"TetrahedronBufferGeometry",function(){return Ps}),i.d(e,"OctahedronGeometry",function(){return Os}),i.d(e,"OctahedronBufferGeometry",function(){return Rs}),i.d(e,"IcosahedronGeometry",function(){return Is}),i.d(e,"IcosahedronBufferGeometry",function(){return Ds}),i.d(e,"DodecahedronGeometry",function(){return Us}),i.d(e,"DodecahedronBufferGeometry",function(){return Ns}),i.d(e,"PolyhedronGeometry",function(){return As}),i.d(e,"PolyhedronBufferGeometry",function(){return ks}),i.d(e,"TubeGeometry",function(){return Bs}),i.d(e,"TubeBufferGeometry",function(){return Fs}),i.d(e,"TorusKnotGeometry",function(){return zs}),i.d(e,"TorusKnotBufferGeometry",function(){return js}),i.d(e,"TorusGeometry",function(){return Hs}),i.d(e,"TorusBufferGeometry",function(){return Gs}),i.d(e,"TextGeometry",function(){return Mc}),i.d(e,"TextBufferGeometry",function(){return Cc}),i.d(e,"SphereGeometry",function(){return Ac}),i.d(e,"SphereBufferGeometry",function(){return kc}),i.d(e,"RingGeometry",function(){return Lc}),i.d(e,"RingBufferGeometry",function(){return Pc}),i.d(e,"PlaneGeometry",function(){return $r}),i.d(e,"PlaneBufferGeometry",function(){return Zr}),i.d(e,"LatheGeometry",function(){return Oc}),i.d(e,"LatheBufferGeometry",function(){return Rc}),i.d(e,"ShapeGeometry",function(){return Ic}),i.d(e,"ShapeBufferGeometry",function(){return Dc}),i.d(e,"ExtrudeGeometry",function(){return Tc}),i.d(e,"ExtrudeBufferGeometry",function(){return xc}),i.d(e,"EdgesGeometry",function(){return Nc}),i.d(e,"ConeGeometry",function(){return zc}),i.d(e,"ConeBufferGeometry",function(){return jc}),i.d(e,"CylinderGeometry",function(){return Bc}),i.d(e,"CylinderBufferGeometry",function(){return Fc}),i.d(e,"CircleGeometry",function(){return Hc}),i.d(e,"CircleBufferGeometry",function(){return Gc}),i.d(e,"BoxGeometry",function(){return Yr}),i.d(e,"CubeGeometry",function(){return Yr}),i.d(e,"BoxBufferGeometry",function(){return Xr}),i.d(e,"ShadowMaterial",function(){return Wc}),i.d(e,"SpriteMaterial",function(){return ls}),i.d(e,"RawShaderMaterial",function(){return qc}),i.d(e,"ShaderMaterial",function(){return ea}),i.d(e,"PointsMaterial",function(){return _s}),i.d(e,"MeshPhysicalMaterial",function(){return Xc}),i.d(e,"MeshStandardMaterial",function(){return Yc}),i.d(e,"MeshPhongMaterial",function(){return $c}),i.d(e,"MeshToonMaterial",function(){return Zc}),i.d(e,"MeshNormalMaterial",function(){return Jc}),i.d(e,"MeshLambertMaterial",function(){return Kc}),i.d(e,"MeshDepthMaterial",function(){return jo}),i.d(e,"MeshDistanceMaterial",function(){return Ho}),i.d(e,"MeshBasicMaterial",function(){return ra}),i.d(e,"MeshMatcapMaterial",function(){return Qc}),i.d(e,"LineDashedMaterial",function(){return tl}),i.d(e,"LineBasicMaterial",function(){return ms}),i.d(e,"Material",function(){return Kr}),i.d(e,"Float64BufferAttribute",function(){return Hr}),i.d(e,"Float32BufferAttribute",function(){return jr}),i.d(e,"Uint32BufferAttribute",function(){return zr}),i.d(e,"Int32BufferAttribute",function(){return Fr}),i.d(e,"Uint16BufferAttribute",function(){return Br}),i.d(e,"Int16BufferAttribute",function(){return Nr}),i.d(e,"Uint8ClampedBufferAttribute",function(){return Ur}),i.d(e,"Uint8BufferAttribute",function(){return Dr}),i.d(e,"Int8BufferAttribute",function(){return Ir}),i.d(e,"BufferAttribute",function(){return Rr}),i.d(e,"ArcCurve",function(){return Pl}),i.d(e,"CatmullRomCurve3",function(){return Nl}),i.d(e,"CubicBezierCurve",function(){return Xl}),i.d(e,"CubicBezierCurve3",function(){return $l}),i.d(e,"EllipseCurve",function(){return Ll}),i.d(e,"LineCurve",function(){return Zl}),i.d(e,"LineCurve3",function(){return Jl}),i.d(e,"QuadraticBezierCurve",function(){return Kl}),i.d(e,"QuadraticBezierCurve3",function(){return Ql}),i.d(e,"SplineCurve",function(){return tu}),i.d(e,"REVISION",function(){return a}),i.d(e,"MOUSE",function(){return o}),i.d(e,"CullFaceNone",function(){return s}),i.d(e,"CullFaceBack",function(){return c}),i.d(e,"CullFaceFront",function(){return l}),i.d(e,"CullFaceFrontBack",function(){return u}),i.d(e,"FrontFaceDirectionCW",function(){return h}),i.d(e,"FrontFaceDirectionCCW",function(){return d}),i.d(e,"BasicShadowMap",function(){return p}),i.d(e,"PCFShadowMap",function(){return f}),i.d(e,"PCFSoftShadowMap",function(){return m}),i.d(e,"FrontSide",function(){return g}),i.d(e,"BackSide",function(){return v}),i.d(e,"DoubleSide",function(){return y}),i.d(e,"FlatShading",function(){return _}),i.d(e,"SmoothShading",function(){return b}),i.d(e,"NoColors",function(){return w}),i.d(e,"FaceColors",function(){return T}),i.d(e,"VertexColors",function(){return x}),i.d(e,"NoBlending",function(){return S}),i.d(e,"NormalBlending",function(){return E}),i.d(e,"AdditiveBlending",function(){return M}),i.d(e,"SubtractiveBlending",function(){return C}),i.d(e,"MultiplyBlending",function(){return A}),i.d(e,"CustomBlending",function(){return k}),i.d(e,"AddEquation",function(){return L}),i.d(e,"SubtractEquation",function(){return P}),i.d(e,"ReverseSubtractEquation",function(){return O}),i.d(e,"MinEquation",function(){return R}),i.d(e,"MaxEquation",function(){return I}),i.d(e,"ZeroFactor",function(){return D}),i.d(e,"OneFactor",function(){return U}),i.d(e,"SrcColorFactor",function(){return N}),i.d(e,"OneMinusSrcColorFactor",function(){return B}),i.d(e,"SrcAlphaFactor",function(){return F}),i.d(e,"OneMinusSrcAlphaFactor",function(){return z}),i.d(e,"DstAlphaFactor",function(){return j}),i.d(e,"OneMinusDstAlphaFactor",function(){return H}),i.d(e,"DstColorFactor",function(){return G}),i.d(e,"OneMinusDstColorFactor",function(){return V}),i.d(e,"SrcAlphaSaturateFactor",function(){return W}),i.d(e,"NeverDepth",function(){return q}),i.d(e,"AlwaysDepth",function(){return Y}),i.d(e,"LessDepth",function(){return X}),i.d(e,"LessEqualDepth",function(){return $}),i.d(e,"EqualDepth",function(){return Z}),i.d(e,"GreaterEqualDepth",function(){return J}),i.d(e,"GreaterDepth",function(){return K}),i.d(e,"NotEqualDepth",function(){return Q}),i.d(e,"MultiplyOperation",function(){return tt}),i.d(e,"MixOperation",function(){return et}),i.d(e,"AddOperation",function(){return it}),i.d(e,"NoToneMapping",function(){return nt}),i.d(e,"LinearToneMapping",function(){return rt}),i.d(e,"ReinhardToneMapping",function(){return at}),i.d(e,"Uncharted2ToneMapping",function(){return ot}),i.d(e,"CineonToneMapping",function(){return st}),i.d(e,"ACESFilmicToneMapping",function(){return ct}),i.d(e,"UVMapping",function(){return lt}),i.d(e,"CubeReflectionMapping",function(){return ut}),i.d(e,"CubeRefractionMapping",function(){return ht}),i.d(e,"EquirectangularReflectionMapping",function(){return dt}),i.d(e,"EquirectangularRefractionMapping",function(){return pt}),i.d(e,"SphericalReflectionMapping",function(){return ft}),i.d(e,"CubeUVReflectionMapping",function(){return mt}),i.d(e,"CubeUVRefractionMapping",function(){return gt}),i.d(e,"RepeatWrapping",function(){return vt}),i.d(e,"ClampToEdgeWrapping",function(){return yt}),i.d(e,"MirroredRepeatWrapping",function(){return _t}),i.d(e,"NearestFilter",function(){return bt}),i.d(e,"NearestMipMapNearestFilter",function(){return wt}),i.d(e,"NearestMipMapLinearFilter",function(){return Tt}),i.d(e,"LinearFilter",function(){return xt}),i.d(e,"LinearMipMapNearestFilter",function(){return St}),i.d(e,"LinearMipMapLinearFilter",function(){return Et}),i.d(e,"UnsignedByteType",function(){return Mt}),i.d(e,"ByteType",function(){return Ct}),i.d(e,"ShortType",function(){return At}),i.d(e,"UnsignedShortType",function(){return kt}),i.d(e,"IntType",function(){return Lt}),i.d(e,"UnsignedIntType",function(){return Pt}),i.d(e,"FloatType",function(){return Ot}),i.d(e,"HalfFloatType",function(){return Rt}),i.d(e,"UnsignedShort4444Type",function(){return It}),i.d(e,"UnsignedShort5551Type",function(){return Dt}),i.d(e,"UnsignedShort565Type",function(){return Ut}),i.d(e,"UnsignedInt248Type",function(){return Nt}),i.d(e,"AlphaFormat",function(){return Bt}),i.d(e,"RGBFormat",function(){return Ft}),i.d(e,"RGBAFormat",function(){return zt}),i.d(e,"LuminanceFormat",function(){return jt}),i.d(e,"LuminanceAlphaFormat",function(){return Ht}),i.d(e,"RGBEFormat",function(){return Gt}),i.d(e,"DepthFormat",function(){return Vt}),i.d(e,"DepthStencilFormat",function(){return Wt}),i.d(e,"RedFormat",function(){return qt}),i.d(e,"RGB_S3TC_DXT1_Format",function(){return Yt}),i.d(e,"RGBA_S3TC_DXT1_Format",function(){return Xt}),i.d(e,"RGBA_S3TC_DXT3_Format",function(){return $t}),i.d(e,"RGBA_S3TC_DXT5_Format",function(){return Zt}),i.d(e,"RGB_PVRTC_4BPPV1_Format",function(){return Jt}),i.d(e,"RGB_PVRTC_2BPPV1_Format",function(){return Kt}),i.d(e,"RGBA_PVRTC_4BPPV1_Format",function(){return Qt}),i.d(e,"RGBA_PVRTC_2BPPV1_Format",function(){return te}),i.d(e,"RGB_ETC1_Format",function(){return ee}),i.d(e,"RGBA_ASTC_4x4_Format",function(){return ie}),i.d(e,"RGBA_ASTC_5x4_Format",function(){return ne}),i.d(e,"RGBA_ASTC_5x5_Format",function(){return re}),i.d(e,"RGBA_ASTC_6x5_Format",function(){return ae}),i.d(e,"RGBA_ASTC_6x6_Format",function(){return oe}),i.d(e,"RGBA_ASTC_8x5_Format",function(){return se}),i.d(e,"RGBA_ASTC_8x6_Format",function(){return ce}),i.d(e,"RGBA_ASTC_8x8_Format",function(){return le}),i.d(e,"RGBA_ASTC_10x5_Format",function(){return ue}),i.d(e,"RGBA_ASTC_10x6_Format",function(){return he}),i.d(e,"RGBA_ASTC_10x8_Format",function(){return de}),i.d(e,"RGBA_ASTC_10x10_Format",function(){return pe}),i.d(e,"RGBA_ASTC_12x10_Format",function(){return fe}),i.d(e,"RGBA_ASTC_12x12_Format",function(){return me}),i.d(e,"LoopOnce",function(){return ge}),i.d(e,"LoopRepeat",function(){return ve}),i.d(e,"LoopPingPong",function(){return ye}),i.d(e,"InterpolateDiscrete",function(){return _e}),i.d(e,"InterpolateLinear",function(){return be}),i.d(e,"InterpolateSmooth",function(){return we}),i.d(e,"ZeroCurvatureEnding",function(){return Te}),i.d(e,"ZeroSlopeEnding",function(){return xe}),i.d(e,"WrapAroundEnding",function(){return Se}),i.d(e,"TrianglesDrawMode",function(){return Ee}),i.d(e,"TriangleStripDrawMode",function(){return Me}),i.d(e,"TriangleFanDrawMode",function(){return Ce}),i.d(e,"LinearEncoding",function(){return Ae}),i.d(e,"sRGBEncoding",function(){return ke}),i.d(e,"GammaEncoding",function(){return Le}),i.d(e,"RGBEEncoding",function(){return Pe}),i.d(e,"LogLuvEncoding",function(){return Oe}),i.d(e,"RGBM7Encoding",function(){return Re}),i.d(e,"RGBM16Encoding",function(){return Ie}),i.d(e,"RGBDEncoding",function(){return De}),i.d(e,"BasicDepthPacking",function(){return Ue}),i.d(e,"RGBADepthPacking",function(){return Ne}),i.d(e,"TangentSpaceNormalMap",function(){return Be}),i.d(e,"ObjectSpaceNormalMap",function(){return Fe}),i.d(e,"Face4",function(){return Mh}),i.d(e,"LineStrip",function(){return Ch}),i.d(e,"LinePieces",function(){return Ah}),i.d(e,"MeshFaceMaterial",function(){return kh}),i.d(e,"MultiMaterial",function(){return Lh}),i.d(e,"PointCloud",function(){return Ph}),i.d(e,"Particle",function(){return Oh}),i.d(e,"ParticleSystem",function(){return Rh}),i.d(e,"PointCloudMaterial",function(){return Ih}),i.d(e,"ParticleBasicMaterial",function(){return Dh}),i.d(e,"ParticleSystemMaterial",function(){return Uh}),i.d(e,"Vertex",function(){return Nh}),i.d(e,"DynamicBufferAttribute",function(){return Bh}),i.d(e,"Int8Attribute",function(){return Fh}),i.d(e,"Uint8Attribute",function(){return zh}),i.d(e,"Uint8ClampedAttribute",function(){return jh}),i.d(e,"Int16Attribute",function(){return Hh}),i.d(e,"Uint16Attribute",function(){return Gh}),i.d(e,"Int32Attribute",function(){return Vh}),i.d(e,"Uint32Attribute",function(){return Wh}),i.d(e,"Float32Attribute",function(){return qh}),i.d(e,"Float64Attribute",function(){return Yh}),i.d(e,"ClosedSplineCurve3",function(){return Xh}),i.d(e,"SplineCurve3",function(){return $h}),i.d(e,"Spline",function(){return Zh}),i.d(e,"AxisHelper",function(){return Jh}),i.d(e,"BoundingBoxHelper",function(){return Kh}),i.d(e,"EdgesHelper",function(){return Qh}),i.d(e,"WireframeHelper",function(){return td}),i.d(e,"XHRLoader",function(){return ed}),i.d(e,"BinaryTextureLoader",function(){return id}),i.d(e,"GeometryUtils",function(){return nd}),i.d(e,"Projector",function(){return rd}),i.d(e,"CanvasRenderer",function(){return ad}),i.d(e,"JSONLoader",function(){return od}),i.d(e,"SceneUtils",function(){return sd}),i.d(e,"LensFlare",function(){return cd}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype===!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}}(),Object.assign(n.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners,n=i[t];if(void 0!==n){var r=n.indexOf(e);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,i=e[t.type];if(void 0!==i){t.target=this;for(var n=i.slice(0),r=0,a=n.length;r<a;r++)n[r].call(this,t)}}}});var r,a="103",o={LEFT:0,MIDDLE:1,RIGHT:2},s=0,c=1,l=2,u=3,h=0,d=1,p=0,f=1,m=2,g=0,v=1,y=2,_=1,b=2,w=0,T=1,x=2,S=0,E=1,M=2,C=3,A=4,k=5,L=100,P=101,O=102,R=103,I=104,D=200,U=201,N=202,B=203,F=204,z=205,j=206,H=207,G=208,V=209,W=210,q=0,Y=1,X=2,$=3,Z=4,J=5,K=6,Q=7,tt=0,et=1,it=2,nt=0,rt=1,at=2,ot=3,st=4,ct=5,lt=300,ut=301,ht=302,dt=303,pt=304,ft=305,mt=306,gt=307,vt=1e3,yt=1001,_t=1002,bt=1003,wt=1004,Tt=1005,xt=1006,St=1007,Et=1008,Mt=1009,Ct=1010,At=1011,kt=1012,Lt=1013,Pt=1014,Ot=1015,Rt=1016,It=1017,Dt=1018,Ut=1019,Nt=1020,Bt=1021,Ft=1022,zt=1023,jt=1024,Ht=1025,Gt=zt,Vt=1026,Wt=1027,qt=1028,Yt=33776,Xt=33777,$t=33778,Zt=33779,Jt=35840,Kt=35841,Qt=35842,te=35843,ee=36196,ie=37808,ne=37809,re=37810,ae=37811,oe=37812,se=37813,ce=37814,le=37815,ue=37816,he=37817,de=37818,pe=37819,fe=37820,me=37821,ge=2200,ve=2201,ye=2202,_e=2300,be=2301,we=2302,Te=2400,xe=2401,Se=2402,Ee=0,Me=1,Ce=2,Ae=3e3,ke=3001,Le=3007,Pe=3002,Oe=3003,Re=3004,Ie=3005,De=3006,Ue=3200,Ne=3201,Be=0,Fe=1,ze={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,a=t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255];return a.toUpperCase()}}(),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(6*t-15)+10))},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*ze.DEG2RAD},radToDeg:function(t){return t*ze.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function je(t,e){this.x=t||0,this.y=e||0}function He(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1}function Ge(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}function Ve(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(je.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(je.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new je,e=new je;return function(i,n){return t.set(i,i),e.set(n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,a=this.y-t.y;return this.x=r*i-a*n+t.x,this.y=r*n+a*i+t.y,this}}),Object.assign(He,{slerp:function(t,e,i,n){return i.copy(t).slerp(e,n)},slerpFlat:function(t,e,i,n,r,a,o){var s=i[n+0],c=i[n+1],l=i[n+2],u=i[n+3],h=r[a+0],d=r[a+1],p=r[a+2],f=r[a+3];if(u!==f||s!==h||c!==d||l!==p){var m=1-o,g=s*h+c*d+l*p+u*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var _=Math.sqrt(y),b=Math.atan2(_,g*v);m=Math.sin(m*b)/_,o=Math.sin(o*b)/_}var w=o*v;if(s=s*m+h*w,c=c*m+d*w,l=l*m+p*w,u=u*m+f*w,m===1-o){var T=1/Math.sqrt(s*s+c*c+l*l+u*u);s*=T,c*=T,l*=T,u*=T}}t[e]=s,t[e+1]=c,t[e+2]=l,t[e+3]=u}}),Object.defineProperties(He.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(He.prototype,{isQuaternion:!0,set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,n=t._y,r=t._z,a=t.order,o=Math.cos,s=Math.sin,c=o(i/2),l=o(n/2),u=o(r/2),h=s(i/2),d=s(n/2),p=s(r/2);return"XYZ"===a?(this._x=h*l*u+c*d*p,this._y=c*d*u-h*l*p,this._z=c*l*p+h*d*u,this._w=c*l*u-h*d*p):"YXZ"===a?(this._x=h*l*u+c*d*p,this._y=c*d*u-h*l*p,this._z=c*l*p-h*d*u,this._w=c*l*u+h*d*p):"ZXY"===a?(this._x=h*l*u-c*d*p,this._y=c*d*u+h*l*p,this._z=c*l*p+h*d*u,this._w=c*l*u-h*d*p):"ZYX"===a?(this._x=h*l*u-c*d*p,this._y=c*d*u+h*l*p,this._z=c*l*p-h*d*u,this._w=c*l*u+h*d*p):"YZX"===a?(this._x=h*l*u+c*d*p,this._y=c*d*u+h*l*p,this._z=c*l*p-h*d*u,this._w=c*l*u-h*d*p):"XZY"===a&&(this._x=h*l*u-c*d*p,this._y=c*d*u-h*l*p,this._z=c*l*p+h*d*u,this._w=c*l*u+h*d*p),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,n=i[0],r=i[4],a=i[8],o=i[1],s=i[5],c=i[9],l=i[2],u=i[6],h=i[10],d=n+s+h;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(u-c)*e,this._y=(a-l)*e,this._z=(o-r)*e):n>s&&n>h?(e=2*Math.sqrt(1+n-s-h),this._w=(u-c)/e,this._x=.25*e,this._y=(r+o)/e,this._z=(a+l)/e):s>h?(e=2*Math.sqrt(1+s-n-h),this._w=(a-l)/e,this._x=(r+o)/e,this._y=.25*e,this._z=(c+u)/e):(e=2*Math.sqrt(1+h-n-s),this._w=(o-r)/e,this._x=(a+l)/e,this._y=(c+u)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(t,e){var i=1e-6,n=t.dot(e)+1;return n<i?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(ze.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var i=this.angleTo(t);if(0===i)return this;var n=Math.min(1,e/i);return this.slerp(t,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,r=t._z,a=t._w,o=e._x,s=e._y,c=e._z,l=e._w;return this._x=i*l+a*o+n*c-r*s,this._y=n*l+a*s+r*o-i*c,this._z=r*l+a*c+i*s-n*o,this._w=a*l-i*o-n*s-r*c,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,r=this._z,a=this._w,o=a*t._w+i*t._x+n*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=i,this._y=n,this._z=r,this;var s=1-o*o;if(s<=Number.EPSILON){var c=1-e;return this._w=c*a+e*this._w,this._x=c*i+e*this._x,this._y=c*n+e*this._y,this._z=c*r+e*this._z,this.normalize()}var l=Math.sqrt(s),u=Math.atan2(l,o),h=Math.sin((1-e)*u)/l,d=Math.sin(e*u)/l;return this._w=a*h+this._w*d,this._x=i*h+this._x*d,this._y=n*h+this._y*d,this._z=r*h+this._z*d,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(Ge.prototype,{isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new He;return function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new He;return function(e,i){return this.applyQuaternion(t.setFromAxisAngle(e,i))}}(),applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements,a=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*a,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*a,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*a,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,a=t.y,o=t.z,s=t.w,c=s*e+a*n-o*i,l=s*i+o*e-r*n,u=s*n+r*i-a*e,h=-r*e-a*i-o*n;return this.x=c*s+h*-r+l*-o-u*-a,this.y=l*s+h*-a+u*-r-c*-o,this.z=u*s+h*-o+c*-a-l*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new Ge,e=new Ge;return function(i,n){return t.set(i,i,i),e.set(n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var i=t.x,n=t.y,r=t.z,a=e.x,o=e.y,s=e.z;return this.x=n*s-r*o,this.y=r*a-i*s,this.z=i*o-n*a,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new Ge;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new Ge;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(ze.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,i){var n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(Ve.prototype,{isMatrix3:!0,set:function(t,e,i,n,r,a,o,s,c){var l=this.elements;return l[0]=t,l[1]=n,l[2]=o,l[3]=e,l[4]=r,l[5]=s,l[6]=i,l[7]=a,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var t=new Ge;return function(e){for(var i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.applyMatrix3(this),e.setXYZ(i,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,a=i[0],o=i[3],s=i[6],c=i[1],l=i[4],u=i[7],h=i[2],d=i[5],p=i[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],_=n[7],b=n[2],w=n[5],T=n[8];return r[0]=a*f+o*v+s*b,r[3]=a*m+o*y+s*w,r[6]=a*g+o*_+s*T,r[1]=c*f+l*v+u*b,r[4]=c*m+l*y+u*w,r[7]=c*g+l*_+u*T,r[2]=h*f+d*v+p*b,r[5]=h*m+d*y+p*w,r[8]=h*g+d*_+p*T,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],a=t[4],o=t[5],s=t[6],c=t[7],l=t[8];return e*a*l-e*o*c-i*r*l+i*o*s+n*r*c-n*a*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var i=t.elements,n=this.elements,r=i[0],a=i[1],o=i[2],s=i[3],c=i[4],l=i[5],u=i[6],h=i[7],d=i[8],p=d*c-l*h,f=l*u-d*s,m=h*s-c*u,g=r*p+a*f+o*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=p*y,n[1]=(o*h-d*a)*y,n[2]=(l*a-o*c)*y,n[3]=f*y,n[4]=(d*r-o*u)*y,n[5]=(o*s-l*r)*y,n[6]=m*y,n[7]=(a*u-h*r)*y,n[8]=(c*r-a*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,i,n,r,a,o){var s=Math.cos(r),c=Math.sin(r);this.set(i*s,i*c,-i*(s*a+c*o)+a+t,-n*c,n*s,-n*(-c*a+s*o)+o+e,0,0,1)},scale:function(t,e){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.elements,r=n[0],a=n[3],o=n[6],s=n[1],c=n[4],l=n[7];return n[0]=e*r+i*s,n[3]=e*a+i*c,n[6]=e*o+i*l,n[1]=-i*r+e*s,n[4]=-i*a+e*c,n[7]=-i*o+e*l,this},translate:function(t,e){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this},equals:function(t){for(var e=this.elements,i=t.elements,n=0;n<9;n++)if(e[n]!==i[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<9;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}});var We={getDataURL:function(t){var e;if("undefined"==typeof HTMLCanvasElement)return t.src;if(t instanceof HTMLCanvasElement)e=t;else{void 0===r&&(r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),r.width=t.width,r.height=t.height;var i=r.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),e=r}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},qe=0;function Ye(t,e,i,n,r,a,o,s,c,l){Object.defineProperty(this,"id",{value:qe++}),this.uuid=ze.generateUUID(),this.name="",this.image=void 0!==t?t:Ye.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:Ye.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:yt,this.wrapT=void 0!==n?n:yt,this.magFilter=void 0!==r?r:xt,this.minFilter=void 0!==a?a:Et,this.anisotropy=void 0!==c?c:1,this.format=void 0!==o?o:zt,this.type=void 0!==s?s:Mt,this.offset=new je(0,0),this.repeat=new je(1,1),this.center=new je(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ve,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:Ae,this.version=0,this.onUpdate=null}function Xe(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1}function $e(t,e,i){this.width=t,this.height=e,this.scissor=new Xe(0,0,t,e),this.scissorTest=!1,this.viewport=new Xe(0,0,t,e),i=i||{},this.texture=new Ye(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:xt,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function Ze(t,e,i){$e.call(this,t,e,i),this.samples=4}function Je(t,e,i){$e.call(this,t,e,i)}function Ke(t,e,i,n,r,a,o,s,c,l,u,h){Ye.call(this,null,a,o,s,c,l,n,r,u,h),this.image={data:t,width:e,height:i},this.magFilter=void 0!==c?c:bt,this.minFilter=void 0!==l?l:bt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Qe(t,e){this.min=void 0!==t?t:new Ge(1/0,1/0,1/0),this.max=void 0!==e?e:new Ge(-1/0,-1/0,-1/0)}function ti(t,e){this.center=void 0!==t?t:new Ge,this.radius=void 0!==e?e:0}function ei(t,e){this.normal=void 0!==t?t:new Ge(1,0,0),this.constant=void 0!==e?e:0}function ii(t,e,i,n,r,a){this.planes=[void 0!==t?t:new ei,void 0!==e?e:new ei,void 0!==i?i:new ei,void 0!==n?n:new ei,void 0!==r?r:new ei,void 0!==a?a:new ei]}function ni(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Ye.DEFAULT_IMAGE=void 0,Ye.DEFAULT_MAPPING=lt,Ye.prototype=Object.assign(Object.create(n.prototype),{constructor:Ye,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=ze.generateUUID()),!e&&void 0===t.images[n.uuid]){var r;if(Array.isArray(n)){r=[];for(var a=0,o=n.length;a<o;a++)r.push(We.getDataURL(n[a]))}else r=We.getDataURL(n);t.images[n.uuid]={uuid:n.uuid,url:r}}i.image=n.uuid}return e||(t.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==lt)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case vt:t.x=t.x-Math.floor(t.x);break;case yt:t.x=t.x<0?0:1;break;case _t:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case vt:t.y=t.y-Math.floor(t.y);break;case yt:t.y=t.y<0?0:1;break;case _t:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(Ye.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Xe.prototype,{isVector4:!0,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,a=t.elements;return this.x=a[0]*e+a[4]*i+a[8]*n+a[12]*r,this.y=a[1]*e+a[5]*i+a[9]*n+a[13]*r,this.z=a[2]*e+a[6]*i+a[10]*n+a[14]*r,this.w=a[3]*e+a[7]*i+a[11]*n+a[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,n,r,a=.01,o=.1,s=t.elements,c=s[0],l=s[4],u=s[8],h=s[1],d=s[5],p=s[9],f=s[2],m=s[6],g=s[10];if(Math.abs(l-h)<a&&Math.abs(u-f)<a&&Math.abs(p-m)<a){if(Math.abs(l+h)<o&&Math.abs(u+f)<o&&Math.abs(p+m)<o&&Math.abs(c+d+g-3)<o)return this.set(1,0,0,0),this;e=Math.PI;var v=(c+1)/2,y=(d+1)/2,_=(g+1)/2,b=(l+h)/4,w=(u+f)/4,T=(p+m)/4;return v>y&&v>_?v<a?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(v),n=b/i,r=w/i):y>_?y<a?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(y),i=b/n,r=T/n):_<a?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(_),i=w/r,n=T/r),this.set(i,n,r,e),this}var x=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-l)*(h-l));return Math.abs(x)<.001&&(x=1),this.x=(m-p)/x,this.y=(u-f)/x,this.z=(h-l)/x,this.w=Math.acos((c+d+g-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new Xe,e=new Xe),t.set(i,i,i,i),e.set(n,n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),$e.prototype=Object.assign(Object.create(n.prototype),{constructor:$e,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ze.prototype=Object.assign(Object.create($e.prototype),{constructor:Ze,isWebGLMultisampleRenderTarget:!0,copy:function(t){return $e.prototype.copy.call(this,t),this.samples=t.samples,this}}),Je.prototype=Object.create($e.prototype),Je.prototype.constructor=Je,Je.prototype.isWebGLRenderTargetCube=!0,Ke.prototype=Object.create(Ye.prototype),Ke.prototype.constructor=Ke,Ke.prototype.isDataTexture=!0,Object.assign(Qe.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,c=t.length;s<c;s+=3){var l=t[s],u=t[s+1],h=t[s+2];l<e&&(e=l),u<i&&(i=u),h<n&&(n=h),l>r&&(r=l),u>a&&(a=u),h>o&&(o=h)}return this.min.set(e,i,n),this.max.set(r,a,o),this},setFromBufferAttribute:function(t){for(var e=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,c=t.count;s<c;s++){var l=t.getX(s),u=t.getY(s),h=t.getZ(s);l<e&&(e=l),u<i&&(i=u),h<n&&(n=h),l>r&&(r=l),u>a&&(a=u),h>o&&(o=h)}return this.min.set(e,i,n),this.max.set(r,a,o),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new Ge;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Ge),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Ge),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t,e,i,n=new Ge;function r(r){var a=r.geometry;if(void 0!==a)if(a.isGeometry){var o=a.vertices;for(e=0,i=o.length;e<i;e++)n.copy(o[e]),n.applyMatrix4(r.matrixWorld),t.expandByPoint(n)}else if(a.isBufferGeometry){var s=a.attributes.position;if(void 0!==s)for(e=0,i=s.count;e<i;e++)n.fromBufferAttribute(s,e).applyMatrix4(r.matrixWorld),t.expandByPoint(n)}}return function(e){return t=this,e.updateMatrixWorld(!0),e.traverse(r),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Ge),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new Ge;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant},intersectsTriangle:function(){var t=new Ge,e=new Ge,i=new Ge,n=new Ge,r=new Ge,a=new Ge,o=new Ge,s=new Ge,c=new Ge,l=new Ge;function u(n){var r,a;for(r=0,a=n.length-3;r<=a;r+=3){o.fromArray(n,r);var s=c.x*Math.abs(o.x)+c.y*Math.abs(o.y)+c.z*Math.abs(o.z),l=t.dot(o),u=e.dot(o),h=i.dot(o);if(Math.max(-Math.max(l,u,h),Math.min(l,u,h))>s)return!1}return!0}return function(o){if(this.isEmpty())return!1;this.getCenter(s),c.subVectors(this.max,s),t.subVectors(o.a,s),e.subVectors(o.b,s),i.subVectors(o.c,s),n.subVectors(e,t),r.subVectors(i,e),a.subVectors(t,i);var h=[0,-n.z,n.y,0,-r.z,r.y,0,-a.z,a.y,n.z,0,-n.x,r.z,0,-r.x,a.z,0,-a.x,-n.y,n.x,0,-r.y,r.x,0,-a.y,a.x,0];return!!u(h)&&(h=[1,0,0,0,1,0,0,0,1],!!u(h)&&(l.crossVectors(n,r),h=[l.x,l.y,l.z],u(h)))}}(),clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Ge),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new Ge;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),getBoundingSphere:function(){var t=new Ge;return function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new Ge,new Ge,new Ge,new Ge,new Ge,new Ge,new Ge,new Ge];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(ti.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new Qe;return function(e,i){var n=this.center;void 0!==i?n.copy(i):t.setFromPoints(e).getCenter(n);for(var r=0,a=0,o=e.length;a<o;a++)r=Math.max(r,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Ge),e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Qe),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(ei.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new Ge,e=new Ge;return function(i,n,r){var a=t.subVectors(r,n).cross(e.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(a,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Ge),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new Ge;return function(e,i){void 0===i&&(console.warn("THREE.Plane: .intersectLine() target is now required"),i=new Ge);var n=e.delta(t),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?i.copy(e.start):void 0;var a=-(e.start.dot(this.normal)+this.constant)/r;return a<0||a>1?void 0:i.copy(n).multiplyScalar(a).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Ge),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new Ge,e=new Ve;return function(i,n){var r=n||e.getNormalMatrix(i),a=this.coplanarPoint(t).applyMatrix4(i),o=this.normal.applyMatrix3(r).normalize();return this.constant=-a.dot(o),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(ii.prototype,{set:function(t,e,i,n,r,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;i<6;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],c=i[5],l=i[6],u=i[7],h=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return e[0].setComponents(o-n,u-s,f-h,y-m).normalize(),e[1].setComponents(o+n,u+s,f+h,y+m).normalize(),e[2].setComponents(o+r,u+c,f+d,y+g).normalize(),e[3].setComponents(o-r,u-c,f-d,y-g).normalize(),e[4].setComponents(o-a,u-l,f-p,y-v).normalize(),e[5].setComponents(o+a,u+l,f+p,y+v).normalize(),this},intersectsObject:function(){var t=new ti;return function(e){var i=e.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),t.copy(i.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new ti;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,i=t.center,n=-t.radius,r=0;r<6;r++){var a=e[r].distanceToPoint(i);if(a<n)return!1}return!0},intersectsBox:function(){var t=new Ge;return function(e){for(var i=this.planes,n=0;n<6;n++){var r=i[n];if(t.x=r.normal.x>0?e.max.x:e.min.x,t.y=r.normal.y>0?e.max.y:e.min.y,t.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(t)<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}}),Object.assign(ni.prototype,{isMatrix4:!0,set:function(t,e,i,n,r,a,o,s,c,l,u,h,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=a,g[9]=o,g[13]=s,g[2]=c,g[6]=l,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new ni).fromArray(this.elements)},copy:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(){var t=new Ge;return function(e){var i=this.elements,n=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),a=1/t.setFromMatrixColumn(e,1).length(),o=1/t.setFromMatrixColumn(e,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[3]=0,i[4]=n[4]*a,i[5]=n[5]*a,i[6]=n[6]*a,i[7]=0,i[8]=n[8]*o,i[9]=n[9]*o,i[10]=n[10]*o,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,n=t.y,r=t.z,a=Math.cos(i),o=Math.sin(i),s=Math.cos(n),c=Math.sin(n),l=Math.cos(r),u=Math.sin(r);if("XYZ"===t.order){var h=a*l,d=a*u,p=o*l,f=o*u;e[0]=s*l,e[4]=-s*u,e[8]=c,e[1]=d+p*c,e[5]=h-f*c,e[9]=-o*s,e[2]=f-h*c,e[6]=p+d*c,e[10]=a*s}else if("YXZ"===t.order){var m=s*l,g=s*u,v=c*l,y=c*u;e[0]=m+y*o,e[4]=v*o-g,e[8]=a*c,e[1]=a*u,e[5]=a*l,e[9]=-o,e[2]=g*o-v,e[6]=y+m*o,e[10]=a*s}else if("ZXY"===t.order){m=s*l,g=s*u,v=c*l,y=c*u;e[0]=m-y*o,e[4]=-a*u,e[8]=v+g*o,e[1]=g+v*o,e[5]=a*l,e[9]=y-m*o,e[2]=-a*c,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){h=a*l,d=a*u,p=o*l,f=o*u;e[0]=s*l,e[4]=p*c-d,e[8]=h*c+f,e[1]=s*u,e[5]=f*c+h,e[9]=d*c-p,e[2]=-c,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){var _=a*s,b=a*c,w=o*s,T=o*c;e[0]=s*l,e[4]=T-_*u,e[8]=w*u+b,e[1]=u,e[5]=a*l,e[9]=-o*l,e[2]=-c*l,e[6]=b*u+w,e[10]=_-T*u}else if("XZY"===t.order){_=a*s,b=a*c,w=o*s,T=o*c;e[0]=s*l,e[4]=-u,e[8]=c*l,e[1]=_*u+T,e[5]=a*l,e[9]=b*u-w,e[2]=w*u-b,e[6]=o*l,e[10]=T*u+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(){var t=new Ge(0,0,0),e=new Ge(1,1,1);return function(i){return this.compose(t,i,e)}}(),lookAt:function(){var t=new Ge,e=new Ge,i=new Ge;return function(n,r,a){var o=this.elements;return i.subVectors(n,r),0===i.lengthSq()&&(i.z=1),i.normalize(),t.crossVectors(a,i),0===t.lengthSq()&&(1===Math.abs(a.z)?i.x+=1e-4:i.z+=1e-4,i.normalize(),t.crossVectors(a,i)),t.normalize(),e.crossVectors(i,t),o[0]=t.x,o[4]=e.x,o[8]=i.x,o[1]=t.y,o[5]=e.y,o[9]=i.y,o[2]=t.z,o[6]=e.z,o[10]=i.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,a=i[0],o=i[4],s=i[8],c=i[12],l=i[1],u=i[5],h=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],_=i[11],b=i[15],w=n[0],T=n[4],x=n[8],S=n[12],E=n[1],M=n[5],C=n[9],A=n[13],k=n[2],L=n[6],P=n[10],O=n[14],R=n[3],I=n[7],D=n[11],U=n[15];return r[0]=a*w+o*E+s*k+c*R,r[4]=a*T+o*M+s*L+c*I,r[8]=a*x+o*C+s*P+c*D,r[12]=a*S+o*A+s*O+c*U,r[1]=l*w+u*E+h*k+d*R,r[5]=l*T+u*M+h*L+d*I,r[9]=l*x+u*C+h*P+d*D,r[13]=l*S+u*A+h*O+d*U,r[2]=p*w+f*E+m*k+g*R,r[6]=p*T+f*M+m*L+g*I,r[10]=p*x+f*C+m*P+g*D,r[14]=p*S+f*A+m*O+g*U,r[3]=v*w+y*E+_*k+b*R,r[7]=v*T+y*M+_*L+b*I,r[11]=v*x+y*C+_*P+b*D,r[15]=v*S+y*A+_*O+b*U,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new Ge;return function(e){for(var i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.applyMatrix4(this),e.setXYZ(i,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],a=t[1],o=t[5],s=t[9],c=t[13],l=t[2],u=t[6],h=t[10],d=t[14],p=t[3],f=t[7],m=t[11],g=t[15];return p*(+r*s*u-n*c*u-r*o*h+i*c*h+n*o*d-i*s*d)+f*(+e*s*d-e*c*h+r*a*h-n*a*d+n*c*l-r*s*l)+m*(+e*c*u-e*o*d-r*a*u+i*a*d+r*o*l-i*c*l)+g*(-n*o*l-e*s*u+e*o*h+n*a*u-i*a*h+i*s*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,n=t.elements,r=n[0],a=n[1],o=n[2],s=n[3],c=n[4],l=n[5],u=n[6],h=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],_=n[15],b=p*y*h-v*f*h+v*u*m-l*y*m-p*u*_+l*f*_,w=g*f*h-d*y*h-g*u*m+c*y*m+d*u*_-c*f*_,T=d*v*h-g*p*h+g*l*m-c*v*m-d*l*_+c*p*_,x=g*p*u-d*v*u-g*l*f+c*v*f+d*l*y-c*p*y,S=r*b+a*w+o*T+s*x;if(0===S){var E="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(E);return console.warn(E),this.identity()}var M=1/S;return i[0]=b*M,i[1]=(v*f*s-p*y*s-v*o*m+a*y*m+p*o*_-a*f*_)*M,i[2]=(l*y*s-v*u*s+v*o*h-a*y*h-l*o*_+a*u*_)*M,i[3]=(p*u*s-l*f*s-p*o*h+a*f*h+l*o*m-a*u*m)*M,i[4]=w*M,i[5]=(d*y*s-g*f*s+g*o*m-r*y*m-d*o*_+r*f*_)*M,i[6]=(g*u*s-c*y*s-g*o*h+r*y*h+c*o*_-r*u*_)*M,i[7]=(c*f*s-d*u*s+d*o*h-r*f*h-c*o*m+r*u*m)*M,i[8]=T*M,i[9]=(g*p*s-d*v*s-g*a*m+r*v*m+d*a*_-r*p*_)*M,i[10]=(c*v*s-g*l*s+g*a*h-r*v*h-c*a*_+r*l*_)*M,i[11]=(d*l*s-c*p*s-d*a*h+r*p*h+c*a*m-r*l*m)*M,i[12]=x*M,i[13]=(d*v*o-g*p*o+g*a*f-r*v*f-d*a*y+r*p*y)*M,i[14]=(g*l*o-c*v*o-g*a*u+r*v*u+c*a*y-r*l*y)*M,i[15]=(c*p*o-d*l*o+d*a*u-r*p*u-c*a*f+r*l*f)*M,this},scale:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=1-i,a=t.x,o=t.y,s=t.z,c=r*a,l=r*o;return this.set(c*a+i,c*o-n*s,c*s+n*o,0,c*o+n*s,l*o+i,l*s-n*a,0,c*s-n*o,l*s+n*a,r*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,i){var n=this.elements,r=e._x,a=e._y,o=e._z,s=e._w,c=r+r,l=a+a,u=o+o,h=r*c,d=r*l,p=r*u,f=a*l,m=a*u,g=o*u,v=s*c,y=s*l,_=s*u,b=i.x,w=i.y,T=i.z;return n[0]=(1-(f+g))*b,n[1]=(d+_)*b,n[2]=(p-y)*b,n[3]=0,n[4]=(d-_)*w,n[5]=(1-(h+g))*w,n[6]=(m+v)*w,n[7]=0,n[8]=(p+y)*T,n[9]=(m-v)*T,n[10]=(1-(h+f))*T,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this},decompose:function(){var t=new Ge,e=new ni;return function(i,n,r){var a=this.elements,o=t.set(a[0],a[1],a[2]).length(),s=t.set(a[4],a[5],a[6]).length(),c=t.set(a[8],a[9],a[10]).length(),l=this.determinant();l<0&&(o=-o),i.x=a[12],i.y=a[13],i.z=a[14],e.copy(this);var u=1/o,h=1/s,d=1/c;return e.elements[0]*=u,e.elements[1]*=u,e.elements[2]*=u,e.elements[4]*=h,e.elements[5]*=h,e.elements[6]*=h,e.elements[8]*=d,e.elements[9]*=d,e.elements[10]*=d,n.setFromRotationMatrix(e),r.x=o,r.y=s,r.z=c,this}}(),makePerspective:function(t,e,i,n,r,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*r/(e-t),c=2*r/(i-n),l=(e+t)/(e-t),u=(i+n)/(i-n),h=-(a+r)/(a-r),d=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=c,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,i,n,r,a){var o=this.elements,s=1/(e-t),c=1/(i-n),l=1/(a-r),u=(e+t)*s,h=(i+n)*c,d=(a+r)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,n=0;n<16;n++)if(e[n]!==i[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<16;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}});var ri="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",ai="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",oi="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",si="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",ci="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",li="vec3 transformed = vec3( position );",ui="vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",hi="vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick( specularColor, dotNV );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}",di="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",pi="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",fi="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",mi="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",gi="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",vi="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",yi="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",_i="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",bi="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",wi="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}",Ti="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",xi="vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",Si="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",Ei="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif",Mi="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",Ci="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",Ai="gl_FragColor = linearToOutputTexel( gl_FragColor );",ki="\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",Li="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",Pi="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",Oi="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",Ri="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",Ii="#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",Di="#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",Ui="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",Ni="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",Bi="#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",Fi="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",zi="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",ji="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",Hi="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",Gi="#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",Vi="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",Wi="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",qi="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif",Yi="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#endif\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\tfloat clearCoatInv = 1.0 - clearCoatDHR;\n\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec3 singleScattering = vec3( 0.0 );\n\t\tvec3 multiScattering = vec3( 0.0 );\n\t\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\t\tvec3 diffuse = material.diffuseColor;\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * singleScattering;\n\t\treflectedLight.indirectDiffuse += multiScattering * cosineWeightedIrradiance;\n\t\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\t#else\n\t\treflectedLight.indirectSpecular += clearCoatInv * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#endif\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",Xi="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif",$i="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif",Zi="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, irradiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif",Ji="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",Ki="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n#endif",Qi="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",tn="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif",en="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",nn="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",rn="#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif",an="#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif",on="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",sn="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",cn="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",ln="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",un="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",hn="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif",dn="#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\t#ifdef USE_TANGENT\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy = normalScale * mapN.xy;\n\t\t\tnormal = normalize( vTBN * mapN );\n\t\t#else\n\t\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t\t#endif\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",pn="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif",fn="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",mn="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",gn="vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;",vn="#if defined( DITHERING )\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",yn="#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",_n="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",bn="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",wn="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",Tn="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif",xn="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",Sn="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",En="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",Mn="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",Cn="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",An="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",kn="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",Ln="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",Pn="#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",On="#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",Rn="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",In="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",Dn="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",Un="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",Nn="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",Bn="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",Fn="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif",zn="uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",jn="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",Hn="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",Gn="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",Vn="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",Wn="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",qn="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",Yn="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",Xn="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",$n="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",Zn="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",Jn="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",Kn="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",Qn="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",tr="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",er="#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",ir="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",nr="#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",rr="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",ar="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",or="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",sr="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",cr="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",lr="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",ur="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",hr="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",dr="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",pr="#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",fr="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",mr="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",gr={alphamap_fragment:ri,alphamap_pars_fragment:ai,alphatest_fragment:oi,aomap_fragment:si,aomap_pars_fragment:ci,begin_vertex:li,beginnormal_vertex:ui,bsdfs:hi,bumpmap_pars_fragment:di,clipping_planes_fragment:pi,clipping_planes_pars_fragment:fi,clipping_planes_pars_vertex:mi,clipping_planes_vertex:gi,color_fragment:vi,color_pars_fragment:yi,color_pars_vertex:_i,color_vertex:bi,common:wi,cube_uv_reflection_fragment:Ti,defaultnormal_vertex:xi,displacementmap_pars_vertex:Si,displacementmap_vertex:Ei,emissivemap_fragment:Mi,emissivemap_pars_fragment:Ci,encodings_fragment:Ai,encodings_pars_fragment:ki,envmap_fragment:Li,envmap_pars_fragment:Pi,envmap_pars_vertex:Oi,envmap_physical_pars_fragment:Gi,envmap_vertex:Ri,fog_vertex:Ii,fog_pars_vertex:Di,fog_fragment:Ui,fog_pars_fragment:Ni,gradientmap_pars_fragment:Bi,lightmap_fragment:Fi,lightmap_pars_fragment:zi,lights_lambert_vertex:ji,lights_pars_begin:Hi,lights_phong_fragment:Vi,lights_phong_pars_fragment:Wi,lights_physical_fragment:qi,lights_physical_pars_fragment:Yi,lights_fragment_begin:Xi,lights_fragment_maps:$i,lights_fragment_end:Zi,logdepthbuf_fragment:Ji,logdepthbuf_pars_fragment:Ki,logdepthbuf_pars_vertex:Qi,logdepthbuf_vertex:tn,map_fragment:en,map_pars_fragment:nn,map_particle_fragment:rn,map_particle_pars_fragment:an,metalnessmap_fragment:on,metalnessmap_pars_fragment:sn,morphnormal_vertex:cn,morphtarget_pars_vertex:ln,morphtarget_vertex:un,normal_fragment_begin:hn,normal_fragment_maps:dn,normalmap_pars_fragment:pn,packing:fn,premultiplied_alpha_fragment:mn,project_vertex:gn,dithering_fragment:vn,dithering_pars_fragment:yn,roughnessmap_fragment:_n,roughnessmap_pars_fragment:bn,shadowmap_pars_fragment:wn,shadowmap_pars_vertex:Tn,shadowmap_vertex:xn,shadowmask_pars_fragment:Sn,skinbase_vertex:En,skinning_pars_vertex:Mn,skinning_vertex:Cn,skinnormal_vertex:An,specularmap_fragment:kn,specularmap_pars_fragment:Ln,tonemapping_fragment:Pn,tonemapping_pars_fragment:On,uv_pars_fragment:Rn,uv_pars_vertex:In,uv_vertex:Dn,uv2_pars_fragment:Un,uv2_pars_vertex:Nn,uv2_vertex:Bn,worldpos_vertex:Fn,background_frag:zn,background_vert:jn,cube_frag:Hn,cube_vert:Gn,depth_frag:Vn,depth_vert:Wn,distanceRGBA_frag:qn,distanceRGBA_vert:Yn,equirect_frag:Xn,equirect_vert:$n,linedashed_frag:Zn,linedashed_vert:Jn,meshbasic_frag:Kn,meshbasic_vert:Qn,meshlambert_frag:tr,meshlambert_vert:er,meshmatcap_frag:ir,meshmatcap_vert:nr,meshphong_frag:rr,meshphong_vert:ar,meshphysical_frag:or,meshphysical_vert:sr,normal_frag:cr,normal_vert:lr,points_frag:ur,points_vert:hr,shadow_frag:dr,shadow_vert:pr,sprite_frag:fr,sprite_vert:mr};function vr(t){var e={};for(var i in t)for(var n in e[i]={},t[i]){var r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}return e}function yr(t){for(var e={},i=0;i<t.length;i++){var n=vr(t[i]);for(var r in n)e[r]=n[r]}return e}var _r={clone:vr,merge:yr},br={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function wr(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}Object.assign(wr.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(){function t(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}return function(e,i,n){if(e=ze.euclideanModulo(e,1),i=ze.clamp(i,0,1),n=ze.clamp(n,0,1),0===i)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+i):n+i-n*i,a=2*n-r;this.r=t(a,r,e+1/3),this.g=t(a,r,e),this.b=t(a,r,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,r=i[1],a=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,c=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(o,s,c)}break}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l=i[1],u=l.length;if(3===u)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}if(t&&t.length>0){l=br[t];void 0!==l?this.setHex(l):console.warn("THREE.Color: Unknown color "+t)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(){function t(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}return function(e){return this.r=t(e.r),this.g=t(e.g),this.b=t(e.b),this}}(),copyLinearToSRGB:function(){function t(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}return function(e){return this.r=t(e.r),this.g=t(e.g),this.b=t(e.b),this}}(),convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,i,n=this.r,r=this.g,a=this.b,o=Math.max(n,r,a),s=Math.min(n,r,a),c=(s+o)/2;if(s===o)e=0,i=0;else{var l=o-s;switch(i=c<=.5?l/(o+s):l/(2-o-s),o){case n:e=(r-a)/l+(r<a?6:0);break;case r:e=(a-n)/l+2;break;case a:e=(n-r)/l+4;break}e/=6}return t.h=e,t.s=i,t.l=c,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var t={};return function(e,i,n){return this.getHSL(t),t.h+=e,t.s+=i,t.l+=n,this.setHSL(t.h,t.s,t.l),this}}(),add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(){var t={h:0,s:0,l:0},e={h:0,s:0,l:0};return function(i,n){this.getHSL(t),i.getHSL(e);var r=ze.lerp(t.h,e.h,n),a=ze.lerp(t.s,e.s,n),o=ze.lerp(t.l,e.l,n);return this.setHSL(r,a,o),this}}(),equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var Tr={common:{diffuse:{value:new wr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ve},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new je(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new wr(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new wr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Ve}},sprite:{diffuse:{value:new wr(15658734)},opacity:{value:1},center:{value:new je(.5,.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new Ve}}},xr={basic:{uniforms:yr([Tr.common,Tr.specularmap,Tr.envmap,Tr.aomap,Tr.lightmap,Tr.fog]),vertexShader:gr.meshbasic_vert,fragmentShader:gr.meshbasic_frag},lambert:{uniforms:yr([Tr.common,Tr.specularmap,Tr.envmap,Tr.aomap,Tr.lightmap,Tr.emissivemap,Tr.fog,Tr.lights,{emissive:{value:new wr(0)}}]),vertexShader:gr.meshlambert_vert,fragmentShader:gr.meshlambert_frag},phong:{uniforms:yr([Tr.common,Tr.specularmap,Tr.envmap,Tr.aomap,Tr.lightmap,Tr.emissivemap,Tr.bumpmap,Tr.normalmap,Tr.displacementmap,Tr.gradientmap,Tr.fog,Tr.lights,{emissive:{value:new wr(0)},specular:{value:new wr(1118481)},shininess:{value:30}}]),vertexShader:gr.meshphong_vert,fragmentShader:gr.meshphong_frag},standard:{uniforms:yr([Tr.common,Tr.envmap,Tr.aomap,Tr.lightmap,Tr.emissivemap,Tr.bumpmap,Tr.normalmap,Tr.displacementmap,Tr.roughnessmap,Tr.metalnessmap,Tr.fog,Tr.lights,{emissive:{value:new wr(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:gr.meshphysical_vert,fragmentShader:gr.meshphysical_frag},matcap:{uniforms:yr([Tr.common,Tr.bumpmap,Tr.normalmap,Tr.displacementmap,Tr.fog,{matcap:{value:null}}]),vertexShader:gr.meshmatcap_vert,fragmentShader:gr.meshmatcap_frag},points:{uniforms:yr([Tr.points,Tr.fog]),vertexShader:gr.points_vert,fragmentShader:gr.points_frag},dashed:{uniforms:yr([Tr.common,Tr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:gr.linedashed_vert,fragmentShader:gr.linedashed_frag},depth:{uniforms:yr([Tr.common,Tr.displacementmap]),vertexShader:gr.depth_vert,fragmentShader:gr.depth_frag},normal:{uniforms:yr([Tr.common,Tr.bumpmap,Tr.normalmap,Tr.displacementmap,{opacity:{value:1}}]),vertexShader:gr.normal_vert,fragmentShader:gr.normal_frag},sprite:{uniforms:yr([Tr.sprite,Tr.fog]),vertexShader:gr.sprite_vert,fragmentShader:gr.sprite_frag},background:{uniforms:{uvTransform:{value:new Ve},t2D:{value:null}},vertexShader:gr.background_vert,fragmentShader:gr.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:gr.cube_vert,fragmentShader:gr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:gr.equirect_vert,fragmentShader:gr.equirect_frag},distanceRGBA:{uniforms:yr([Tr.common,Tr.displacementmap,{referencePosition:{value:new Ge},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:gr.distanceRGBA_vert,fragmentShader:gr.distanceRGBA_frag},shadow:{uniforms:yr([Tr.lights,Tr.fog,{color:{value:new wr(0)},opacity:{value:1}}]),vertexShader:gr.shadow_vert,fragmentShader:gr.shadow_frag}};function Sr(){var t=null,e=!1,i=null;function n(r,a){!1!==e&&(i(r,a),t.requestAnimationFrame(n))}return{start:function(){!0!==e&&null!==i&&(t.requestAnimationFrame(n),e=!0)},stop:function(){e=!1},setAnimationLoop:function(t){i=t},setContext:function(e){t=e}}}function Er(t){var e=new WeakMap;function i(e,i){var n=e.array,r=e.dynamic?35048:35044,a=t.createBuffer();t.bindBuffer(i,a),t.bufferData(i,n,r),e.onUploadCallback();var o=5126;return n instanceof Float32Array?o=5126:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?o=5123:n instanceof Int16Array?o=5122:n instanceof Uint32Array?o=5125:n instanceof Int32Array?o=5124:n instanceof Int8Array?o=5120:n instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version}}function n(e,i,n){var r=i.array,a=i.updateRange;t.bindBuffer(n,e),!1===i.dynamic?t.bufferData(n,r,35044):-1===a.count?t.bufferSubData(n,0,r):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(n,a.offset*r.BYTES_PER_ELEMENT,r.subarray(a.offset,a.offset+a.count)),a.count=-1)}function r(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)}function a(i){i.isInterleavedBufferAttribute&&(i=i.data);var n=e.get(i);n&&(t.deleteBuffer(n.buffer),e.delete(i))}function o(t,r){t.isInterleavedBufferAttribute&&(t=t.data);var a=e.get(t);void 0===a?e.set(t,i(t,r)):a.version<t.version&&(n(a.buffer,t,r),a.version=t.version)}return{get:r,remove:a,update:o}}function Mr(t,e,i,n,r,a){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new Ge,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new wr,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0}function Cr(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||Cr.DefaultOrder}function Ar(){this.mask=1}xr.physical={uniforms:yr([xr.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:gr.meshphysical_vert,fragmentShader:gr.meshphysical_frag},Object.assign(Mr.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}}),Cr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Cr.DefaultOrder="XYZ",Object.defineProperties(Cr.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(Cr.prototype,{isEuler:!0,set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var n=ze.clamp,r=t.elements,a=r[0],o=r[4],s=r[8],c=r[1],l=r[5],u=r[9],h=r[2],d=r[6],p=r[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,l),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-h,a),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(c,a))):"ZYX"===e?(this._y=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-o,l))):"YZX"===e?(this._z=Math.asin(n(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===e?(this._z=Math.asin(-n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(d,l),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-u,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new ni;return function(e,i,n){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,i,n)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new He;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Ge(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(Ar.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!==(this.mask&t.mask)}});var kr=0;function Lr(){Object.defineProperty(this,"id",{value:kr++}),this.uuid=ze.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Lr.DefaultUp.clone();var t=new Ge,e=new Cr,i=new He,n=new Ge(1,1,1);function r(){i.setFromEuler(e,!1)}function a(){e.setFromQuaternion(i,void 0,!1)}e.onChange(r),i.onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new ni},normalMatrix:{value:new Ve}}),this.matrix=new ni,this.matrixWorld=new ni,this.matrixAutoUpdate=Lr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ar,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Lr.DefaultUp=new Ge(0,1,0),Lr.DefaultMatrixAutoUpdate=!0,Lr.prototype=Object.assign(Object.create(n.prototype),{constructor:Lr,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new He;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.multiply(t),this}}(),rotateOnWorldAxis:function(){var t=new He;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new Ge(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new Ge(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new Ge(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new Ge;return function(e,i){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(i)),this}}(),translateX:function(){var t=new Ge(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new Ge(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new Ge(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new ni;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new He,e=new ni,i=new Ge,n=new Ge;return function(r,a,o){r.isVector3?i.copy(r):i.set(r,a,o);var s=this.parent;this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?e.lookAt(n,i,this.up):e.lookAt(i,n,this.up),this.quaternion.setFromRotationMatrix(e),s&&(e.extractRotation(s.matrixWorld),t.setFromRotationMatrix(e),this.quaternion.premultiply(t.inverse()))}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var i=this.children.indexOf(t);return-1!==i&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(i,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i],a=r.getObjectByProperty(t,e);if(void 0!==a)return a}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Ge),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new Ge,e=new Ge;return function(i){return void 0===i&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),i=new He),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,i,e),i}}(),getWorldScale:function(){var t=new Ge,e=new He;return function(i){return void 0===i&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),i=new Ge),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,i),i}}(),getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new Ge),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var i=this.parent;if(!0===t&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var n=this.children,r=0,a=n.length;r<a;r++)n[r].updateWorldMatrix(!1,!0)},toJSON:function(t){var e=void 0===t||"string"===typeof t,i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function r(e,i){return void 0===e[i.uuid]&&(e[i.uuid]=i.toJSON(t)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isMesh&&this.drawMode!==Ee&&(n.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){n.geometry=r(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,c=o.length;s<c;s++){var l=o[s];r(t.shapes,l)}else r(t.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var u=[];for(s=0,c=this.material.length;s<c;s++)u.push(r(t.materials,this.material[s]));n.material=u}else n.material=r(t.materials,this.material);if(this.children.length>0){n.children=[];for(s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(t).object)}if(e){var h=m(t.geometries),d=m(t.materials),p=m(t.textures),f=m(t.images);o=m(t.shapes);h.length>0&&(i.geometries=h),d.length>0&&(i.materials=d),p.length>0&&(i.textures=p),f.length>0&&(i.images=f),o.length>0&&(i.shapes=o)}return i.object=n,i;function m(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var i=0;i<t.children.length;i++){var n=t.children[i];this.add(n.clone())}return this}});var Pr=0;function Or(){Object.defineProperty(this,"id",{value:Pr+=2}),this.uuid=ze.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Rr(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Ir(t,e,i){Rr.call(this,new Int8Array(t),e,i)}function Dr(t,e,i){Rr.call(this,new Uint8Array(t),e,i)}function Ur(t,e,i){Rr.call(this,new Uint8ClampedArray(t),e,i)}function Nr(t,e,i){Rr.call(this,new Int16Array(t),e,i)}function Br(t,e,i){Rr.call(this,new Uint16Array(t),e,i)}function Fr(t,e,i){Rr.call(this,new Int32Array(t),e,i)}function zr(t,e,i){Rr.call(this,new Uint32Array(t),e,i)}function jr(t,e,i){Rr.call(this,new Float32Array(t),e,i)}function Hr(t,e,i){Rr.call(this,new Float64Array(t),e,i)}function Gr(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Vr(t){if(0===t.length)return-1/0;for(var e=t[0],i=1,n=t.length;i<n;++i)t[i]>e&&(e=t[i]);return e}Or.prototype=Object.assign(Object.create(n.prototype),{constructor:Or,isGeometry:!0,applyMatrix:function(t){for(var e=(new Ve).getNormalMatrix(t),i=0,n=this.vertices.length;i<n;i++){var r=this.vertices[i];r.applyMatrix4(t)}for(i=0,n=this.faces.length;i<n;i++){var a=this.faces[i];a.normal.applyMatrix3(e).normalize();for(var o=0,s=a.vertexNormals.length;o<s;o++)a.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new ni;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new ni;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new ni;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new ni;return function(e,i,n){return t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t=new ni;return function(e,i,n){return t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t=new Lr;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){var e=this,i=null!==t.index?t.index.array:void 0,n=t.attributes,r=n.position.array,a=void 0!==n.normal?n.normal.array:void 0,o=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,c=void 0!==n.uv2?n.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var l=0,u=0;l<r.length;l+=3,u+=2)e.vertices.push((new Ge).fromArray(r,l)),void 0!==o&&e.colors.push((new wr).fromArray(o,l));function h(t,i,n,r){var l=void 0===o?[]:[e.colors[t].clone(),e.colors[i].clone(),e.colors[n].clone()],u=void 0===a?[]:[(new Ge).fromArray(a,3*t),(new Ge).fromArray(a,3*i),(new Ge).fromArray(a,3*n)],h=new Mr(t,i,n,u,l,r);e.faces.push(h),void 0!==s&&e.faceVertexUvs[0].push([(new je).fromArray(s,2*t),(new je).fromArray(s,2*i),(new je).fromArray(s,2*n)]),void 0!==c&&e.faceVertexUvs[1].push([(new je).fromArray(c,2*t),(new je).fromArray(c,2*i),(new je).fromArray(c,2*n)])}var d=t.groups;if(d.length>0)for(l=0;l<d.length;l++)for(var p=d[l],f=p.start,m=p.count,g=(u=f,f+m);u<g;u+=3)void 0!==i?h(i[u],i[u+1],i[u+2],p.materialIndex):h(u,u+1,u+2,p.materialIndex);else if(void 0!==i)for(l=0;l<i.length;l+=3)h(i[l],i[l+1],i[l+2]);else for(l=0;l<r.length/3;l+=3)h(l,l+1,l+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){var t=new Ge;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,i=0===e?1:1/e,n=new ni;return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new Ge,e=new Ge,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,o),e.subVectors(a,o),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){var e,i,n,r,a,o;for(void 0===t&&(t=!0),o=new Array(this.vertices.length),e=0,i=this.vertices.length;e<i;e++)o[e]=new Ge;if(t){var s,c,l,u=new Ge,h=new Ge;for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],s=this.vertices[a.a],c=this.vertices[a.b],l=this.vertices[a.c],u.subVectors(l,c),h.subVectors(s,c),u.cross(h),o[a.a].add(u),o[a.b].add(u),o[a.c].add(u)}else for(this.computeFaceNormals(),n=0,r=this.faces.length;n<r;n++)a=this.faces[n],o[a.a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(e=0,i=this.vertices.length;e<i;e++)o[e].normalize();for(n=0,r=this.faces.length;n<r;n++){a=this.faces[n];var d=a.vertexNormals;3===d.length?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,i;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){i=this.faces[t];var n=i.vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,i,n,r;for(i=0,n=this.faces.length;i<n;i++)for(r=this.faces[i],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;t<e;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var a=new Or;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var o=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)c=new Ge,l={a:new Ge,b:new Ge,c:new Ge},o.push(c),s.push(l)}var c,l,u=this.morphNormals[t];for(a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals(),i=0,n=this.faces.length;i<n;i++)r=this.faces[i],c=u.faceNormals[i],l=u.vertexNormals[i],c.copy(r.normal),l.a.copy(r.vertexNormals[0]),l.b.copy(r.vertexNormals[1]),l.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)r=this.faces[i],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Qe),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new ti),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if(t&&t.isGeometry){var n,r=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,c=t.faces,l=this.faceVertexUvs[0],u=t.faceVertexUvs[0],h=this.colors,d=t.colors;void 0===i&&(i=0),void 0!==e&&(n=(new Ve).getNormalMatrix(e));for(var p=0,f=o.length;p<f;p++){var m=o[p],g=m.clone();void 0!==e&&g.applyMatrix4(e),a.push(g)}for(p=0,f=d.length;p<f;p++)h.push(d[p].clone());for(p=0,f=c.length;p<f;p++){var v,y,_,b=c[p],w=b.vertexNormals,T=b.vertexColors;v=new Mr(b.a+r,b.b+r,b.c+r),v.normal.copy(b.normal),void 0!==n&&v.normal.applyMatrix3(n).normalize();for(var x=0,S=w.length;x<S;x++)y=w[x].clone(),void 0!==n&&y.applyMatrix3(n).normalize(),v.vertexNormals.push(y);v.color.copy(b.color);for(x=0,S=T.length;x<S;x++)_=T[x],v.vertexColors.push(_.clone());v.materialIndex=b.materialIndex+i,s.push(v)}for(p=0,f=u.length;p<f;p++){var E=u[p],M=[];if(void 0!==E){for(x=0,S=E.length;x<S;x++)M.push(E[x].clone());l.push(M)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,i,n,r,a,o,s,c={},l=[],u=[],h=4,d=Math.pow(10,h);for(i=0,n=this.vertices.length;i<n;i++)t=this.vertices[i],e=Math.round(t.x*d)+"_"+Math.round(t.y*d)+"_"+Math.round(t.z*d),void 0===c[e]?(c[e]=i,l.push(this.vertices[i]),u[i]=l.length-1):u[i]=u[c[e]];var p=[];for(i=0,n=this.faces.length;i<n;i++){r=this.faces[i],r.a=u[r.a],r.b=u[r.b],r.c=u[r.c],a=[r.a,r.b,r.c];for(var f=0;f<3;f++)if(a[f]===a[(f+1)%3]){p.push(i);break}}for(i=p.length-1;i>=0;i--){var m=p[i];for(this.faces.splice(m,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(m,1)}var g=this.vertices.length-l.length;return this.vertices=l,g},setFromPoints:function(t){this.vertices=[];for(var e=0,i=t.length;e<i;e++){var n=t[e];this.vertices.push(new Ge(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,i=0;i<e;i++)t[i]._id=i;function n(t,e){return t.materialIndex-e.materialIndex}t.sort(n);var r,a,o=this.faceVertexUvs[0],s=this.faceVertexUvs[1];o&&o.length===e&&(r=[]),s&&s.length===e&&(a=[]);for(i=0;i<e;i++){var c=t[i]._id;r&&r.push(o[c]),a&&a.push(s[c])}r&&(this.faceVertexUvs[0]=r),a&&(this.faceVertexUvs[1]=a)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}for(var n=[],r=0;r<this.vertices.length;r++){var a=this.vertices[r];n.push(a.x,a.y,a.z)}var o=[],s=[],c={},l=[],u={},h=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=!0,m=!1,g=void 0!==this.faceVertexUvs[0][r],v=p.normal.length()>0,y=p.vertexNormals.length>0,_=1!==p.color.r||1!==p.color.g||1!==p.color.b,b=p.vertexColors.length>0,w=0;if(w=E(w,0,0),w=E(w,1,f),w=E(w,2,m),w=E(w,3,g),w=E(w,4,v),w=E(w,5,y),w=E(w,6,_),w=E(w,7,b),o.push(w),o.push(p.a,p.b,p.c),o.push(p.materialIndex),g){var T=this.faceVertexUvs[0][r];o.push(A(T[0]),A(T[1]),A(T[2]))}if(v&&o.push(M(p.normal)),y){var x=p.vertexNormals;o.push(M(x[0]),M(x[1]),M(x[2]))}if(_&&o.push(C(p.color)),b){var S=p.vertexColors;o.push(C(S[0]),C(S[1]),C(S[2]))}}function E(t,e,i){return i?t|1<<e:t&~(1<<e)}function M(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]?c[e]:(c[e]=s.length/3,s.push(t.x,t.y,t.z),c[e])}function C(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==u[e]?u[e]:(u[e]=l.length,l.push(t.getHex()),u[e])}function A(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]?d[e]:(d[e]=h.length/2,h.push(t.x,t.y),d[e])}return t.data={},t.data.vertices=n,t.data.normals=s,l.length>0&&(t.data.colors=l),h.length>0&&(t.data.uvs=[h]),t.data.faces=o,t},clone:function(){return(new Or).copy(this)},copy:function(t){var e,i,n,r,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,i=s.length;e<i;e++)this.vertices.push(s[e].clone());var c=t.colors;for(e=0,i=c.length;e<i;e++)this.colors.push(c[e].clone());var l=t.faces;for(e=0,i=l.length;e<i;e++)this.faces.push(l[e].clone());for(e=0,i=t.faceVertexUvs.length;e<i;e++){var u=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),n=0,r=u.length;n<r;n++){var h=u[n],d=[];for(a=0,o=h.length;a<o;a++){var p=h[a];d.push(p.clone())}this.faceVertexUvs[e].push(d)}}var f=t.morphTargets;for(e=0,i=f.length;e<i;e++){var m={};if(m.name=f[e].name,void 0!==f[e].vertices)for(m.vertices=[],n=0,r=f[e].vertices.length;n<r;n++)m.vertices.push(f[e].vertices[n].clone());if(void 0!==f[e].normals)for(m.normals=[],n=0,r=f[e].normals.length;n<r;n++)m.normals.push(f[e].normals[n].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,i=g.length;e<i;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],n=0,r=g[e].vertexNormals.length;n<r;n++){var y=g[e].vertexNormals[n],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),v.vertexNormals.push(_)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],n=0,r=g[e].faceNormals.length;n<r;n++)v.faceNormals.push(g[e].faceNormals[n].clone());this.morphNormals.push(v)}var b=t.skinWeights;for(e=0,i=b.length;e<i;e++)this.skinWeights.push(b[e].clone());var w=t.skinIndices;for(e=0,i=w.length;e<i;e++)this.skinIndices.push(w[e].clone());var T=t.lineDistances;for(e=0,i=T.length;e<i;e++)this.lineDistances.push(T[e]);var x=t.boundingBox;null!==x&&(this.boundingBox=x.clone());var S=t.boundingSphere;return null!==S&&(this.boundingSphere=S.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Rr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Rr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.itemSize:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),a=new wr),e[i++]=a.r,e[i++]=a.g,e[i++]=a.b}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),a=new je),e[i++]=a.x,e[i++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),a=new Ge),e[i++]=a.x,e[i++]=a.y,e[i++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),a=new Xe),e[i++]=a.x,e[i++]=a.y,e[i++]=a.z,e[i++]=a.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),Ir.prototype=Object.create(Rr.prototype),Ir.prototype.constructor=Ir,Dr.prototype=Object.create(Rr.prototype),Dr.prototype.constructor=Dr,Ur.prototype=Object.create(Rr.prototype),Ur.prototype.constructor=Ur,Nr.prototype=Object.create(Rr.prototype),Nr.prototype.constructor=Nr,Br.prototype=Object.create(Rr.prototype),Br.prototype.constructor=Br,Fr.prototype=Object.create(Rr.prototype),Fr.prototype.constructor=Fr,zr.prototype=Object.create(Rr.prototype),zr.prototype.constructor=zr,jr.prototype=Object.create(Rr.prototype),jr.prototype.constructor=jr,Hr.prototype=Object.create(Rr.prototype),Hr.prototype.constructor=Hr,Object.assign(Gr.prototype,{computeGroups:function(t){for(var e,i=[],n=void 0,r=t.faces,a=0;a<r.length;a++){var o=r[a];o.materialIndex!==n&&(n=o.materialIndex,void 0!==e&&(e.count=3*a-e.start,i.push(e)),e={start:3*a,materialIndex:n})}void 0!==e&&(e.count=3*a-e.start,i.push(e)),this.groups=i},fromGeometry:function(t){var e,i=t.faces,n=t.vertices,r=t.faceVertexUvs,a=r[0]&&r[0].length>0,o=r[1]&&r[1].length>0,s=t.morphTargets,c=s.length;if(c>0){e=[];for(var l=0;l<c;l++)e[l]={name:s[l].name,data:[]};this.morphTargets.position=e}var u,h=t.morphNormals,d=h.length;if(d>0){u=[];for(l=0;l<d;l++)u[l]={name:h[l].name,data:[]};this.morphTargets.normal=u}var p=t.skinIndices,f=t.skinWeights,m=p.length===n.length,g=f.length===n.length;n.length>0&&0===i.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(l=0;l<i.length;l++){var v=i[l];this.vertices.push(n[v.a],n[v.b],n[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var _=v.normal;this.normals.push(_,_,_)}var b=v.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===a){var T=r[0][l];void 0!==T?this.uvs.push(T[0],T[1],T[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new je,new je,new je))}if(!0===o){T=r[1][l];void 0!==T?this.uvs2.push(T[0],T[1],T[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new je,new je,new je))}for(var x=0;x<c;x++){var S=s[x].vertices;e[x].data.push(S[v.a],S[v.b],S[v.c])}for(x=0;x<d;x++){var E=h[x].vertexNormals[l];u[x].data.push(E.a,E.b,E.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Wr=1;function qr(){Object.defineProperty(this,"id",{value:Wr+=2}),this.uuid=ze.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function Yr(t,e,i,n,r,a){Or.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:a},this.fromBufferGeometry(new Xr(t,e,i,n,r,a)),this.mergeVertices()}function Xr(t,e,i,n,r,a){qr.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:a};var o=this;t=t||1,e=e||1,i=i||1,n=Math.floor(n)||1,r=Math.floor(r)||1,a=Math.floor(a)||1;var s=[],c=[],l=[],u=[],h=0,d=0;function p(t,e,i,n,r,a,p,f,m,g,v){var y,_,b=a/m,w=p/g,T=a/2,x=p/2,S=f/2,E=m+1,M=g+1,C=0,A=0,k=new Ge;for(_=0;_<M;_++){var L=_*w-x;for(y=0;y<E;y++){var P=y*b-T;k[t]=P*n,k[e]=L*r,k[i]=S,c.push(k.x,k.y,k.z),k[t]=0,k[e]=0,k[i]=f>0?1:-1,l.push(k.x,k.y,k.z),u.push(y/m),u.push(1-_/g),C+=1}}for(_=0;_<g;_++)for(y=0;y<m;y++){var O=h+y+E*_,R=h+y+E*(_+1),I=h+(y+1)+E*(_+1),D=h+(y+1)+E*_;s.push(O,R,D),s.push(R,I,D),A+=6}o.addGroup(d,A,v),d+=A,h+=C}p("z","y","x",-1,-1,i,e,t,a,r,0),p("z","y","x",1,-1,i,e,-t,a,r,1),p("x","z","y",1,1,t,i,e,n,a,2),p("x","z","y",1,-1,t,i,-e,n,a,3),p("x","y","z",1,-1,t,e,i,n,r,4),p("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(s),this.addAttribute("position",new jr(c,3)),this.addAttribute("normal",new jr(l,3)),this.addAttribute("uv",new jr(u,2))}function $r(t,e,i,n){Or.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new Zr(t,e,i,n)),this.mergeVertices()}function Zr(t,e,i,n){qr.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},t=t||1,e=e||1;var r,a,o=t/2,s=e/2,c=Math.floor(i)||1,l=Math.floor(n)||1,u=c+1,h=l+1,d=t/c,p=e/l,f=[],m=[],g=[],v=[];for(a=0;a<h;a++){var y=a*p-s;for(r=0;r<u;r++){var _=r*d-o;m.push(_,-y,0),g.push(0,0,1),v.push(r/c),v.push(1-a/l)}}for(a=0;a<l;a++)for(r=0;r<c;r++){var b=r+u*a,w=r+u*(a+1),T=r+1+u*(a+1),x=r+1+u*a;f.push(b,w,x),f.push(w,T,x)}this.setIndex(f),this.addAttribute("position",new jr(m,3)),this.addAttribute("normal",new jr(g,3)),this.addAttribute("uv",new jr(v,2))}qr.prototype=Object.assign(Object.create(n.prototype),{constructor:qr,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(Vr(t)>65535?zr:Br)(t,1):this.index=t},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):(this.attributes[t]=e,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(t,new Rr(arguments[1],arguments[2])))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var i=this.attributes.normal;if(void 0!==i){var n=(new Ve).getNormalMatrix(t);n.applyToBufferAttribute(i),i.needsUpdate=!0}var r=this.attributes.tangent;if(void 0!==r){n=(new Ve).getNormalMatrix(t);n.applyToBufferAttribute(r),r.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new ni;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new ni;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new ni;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new ni;return function(e,i,n){return t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t=new ni;return function(e,i,n){return t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t=new Lr;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){var t=new Ge;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var i=new jr(3*e.vertices.length,3),n=new jr(3*e.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var r=new jr(e.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];e.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new jr(e,3)),this},updateFromObject:function(t){var e,i=t.geometry;if(t.isMesh){var n=i.__directGeometry;if(!0===i.elementsNeedUpdate&&(n=void 0,i.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}return!0===i.verticesNeedUpdate&&(e=this.attributes.position,void 0!==e&&(e.copyVector3sArray(i.vertices),e.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(e=this.attributes.normal,void 0!==e&&(e.copyVector3sArray(i.normals),e.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(e=this.attributes.color,void 0!==e&&(e.copyColorsArray(i.colors),e.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(e=this.attributes.uv,void 0!==e&&(e.copyVector2sArray(i.uvs),e.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(e=this.attributes.lineDistance,void 0!==e&&(e.copyArray(i.lineDistances),e.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(t.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Gr).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new Rr(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var i=new Float32Array(3*t.normals.length);this.addAttribute("normal",new Rr(i,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var n=new Float32Array(3*t.colors.length);this.addAttribute("color",new Rr(n,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var r=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new Rr(r,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new Rr(a,2).copyVector2sArray(t.uvs2))}for(var o in this.groups=t.groups,t.morphTargets){for(var s=[],c=t.morphTargets[o],l=0,u=c.length;l<u;l++){var h=c[l],d=new jr(3*h.data.length,3);d.name=h.name,s.push(d.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(t.skinIndices.length>0){var p=new jr(4*t.skinIndices.length,4);this.addAttribute("skinIndex",p.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var f=new jr(4*t.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){var t=new Qe;return function(){null===this.boundingBox&&(this.boundingBox=new Qe);var e=this.attributes.position,i=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),i)for(var n=0,r=i.length;n<r;n++){var a=i[n];t.setFromBufferAttribute(a),this.boundingBox.expandByPoint(t.min),this.boundingBox.expandByPoint(t.max)}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var t=new Qe,e=new Qe,i=new Ge;return function(){null===this.boundingSphere&&(this.boundingSphere=new ti);var n=this.attributes.position,r=this.morphAttributes.position;if(n){var a=this.boundingSphere.center;if(t.setFromBufferAttribute(n),r)for(var o=0,s=r.length;o<s;o++){var c=r[o];e.setFromBufferAttribute(c),t.expandByPoint(e.min),t.expandByPoint(e.max)}t.getCenter(a);var l=0;for(o=0,s=n.count;o<s;o++)i.fromBufferAttribute(n,o),l=Math.max(l,a.distanceToSquared(i));if(r)for(o=0,s=r.length;o<s;o++){c=r[o];for(var u=0,h=c.count;u<h;u++)i.fromBufferAttribute(c,o),l=Math.max(l,a.distanceToSquared(i))}this.boundingSphere.radius=Math.sqrt(l),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var i=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new Rr(new Float32Array(i.length),3));else for(var n=e.normal.array,r=0,a=n.length;r<a;r++)n[r]=0;var o,s,c,l=e.normal.array,u=new Ge,h=new Ge,d=new Ge,p=new Ge,f=new Ge;if(t){var m=t.array;for(r=0,a=t.count;r<a;r+=3)o=3*m[r+0],s=3*m[r+1],c=3*m[r+2],u.fromArray(i,o),h.fromArray(i,s),d.fromArray(i,c),p.subVectors(d,h),f.subVectors(u,h),p.cross(f),l[o]+=p.x,l[o+1]+=p.y,l[o+2]+=p.z,l[s]+=p.x,l[s+1]+=p.y,l[s+2]+=p.z,l[c]+=p.x,l[c+1]+=p.y,l[c+2]+=p.z}else for(r=0,a=i.length;r<a;r+=9)u.fromArray(i,r),h.fromArray(i,r+3),d.fromArray(i,r+6),p.subVectors(d,h),f.subVectors(u,h),p.cross(f),l[r]=p.x,l[r+1]=p.y,l[r+2]=p.z,l[r+3]=p.x,l[r+4]=p.y,l[r+5]=p.z,l[r+6]=p.x,l[r+7]=p.y,l[r+8]=p.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes;for(var n in i)if(void 0!==t.attributes[n])for(var r=i[n],a=r.array,o=t.attributes[n],s=o.array,c=o.itemSize,l=0,u=c*e;l<s.length;l++,u++)a[u]=s[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){var t=new Ge;return function(){for(var e=this.attributes.normal,i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.normalize(),e.setXYZ(i,t.x,t.y,t.z)}}(),toNonIndexed:function(){function t(t,e){for(var i=t.array,n=t.itemSize,r=new i.constructor(e.length*n),a=0,o=0,s=0,c=e.length;s<c;s++){a=e[s]*n;for(var l=0;l<n;l++)r[o++]=i[a++]}return new Rr(r,n)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new qr,i=this.index.array,n=this.attributes;for(var r in n){var a=n[r],o=t(a,i);e.addAttribute(r,o)}var s=this.morphAttributes;for(r in s){for(var c=[],l=s[r],u=0,h=l.length;u<h;u++){a=l[u],o=t(a,i);c.push(o)}e.morphAttributes[r]=c}for(var d=this.groups,p=(u=0,d.length);u<p;u++){var f=d[u];e.addGroup(f.start,f.count,f.materialIndex)}return e},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var n=this.index;null!==n&&(t.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var r=this.attributes;for(var i in r){var a=r[i],o={itemSize:a.itemSize,type:a.array.constructor.name,array:Array.prototype.slice.call(a.array),normalized:a.normalized};""!==a.name&&(o.name=a.name),t.data.attributes[i]=o}var s={},c=!1;for(var i in this.morphAttributes){for(var l=this.morphAttributes[i],u=[],h=0,d=l.length;h<d;h++){a=l[h],o={itemSize:a.itemSize,type:a.array.constructor.name,array:Array.prototype.slice.call(a.array),normalized:a.normalized};""!==a.name&&(o.name=a.name),u.push(o)}u.length>0&&(s[i]=u,c=!0)}c&&(t.data.morphAttributes=s);var p=this.groups;p.length>0&&(t.data.groups=JSON.parse(JSON.stringify(p)));var f=this.boundingSphere;return null!==f&&(t.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),t},clone:function(){return(new qr).copy(this)},copy:function(t){var e,i,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var r=t.index;null!==r&&this.setIndex(r.clone());var a=t.attributes;for(e in a){var o=a[e];this.addAttribute(e,o.clone())}var s=t.morphAttributes;for(e in s){var c=[],l=s[e];for(i=0,n=l.length;i<n;i++)c.push(l[i].clone());this.morphAttributes[e]=c}var u=t.groups;for(i=0,n=u.length;i<n;i++){var h=u[i];this.addGroup(h.start,h.count,h.materialIndex)}var d=t.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=t.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Yr.prototype=Object.create(Or.prototype),Yr.prototype.constructor=Yr,Xr.prototype=Object.create(qr.prototype),Xr.prototype.constructor=Xr,$r.prototype=Object.create(Or.prototype),$r.prototype.constructor=$r,Zr.prototype=Object.create(qr.prototype),Zr.prototype.constructor=Zr;var Jr=0;function Kr(){Object.defineProperty(this,"id",{value:Jr++}),this.uuid=ze.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=E,this.side=g,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=w,this.opacity=1,this.transparent=!1,this.blendSrc=F,this.blendDst=z,this.blendEquation=L,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=$,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.userData={},this.needsUpdate=!0}Kr.prototype=Object.assign(Object.create(n.prototype),{constructor:Kr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i)if("shading"!==e){var n=this[e];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===_;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"===typeof t;e&&(t={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearCoat&&(i.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(i.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity,void 0!==this.combine&&(i.combine=this.combine),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==E&&(i.blending=this.blending),!0===this.flatShading&&(i.flatShading=this.flatShading),this.side!==g&&(i.side=this.side),this.vertexColors!==w&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(i.morphTargets=!0),!0===this.skinning&&(i.skinning=!0),!1===this.visible&&(i.visible=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),e){var r=n(t.textures),a=n(t.images);r.length>0&&(i.textures=r),a.length>0&&(i.images=a)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,i=null;if(null!==e){var n=e.length;i=new Array(n);for(var r=0;r!==n;++r)i[r]=e[r].clone()}return this.clippingPlanes=i,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Qr="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",ta="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function ea(t){Kr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Qr,this.fragmentShader=ta,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function ia(t,e){this.origin=void 0!==t?t:new Ge,this.direction=void 0!==e?e:new Ge}function na(t,e,i){this.a=void 0!==t?t:new Ge,this.b=void 0!==e?e:new Ge,this.c=void 0!==i?i:new Ge}function ra(t){Kr.call(this),this.type="MeshBasicMaterial",this.color=new wr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=tt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function aa(t,e){Lr.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new qr,this.material=void 0!==e?e:new ra({color:16777215*Math.random()}),this.drawMode=Ee,this.updateMorphTargets()}function oa(t,e,i,n){var r,a,o=new wr(0),s=0,c=null,l=0;function u(e,n,u,d){var p=n.background,f=t.vr,m=f.getSession&&f.getSession();if(m&&"additive"===m.environmentBlendMode&&(p=null),null===p?(h(o,s),c=null,l=0):p&&p.isColor&&(h(p,1),d=!0,c=null,l=0),(t.autoClear||d)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLRenderTargetCube)){void 0===a&&(a=new aa(new Xr(1,1,1),new ea({type:"BackgroundCubeMaterial",uniforms:vr(xr.cube.uniforms),vertexShader:xr.cube.vertexShader,fragmentShader:xr.cube.fragmentShader,side:v,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.removeAttribute("normal"),a.geometry.removeAttribute("uv"),a.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.tCube.value}}),i.update(a));var y=p.isWebGLRenderTargetCube?p.texture:p;a.material.uniforms.tCube.value=y,a.material.uniforms.tFlip.value=p.isWebGLRenderTargetCube?1:-1,c===p&&l===y.version||(a.material.needsUpdate=!0,c=p,l=y.version),e.unshift(a,a.geometry,a.material,0,0,null)}else p&&p.isTexture&&(void 0===r&&(r=new aa(new Zr(2,2),new ea({type:"BackgroundMaterial",uniforms:vr(xr.background.uniforms),vertexShader:xr.background.vertexShader,fragmentShader:xr.background.fragmentShader,side:g,depthTest:!1,depthWrite:!1,fog:!1})),r.geometry.removeAttribute("normal"),Object.defineProperty(r.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(r)),r.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),r.material.uniforms.uvTransform.value.copy(p.matrix),c===p&&l===p.version||(r.material.needsUpdate=!0,c=p,l=p.version),e.unshift(r,r.geometry,r.material,0,0,null))}function h(t,i){e.buffers.color.setClear(t.r,t.g,t.b,i,n)}return{getClearColor:function(){return o},setClearColor:function(t,e){o.set(t),s=void 0!==e?e:1,h(o,s)},getClearAlpha:function(){return s},setClearAlpha:function(t){s=t,h(o,s)},render:u}}function sa(t,e,i,n){var r;function a(t){r=t}function o(e,n){t.drawArrays(r,e,n),i.update(n,r)}function s(a,o,s){var c;if(n.isWebGL2)c=t;else if(c=e.get("ANGLE_instanced_arrays"),null===c)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[n.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](r,o,s,a.maxInstancedCount),i.update(s,r,a.maxInstancedCount)}this.setMode=a,this.render=o,this.renderInstances=s}function ca(t,e,i){var n;function r(){if(void 0!==n)return n;var i=e.get("EXT_texture_filter_anisotropic");return n=null!==i?t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,n}function a(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,s=void 0!==i.precision?i.precision:"highp",c=a(s);c!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",c,"instead."),s=c);var l=!0===i.logarithmicDepthBuffer,u=t.getParameter(34930),h=t.getParameter(35660),d=t.getParameter(3379),p=t.getParameter(34076),f=t.getParameter(34921),m=t.getParameter(36347),g=t.getParameter(36348),v=t.getParameter(36349),y=h>0,_=o||!!e.get("OES_texture_float"),b=y&&_,w=o?t.getParameter(36183):0;return{isWebGL2:o,getMaxAnisotropy:r,getMaxPrecision:a,precision:s,logarithmicDepthBuffer:l,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:_,floatVertexTextures:b,maxSamples:w}}function la(){var t=this,e=null,i=0,n=!1,r=!1,a=new ei,o=new Ve,s={value:null,needsUpdate:!1};function c(){s.value!==e&&(s.value=e,s.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function l(e,i,n,r){var c=null!==e?e.length:0,l=null;if(0!==c){if(l=s.value,!0!==r||null===l){var u=n+4*c,h=i.matrixWorldInverse;o.getNormalMatrix(h),(null===l||l.length<u)&&(l=new Float32Array(u));for(var d=0,p=n;d!==c;++d,p+=4)a.copy(e[d]).applyMatrix4(h,o),a.normal.toArray(l,p),l[p+3]=a.constant}s.value=l,s.needsUpdate=!0}return t.numPlanes=c,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,r,a){var o=0!==t.length||r||0!==i||n;return n=r,e=l(t,a,0),i=t.length,o},this.beginShadows=function(){r=!0,l(null)},this.endShadows=function(){r=!1,c()},this.setState=function(t,a,o,u,h,d){if(!n||null===t||0===t.length||r&&!o)r?l(null):c();else{var p=r?0:i,f=4*p,m=h.clippingState||null;s.value=m,m=l(t,u,f,d);for(var g=0;g!==f;++g)m[g]=e[g];h.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=p}}}function ua(t){var e={};return{get:function(i){if(void 0!==e[i])return e[i];var n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),e[i]=n,n}}}function ha(t,e,i){var n={},r={};function a(t){var o=t.target,s=n[o.id];for(var c in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[c]);o.removeEventListener("dispose",a),delete n[o.id];var l=r[s.id];l&&(e.remove(l),delete r[s.id]),i.memory.geometries--}function o(t,e){var r=n[e.id];return r||(e.addEventListener("dispose",a),e.isBufferGeometry?r=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new qr).setFromObject(t)),r=e._bufferGeometry),n[e.id]=r,i.memory.geometries++,r)}function s(t){var i=t.index,n=t.attributes;for(var r in null!==i&&e.update(i,34963),n)e.update(n[r],34962);var a=t.morphAttributes;for(var r in a)for(var o=a[r],s=0,c=o.length;s<c;s++)e.update(o[s],34962)}function c(t){var i=r[t.id];if(i)return i;var n=[],a=t.index,o=t.attributes;if(null!==a)for(var s=a.array,c=0,l=s.length;c<l;c+=3){var u=s[c+0],h=s[c+1],d=s[c+2];n.push(u,h,h,d,d,u)}else for(s=o.position.array,c=0,l=s.length/3-1;c<l;c+=3){u=c+0,h=c+1,d=c+2;n.push(u,h,h,d,d,u)}return i=new(Vr(n)>65535?zr:Br)(n,1),e.update(i,34963),r[t.id]=i,i}return{get:o,update:s,getWireframeAttribute:c}}function da(t,e,i,n){var r,a,o;function s(t){r=t}function c(t){a=t.type,o=t.bytesPerElement}function l(e,n){t.drawElements(r,n,a,e*o),i.update(n,r)}function u(s,c,l){if(n.isWebGL2)u=t;else{var u=e.get("ANGLE_instanced_arrays");if(null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}u[n.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](r,l,a,c*o,s.maxInstancedCount),i.update(l,r,s.maxInstancedCount)}this.setMode=s,this.setIndex=c,this.render=l,this.renderInstances=u}function pa(t){var e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(t,e,n){switch(n=n||1,i.calls++,e){case 4:i.triangles+=n*(t/3);break;case 5:case 6:i.triangles+=n*(t-2);break;case 1:i.lines+=n*(t/2);break;case 3:i.lines+=n*(t-1);break;case 2:i.lines+=n*t;break;case 0:i.points+=n*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",e);break}}function r(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:r,update:n}}function fa(t,e){return Math.abs(e[1])-Math.abs(t[1])}function ma(t){var e={},i=new Float32Array(8);function n(n,r,a,o){var s=n.morphTargetInfluences,c=s.length,l=e[r.id];if(void 0===l){l=[];for(var u=0;u<c;u++)l[u]=[u,0];e[r.id]=l}var h=a.morphTargets&&r.morphAttributes.position,d=a.morphNormals&&r.morphAttributes.normal;for(u=0;u<c;u++){var p=l[u];0!==p[1]&&(h&&r.removeAttribute("morphTarget"+u),d&&r.removeAttribute("morphNormal"+u))}for(u=0;u<c;u++){p=l[u];p[0]=u,p[1]=s[u]}l.sort(fa);for(u=0;u<8;u++){p=l[u];if(p){var f=p[0],m=p[1];if(m){h&&r.addAttribute("morphTarget"+u,h[f]),d&&r.addAttribute("morphNormal"+u,d[f]),i[u]=m;continue}}i[u]=0}o.getUniforms().setValue(t,"morphTargetInfluences",i)}return{update:n}}function ga(t,e){var i={};function n(n){var r=e.render.frame,a=n.geometry,o=t.get(n,a);return i[o.id]!==r&&(a.isGeometry&&o.updateFromObject(n),t.update(o),i[o.id]=r),o}function r(){i={}}return{update:n,dispose:r}}function va(t,e,i,n,r,a,o,s,c,l){t=void 0!==t?t:[],e=void 0!==e?e:ut,o=void 0!==o?o:Ft,Ye.call(this,t,e,i,n,r,a,o,s,c,l),this.flipY=!1}function ya(t,e,i,n){Ye.call(this,null),this.image={data:t,width:e,height:i,depth:n},this.magFilter=bt,this.minFilter=bt,this.wrapR=yt,this.generateMipmaps=!1,this.flipY=!1}function _a(t,e,i,n){Ye.call(this,null),this.image={data:t,width:e,height:i,depth:n},this.magFilter=bt,this.minFilter=bt,this.wrapR=yt,this.generateMipmaps=!1,this.flipY=!1}ea.prototype=Object.create(Kr.prototype),ea.prototype.constructor=ea,ea.prototype.isShaderMaterial=!0,ea.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=vr(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},ea.prototype.toJSON=function(t){var e=Kr.prototype.toJSON.call(this,t);for(var i in e.uniforms={},this.uniforms){var n=this.uniforms[i],r=n.value;r&&r.isTexture?e.uniforms[i]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[i]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[i]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[i]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[i]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[i]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[i]={type:"m4",value:r.toArray()}:e.uniforms[i]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var a={};for(var o in this.extensions)!0===this.extensions[o]&&(a[o]=!0);return Object.keys(a).length>0&&(e.extensions=a),e},Object.assign(ia.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Ge),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new Ge;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Ge),e.subVectors(t,this.origin);var i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new Ge;return function(e){var i=t.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(i).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new Ge,e=new Ge,i=new Ge;return function(n,r,a,o){t.copy(n).add(r).multiplyScalar(.5),e.copy(r).sub(n).normalize(),i.copy(this.origin).sub(t);var s,c,l,u,h=.5*n.distanceTo(r),d=-this.direction.dot(e),p=i.dot(this.direction),f=-i.dot(e),m=i.lengthSq(),g=Math.abs(1-d*d);if(g>0)if(s=d*f-p,c=d*p-f,u=h*g,s>=0)if(c>=-u)if(c<=u){var v=1/g;s*=v,c*=v,l=s*(s+d*c+2*p)+c*(d*s+c+2*f)+m}else c=h,s=Math.max(0,-(d*c+p)),l=-s*s+c*(c+2*f)+m;else c=-h,s=Math.max(0,-(d*c+p)),l=-s*s+c*(c+2*f)+m;else c<=-u?(s=Math.max(0,-(-d*h+p)),c=s>0?-h:Math.min(Math.max(-h,-f),h),l=-s*s+c*(c+2*f)+m):c<=u?(s=0,c=Math.min(Math.max(-h,-f),h),l=c*(c+2*f)+m):(s=Math.max(0,-(d*h+p)),c=s>0?h:Math.min(Math.max(-h,-f),h),l=-s*s+c*(c+2*f)+m);else c=d>0?-h:h,s=Math.max(0,-(d*c+p)),l=-s*s+c*(c+2*f)+m;return a&&a.copy(this.direction).multiplyScalar(s).add(this.origin),o&&o.copy(e).multiplyScalar(c).add(t),l}}(),intersectSphere:function(){var t=new Ge;return function(e,i){t.subVectors(e.center,this.origin);var n=t.dot(this.direction),r=t.dot(t)-n*n,a=e.radius*e.radius;if(r>a)return null;var o=Math.sqrt(a-r),s=n-o,c=n+o;return s<0&&c<0?null:s<0?this.at(c,i):this.at(s,i)}}(),intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;var i=t.normal.dot(this.direction);return i*e<0},intersectBox:function(t,e){var i,n,r,a,o,s,c=1/this.direction.x,l=1/this.direction.y,u=1/this.direction.z,h=this.origin;return c>=0?(i=(t.min.x-h.x)*c,n=(t.max.x-h.x)*c):(i=(t.max.x-h.x)*c,n=(t.min.x-h.x)*c),l>=0?(r=(t.min.y-h.y)*l,a=(t.max.y-h.y)*l):(r=(t.max.y-h.y)*l,a=(t.min.y-h.y)*l),i>a||r>n?null:((r>i||i!==i)&&(i=r),(a<n||n!==n)&&(n=a),u>=0?(o=(t.min.z-h.z)*u,s=(t.max.z-h.z)*u):(o=(t.max.z-h.z)*u,s=(t.min.z-h.z)*u),i>s||o>n?null:((o>i||i!==i)&&(i=o),(s<n||n!==n)&&(n=s),n<0?null:this.at(i>=0?i:n,e)))},intersectsBox:function(){var t=new Ge;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new Ge,e=new Ge,i=new Ge,n=new Ge;return function(r,a,o,s,c){e.subVectors(a,r),i.subVectors(o,r),n.crossVectors(e,i);var l,u=this.direction.dot(n);if(u>0){if(s)return null;l=1}else{if(!(u<0))return null;l=-1,u=-u}t.subVectors(this.origin,r);var h=l*this.direction.dot(i.crossVectors(t,i));if(h<0)return null;var d=l*this.direction.dot(e.cross(t));if(d<0)return null;if(h+d>u)return null;var p=-l*t.dot(n);return p<0?null:this.at(p/u,c)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(na,{getNormal:function(){var t=new Ge;return function(e,i,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Ge),r.subVectors(n,i),t.subVectors(e,i),r.cross(t);var a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}}(),getBarycoord:function(){var t=new Ge,e=new Ge,i=new Ge;return function(n,r,a,o,s){t.subVectors(o,r),e.subVectors(a,r),i.subVectors(n,r);var c=t.dot(t),l=t.dot(e),u=t.dot(i),h=e.dot(e),d=e.dot(i),p=c*h-l*l;if(void 0===s&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),s=new Ge),0===p)return s.set(-2,-1,-1);var f=1/p,m=(h*u-l*d)*f,g=(c*d-l*u)*f;return s.set(1-m-g,g,m)}}(),containsPoint:function(){var t=new Ge;return function(e,i,n,r){return na.getBarycoord(e,i,n,r,t),t.x>=0&&t.y>=0&&t.x+t.y<=1}}(),getUV:function(){var t=new Ge;return function(e,i,n,r,a,o,s,c){return this.getBarycoord(e,i,n,r,t),c.set(0,0),c.addScaledVector(a,t.x),c.addScaledVector(o,t.y),c.addScaledVector(s,t.z),c}}()}),Object.assign(na.prototype,{set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){var t=new Ge,e=new Ge;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Ge),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return na.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Ge),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return na.getBarycoord(t,this.a,this.b,this.c,e)},containsPoint:function(t){return na.containsPoint(t,this.a,this.b,this.c)},getUV:function(t,e,i,n,r){return na.getUV(t,this.a,this.b,this.c,e,i,n,r)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(){var t=new Ge,e=new Ge,i=new Ge,n=new Ge,r=new Ge,a=new Ge;return function(o,s){void 0===s&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),s=new Ge);var c,l,u=this.a,h=this.b,d=this.c;t.subVectors(h,u),e.subVectors(d,u),n.subVectors(o,u);var p=t.dot(n),f=e.dot(n);if(p<=0&&f<=0)return s.copy(u);r.subVectors(o,h);var m=t.dot(r),g=e.dot(r);if(m>=0&&g<=m)return s.copy(h);var v=p*g-m*f;if(v<=0&&p>=0&&m<=0)return c=p/(p-m),s.copy(u).addScaledVector(t,c);a.subVectors(o,d);var y=t.dot(a),_=e.dot(a);if(_>=0&&y<=_)return s.copy(d);var b=y*f-p*_;if(b<=0&&f>=0&&_<=0)return l=f/(f-_),s.copy(u).addScaledVector(e,l);var w=m*_-y*g;if(w<=0&&g-m>=0&&y-_>=0)return i.subVectors(d,h),l=(g-m)/(g-m+(y-_)),s.copy(h).addScaledVector(i,l);var T=1/(w+b+v);return c=b*T,l=v*T,s.copy(u).addScaledVector(t,c).addScaledVector(e,l)}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),ra.prototype=Object.create(Kr.prototype),ra.prototype.constructor=ra,ra.prototype.isMeshBasicMaterial=!0,ra.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},aa.prototype=Object.assign(Object.create(Lr.prototype),{constructor:aa,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return Lr.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,i,n=this.geometry;if(n.isBufferGeometry){var r=n.morphAttributes,a=Object.keys(r);if(a.length>0){var o=r[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)i=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}else{var s=n.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(){var t=new ni,e=new ia,i=new ti,n=new Ge,r=new Ge,a=new Ge,o=new Ge,s=new Ge,c=new Ge,l=new Ge,u=new Ge,h=new Ge,d=new je,p=new je,f=new je,m=new Ge,g=new Ge;function _(t,e,i,n,r,a,o,s){var c;if(c=e.side===v?n.intersectTriangle(o,a,r,!0,s):n.intersectTriangle(r,a,o,e.side!==y,s),null===c)return null;g.copy(s),g.applyMatrix4(t.matrixWorld);var l=i.ray.origin.distanceTo(g);return l<i.near||l>i.far?null:{distance:l,point:g.clone(),object:t}}function b(t,e,i,g,v,y,b,w,T,x){n.fromBufferAttribute(v,w),r.fromBufferAttribute(v,T),a.fromBufferAttribute(v,x);var S=t.morphTargetInfluences;if(e.morphTargets&&y&&S){l.set(0,0,0),u.set(0,0,0),h.set(0,0,0);for(var E=0,M=y.length;E<M;E++){var C=S[E],A=y[E];0!==C&&(o.fromBufferAttribute(A,w),s.fromBufferAttribute(A,T),c.fromBufferAttribute(A,x),l.addScaledVector(o.sub(n),C),u.addScaledVector(s.sub(r),C),h.addScaledVector(c.sub(a),C))}n.add(l),r.add(u),a.add(h)}var k=_(t,e,i,g,n,r,a,m);if(k){b&&(d.fromBufferAttribute(b,w),p.fromBufferAttribute(b,T),f.fromBufferAttribute(b,x),k.uv=na.getUV(m,n,r,a,d,p,f,new je));var L=new Mr(w,T,x);na.getNormal(n,r,a,L.normal),k.face=L}return k}return function(n,r){var a,o=this.geometry,s=this.material,c=this.matrixWorld;if(void 0!==s&&(null===o.boundingSphere&&o.computeBoundingSphere(),i.copy(o.boundingSphere),i.applyMatrix4(c),!1!==n.ray.intersectsSphere(i)&&(t.getInverse(c),e.copy(n.ray).applyMatrix4(t),null===o.boundingBox||!1!==e.intersectsBox(o.boundingBox))))if(o.isBufferGeometry){var l,u,h,g,v,y,w,T,x,S,E,M=o.index,C=o.attributes.position,A=o.morphAttributes.position,k=o.attributes.uv,L=o.groups,P=o.drawRange;if(null!==M)if(Array.isArray(s))for(g=0,y=L.length;g<y;g++)for(T=L[g],x=s[T.materialIndex],S=Math.max(T.start,P.start),E=Math.min(T.start+T.count,P.start+P.count),v=S,w=E;v<w;v+=3)l=M.getX(v),u=M.getX(v+1),h=M.getX(v+2),a=b(this,x,n,e,C,A,k,l,u,h),a&&(a.faceIndex=Math.floor(v/3),a.face.materialIndex=T.materialIndex,r.push(a));else for(S=Math.max(0,P.start),E=Math.min(M.count,P.start+P.count),g=S,y=E;g<y;g+=3)l=M.getX(g),u=M.getX(g+1),h=M.getX(g+2),a=b(this,s,n,e,C,A,k,l,u,h),a&&(a.faceIndex=Math.floor(g/3),r.push(a));else if(void 0!==C)if(Array.isArray(s))for(g=0,y=L.length;g<y;g++)for(T=L[g],x=s[T.materialIndex],S=Math.max(T.start,P.start),E=Math.min(T.start+T.count,P.start+P.count),v=S,w=E;v<w;v+=3)l=v,u=v+1,h=v+2,a=b(this,x,n,e,C,A,k,l,u,h),a&&(a.faceIndex=Math.floor(v/3),a.face.materialIndex=T.materialIndex,r.push(a));else for(S=Math.max(0,P.start),E=Math.min(C.count,P.start+P.count),g=S,y=E;g<y;g+=3)l=g,u=g+1,h=g+2,a=b(this,s,n,e,C,A,k,l,u,h),a&&(a.faceIndex=Math.floor(g/3),r.push(a))}else if(o.isGeometry){var O,R,I,D,U=Array.isArray(s),N=o.vertices,B=o.faces,F=o.faceVertexUvs[0];F.length>0&&(D=F);for(var z=0,j=B.length;z<j;z++){var H=B[z],G=U?s[H.materialIndex]:s;if(void 0!==G&&(O=N[H.a],R=N[H.b],I=N[H.c],a=_(this,G,n,e,O,R,I,m),a)){if(D&&D[z]){var V=D[z];d.copy(V[0]),p.copy(V[1]),f.copy(V[2]),a.uv=na.getUV(m,O,R,I,d,p,f,new je)}a.face=H,a.faceIndex=z,r.push(a)}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),va.prototype=Object.create(Ye.prototype),va.prototype.constructor=va,va.prototype.isCubeTexture=!0,Object.defineProperty(va.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),ya.prototype=Object.create(Ye.prototype),ya.prototype.constructor=ya,ya.prototype.isDataTexture2DArray=!0,_a.prototype=Object.create(Ye.prototype),_a.prototype.constructor=_a,_a.prototype.isDataTexture3D=!0;var ba=new Ye,wa=new ya,Ta=new _a,xa=new va,Sa=[],Ea=[],Ma=new Float32Array(16),Ca=new Float32Array(9),Aa=new Float32Array(4);function ka(t,e,i){var n=t[0];if(n<=0||n>0)return t;var r=e*i,a=Sa[r];if(void 0===a&&(a=new Float32Array(r),Sa[r]=a),0!==e){n.toArray(a,0);for(var o=1,s=0;o!==e;++o)s+=i,t[o].toArray(a,s)}return a}function La(t,e){if(t.length!==e.length)return!1;for(var i=0,n=t.length;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Pa(t,e){for(var i=0,n=e.length;i<n;i++)t[i]=e[i]}function Oa(t,e){var i=Ea[e];void 0===i&&(i=new Int32Array(e),Ea[e]=i);for(var n=0;n!==e;++n)i[n]=t.allocateTextureUnit();return i}function Ra(t,e){var i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function Ia(t,e){var i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function Da(t,e){var i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(La(i,e))return;t.uniform2fv(this.addr,e),Pa(i,e)}}function Ua(t,e){var i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(void 0!==e.r)i[0]===e.r&&i[1]===e.g&&i[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(La(i,e))return;t.uniform3fv(this.addr,e),Pa(i,e)}}function Na(t,e){var i=this.cache;if(void 0!==e.x)i[0]===e.x&&i[1]===e.y&&i[2]===e.z&&i[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(La(i,e))return;t.uniform4fv(this.addr,e),Pa(i,e)}}function Ba(t,e){var i=this.cache,n=e.elements;if(void 0===n){if(La(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),Pa(i,e)}else{if(La(i,n))return;Aa.set(n),t.uniformMatrix2fv(this.addr,!1,Aa),Pa(i,n)}}function Fa(t,e){var i=this.cache,n=e.elements;if(void 0===n){if(La(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),Pa(i,e)}else{if(La(i,n))return;Ca.set(n),t.uniformMatrix3fv(this.addr,!1,Ca),Pa(i,n)}}function za(t,e){var i=this.cache,n=e.elements;if(void 0===n){if(La(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),Pa(i,e)}else{if(La(i,n))return;Ma.set(n),t.uniformMatrix4fv(this.addr,!1,Ma),Pa(i,n)}}function ja(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.safeSetTexture2D(e||ba,r)}function Ha(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(e||wa,r)}function Ga(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(e||Ta,r)}function Va(t,e,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(t.uniform1i(this.addr,r),n[0]=r),i.safeSetTextureCube(e||xa,r)}function Wa(t,e){var i=this.cache;La(i,e)||(t.uniform2iv(this.addr,e),Pa(i,e))}function qa(t,e){var i=this.cache;La(i,e)||(t.uniform3iv(this.addr,e),Pa(i,e))}function Ya(t,e){var i=this.cache;La(i,e)||(t.uniform4iv(this.addr,e),Pa(i,e))}function Xa(t){switch(t){case 5126:return Ra;case 35664:return Da;case 35665:return Ua;case 35666:return Na;case 35674:return Ba;case 35675:return Fa;case 35676:return za;case 35678:case 36198:return ja;case 35679:return Ga;case 35680:return Va;case 36289:return Ha;case 5124:case 35670:return Ia;case 35667:case 35671:return Wa;case 35668:case 35672:return qa;case 35669:case 35673:return Ya}}function $a(t,e){var i=this.cache;La(i,e)||(t.uniform1fv(this.addr,e),Pa(i,e))}function Za(t,e){var i=this.cache;La(i,e)||(t.uniform1iv(this.addr,e),Pa(i,e))}function Ja(t,e){var i=this.cache,n=ka(e,this.size,2);La(i,n)||(t.uniform2fv(this.addr,n),this.updateCache(n))}function Ka(t,e){var i=this.cache,n=ka(e,this.size,3);La(i,n)||(t.uniform3fv(this.addr,n),this.updateCache(n))}function Qa(t,e){var i=this.cache,n=ka(e,this.size,4);La(i,n)||(t.uniform4fv(this.addr,n),this.updateCache(n))}function to(t,e){var i=this.cache,n=ka(e,this.size,4);La(i,n)||(t.uniformMatrix2fv(this.addr,!1,n),this.updateCache(n))}function eo(t,e){var i=this.cache,n=ka(e,this.size,9);La(i,n)||(t.uniformMatrix3fv(this.addr,!1,n),this.updateCache(n))}function io(t,e){var i=this.cache,n=ka(e,this.size,16);La(i,n)||(t.uniformMatrix4fv(this.addr,!1,n),this.updateCache(n))}function no(t,e,i){var n=this.cache,r=e.length,a=Oa(i,r);!1===La(n,a)&&(t.uniform1iv(this.addr,a),Pa(n,a));for(var o=0;o!==r;++o)i.safeSetTexture2D(e[o]||ba,a[o])}function ro(t,e,i){var n=this.cache,r=e.length,a=Oa(i,r);!1===La(n,a)&&(t.uniform1iv(this.addr,a),Pa(n,a));for(var o=0;o!==r;++o)i.safeSetTextureCube(e[o]||xa,a[o])}function ao(t){switch(t){case 5126:return $a;case 35664:return Ja;case 35665:return Ka;case 35666:return Qa;case 35674:return to;case 35675:return eo;case 35676:return io;case 35678:return no;case 35680:return ro;case 5124:case 35670:return Za;case 35667:case 35671:return Wa;case 35668:case 35672:return qa;case 35669:case 35673:return Ya}}function oo(t,e,i){this.id=t,this.addr=i,this.cache=[],this.setValue=Xa(e.type)}function so(t,e,i){this.id=t,this.addr=i,this.cache=[],this.size=e.size,this.setValue=ao(e.type)}function co(t){this.id=t,this.seq=[],this.map={}}so.prototype.updateCache=function(t){var e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),Pa(e,t)},co.prototype.setValue=function(t,e,i){for(var n=this.seq,r=0,a=n.length;r!==a;++r){var o=n[r];o.setValue(t,e[o.id],i)}};var lo=/([\w\d_]+)(\])?(\[|\.)?/g;function uo(t,e){t.seq.push(e),t.map[e.id]=e}function ho(t,e,i){var n=t.name,r=n.length;lo.lastIndex=0;while(1){var a=lo.exec(n),o=lo.lastIndex,s=a[1],c="]"===a[2],l=a[3];if(c&&(s|=0),void 0===l||"["===l&&o+2===r){uo(i,void 0===l?new oo(s,t,e):new so(s,t,e));break}var u=i.map,h=u[s];void 0===h&&(h=new co(s),uo(i,h)),i=h}}function po(t,e){this.seq=[],this.map={};for(var i=t.getProgramParameter(e,35718),n=0;n<i;++n){var r=t.getActiveUniform(e,n),a=t.getUniformLocation(e,r.name);ho(r,a,this)}}function fo(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\n")}function mo(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),!1===t.getShaderParameter(n,35713)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",35633===e?"vertex":"fragment",t.getShaderInfoLog(n),fo(i)),n}po.prototype.setValue=function(t,e,i,n){var r=this.map[e];void 0!==r&&r.setValue(t,i,n)},po.prototype.setOptional=function(t,e,i){var n=e[i];void 0!==n&&this.setValue(t,i,n)},po.upload=function(t,e,i,n){for(var r=0,a=e.length;r!==a;++r){var o=e[r],s=i[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,n)}},po.seqWithValue=function(t,e){for(var i=[],n=0,r=t.length;n!==r;++n){var a=t[n];a.id in e&&i.push(a)}return i};var go=0;function vo(t){switch(t){case Ae:return["Linear","( value )"];case ke:return["sRGB","( value )"];case Pe:return["RGBE","( value )"];case Re:return["RGBM","( value, 7.0 )"];case Ie:return["RGBM","( value, 16.0 )"];case De:return["RGBD","( value, 256.0 )"];case Le:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function yo(t,e){var i=vo(e);return"vec4 "+t+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function _o(t,e){var i=vo(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function bo(t,e){var i;switch(e){case rt:i="Linear";break;case at:i="Reinhard";break;case ot:i="Uncharted2";break;case st:i="OptimizedCineon";break;case ct:i="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function wo(t,e,i){t=t||{};var n=[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap&&!e.objectSpaceNormalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return n.filter(So).join("\n")}function To(t){var e=[];for(var i in t){var n=t[i];!1!==n&&e.push("#define "+i+" "+n)}return e.join("\n")}function xo(t,e){for(var i={},n=t.getProgramParameter(e,35721),r=0;r<n;r++){var a=t.getActiveAttrib(e,r),o=a.name;i[o]=t.getAttribLocation(e,o)}return i}function So(t){return""!==t}function Eo(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Mo(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function Co(t){var e=/^[ \t]*#include +<([\w\d.\/]+)>/gm;function i(t,e){var i=gr[e];if(void 0===i)throw new Error("Can not resolve #include <"+e+">");return Co(i)}return t.replace(e,i)}function Ao(t){var e=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function i(t,e,i,n){for(var r="",a=parseInt(e);a<parseInt(i);a++)r+=n.replace(/\[ i \]/g,"[ "+a+" ]");return r}return t.replace(e,i)}function ko(t,e,i,n,r,a,o,s){var c=t.context,l=n.defines,u=r.vertexShader,h=r.fragmentShader,d="SHADOWMAP_TYPE_BASIC";a.shadowMapType===f?d="SHADOWMAP_TYPE_PCF":a.shadowMapType===m&&(d="SHADOWMAP_TYPE_PCF_SOFT");var p="ENVMAP_TYPE_CUBE",g="ENVMAP_MODE_REFLECTION",v="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(n.envMap.mapping){case ut:case ht:p="ENVMAP_TYPE_CUBE";break;case mt:case gt:p="ENVMAP_TYPE_CUBE_UV";break;case dt:case pt:p="ENVMAP_TYPE_EQUIREC";break;case ft:p="ENVMAP_TYPE_SPHERE";break}switch(n.envMap.mapping){case ht:case pt:g="ENVMAP_MODE_REFRACTION";break}switch(n.combine){case tt:v="ENVMAP_BLENDING_MULTIPLY";break;case et:v="ENVMAP_BLENDING_MIX";break;case it:v="ENVMAP_BLENDING_ADD";break}}var y,_,b=t.gammaFactor>0?t.gammaFactor:1,w=o.isWebGL2?"":wo(n.extensions,a,e),T=To(l),x=c.createProgram();if(n.isRawShaderMaterial?(y=[T].filter(So).join("\n"),y.length>0&&(y+="\n"),_=[w,T].filter(So).join("\n"),_.length>0&&(_+="\n")):(y=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+r.name,T,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+g:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+d:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(o.isWebGL2||e.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(So).join("\n"),_=[w,"precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+r.name,T,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+b,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+p:"",a.envMap?"#define "+g:"",a.envMap?"#define "+v:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+d:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&(o.isWebGL2||e.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",a.envMap&&(o.isWebGL2||e.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",a.toneMapping!==nt?"#define TONE_MAPPING":"",a.toneMapping!==nt?gr["tonemapping_pars_fragment"]:"",a.toneMapping!==nt?bo("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.matcapEncoding||a.envMapEncoding||a.emissiveMapEncoding?gr["encodings_pars_fragment"]:"",a.mapEncoding?yo("mapTexelToLinear",a.mapEncoding):"",a.matcapEncoding?yo("matcapTexelToLinear",a.matcapEncoding):"",a.envMapEncoding?yo("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?yo("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?_o("linearToOutputTexel",a.outputEncoding):"",a.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(So).join("\n")),u=Co(u),u=Eo(u,a),u=Mo(u,a),h=Co(h),h=Eo(h,a),h=Mo(h,a),u=Ao(u),h=Ao(h),o.isWebGL2&&!n.isRawShaderMaterial){var S=!1,E=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==u.match(E)&&null!==h.match(E)&&(S=!0,u=u.replace(E,""),h=h.replace(E,"")),y=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+y,_=["#version 300 es\n","#define varying in",S?"":"out highp vec4 pc_fragColor;",S?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_}var M=y+u,C=_+h,A=mo(c,35633,M),k=mo(c,35632,C);c.attachShader(x,A),c.attachShader(x,k),void 0!==n.index0AttributeName?c.bindAttribLocation(x,0,n.index0AttributeName):!0===a.morphTargets&&c.bindAttribLocation(x,0,"position"),c.linkProgram(x);var L,P,O=c.getProgramInfoLog(x).trim(),R=c.getShaderInfoLog(A).trim(),I=c.getShaderInfoLog(k).trim(),D=!0,U=!0;return!1===c.getProgramParameter(x,35714)?(D=!1,console.error("THREE.WebGLProgram: shader error: ",c.getError(),"35715",c.getProgramParameter(x,35715),"gl.getProgramInfoLog",O,R,I)):""!==O?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",O):""!==R&&""!==I||(U=!1),U&&(this.diagnostics={runnable:D,material:n,programLog:O,vertexShader:{log:R,prefix:y},fragmentShader:{log:I,prefix:_}}),c.deleteShader(A),c.deleteShader(k),this.getUniforms=function(){return void 0===L&&(L=new po(c,x,s)),L},this.getAttributes=function(){return void 0===P&&(P=xo(c,x)),P},this.destroy=function(){c.deleteProgram(x),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=r.name,this.id=go++,this.code=i,this.usedTimes=1,this.program=x,this.vertexShader=A,this.fragmentShader=k,this}function Lo(t,e,i,n){var r=[],a={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},o=["precision","supportsVertexTextures","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function s(t){var e=t.skeleton,n=e.bones;if(i.floatVertexTextures)return 1024;var r=i.maxVertexUniforms,a=Math.floor((r-20)/4),o=Math.min(a,n.length);return o<n.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+n.length+" bones. This GPU supports "+o+"."),0):o}function c(t,e){var i;return t?t.isTexture?i=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=t.texture.encoding):i=Ae,i===Ae&&e&&(i=Le),i}this.getParameters=function(e,n,r,o,l,u,h){var d=a[e.type],p=h.isSkinnedMesh?s(h):0,f=i.precision;null!==e.precision&&(f=i.getMaxPrecision(e.precision),f!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",f,"instead."));var m=t.getRenderTarget(),g={shaderID:d,precision:f,supportsVertexTextures:i.vertexTextures,outputEncoding:c(m?m.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:c(e.map,t.gammaInput),matcap:!!e.matcap,matcapEncoding:c(e.matcap,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:c(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===mt||e.envMap.mapping===gt),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:c(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,objectSpaceNormalMap:e.normalMapType===Fe,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexTangents:e.normalMap&&e.vertexTangents,vertexColors:e.vertexColors,fog:!!o,useFog:e.fog,fogExp:o&&o.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:i.logarithmicDepthBuffer,skinning:e.skinning&&p>0,maxBones:p,useVertexTexture:i.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numRectAreaLights:n.rectArea.length,numHemiLights:n.hemi.length,numClippingPlanes:l,numClipIntersection:u,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&h.receiveShadow&&r.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===y,flipSided:e.side===v,depthPacking:void 0!==e.depthPacking&&e.depthPacking};return g},this.getProgramCode=function(e,i){var n=[];if(i.shaderID?n.push(i.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);for(var a=0;a<o.length;a++)n.push(i[o[a]]);return n.push(e.onBeforeCompile.toString()),n.push(t.gammaOutput),n.push(t.gammaFactor),n.join()},this.acquireProgram=function(a,o,s,c){for(var l,u=0,h=r.length;u<h;u++){var d=r[u];if(d.code===c){l=d,++l.usedTimes;break}}return void 0===l&&(l=new ko(t,e,c,a,o,s,i,n),r.push(l)),l},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=r.indexOf(t);r[e]=r[r.length-1],r.pop(),t.destroy()}},this.programs=r}function Po(){var t=new WeakMap;function e(e){var i=t.get(e);return void 0===i&&(i={},t.set(e,i)),i}function i(e){t.delete(e)}function n(e,i,n){t.get(e)[i]=n}function r(){t=new WeakMap}return{get:e,remove:i,update:n,dispose:r}}function Oo(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Ro(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Io(){var t=[],e=0,i=[],n=[],r={id:-1};function a(){e=0,i.length=0,n.length=0}function o(i,n,a,o,s,c){var l=t[e];return void 0===l?(l={id:i.id,object:i,geometry:n,material:a,program:a.program||r,groupOrder:o,renderOrder:i.renderOrder,z:s,group:c},t[e]=l):(l.id=i.id,l.object=i,l.geometry=n,l.material=a,l.program=a.program||r,l.groupOrder=o,l.renderOrder=i.renderOrder,l.z=s,l.group=c),e++,l}function s(t,e,r,a,s,c){var l=o(t,e,r,a,s,c);(!0===r.transparent?n:i).push(l)}function c(t,e,r,a,s,c){var l=o(t,e,r,a,s,c);(!0===r.transparent?n:i).unshift(l)}function l(){i.length>1&&i.sort(Oo),n.length>1&&n.sort(Ro)}return{opaque:i,transparent:n,init:a,push:s,unshift:c,sort:l}}function Do(){var t={};function e(i){var n=i.target;n.removeEventListener("dispose",e),delete t[n.id]}function i(i,n){var r,a=t[i.id];return void 0===a?(r=new Io,t[i.id]={},t[i.id][n.id]=r,i.addEventListener("dispose",e)):(r=a[n.id],void 0===r&&(r=new Io,a[n.id]=r)),r}function n(){t={}}return{get:i,dispose:n}}function Uo(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var i;switch(e.type){case"DirectionalLight":i={direction:new Ge,color:new wr,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new je};break;case"SpotLight":i={position:new Ge,direction:new Ge,color:new wr,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new je};break;case"PointLight":i={position:new Ge,color:new wr,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new je,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":i={direction:new Ge,skyColor:new wr,groundColor:new wr};break;case"RectAreaLight":i={color:new wr,position:new Ge,halfWidth:new Ge,halfHeight:new Ge};break}return t[e.id]=i,i}}}var No=0;function Bo(){var t=new Uo,e={id:No++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},i=new Ge,n=new ni,r=new ni;function a(a,o,s){for(var c=0,l=0,u=0,h=0,d=0,p=0,f=0,m=0,g=s.matrixWorldInverse,v=0,y=a.length;v<y;v++){var _=a[v],b=_.color,w=_.intensity,T=_.distance,x=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)c+=b.r*w,l+=b.g*w,u+=b.b*w;else if(_.isDirectionalLight){var S=t.get(_);if(S.color.copy(_.color).multiplyScalar(_.intensity),S.direction.setFromMatrixPosition(_.matrixWorld),i.setFromMatrixPosition(_.target.matrixWorld),S.direction.sub(i),S.direction.transformDirection(g),S.shadow=_.castShadow,_.castShadow){var E=_.shadow;S.shadowBias=E.bias,S.shadowRadius=E.radius,S.shadowMapSize=E.mapSize}e.directionalShadowMap[h]=x,e.directionalShadowMatrix[h]=_.shadow.matrix,e.directional[h]=S,h++}else if(_.isSpotLight){S=t.get(_);if(S.position.setFromMatrixPosition(_.matrixWorld),S.position.applyMatrix4(g),S.color.copy(b).multiplyScalar(w),S.distance=T,S.direction.setFromMatrixPosition(_.matrixWorld),i.setFromMatrixPosition(_.target.matrixWorld),S.direction.sub(i),S.direction.transformDirection(g),S.coneCos=Math.cos(_.angle),S.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),S.decay=_.decay,S.shadow=_.castShadow,_.castShadow){E=_.shadow;S.shadowBias=E.bias,S.shadowRadius=E.radius,S.shadowMapSize=E.mapSize}e.spotShadowMap[p]=x,e.spotShadowMatrix[p]=_.shadow.matrix,e.spot[p]=S,p++}else if(_.isRectAreaLight){S=t.get(_);S.color.copy(b).multiplyScalar(w),S.position.setFromMatrixPosition(_.matrixWorld),S.position.applyMatrix4(g),r.identity(),n.copy(_.matrixWorld),n.premultiply(g),r.extractRotation(n),S.halfWidth.set(.5*_.width,0,0),S.halfHeight.set(0,.5*_.height,0),S.halfWidth.applyMatrix4(r),S.halfHeight.applyMatrix4(r),e.rectArea[f]=S,f++}else if(_.isPointLight){S=t.get(_);if(S.position.setFromMatrixPosition(_.matrixWorld),S.position.applyMatrix4(g),S.color.copy(_.color).multiplyScalar(_.intensity),S.distance=_.distance,S.decay=_.decay,S.shadow=_.castShadow,_.castShadow){E=_.shadow;S.shadowBias=E.bias,S.shadowRadius=E.radius,S.shadowMapSize=E.mapSize,S.shadowCameraNear=E.camera.near,S.shadowCameraFar=E.camera.far}e.pointShadowMap[d]=x,e.pointShadowMatrix[d]=_.shadow.matrix,e.point[d]=S,d++}else if(_.isHemisphereLight){S=t.get(_);S.direction.setFromMatrixPosition(_.matrixWorld),S.direction.transformDirection(g),S.direction.normalize(),S.skyColor.copy(_.color).multiplyScalar(w),S.groundColor.copy(_.groundColor).multiplyScalar(w),e.hemi[m]=S,m++}}e.ambient[0]=c,e.ambient[1]=l,e.ambient[2]=u,e.directional.length=h,e.spot.length=p,e.rectArea.length=f,e.point.length=d,e.hemi.length=m,e.hash.stateID=e.id,e.hash.directionalLength=h,e.hash.pointLength=d,e.hash.spotLength=p,e.hash.rectAreaLength=f,e.hash.hemiLength=m,e.hash.shadowsLength=o.length}return{setup:a,state:e}}function Fo(){var t=new Bo,e=[],i=[];function n(){e.length=0,i.length=0}function r(t){e.push(t)}function a(t){i.push(t)}function o(n){t.setup(e,i,n)}var s={lightsArray:e,shadowsArray:i,lights:t};return{init:n,state:s,setupLights:o,pushLight:r,pushShadow:a}}function zo(){var t={};function e(i){var n=i.target;n.removeEventListener("dispose",e),delete t[n.id]}function i(i,n){var r;return void 0===t[i.id]?(r=new Fo,t[i.id]={},t[i.id][n.id]=r,i.addEventListener("dispose",e)):void 0===t[i.id][n.id]?(r=new Fo,t[i.id][n.id]=r):r=t[i.id][n.id],r}function n(){t={}}return{get:i,dispose:n}}function jo(t){Kr.call(this),this.type="MeshDepthMaterial",this.depthPacking=Ue,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function Ho(t){Kr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Ge,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Go(t,e,i){for(var n=new ii,r=new ni,a=new je,o=new je(i,i),s=new Ge,c=new Ge,l=1,u=2,h=1+(l|u),d=new Array(h),p=new Array(h),m={},_={0:v,1:g,2:y},b=[new Ge(1,0,0),new Ge(-1,0,0),new Ge(0,0,1),new Ge(0,0,-1),new Ge(0,1,0),new Ge(0,-1,0)],w=[new Ge(0,1,0),new Ge(0,1,0),new Ge(0,1,0),new Ge(0,1,0),new Ge(0,0,1),new Ge(0,0,-1)],T=[new Xe,new Xe,new Xe,new Xe,new Xe,new Xe],x=0;x!==h;++x){var E=0!==(x&l),M=0!==(x&u),C=new jo({depthPacking:Ne,morphTargets:E,skinning:M});d[x]=C;var A=new Ho({morphTargets:E,skinning:M});p[x]=A}var k=this;function L(e,i,n,r,a,o){var s=e.geometry,c=null,h=d,f=e.customDepthMaterial;if(n&&(h=p,f=e.customDistanceMaterial),f)c=f;else{var g=!1;i.morphTargets&&(s&&s.isBufferGeometry?g=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(g=s.morphTargets&&s.morphTargets.length>0)),e.isSkinnedMesh&&!1===i.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var v=e.isSkinnedMesh&&i.skinning,y=0;g&&(y|=l),v&&(y|=u),c=h[y]}if(t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){var b=c.uuid,w=i.uuid,T=m[b];void 0===T&&(T={},m[b]=T);var x=T[w];void 0===x&&(x=c.clone(),T[w]=x),c=x}return c.visible=i.visible,c.wireframe=i.wireframe,c.side=null!=i.shadowSide?i.shadowSide:_[i.side],c.clipShadows=i.clipShadows,c.clippingPlanes=i.clippingPlanes,c.clipIntersection=i.clipIntersection,c.wireframeLinewidth=i.wireframeLinewidth,c.linewidth=i.linewidth,n&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(r),c.nearDistance=a,c.farDistance=o),c}function P(i,r,a,o){if(!1!==i.visible){var s=i.layers.test(r.layers);if(s&&(i.isMesh||i.isLine||i.isPoints)&&i.castShadow&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,i.matrixWorld);var l=e.update(i),u=i.material;if(Array.isArray(u))for(var h=l.groups,d=0,p=h.length;d<p;d++){var f=h[d],m=u[f.materialIndex];if(m&&m.visible){var g=L(i,m,o,c,a.near,a.far);t.renderBufferDirect(a,null,l,g,i,f)}}else if(u.visible){g=L(i,u,o,c,a.near,a.far);t.renderBufferDirect(a,null,l,g,i,null)}}for(var v=i.children,y=0,_=v.length;y<_;y++)P(v[y],r,a,o)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=f,this.render=function(e,i,l){if(!1!==k.enabled&&(!1!==k.autoUpdate||!1!==k.needsUpdate)&&0!==e.length){var u,h=t.getRenderTarget(),d=t.state;d.setBlending(S),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var p=0,f=e.length;p<f;p++){var m=e[p],g=m.shadow,v=m&&m.isPointLight;if(void 0!==g){var y=g.camera;if(a.copy(g.mapSize),a.min(o),v){var _=a.x,x=a.y;T[0].set(2*_,x,_,x),T[1].set(0,x,_,x),T[2].set(3*_,x,_,x),T[3].set(_,x,_,x),T[4].set(3*_,0,_,x),T[5].set(_,0,_,x),a.x*=4,a.y*=2}if(null===g.map){var E={minFilter:bt,magFilter:bt,format:zt};g.map=new $e(a.x,a.y,E),g.map.texture.name=m.name+".shadowMap",y.updateProjectionMatrix()}g.isSpotLightShadow&&g.update(m);var M=g.map,C=g.matrix;c.setFromMatrixPosition(m.matrixWorld),y.position.copy(c),v?(u=6,C.makeTranslation(-c.x,-c.y,-c.z)):(u=1,s.setFromMatrixPosition(m.target.matrixWorld),y.lookAt(s),y.updateMatrixWorld(),C.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),C.multiply(y.projectionMatrix),C.multiply(y.matrixWorldInverse)),t.setRenderTarget(M),t.clear();for(var A=0;A<u;A++){if(v){s.copy(y.position),s.add(b[A]),y.up.copy(w[A]),y.lookAt(s),y.updateMatrixWorld();var L=T[A];d.viewport(L)}r.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),n.setFromMatrix(r),P(i,l,y,v)}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}k.needsUpdate=!1,t.setRenderTarget(h)}}}function Vo(t,e,i,n){function r(){var e=!1,i=new Xe,n=null,r=new Xe(0,0,0,0);return{setMask:function(i){n===i||e||(t.colorMask(i,i,i,i),n=i)},setLocked:function(t){e=t},setClear:function(e,n,a,o,s){!0===s&&(e*=o,n*=o,a*=o),i.set(e,n,a,o),!1===r.equals(i)&&(t.clearColor(e,n,a,o),r.copy(i))},reset:function(){e=!1,n=null,r.set(-1,0,0,0)}}}function a(){var e=!1,i=null,n=null,r=null;return{setTest:function(t){t?ht(2929):dt(2929)},setMask:function(n){i===n||e||(t.depthMask(n),i=n)},setFunc:function(e){if(n!==e){if(e)switch(e){case q:t.depthFunc(512);break;case Y:t.depthFunc(519);break;case X:t.depthFunc(513);break;case $:t.depthFunc(515);break;case Z:t.depthFunc(514);break;case J:t.depthFunc(518);break;case K:t.depthFunc(516);break;case Q:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);n=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,i=null,n=null,r=null}}}function o(){var e=!1,i=null,n=null,r=null,a=null,o=null,s=null,c=null,l=null;return{setTest:function(t){t?ht(2960):dt(2960)},setMask:function(n){i===n||e||(t.stencilMask(n),i=n)},setFunc:function(e,i,o){n===e&&r===i&&a===o||(t.stencilFunc(e,i,o),n=e,r=i,a=o)},setOp:function(e,i,n){o===e&&s===i&&c===n||(t.stencilOp(e,i,n),o=e,s=i,c=n)},setLocked:function(t){e=t},setClear:function(e){l!==e&&(t.clearStencil(e),l=e)},reset:function(){e=!1,i=null,n=null,r=null,a=null,o=null,s=null,c=null,l=null}}}var u=new r,h=new a,d=new o,p=t.getParameter(34921),f=new Uint8Array(p),m=new Uint8Array(p),g=new Uint8Array(p),_={},b=null,w=null,T=null,x=null,P=null,O=null,R=null,I=null,D=null,U=null,N=!1,B=null,F=null,z=null,j=null,H=null,G=t.getParameter(35661),V=!1,W=0,tt=t.getParameter(7938);-1!==tt.indexOf("WebGL")?(W=parseFloat(/^WebGL\ ([0-9])/.exec(tt)[1]),V=W>=1):-1!==tt.indexOf("OpenGL ES")&&(W=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(tt)[1]),V=W>=2);var et=null,it={},nt=new Xe,rt=new Xe;function at(e,i,n){var r=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var o=0;o<n;o++)t.texImage2D(i+o,0,6408,1,1,0,6408,5121,r);return a}var ot={};function st(){for(var t=0,e=f.length;t<e;t++)f[t]=0}function ct(t){lt(t,0)}function lt(i,r){if(f[i]=1,0===m[i]&&(t.enableVertexAttribArray(i),m[i]=1),g[i]!==r){var a=n.isWebGL2?t:e.get("ANGLE_instanced_arrays");a[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](i,r),g[i]=r}}function ut(){for(var e=0,i=m.length;e!==i;++e)m[e]!==f[e]&&(t.disableVertexAttribArray(e),m[e]=0)}function ht(e){!0!==_[e]&&(t.enable(e),_[e]=!0)}function dt(e){!1!==_[e]&&(t.disable(e),_[e]=!1)}function pt(){if(null===b&&(b=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")||e.get("WEBGL_compressed_texture_astc")))for(var i=t.getParameter(34467),n=0;n<i.length;n++)b.push(i[n]);return b}function ft(e){return w!==e&&(t.useProgram(e),w=e,!0)}function mt(e,n,r,a,o,s,c,l){if(e!==S){if(T||(ht(3042),T=!0),e===k)o=o||n,s=s||r,c=c||a,n===P&&o===I||(t.blendEquationSeparate(i.convert(n),i.convert(o)),P=n,I=o),r===O&&a===R&&s===D&&c===U||(t.blendFuncSeparate(i.convert(r),i.convert(a),i.convert(s),i.convert(c)),O=r,R=a,D=s,U=c),x=e,N=null;else if(e!==x||l!==N){if(P===L&&I===L||(t.blendEquation(32774),P=L,I=L),l)switch(e){case E:t.blendFuncSeparate(1,771,1,771);break;case M:t.blendFunc(1,1);break;case C:t.blendFuncSeparate(0,0,769,771);break;case A:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case E:t.blendFuncSeparate(770,771,1,771);break;case M:t.blendFunc(770,1);break;case C:t.blendFunc(0,769);break;case A:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}O=null,R=null,D=null,U=null,x=e,N=l}}else T&&(dt(3042),T=!1)}function gt(t,e){t.side===y?dt(2884):ht(2884);var i=t.side===v;e&&(i=!i),vt(i),t.blending===E&&!1===t.transparent?mt(S):mt(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),h.setFunc(t.depthFunc),h.setTest(t.depthTest),h.setMask(t.depthWrite),u.setMask(t.colorWrite),bt(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function vt(e){B!==e&&(e?t.frontFace(2304):t.frontFace(2305),B=e)}function yt(e){e!==s?(ht(2884),e!==F&&(e===c?t.cullFace(1029):e===l?t.cullFace(1028):t.cullFace(1032))):dt(2884),F=e}function _t(e){e!==z&&(V&&t.lineWidth(e),z=e)}function bt(e,i,n){e?(ht(32823),j===i&&H===n||(t.polygonOffset(i,n),j=i,H=n)):dt(32823)}function wt(t){t?ht(3089):dt(3089)}function Tt(e){void 0===e&&(e=33984+G-1),et!==e&&(t.activeTexture(e),et=e)}function xt(e,i){null===et&&Tt();var n=it[et];void 0===n&&(n={type:void 0,texture:void 0},it[et]=n),n.type===e&&n.texture===i||(t.bindTexture(e,i||ot[e]),n.type=e,n.texture=i)}function St(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function Et(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function Mt(){try{t.texImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function Ct(e){!1===nt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),nt.copy(e))}function At(e){!1===rt.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),rt.copy(e))}function kt(){for(var e=0;e<m.length;e++)1===m[e]&&(t.disableVertexAttribArray(e),m[e]=0);_={},b=null,et=null,it={},w=null,x=null,B=null,F=null,u.reset(),h.reset(),d.reset()}return ot[3553]=at(3553,3553,1),ot[34067]=at(34067,34069,6),u.setClear(0,0,0,1),h.setClear(1),d.setClear(0),ht(2929),h.setFunc($),vt(!1),yt(c),ht(2884),mt(S),{buffers:{color:u,depth:h,stencil:d},initAttributes:st,enableAttribute:ct,enableAttributeAndDivisor:lt,disableUnusedAttributes:ut,enable:ht,disable:dt,getCompressedTextureFormats:pt,useProgram:ft,setBlending:mt,setMaterial:gt,setFlipSided:vt,setCullFace:yt,setLineWidth:_t,setPolygonOffset:bt,setScissorTest:wt,activeTexture:Tt,bindTexture:xt,compressedTexImage2D:St,texImage2D:Et,texImage3D:Mt,scissor:Ct,viewport:At,reset:kt}}function Wo(t,e,i,n,r,a,o){var s,c={},l="undefined"!==typeof OffscreenCanvas;function u(t,e){return l?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function h(t,e,i,n){var r=1;if((t.width>n||t.height>n)&&(r=n/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){var a=e?ze.floorPowerOfTwo:Math.floor,o=a(r*t.width),c=a(r*t.height);void 0===s&&(s=u(o,c));var l=i?u(o,c):s;l.width=o,l.height=c;var h=l.getContext("2d");return h.drawImage(t,0,0,o,c),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+c+")."),l}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function d(t){return ze.isPowerOfTwo(t.width)&&ze.isPowerOfTwo(t.height)}function p(t){return!r.isWebGL2&&(t.wrapS!==yt||t.wrapT!==yt||t.minFilter!==bt&&t.minFilter!==xt)}function f(t,e){return t.generateMipmaps&&e&&t.minFilter!==bt&&t.minFilter!==xt}function m(e,i,r,a){t.generateMipmap(e);var o=n.get(i);o.__maxMipLevel=Math.log(Math.max(r,a))*Math.LOG2E}function g(t,i){if(!r.isWebGL2)return t;var n=t;return 6403===t&&(5126===i&&(n=33326),5131===i&&(n=33325),5121===i&&(n=33321)),6407===t&&(5126===i&&(n=34837),5131===i&&(n=34843),5121===i&&(n=32849)),6408===t&&(5126===i&&(n=34836),5131===i&&(n=34842),5121===i&&(n=32856)),33325===n||33326===n||34842===n||34836===n?e.get("EXT_color_buffer_float"):34843!==n&&34837!==n||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),n}function v(t){return t===bt||t===wt||t===Tt?9728:9729}function y(t){var e=t.target;e.removeEventListener("dispose",y),b(e),e.isVideoTexture&&delete c[e.id],o.memory.textures--}function _(t){var e=t.target;e.removeEventListener("dispose",_),w(e),o.memory.textures--}function b(e){var i=n.get(e);void 0!==i.__webglInit&&(t.deleteTexture(i.__webglTexture),n.remove(e))}function w(e){var i=n.get(e),r=n.get(e.texture);if(e){if(void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var a=0;a<6;a++)t.deleteFramebuffer(i.__webglFramebuffer[a]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[a]);else t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer);n.remove(e.texture),n.remove(e)}}var T=0;function x(){T=0}function S(){var t=T;return t>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+r.maxTextures),T+=1,t}function E(t,e){var r=n.get(t);if(t.isVideoTexture&&j(t),t.version>0&&r.__version!==t.version){var a=t.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void O(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.activeTexture(33984+e),i.bindTexture(3553,r.__webglTexture)}function M(t,e){var r=n.get(t);t.version>0&&r.__version!==t.version?O(r,t,e):(i.activeTexture(33984+e),i.bindTexture(35866,r.__webglTexture))}function C(t,e){var r=n.get(t);t.version>0&&r.__version!==t.version?O(r,t,e):(i.activeTexture(33984+e),i.bindTexture(32879,r.__webglTexture))}function A(e,o){var s=n.get(e);if(6===e.image.length)if(e.version>0&&s.__version!==e.version){P(s,e),i.activeTexture(33984+o),i.bindTexture(34067,s.__webglTexture),t.pixelStorei(37440,e.flipY);for(var c=e&&e.isCompressedTexture,l=e.image[0]&&e.image[0].isDataTexture,u=[],p=0;p<6;p++)u[p]=c||l?l?e.image[p].image:e.image[p]:h(e.image[p],!1,!0,r.maxCubemapSize);var v=u[0],y=d(v)||r.isWebGL2,_=a.convert(e.format),b=a.convert(e.type),w=g(_,b);L(34067,e,y);for(p=0;p<6;p++)if(c)for(var T,x=u[p].mipmaps,S=0,E=x.length;S<E;S++)T=x[S],e.format!==zt&&e.format!==Ft?i.getCompressedTextureFormats().indexOf(_)>-1?i.compressedTexImage2D(34069+p,S,w,T.width,T.height,0,T.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+p,S,w,T.width,T.height,0,_,b,T.data);else l?i.texImage2D(34069+p,0,w,u[p].width,u[p].height,0,_,b,u[p].data):i.texImage2D(34069+p,0,w,_,b,u[p]);s.__maxMipLevel=c?x.length-1:0,f(e,y)&&m(34067,e,v.width,v.height),s.__version=e.version,e.onUpdate&&e.onUpdate(e)}else i.activeTexture(33984+o),i.bindTexture(34067,s.__webglTexture)}function k(t,e){i.activeTexture(33984+e),i.bindTexture(34067,n.get(t).__webglTexture)}function L(i,o,s){var c;if(s?(t.texParameteri(i,10242,a.convert(o.wrapS)),t.texParameteri(i,10243,a.convert(o.wrapT)),32879!==i&&35866!==i||t.texParameteri(i,32882,a.convert(o.wrapR)),t.texParameteri(i,10240,a.convert(o.magFilter)),t.texParameteri(i,10241,a.convert(o.minFilter))):(t.texParameteri(i,10242,33071),t.texParameteri(i,10243,33071),32879!==i&&35866!==i||t.texParameteri(i,32882,33071),o.wrapS===yt&&o.wrapT===yt||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(i,10240,v(o.magFilter)),t.texParameteri(i,10241,v(o.minFilter)),o.minFilter!==bt&&o.minFilter!==xt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),c=e.get("EXT_texture_filter_anisotropic"),c){if(o.type===Ot&&null===e.get("OES_texture_float_linear"))return;if(o.type===Rt&&null===(r.isWebGL2||e.get("OES_texture_half_float_linear")))return;(o.anisotropy>1||n.get(o).__currentAnisotropy)&&(t.texParameterf(i,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),n.get(o).__currentAnisotropy=o.anisotropy)}}function P(e,i){void 0===e.__webglInit&&(e.__webglInit=!0,i.addEventListener("dispose",y),e.__webglTexture=t.createTexture(),o.memory.textures++)}function O(e,n,o){var s=3553;n.isDataTexture2DArray&&(s=35866),n.isDataTexture3D&&(s=32879),P(e,n),i.activeTexture(33984+o),i.bindTexture(s,e.__webglTexture),t.pixelStorei(37440,n.flipY),t.pixelStorei(37441,n.premultiplyAlpha),t.pixelStorei(3317,n.unpackAlignment);var c=p(n)&&!1===d(n.image),l=h(n.image,c,!1,r.maxTextureSize),u=d(l)||r.isWebGL2,v=a.convert(n.format),y=a.convert(n.type),_=g(v,y);L(s,n,u);var b,w=n.mipmaps;if(n.isDepthTexture){if(_=6402,n.type===Ot){if(!r.isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");_=36012}else r.isWebGL2&&(_=33189);n.format===Vt&&6402===_&&n.type!==kt&&n.type!==Pt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=kt,y=a.convert(n.type)),n.format===Wt&&(_=34041,n.type!==Nt&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=Nt,y=a.convert(n.type))),i.texImage2D(3553,0,_,l.width,l.height,0,v,y,null)}else if(n.isDataTexture)if(w.length>0&&u){for(var T=0,x=w.length;T<x;T++)b=w[T],i.texImage2D(3553,T,_,b.width,b.height,0,v,y,b.data);n.generateMipmaps=!1,e.__maxMipLevel=w.length-1}else i.texImage2D(3553,0,_,l.width,l.height,0,v,y,l.data),e.__maxMipLevel=0;else if(n.isCompressedTexture){for(T=0,x=w.length;T<x;T++)b=w[T],n.format!==zt&&n.format!==Ft?i.getCompressedTextureFormats().indexOf(v)>-1?i.compressedTexImage2D(3553,T,_,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,T,_,b.width,b.height,0,v,y,b.data);e.__maxMipLevel=w.length-1}else if(n.isDataTexture2DArray)i.texImage3D(35866,0,_,l.width,l.height,l.depth,0,v,y,l.data),e.__maxMipLevel=0;else if(n.isDataTexture3D)i.texImage3D(32879,0,_,l.width,l.height,l.depth,0,v,y,l.data),e.__maxMipLevel=0;else if(w.length>0&&u){for(T=0,x=w.length;T<x;T++)b=w[T],i.texImage2D(3553,T,_,v,y,b);n.generateMipmaps=!1,e.__maxMipLevel=w.length-1}else i.texImage2D(3553,0,_,v,y,l),e.__maxMipLevel=0;f(n,u)&&m(3553,n,l.width,l.height),e.__version=n.version,n.onUpdate&&n.onUpdate(n)}function R(e,r,o,s){var c=a.convert(r.texture.format),l=a.convert(r.texture.type),u=g(c,l);i.texImage2D(s,0,u,r.width,r.height,0,c,l,null),t.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,o,s,n.get(r.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function I(e,i,n){if(t.bindRenderbuffer(36161,e),i.depthBuffer&&!i.stencilBuffer){if(n){var r=z(i);t.renderbufferStorageMultisample(36161,r,33189,i.width,i.height)}else t.renderbufferStorage(36161,33189,i.width,i.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(i.depthBuffer&&i.stencilBuffer){if(n){r=z(i);t.renderbufferStorageMultisample(36161,r,34041,i.width,i.height)}else t.renderbufferStorage(36161,34041,i.width,i.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{var o=a.convert(i.texture.format),s=a.convert(i.texture.type),c=g(o,s);if(n){r=z(i);t.renderbufferStorageMultisample(36161,r,c,i.width,i.height)}else t.renderbufferStorage(36161,c,i.width,i.height)}t.bindRenderbuffer(36161,null)}function D(e,i){var r=i&&i.isWebGLRenderTargetCube;if(r)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),E(i.depthTexture,0);var a=n.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===Vt)t.framebufferTexture2D(36160,36096,3553,a,0);else{if(i.depthTexture.format!==Wt)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,a,0)}}function U(e){var i=n.get(e),r=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");D(i.__webglFramebuffer,e)}else if(r){i.__webglDepthbuffer=[];for(var a=0;a<6;a++)t.bindFramebuffer(36160,i.__webglFramebuffer[a]),i.__webglDepthbuffer[a]=t.createRenderbuffer(),I(i.__webglDepthbuffer[a],e)}else t.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),I(i.__webglDepthbuffer,e);t.bindFramebuffer(36160,null)}function N(e){var s=n.get(e),c=n.get(e.texture);e.addEventListener("dispose",_),c.__webglTexture=t.createTexture(),o.memory.textures++;var l=!0===e.isWebGLRenderTargetCube,u=!0===e.isWebGLMultisampleRenderTarget,h=d(e)||r.isWebGL2;if(l){s.__webglFramebuffer=[];for(var p=0;p<6;p++)s.__webglFramebuffer[p]=t.createFramebuffer()}else if(s.__webglFramebuffer=t.createFramebuffer(),u)if(r.isWebGL2){s.__webglMultisampledFramebuffer=t.createFramebuffer(),s.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var v=a.convert(e.texture.format),y=a.convert(e.texture.type),b=g(v,y),w=z(e);t.renderbufferStorageMultisample(36161,w,b,e.width,e.height),t.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(s.__webglDepthRenderbuffer=t.createRenderbuffer(),I(s.__webglDepthRenderbuffer,e,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(l){i.bindTexture(34067,c.__webglTexture),L(34067,e.texture,h);for(p=0;p<6;p++)R(s.__webglFramebuffer[p],e,36064,34069+p);f(e.texture,h)&&m(34067,e.texture,e.width,e.height),i.bindTexture(34067,null)}else i.bindTexture(3553,c.__webglTexture),L(3553,e.texture,h),R(s.__webglFramebuffer,e,36064,3553),f(e.texture,h)&&m(3553,e.texture,e.width,e.height),i.bindTexture(3553,null);e.depthBuffer&&U(e)}function B(t){var e=t.texture,a=d(t)||r.isWebGL2;if(f(e,a)){var o=t.isWebGLRenderTargetCube?34067:3553,s=n.get(e).__webglTexture;i.bindTexture(o,s),m(o,e,t.width,t.height),i.bindTexture(o,null)}}function F(e){if(e.isWebGLMultisampleRenderTarget)if(r.isWebGL2){var i=n.get(e);t.bindFramebuffer(36008,i.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,i.__webglFramebuffer);var a=e.width,o=e.height,s=16384;e.depthBuffer&&(s|=256),e.stencilBuffer&&(s|=1024),t.blitFramebuffer(0,0,a,o,0,0,a,o,s,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function z(t){return r.isWebGL2&&t.isWebGLMultisampleRenderTarget?Math.min(r.maxSamples,t.samples):0}function j(t){var e=t.id,i=o.render.frame;c[e]!==i&&(c[e]=i,t.update())}var H=!1,G=!1;function V(t,e){t&&t.isWebGLRenderTarget&&(!1===H&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),H=!0),t=t.texture),E(t,e)}function W(t,e){t&&t.isWebGLRenderTargetCube&&(!1===G&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),G=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?A(t,e):k(t,e)}this.allocateTextureUnit=S,this.resetTextureUnits=x,this.setTexture2D=E,this.setTexture2DArray=M,this.setTexture3D=C,this.setTextureCube=A,this.setTextureCubeDynamic=k,this.setupRenderTarget=N,this.updateRenderTargetMipmap=B,this.updateMultisampleRenderTarget=F,this.safeSetTexture2D=V,this.safeSetTextureCube=W}function qo(t,e,i){function n(t){var n;if(t===vt)return 10497;if(t===yt)return 33071;if(t===_t)return 33648;if(t===bt)return 9728;if(t===wt)return 9984;if(t===Tt)return 9986;if(t===xt)return 9729;if(t===St)return 9985;if(t===Et)return 9987;if(t===Mt)return 5121;if(t===It)return 32819;if(t===Dt)return 32820;if(t===Ut)return 33635;if(t===Ct)return 5120;if(t===At)return 5122;if(t===kt)return 5123;if(t===Lt)return 5124;if(t===Pt)return 5125;if(t===Ot)return 5126;if(t===Rt){if(i.isWebGL2)return 5131;if(n=e.get("OES_texture_half_float"),null!==n)return n.HALF_FLOAT_OES}if(t===Bt)return 6406;if(t===Ft)return 6407;if(t===zt)return 6408;if(t===jt)return 6409;if(t===Ht)return 6410;if(t===Vt)return 6402;if(t===Wt)return 34041;if(t===qt)return 6403;if(t===L)return 32774;if(t===P)return 32778;if(t===O)return 32779;if(t===D)return 0;if(t===U)return 1;if(t===N)return 768;if(t===B)return 769;if(t===F)return 770;if(t===z)return 771;if(t===j)return 772;if(t===H)return 773;if(t===G)return 774;if(t===V)return 775;if(t===W)return 776;if((t===Yt||t===Xt||t===$t||t===Zt)&&(n=e.get("WEBGL_compressed_texture_s3tc"),null!==n)){if(t===Yt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===Xt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===$t)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===Zt)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((t===Jt||t===Kt||t===Qt||t===te)&&(n=e.get("WEBGL_compressed_texture_pvrtc"),null!==n)){if(t===Jt)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===Kt)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===Qt)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===te)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===ee&&(n=e.get("WEBGL_compressed_texture_etc1"),null!==n))return n.COMPRESSED_RGB_ETC1_WEBGL;if((t===ie||t===ne||t===re||t===ae||t===oe||t===se||t===ce||t===le||t===ue||t===he||t===de||t===pe||t===fe||t===me)&&(n=e.get("WEBGL_compressed_texture_astc"),null!==n))return t;if(t===R||t===I){if(i.isWebGL2){if(t===R)return 32775;if(t===I)return 32776}if(n=e.get("EXT_blend_minmax"),null!==n){if(t===R)return n.MIN_EXT;if(t===I)return n.MAX_EXT}}if(t===Nt){if(i.isWebGL2)return 34042;if(n=e.get("WEBGL_depth_texture"),null!==n)return n.UNSIGNED_INT_24_8_WEBGL}return 0}return{convert:n}}function Yo(){Lr.call(this),this.type="Group"}function Xo(){Lr.call(this),this.type="Camera",this.matrixWorldInverse=new ni,this.projectionMatrix=new ni,this.projectionMatrixInverse=new ni}function $o(t,e,i,n){Xo.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Zo(t){$o.call(this),this.cameras=t||[]}jo.prototype=Object.create(Kr.prototype),jo.prototype.constructor=jo,jo.prototype.isMeshDepthMaterial=!0,jo.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Ho.prototype=Object.create(Kr.prototype),Ho.prototype.constructor=Ho,Ho.prototype.isMeshDistanceMaterial=!0,Ho.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Yo.prototype=Object.assign(Object.create(Lr.prototype),{constructor:Yo,isGroup:!0}),Xo.prototype=Object.assign(Object.create(Lr.prototype),{constructor:Xo,isCamera:!0,copy:function(t,e){return Lr.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new Ge),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Lr.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),$o.prototype=Object.assign(Object.create(Xo.prototype),{constructor:$o,isPerspectiveCamera:!0,copy:function(t,e){return Xo.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*ze.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*ze.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*ze.RAD2DEG*Math.atan(Math.tan(.5*ze.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,i,n,r,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*ze.DEG2RAD*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;r+=a.offsetX*n/o,e-=a.offsetY*i/s,n*=a.width/o,i*=a.height/s}var c=this.filmOffset;0!==c&&(r+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,e,e-i,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Lr.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),Zo.prototype=Object.assign(Object.create($o.prototype),{constructor:Zo,isArrayCamera:!0});var Jo,Ko=new Ge,Qo=new Ge;function ts(t,e,i){Ko.setFromMatrixPosition(e.matrixWorld),Qo.setFromMatrixPosition(i.matrixWorld);var n=Ko.distanceTo(Qo),r=e.projectionMatrix.elements,a=i.projectionMatrix.elements,o=r[14]/(r[10]-1),s=r[14]/(r[10]+1),c=(r[9]+1)/r[5],l=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(a[8]+1)/a[0],d=o*u,p=o*h,f=n/(-u+h),m=f*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.getInverse(t.matrixWorld);var g=o+f,v=s+f,y=d-m,_=p+(n-m),b=c*s/v*g,w=l*s/v*g;t.projectionMatrix.makePerspective(y,_,b,w,g,v)}function es(t){var e=this,i=null,n=null,r=null,a=[],o=new ni,s=new ni,c=1,l="stage";"undefined"!==typeof window&&"VRFrameData"in window&&(n=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",_,!1));var u=new ni,h=new He,d=new Ge,p=new $o;p.bounds=new Xe(0,0,.5,1),p.layers.enable(1);var f=new $o;f.bounds=new Xe(.5,0,.5,1),f.layers.enable(2);var m=new Zo([p,f]);function g(){return null!==i&&!0===i.isPresenting}m.layers.enable(1),m.layers.enable(2);var v,y=new je;function _(){if(g()){var n=i.getEyeParameters("left"),r=n.renderWidth*c,a=n.renderHeight*c;v=t.getPixelRatio(),t.getSize(y),t.setDrawingBufferSize(2*r,a,1),x.start()}else e.enabled&&t.setDrawingBufferSize(y.width,y.height,v),x.stop()}var b=[];function w(t){for(var e=navigator.getGamepads&&navigator.getGamepads(),i=0,n=0,r=e.length;i<r;i++){var a=e[i];if(a&&("Daydream Controller"===a.id||"Gear VR Controller"===a.id||"Oculus Go Controller"===a.id||"OpenVR Gamepad"===a.id||a.id.startsWith("Oculus Touch")||a.id.startsWith("Spatial Controller"))){if(n===t)return a;n++}}}function T(){for(var t=0;t<a.length;t++){var e=a[t],i=w(t);if(void 0!==i&&void 0!==i.pose){if(null===i.pose)return;var n=i.pose;!1===n.hasPosition&&e.position.set(.2,-.6,-.05),null!==n.position&&e.position.fromArray(n.position),null!==n.orientation&&e.quaternion.fromArray(n.orientation),e.matrix.compose(e.position,e.quaternion,e.scale),e.matrix.premultiply(o),e.matrix.decompose(e.position,e.quaternion,e.scale),e.matrixWorldNeedsUpdate=!0,e.visible=!0;var r="Daydream Controller"===i.id?0:1;b[t]!==i.buttons[r].pressed&&(b[t]=i.buttons[r].pressed,!0===b[t]?e.dispatchEvent({type:"selectstart"}):(e.dispatchEvent({type:"selectend"}),e.dispatchEvent({type:"select"})))}else e.visible=!1}}this.enabled=!1,this.getController=function(t){var e=a[t];return void 0===e&&(e=new Yo,e.matrixAutoUpdate=!1,e.visible=!1,a[t]=e),e},this.getDevice=function(){return i},this.setDevice=function(t){void 0!==t&&(i=t),x.setContext(t)},this.setFramebufferScaleFactor=function(t){c=t},this.setFrameOfReferenceType=function(t){l=t},this.setPoseTarget=function(t){void 0!==t&&(r=t)},this.getCamera=function(t){var e="stage"===l?1.6:0;if(!1===g())return t.position.set(0,e,0),t.rotation.set(0,0,0),t;if(i.depthNear=t.near,i.depthFar=t.far,i.getFrameData(n),"stage"===l){var a=i.stageParameters;a?o.fromArray(a.sittingToStandingTransform):o.makeTranslation(0,e,0)}var c=n.pose,v=null!==r?r:t;v.matrix.copy(o),v.matrix.decompose(v.position,v.quaternion,v.scale),null!==c.orientation&&(h.fromArray(c.orientation),v.quaternion.multiply(h)),null!==c.position&&(h.setFromRotationMatrix(o),d.fromArray(c.position),d.applyQuaternion(h),v.position.add(d)),v.updateMatrixWorld(),p.near=t.near,f.near=t.near,p.far=t.far,f.far=t.far,p.matrixWorldInverse.fromArray(n.leftViewMatrix),f.matrixWorldInverse.fromArray(n.rightViewMatrix),s.getInverse(o),"stage"===l&&(p.matrixWorldInverse.multiply(s),f.matrixWorldInverse.multiply(s));var y=v.parent;null!==y&&(u.getInverse(y.matrixWorld),p.matrixWorldInverse.multiply(u),f.matrixWorldInverse.multiply(u)),p.matrixWorld.getInverse(p.matrixWorldInverse),f.matrixWorld.getInverse(f.matrixWorldInverse),p.projectionMatrix.fromArray(n.leftProjectionMatrix),f.projectionMatrix.fromArray(n.rightProjectionMatrix),ts(m,p,f);var _=i.getLayers();if(_.length){var b=_[0];null!==b.leftBounds&&4===b.leftBounds.length&&p.bounds.fromArray(b.leftBounds),null!==b.rightBounds&&4===b.rightBounds.length&&f.bounds.fromArray(b.rightBounds)}return T(),m},this.getStandingMatrix=function(){return o},this.isPresenting=g;var x=new Sr;this.setAnimationLoop=function(t){x.setAnimationLoop(t),g()&&x.start()},this.submitFrame=function(){g()&&i.submitFrame()},this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",_)}}function is(t){var e=t.context,i=null,n=null,r=1,a=null,o="stage",s=null,c=[],l=[];function u(){return null!==n&&null!==a}var h=new $o;h.layers.enable(1),h.viewport=new Xe;var d=new $o;d.layers.enable(2),d.viewport=new Xe;var p=new Zo([h,d]);function f(t){var e=c[l.indexOf(t.inputSource)];e&&e.dispatchEvent({type:t.type})}function m(){t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),_.stop()}function g(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.getInverse(t.matrixWorld)}p.layers.enable(1),p.layers.enable(2),this.enabled=!1,this.getController=function(t){var e=c[t];return void 0===e&&(e=new Yo,e.matrixAutoUpdate=!1,e.visible=!1,c[t]=e),e},this.getDevice=function(){return i},this.setDevice=function(t){void 0!==t&&(i=t),t instanceof XRDevice&&e.setCompatibleXRDevice(t)},this.setFramebufferScaleFactor=function(t){r=t},this.setFrameOfReferenceType=function(t){o=t},this.setSession=function(i){n=i,null!==n&&(n.addEventListener("select",f),n.addEventListener("selectstart",f),n.addEventListener("selectend",f),n.addEventListener("end",m),n.baseLayer=new XRWebGLLayer(n,e,{framebufferScaleFactor:r}),n.requestFrameOfReference(o).then(function(e){a=e,t.setFramebuffer(n.baseLayer.framebuffer),_.setContext(n),_.start()}),l=n.getInputSources(),n.addEventListener("inputsourceschange",function(){l=n.getInputSources(),console.log(l);for(var t=0;t<c.length;t++){var e=c[t];e.userData.inputSource=l[t]}}))},this.getCamera=function(t){if(u()){var e=t.parent,i=p.cameras;g(p,e);for(var n=0;n<i.length;n++)g(i[n],e);t.matrixWorld.copy(p.matrixWorld);for(var r=t.children,a=(n=0,r.length);n<a;n++)r[n].updateMatrixWorld(!0);return ts(p,h,d),p}return t},this.isPresenting=u;var v=null;function y(t,e){if(s=e.getDevicePose(a),null!==s)for(var i=n.baseLayer,r=e.views,o=0;o<r.length;o++){var u=r[o],h=i.getViewport(u),d=s.getViewMatrix(u),f=p.cameras[o];f.matrix.fromArray(d).getInverse(f.matrix),f.projectionMatrix.fromArray(u.projectionMatrix),f.viewport.set(h.x,h.y,h.width,h.height),0===o&&p.matrix.copy(f.matrix)}for(o=0;o<c.length;o++){var m=c[o],g=l[o];if(g){var y=e.getInputPose(g,a);if(null!==y){"targetRay"in y?m.matrix.elements=y.targetRay.transformMatrix:"pointerMatrix"in y&&(m.matrix.elements=y.pointerMatrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.visible=!0;continue}}m.visible=!1}v&&v(t)}var _=new Sr;_.setAnimationLoop(y),this.setAnimationLoop=function(t){v=t},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new ni},this.submitFrame=function(){}}function ns(t){console.log("THREE.WebGLRenderer",a),t=t||{};var e=void 0!==t.canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i=void 0!==t.context?t.context:null,n=void 0!==t.alpha&&t.alpha,r=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,c=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,u=void 0!==t.powerPreference?t.powerPreference:"default",h=null,d=null;this.domElement=e,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=rt,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var p,f,m,g,y,_,b,w,T,x,S,E,M,C,A,k,L,P,O=this,R=!1,I=null,D=null,U=null,N=-1,B={geometry:null,program:null,wireframe:!1},F=null,z=null,j=new Xe,H=new Xe,G=null,V=e.width,W=e.height,q=1,Y=new Xe(0,0,V,W),X=new Xe(0,0,V,W),$=!1,Z=new ii,J=new la,K=!1,Q=!1,tt=new ni,et=new Ge;function it(){return null===D?q:1}try{var nt={alpha:n,depth:r,stencil:o,antialias:s,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u};if(e.addEventListener("webglcontextlost",ct,!1),e.addEventListener("webglcontextrestored",lt,!1),p=i||e.getContext("webgl",nt)||e.getContext("experimental-webgl",nt),null===p)throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===p.getShaderPrecisionFormat&&(p.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Gt){throw console.error("THREE.WebGLRenderer: "+Gt.message),Gt}function at(){f=new ua(p),m=new ca(p,f,t),m.isWebGL2||(f.get("WEBGL_depth_texture"),f.get("OES_texture_float"),f.get("OES_texture_half_float"),f.get("OES_texture_half_float_linear"),f.get("OES_standard_derivatives"),f.get("OES_element_index_uint"),f.get("ANGLE_instanced_arrays")),f.get("OES_texture_float_linear"),P=new qo(p,f,m),g=new Vo(p,f,P,m),g.scissor(H.copy(X).multiplyScalar(q)),g.viewport(j.copy(Y).multiplyScalar(q)),y=new pa(p),_=new Po,b=new Wo(p,f,g,_,m,P,y),w=new Er(p),T=new ha(p,w,y),x=new ga(T,y),A=new ma(p),S=new Lo(O,f,m,b),E=new Do,M=new zo,C=new oa(O,g,x,c),k=new sa(p,f,y,m),L=new da(p,f,y,m),y.programs=S.programs,O.context=p,O.capabilities=m,O.extensions=f,O.properties=_,O.renderLists=E,O.state=g,O.info=y}at();var ot=null;"undefined"!==typeof navigator&&(ot="xr"in navigator?new is(O):new es(O)),this.vr=ot;var st=new Go(O,x,m.maxTextureSize);function ct(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),R=!0}function lt(){console.log("THREE.WebGLRenderer: Context Restored."),R=!1,at()}function ut(t){var e=t.target;e.removeEventListener("dispose",ut),ht(e)}function ht(t){dt(t),_.remove(t)}function dt(t){var e=_.get(t).program;t.program=void 0,void 0!==e&&S.releaseProgram(e)}function pt(t,e){t.render(function(t){O.renderBufferImmediate(t,e)})}function ft(t,e,i){if(i&&i.isInstancedBufferGeometry&&!m.isWebGL2&&null===f.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{g.initAttributes();var n=i.attributes,r=e.getAttributes(),a=t.defaultAttributeValues;for(var o in r){var s=r[o];if(s>=0){var c=n[o];if(void 0!==c){var l=c.normalized,u=c.itemSize,h=w.get(c);if(void 0===h)continue;var d=h.buffer,v=h.type,y=h.bytesPerElement;if(c.isInterleavedBufferAttribute){var _=c.data,b=_.stride,T=c.offset;_&&_.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(s,_.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=_.meshPerAttribute*_.count)):g.enableAttribute(s),p.bindBuffer(34962,d),p.vertexAttribPointer(s,u,v,l,b*y,T*y)}else c.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(s,c.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=c.meshPerAttribute*c.count)):g.enableAttribute(s),p.bindBuffer(34962,d),p.vertexAttribPointer(s,u,v,l,0,0)}else if(void 0!==a){var x=a[o];if(void 0!==x)switch(x.length){case 2:p.vertexAttrib2fv(s,x);break;case 3:p.vertexAttrib3fv(s,x);break;case 4:p.vertexAttrib4fv(s,x);break;default:p.vertexAttrib1fv(s,x)}}}}g.disableUnusedAttributes()}}this.shadowMap=st,this.getContext=function(){return p},this.getContextAttributes=function(){return p.getContextAttributes()},this.forceContextLoss=function(){var t=f.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=f.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return q},this.setPixelRatio=function(t){void 0!==t&&(q=t,this.setSize(V,W,!1))},this.getSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),t=new je),t.set(V,W)},this.setSize=function(t,i,n){ot.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(V=t,W=i,e.width=t*q,e.height=i*q,!1!==n&&(e.style.width=t+"px",e.style.height=i+"px"),this.setViewport(0,0,t,i))},this.getDrawingBufferSize=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),t=new je),t.set(V*q,W*q)},this.setDrawingBufferSize=function(t,i,n){V=t,W=i,q=n,e.width=t*n,e.height=i*n,this.setViewport(0,0,t,i)},this.getCurrentViewport=function(t){return void 0===t&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),t=new Xe),t.copy(j)},this.getViewport=function(t){return t.copy(Y)},this.setViewport=function(t,e,i,n){t.isVector4?Y.set(t.x,t.y,t.z,t.w):Y.set(t,e,i,n),g.viewport(j.copy(Y).multiplyScalar(q))},this.getScissor=function(t){return t.copy(X)},this.setScissor=function(t,e,i,n){t.isVector4?X.set(t.x,t.y,t.z,t.w):X.set(t,e,i,n),g.scissor(H.copy(X).multiplyScalar(q))},this.getScissorTest=function(){return $},this.setScissorTest=function(t){g.setScissorTest($=t)},this.getClearColor=function(){return C.getClearColor()},this.setClearColor=function(){C.setClearColor.apply(C,arguments)},this.getClearAlpha=function(){return C.getClearAlpha()},this.setClearAlpha=function(){C.setClearAlpha.apply(C,arguments)},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=16384),(void 0===e||e)&&(n|=256),(void 0===i||i)&&(n|=1024),p.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ct,!1),e.removeEventListener("webglcontextrestored",lt,!1),E.dispose(),M.dispose(),_.dispose(),x.dispose(),ot.dispose(),vt.stop()},this.renderBufferImmediate=function(t,e){g.initAttributes();var i=_.get(t);t.hasPositions&&!i.position&&(i.position=p.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=p.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=p.createBuffer()),t.hasColors&&!i.color&&(i.color=p.createBuffer());var n=e.getAttributes();t.hasPositions&&(p.bindBuffer(34962,i.position),p.bufferData(34962,t.positionArray,35048),g.enableAttribute(n.position),p.vertexAttribPointer(n.position,3,5126,!1,0,0)),t.hasNormals&&(p.bindBuffer(34962,i.normal),p.bufferData(34962,t.normalArray,35048),g.enableAttribute(n.normal),p.vertexAttribPointer(n.normal,3,5126,!1,0,0)),t.hasUvs&&(p.bindBuffer(34962,i.uv),p.bufferData(34962,t.uvArray,35048),g.enableAttribute(n.uv),p.vertexAttribPointer(n.uv,2,5126,!1,0,0)),t.hasColors&&(p.bindBuffer(34962,i.color),p.bufferData(34962,t.colorArray,35048),g.enableAttribute(n.color),p.vertexAttribPointer(n.color,3,5126,!1,0,0)),g.disableUnusedAttributes(),p.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,n,r,a){var o=r.isMesh&&r.matrixWorld.determinant()<0;g.setMaterial(n,o);var s=Tt(t,e,n,r),c=!1;B.geometry===i.id&&B.program===s.id&&B.wireframe===(!0===n.wireframe)||(B.geometry=i.id,B.program=s.id,B.wireframe=!0===n.wireframe,c=!0),r.morphTargetInfluences&&(A.update(r,i,n,s),c=!0);var l,u=i.index,h=i.attributes.position,d=1;!0===n.wireframe&&(u=T.getWireframeAttribute(i),d=2);var f=k;null!==u&&(l=w.get(u),f=L,f.setIndex(l)),c&&(ft(n,s,i),null!==u&&p.bindBuffer(34963,l.buffer));var m=1/0;null!==u?m=u.count:void 0!==h&&(m=h.count);var v=i.drawRange.start*d,y=i.drawRange.count*d,_=null!==a?a.start*d:0,b=null!==a?a.count*d:1/0,x=Math.max(v,_),S=Math.min(m,v+y,_+b)-1,E=Math.max(0,S-x+1);if(0!==E){if(r.isMesh)if(!0===n.wireframe)g.setLineWidth(n.wireframeLinewidth*it()),f.setMode(1);else switch(r.drawMode){case Ee:f.setMode(4);break;case Me:f.setMode(5);break;case Ce:f.setMode(6);break}else if(r.isLine){var M=n.linewidth;void 0===M&&(M=1),g.setLineWidth(M*it()),r.isLineSegments?f.setMode(1):r.isLineLoop?f.setMode(2):f.setMode(3)}else r.isPoints?f.setMode(0):r.isSprite&&f.setMode(4);i&&i.isInstancedBufferGeometry?i.maxInstancedCount>0&&f.renderInstances(i,x,E):f.render(x,E)}},this.compile=function(t,e){d=M.get(t,e),d.init(),t.traverse(function(t){t.isLight&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))}),d.setupLights(e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var i=0;i<e.material.length;i++)wt(e.material[i],t.fog,e);else wt(e.material,t.fog,e)})};var mt=null;function gt(t){ot.isPresenting()||mt&&mt(t)}var vt=new Sr;function yt(t,e,i,n){if(!1!==t.visible){var r=t.layers.test(e.layers);if(r)if(t.isGroup)i=t.renderOrder;else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||Z.intersectsSprite(t)){n&&et.setFromMatrixPosition(t.matrixWorld).applyMatrix4(tt);var a=x.update(t),o=t.material;o.visible&&h.push(t,a,o,i,et.z,null)}}else if(t.isImmediateRenderObject)n&&et.setFromMatrixPosition(t.matrixWorld).applyMatrix4(tt),h.push(t,null,t.material,i,et.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||Z.intersectsObject(t))){n&&et.setFromMatrixPosition(t.matrixWorld).applyMatrix4(tt);a=x.update(t),o=t.material;if(Array.isArray(o))for(var s=a.groups,c=0,l=s.length;c<l;c++){var u=s[c],p=o[u.materialIndex];p&&p.visible&&h.push(t,a,p,i,et.z,u)}else o.visible&&h.push(t,a,o,i,et.z,null)}var f=t.children;for(c=0,l=f.length;c<l;c++)yt(f[c],e,i,n)}}function _t(t,e,i,n){for(var r=0,a=t.length;r<a;r++){var o=t[r],s=o.object,c=o.geometry,l=void 0===n?o.material:n,u=o.group;if(i.isArrayCamera){z=i;for(var h=i.cameras,p=0,f=h.length;p<f;p++){var m=h[p];if(s.layers.test(m.layers)){if("viewport"in m)g.viewport(j.copy(m.viewport));else{var v=m.bounds,y=v.x*V,_=v.y*W,b=v.z*V,w=v.w*W;g.viewport(j.set(y,_,b,w).multiplyScalar(q))}d.setupLights(m),bt(s,e,m,c,l,u)}}}else z=null,bt(s,e,i,c,l,u)}}function bt(t,e,i,n,r,a){if(t.onBeforeRender(O,e,i,n,r,a),d=M.get(e,z||i),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){g.setMaterial(r);var o=Tt(i,e.fog,r,t);B.geometry=null,B.program=null,B.wireframe=!1,pt(t,o)}else O.renderBufferDirect(i,e.fog,n,r,t,a);t.onAfterRender(O,e,i,n,r,a),d=M.get(e,z||i)}function wt(t,e,i){var n=_.get(t),r=d.state.lights,a=d.state.shadowsArray,o=n.lightsHash,s=r.state.hash,c=S.getParameters(t,r.state,a,e,J.numPlanes,J.numIntersection,i),l=S.getProgramCode(t,c),u=n.program,h=!0;if(void 0===u)t.addEventListener("dispose",ut);else if(u.code!==l)dt(t);else if(o.stateID!==s.stateID||o.directionalLength!==s.directionalLength||o.pointLength!==s.pointLength||o.spotLength!==s.spotLength||o.rectAreaLength!==s.rectAreaLength||o.hemiLength!==s.hemiLength||o.shadowsLength!==s.shadowsLength)o.stateID=s.stateID,o.directionalLength=s.directionalLength,o.pointLength=s.pointLength,o.spotLength=s.spotLength,o.rectAreaLength=s.rectAreaLength,o.hemiLength=s.hemiLength,o.shadowsLength=s.shadowsLength,h=!1;else{if(void 0!==c.shaderID)return;h=!1}if(h){if(c.shaderID){var p=xr[c.shaderID];n.shader={name:t.type,uniforms:vr(p.uniforms),vertexShader:p.vertexShader,fragmentShader:p.fragmentShader}}else n.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(n.shader,O),l=S.getProgramCode(t,c),u=S.acquireProgram(t,n.shader,c,l),n.program=u,t.program=u}var f=u.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var m=0;m<O.maxMorphTargets;m++)f["morphTarget"+m]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(m=0;m<O.maxMorphNormals;m++)f["morphNormal"+m]>=0&&t.numSupportedMorphNormals++}var g=n.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=J.numPlanes,n.numIntersection=J.numIntersection,g.clippingPlanes=J.uniform),n.fog=e,void 0===o&&(n.lightsHash=o={}),o.stateID=s.stateID,o.directionalLength=s.directionalLength,o.pointLength=s.pointLength,o.spotLength=s.spotLength,o.rectAreaLength=s.rectAreaLength,o.hemiLength=s.hemiLength,o.shadowsLength=s.shadowsLength,t.lights&&(g.ambientLightColor.value=r.state.ambient,g.directionalLights.value=r.state.directional,g.spotLights.value=r.state.spot,g.rectAreaLights.value=r.state.rectArea,g.pointLights.value=r.state.point,g.hemisphereLights.value=r.state.hemi,g.directionalShadowMap.value=r.state.directionalShadowMap,g.directionalShadowMatrix.value=r.state.directionalShadowMatrix,g.spotShadowMap.value=r.state.spotShadowMap,g.spotShadowMatrix.value=r.state.spotShadowMatrix,g.pointShadowMap.value=r.state.pointShadowMap,g.pointShadowMatrix.value=r.state.pointShadowMatrix);var v=n.program.getUniforms(),y=po.seqWithValue(v.seq,g);n.uniformsList=y}function Tt(t,e,i,n){b.resetTextureUnits();var r=_.get(i),a=d.state.lights,o=r.lightsHash,s=a.state.hash;if(K&&(Q||t!==F)){var c=t===F&&i.id===N;J.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,t,r,c)}!1===i.needsUpdate&&(void 0===r.program?i.needsUpdate=!0:i.fog&&r.fog!==e?i.needsUpdate=!0:(!i.lights||o.stateID===s.stateID&&o.directionalLength===s.directionalLength&&o.pointLength===s.pointLength&&o.spotLength===s.spotLength&&o.rectAreaLength===s.rectAreaLength&&o.hemiLength===s.hemiLength&&o.shadowsLength===s.shadowsLength)&&(void 0===r.numClippingPlanes||r.numClippingPlanes===J.numPlanes&&r.numIntersection===J.numIntersection)||(i.needsUpdate=!0)),i.needsUpdate&&(wt(i,e,n),i.needsUpdate=!1);var l=!1,u=!1,h=!1,f=r.program,v=f.getUniforms(),y=r.shader.uniforms;if(g.useProgram(f.program)&&(l=!0,u=!0,h=!0),i.id!==N&&(N=i.id,u=!0),l||F!==t){if(v.setValue(p,"projectionMatrix",t.projectionMatrix),m.logarithmicDepthBuffer&&v.setValue(p,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),F!==t&&(F=t,u=!0,h=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap){var w=v.map.cameraPosition;void 0!==w&&w.setValue(p,et.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&v.setValue(p,"viewMatrix",t.matrixWorldInverse)}if(i.skinning){v.setOptional(p,n,"bindMatrix"),v.setOptional(p,n,"bindMatrixInverse");var T=n.skeleton;if(T){var x=T.bones;if(m.floatVertexTextures){if(void 0===T.boneTexture){var S=Math.sqrt(4*x.length);S=ze.ceilPowerOfTwo(S),S=Math.max(S,4);var E=new Float32Array(S*S*4);E.set(T.boneMatrices);var M=new Ke(E,S,S,zt,Ot);M.needsUpdate=!0,T.boneMatrices=E,T.boneTexture=M,T.boneTextureSize=S}v.setValue(p,"boneTexture",T.boneTexture,b),v.setValue(p,"boneTextureSize",T.boneTextureSize)}else v.setOptional(p,T,"boneMatrices")}}return u&&(v.setValue(p,"toneMappingExposure",O.toneMappingExposure),v.setValue(p,"toneMappingWhitePoint",O.toneMappingWhitePoint),i.lights&&Ht(y,h),e&&i.fog&&kt(y,e),i.isMeshBasicMaterial?xt(y,i):i.isMeshLambertMaterial?(xt(y,i),Lt(y,i)):i.isMeshPhongMaterial?(xt(y,i),i.isMeshToonMaterial?It(y,i):Pt(y,i)):i.isMeshStandardMaterial?(xt(y,i),i.isMeshPhysicalMaterial?Ut(y,i):Dt(y,i)):i.isMeshMatcapMaterial?(xt(y,i),Nt(y,i)):i.isMeshDepthMaterial?(xt(y,i),Bt(y,i)):i.isMeshDistanceMaterial?(xt(y,i),Ft(y,i)):i.isMeshNormalMaterial?(xt(y,i),jt(y,i)):i.isLineBasicMaterial?(St(y,i),i.isLineDashedMaterial&&Et(y,i)):i.isPointsMaterial?Ct(y,i):i.isSpriteMaterial?At(y,i):i.isShadowMaterial&&(y.color.value=i.color,y.opacity.value=i.opacity),void 0!==y.ltc_1&&(y.ltc_1.value=Tr.LTC_1),void 0!==y.ltc_2&&(y.ltc_2.value=Tr.LTC_2),po.upload(p,r.uniformsList,y,b)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(po.upload(p,r.uniformsList,y,b),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&v.setValue(p,"center",n.center),v.setValue(p,"modelViewMatrix",n.modelViewMatrix),v.setValue(p,"normalMatrix",n.normalMatrix),v.setValue(p,"modelMatrix",n.matrixWorld),f}function xt(t,e){var i;t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=_.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}function St(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function Et(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function Ct(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*q,t.scale.value=.5*W,t.map.value=e.map,null!==e.map&&(!0===e.map.matrixAutoUpdate&&e.map.updateMatrix(),t.uvTransform.value.copy(e.map.matrix))}function At(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity,t.rotation.value=e.rotation,t.map.value=e.map,null!==e.map&&(!0===e.map.matrixAutoUpdate&&e.map.updateMatrix(),t.uvTransform.value.copy(e.map.matrix))}function kt(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}function Lt(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function Pt(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function It(t,e){Pt(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}function Dt(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function Ut(t,e){Dt(t,e),t.reflectivity.value=e.reflectivity,t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness}function Nt(t,e){e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function Bt(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function Ft(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}function jt(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===v&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===v&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function Ht(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}vt.setAnimationLoop(gt),"undefined"!==typeof window&&vt.setContext(window),this.setAnimationLoop=function(t){mt=t,ot.setAnimationLoop(t),vt.start()},this.render=function(t,e){var i,n;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),i=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),n=arguments[3]),e&&e.isCamera){if(!R){B.geometry=null,B.program=null,B.wireframe=!1,N=-1,F=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),ot.enabled&&(e=ot.getCamera(e)),d=M.get(t,e),d.init(),t.onBeforeRender(O,t,e,i||D),tt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Z.setFromMatrix(tt),Q=this.localClippingEnabled,K=J.init(this.clippingPlanes,Q,e),h=E.get(t,e),h.init(),yt(t,e,0,O.sortObjects),!0===O.sortObjects&&h.sort(),K&&J.beginShadows();var r=d.state.shadowsArray;st.render(r,t,e),d.setupLights(e),K&&J.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==i&&this.setRenderTarget(i),C.render(h,t,e,n);var a=h.opaque,o=h.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;a.length&&_t(a,t,e,s),o.length&&_t(o,t,e,s)}else a.length&&_t(a,t,e),o.length&&_t(o,t,e);t.onAfterRender(O,t,e),null!==D&&(b.updateRenderTargetMipmap(D),b.updateMultisampleRenderTarget(D)),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),ot.enabled&&ot.submitFrame(),h=null,d=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(t){I=t},this.getRenderTarget=function(){return D},this.setRenderTarget=function(t,e,i){D=t,t&&void 0===_.get(t).__webglFramebuffer&&b.setupRenderTarget(t);var n=I,r=!1;if(t){var a=_.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(n=a[e||0],r=!0):n=t.isWebGLMultisampleRenderTarget?_.get(t).__webglMultisampledFramebuffer:a,j.copy(t.viewport),H.copy(t.scissor),G=t.scissorTest}else j.copy(Y).multiplyScalar(q),H.copy(X).multiplyScalar(q),G=$;if(U!==n&&(p.bindFramebuffer(36160,n),U=n),g.viewport(j),g.scissor(H),g.setScissorTest(G),r){var o=_.get(t.texture);p.framebufferTexture2D(36160,36064,34069+(e||0),o.__webglTexture,i||0)}},this.readRenderTargetPixels=function(t,e,i,n,r,a){if(t&&t.isWebGLRenderTarget){var o=_.get(t).__webglFramebuffer;if(o){var s=!1;o!==U&&(p.bindFramebuffer(36160,o),s=!0);try{var c=t.texture,l=c.format,u=c.type;if(l!==zt&&P.convert(l)!==p.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(u!==Mt&&P.convert(u)!==p.getParameter(35738)&&(u!==Ot||!(m.isWebGL2||f.get("OES_texture_float")||f.get("WEBGL_color_buffer_float")))&&(u!==Rt||(m.isWebGL2?!f.get("EXT_color_buffer_float"):!f.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===p.checkFramebufferStatus(36160)?e>=0&&e<=t.width-n&&i>=0&&i<=t.height-r&&p.readPixels(e,i,n,r,P.convert(l),P.convert(u),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&p.bindFramebuffer(36160,U)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,i){var n=e.image.width,r=e.image.height,a=P.convert(e.format);b.setTexture2D(e,0),p.copyTexImage2D(3553,i||0,a,t.x,t.y,n,r,0)},this.copyTextureToTexture=function(t,e,i,n){var r=e.image.width,a=e.image.height,o=P.convert(i.format),s=P.convert(i.type);b.setTexture2D(i,0),e.isDataTexture?p.texSubImage2D(3553,n||0,t.x,t.y,r,a,o,s,e.image.data):p.texSubImage2D(3553,n||0,t.x,t.y,o,s,e.image)}}function rs(t,e){this.name="",this.color=new wr(t),this.density=void 0!==e?e:25e-5}function as(t,e,i){this.name="",this.color=new wr(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3}function os(){Lr.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function ss(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function cs(t,e,i,n){this.data=t,this.itemSize=e,this.offset=i,this.normalized=!0===n}function ls(t){Kr.call(this),this.type="SpriteMaterial",this.color=new wr(16777215),this.map=null,this.rotation=0,this.sizeAttenuation=!0,this.lights=!1,this.transparent=!0,this.setValues(t)}function us(t){if(Lr.call(this),this.type="Sprite",void 0===Jo){Jo=new qr;var e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new ss(e,5);Jo.setIndex([0,1,2,0,2,3]),Jo.addAttribute("position",new cs(i,3,0,!1)),Jo.addAttribute("uv",new cs(i,2,3,!1))}this.geometry=Jo,this.material=void 0!==t?t:new ls,this.center=new je(.5,.5)}function hs(){Lr.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function ds(t,e){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),aa.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ni,this.bindMatrixInverse=new ni}function ps(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new ni)}}function fs(){Lr.call(this),this.type="Bone"}function ms(t){Kr.call(this),this.type="LineBasicMaterial",this.color=new wr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function gs(t,e,i){1===i&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Lr.call(this),this.type="Line",this.geometry=void 0!==t?t:new qr,this.material=void 0!==e?e:new ms({color:16777215*Math.random()})}function vs(t,e){gs.call(this,t,e),this.type="LineSegments"}function ys(t,e){gs.call(this,t,e),this.type="LineLoop"}function _s(t){Kr.call(this),this.type="PointsMaterial",this.color=new wr(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function bs(t,e){Lr.call(this),this.type="Points",this.geometry=void 0!==t?t:new qr,this.material=void 0!==e?e:new _s({color:16777215*Math.random()})}function ws(t,e,i,n,r,a,o,s,c){Ye.call(this,t,e,i,n,r,a,o,s,c),this.format=void 0!==o?o:Ft,this.minFilter=void 0!==a?a:xt,this.magFilter=void 0!==r?r:xt,this.generateMipmaps=!1}function Ts(t,e,i,n,r,a,o,s,c,l,u,h){Ye.call(this,null,a,o,s,c,l,n,r,u,h),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function xs(t,e,i,n,r,a,o,s,c){Ye.call(this,t,e,i,n,r,a,o,s,c),this.needsUpdate=!0}function Ss(t,e,i,n,r,a,o,s,c,l){if(l=void 0!==l?l:Vt,l!==Vt&&l!==Wt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&l===Vt&&(i=kt),void 0===i&&l===Wt&&(i=Nt),Ye.call(this,null,n,r,a,o,s,l,i,c),this.image={width:t,height:e},this.magFilter=void 0!==o?o:bt,this.minFilter=void 0!==s?s:bt,this.flipY=!1,this.generateMipmaps=!1}function Es(t){qr.call(this),this.type="WireframeGeometry";var e,i,n,r,a,o,s,c,l,u,h=[],d=[0,0],p={},f=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,n=m.length;e<n;e++){var g=m[e];for(i=0;i<3;i++)s=g[f[i]],c=g[f[(i+1)%3]],d[0]=Math.min(s,c),d[1]=Math.max(s,c),l=d[0]+","+d[1],void 0===p[l]&&(p[l]={index1:d[0],index2:d[1]})}for(l in p)o=p[l],u=t.vertices[o.index1],h.push(u.x,u.y,u.z),u=t.vertices[o.index2],h.push(u.x,u.y,u.z)}else if(t&&t.isBufferGeometry){var v,y,_,b,w,T,x,S;if(u=new Ge,null!==t.index){for(v=t.attributes.position,y=t.index,_=t.groups,0===_.length&&(_=[{start:0,count:y.count,materialIndex:0}]),r=0,a=_.length;r<a;++r)for(b=_[r],w=b.start,T=b.count,e=w,n=w+T;e<n;e+=3)for(i=0;i<3;i++)s=y.getX(e+i),c=y.getX(e+(i+1)%3),d[0]=Math.min(s,c),d[1]=Math.max(s,c),l=d[0]+","+d[1],void 0===p[l]&&(p[l]={index1:d[0],index2:d[1]});for(l in p)o=p[l],u.fromBufferAttribute(v,o.index1),h.push(u.x,u.y,u.z),u.fromBufferAttribute(v,o.index2),h.push(u.x,u.y,u.z)}else for(v=t.attributes.position,e=0,n=v.count/3;e<n;e++)for(i=0;i<3;i++)x=3*e+i,u.fromBufferAttribute(v,x),h.push(u.x,u.y,u.z),S=3*e+(i+1)%3,u.fromBufferAttribute(v,S),h.push(u.x,u.y,u.z)}this.addAttribute("position",new jr(h,3))}function Ms(t,e,i){Or.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i},this.fromBufferGeometry(new Cs(t,e,i)),this.mergeVertices()}function Cs(t,e,i){qr.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:i};var n,r,a=[],o=[],s=[],c=[],l=1e-5,u=new Ge,h=new Ge,d=new Ge,p=new Ge,f=new Ge;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=e+1;for(n=0;n<=i;n++){var g=n/i;for(r=0;r<=e;r++){var v=r/e;t(v,g,h),o.push(h.x,h.y,h.z),v-l>=0?(t(v-l,g,d),p.subVectors(h,d)):(t(v+l,g,d),p.subVectors(d,h)),g-l>=0?(t(v,g-l,d),f.subVectors(h,d)):(t(v,g+l,d),f.subVectors(d,h)),u.crossVectors(p,f).normalize(),s.push(u.x,u.y,u.z),c.push(v,g)}}for(n=0;n<i;n++)for(r=0;r<e;r++){var y=n*m+r,_=n*m+r+1,b=(n+1)*m+r+1,w=(n+1)*m+r;a.push(y,_,w),a.push(_,b,w)}this.setIndex(a),this.addAttribute("position",new jr(o,3)),this.addAttribute("normal",new jr(s,3)),this.addAttribute("uv",new jr(c,2))}function As(t,e,i,n){Or.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},this.fromBufferGeometry(new ks(t,e,i,n)),this.mergeVertices()}function ks(t,e,i,n){qr.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},i=i||1,n=n||0;var r=[],a=[];function o(t){for(var i=new Ge,n=new Ge,r=new Ge,a=0;a<e.length;a+=3)d(e[a+0],i),d(e[a+1],n),d(e[a+2],r),s(i,n,r,t)}function s(t,e,i,n){var r,a,o=Math.pow(2,n),s=[];for(r=0;r<=o;r++){s[r]=[];var c=t.clone().lerp(i,r/o),l=e.clone().lerp(i,r/o),u=o-r;for(a=0;a<=u;a++)s[r][a]=0===a&&r===o?c:c.clone().lerp(l,a/u)}for(r=0;r<o;r++)for(a=0;a<2*(o-r)-1;a++){var d=Math.floor(a/2);a%2===0?(h(s[r][d+1]),h(s[r+1][d]),h(s[r][d])):(h(s[r][d+1]),h(s[r+1][d+1]),h(s[r+1][d]))}}function c(t){for(var e=new Ge,i=0;i<r.length;i+=3)e.x=r[i+0],e.y=r[i+1],e.z=r[i+2],e.normalize().multiplyScalar(t),r[i+0]=e.x,r[i+1]=e.y,r[i+2]=e.z}function l(){for(var t=new Ge,e=0;e<r.length;e+=3){t.x=r[e+0],t.y=r[e+1],t.z=r[e+2];var i=m(t)/2/Math.PI+.5,n=g(t)/Math.PI+.5;a.push(i,1-n)}p(),u()}function u(){for(var t=0;t<a.length;t+=6){var e=a[t+0],i=a[t+2],n=a[t+4],r=Math.max(e,i,n),o=Math.min(e,i,n);r>.9&&o<.1&&(e<.2&&(a[t+0]+=1),i<.2&&(a[t+2]+=1),n<.2&&(a[t+4]+=1))}}function h(t){r.push(t.x,t.y,t.z)}function d(e,i){var n=3*e;i.x=t[n+0],i.y=t[n+1],i.z=t[n+2]}function p(){for(var t=new Ge,e=new Ge,i=new Ge,n=new Ge,o=new je,s=new je,c=new je,l=0,u=0;l<r.length;l+=9,u+=6){t.set(r[l+0],r[l+1],r[l+2]),e.set(r[l+3],r[l+4],r[l+5]),i.set(r[l+6],r[l+7],r[l+8]),o.set(a[u+0],a[u+1]),s.set(a[u+2],a[u+3]),c.set(a[u+4],a[u+5]),n.copy(t).add(e).add(i).divideScalar(3);var h=m(n);f(o,u+0,t,h),f(s,u+2,e,h),f(c,u+4,i,h)}}function f(t,e,i,n){n<0&&1===t.x&&(a[e]=t.x-1),0===i.x&&0===i.z&&(a[e]=n/2/Math.PI+.5)}function m(t){return Math.atan2(t.z,-t.x)}function g(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}o(n),c(i),l(),this.addAttribute("position",new jr(r,3)),this.addAttribute("normal",new jr(r.slice(),3)),this.addAttribute("uv",new jr(a,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function Ls(t,e){Or.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ps(t,e)),this.mergeVertices()}function Ps(t,e){var i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];ks.call(this,i,n,t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Os(t,e){Or.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Rs(t,e)),this.mergeVertices()}function Rs(t,e){var i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];ks.call(this,i,n,t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Is(t,e){Or.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ds(t,e)),this.mergeVertices()}function Ds(t,e){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];ks.call(this,n,r,t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Us(t,e){Or.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ns(t,e)),this.mergeVertices()}function Ns(t,e){var i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];ks.call(this,r,a,t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Bs(t,e,i,n,r,a){Or.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:n,closed:r},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new Fs(t,e,i,n,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function Fs(t,e,i,n,r){qr.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:n,closed:r},e=e||64,i=i||1,n=n||8,r=r||!1;var a=t.computeFrenetFrames(e,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,c=new Ge,l=new Ge,u=new je,h=new Ge,d=[],p=[],f=[],m=[];function g(){for(o=0;o<e;o++)v(o);v(!1===r?e:0),_(),y()}function v(r){h=t.getPointAt(r/e,h);var o=a.normals[r],u=a.binormals[r];for(s=0;s<=n;s++){var f=s/n*Math.PI*2,m=Math.sin(f),g=-Math.cos(f);l.x=g*o.x+m*u.x,l.y=g*o.y+m*u.y,l.z=g*o.z+m*u.z,l.normalize(),p.push(l.x,l.y,l.z),c.x=h.x+i*l.x,c.y=h.y+i*l.y,c.z=h.z+i*l.z,d.push(c.x,c.y,c.z)}}function y(){for(s=1;s<=e;s++)for(o=1;o<=n;o++){var t=(n+1)*(s-1)+(o-1),i=(n+1)*s+(o-1),r=(n+1)*s+o,a=(n+1)*(s-1)+o;m.push(t,i,a),m.push(i,r,a)}}function _(){for(o=0;o<=e;o++)for(s=0;s<=n;s++)u.x=o/e,u.y=s/n,f.push(u.x,u.y)}g(),this.setIndex(m),this.addAttribute("position",new jr(d,3)),this.addAttribute("normal",new jr(p,3)),this.addAttribute("uv",new jr(f,2))}function zs(t,e,i,n,r,a,o){Or.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new js(t,e,i,n,r,a)),this.mergeVertices()}function js(t,e,i,n,r,a){qr.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:a},t=t||1,e=e||.4,i=Math.floor(i)||64,n=Math.floor(n)||8,r=r||2,a=a||3;var o,s,c=[],l=[],u=[],h=[],d=new Ge,p=new Ge,f=new Ge,m=new Ge,g=new Ge,v=new Ge,y=new Ge;for(o=0;o<=i;++o){var _=o/i*r*Math.PI*2;for(C(_,r,a,t,f),C(_+.01,r,a,t,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=n;++s){var b=s/n*Math.PI*2,w=-e*Math.cos(b),T=e*Math.sin(b);d.x=f.x+(w*y.x+T*g.x),d.y=f.y+(w*y.y+T*g.y),d.z=f.z+(w*y.z+T*g.z),l.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),u.push(p.x,p.y,p.z),h.push(o/i),h.push(s/n)}}for(s=1;s<=i;s++)for(o=1;o<=n;o++){var x=(n+1)*(s-1)+(o-1),S=(n+1)*s+(o-1),E=(n+1)*s+o,M=(n+1)*(s-1)+o;c.push(x,S,M),c.push(S,E,M)}function C(t,e,i,n,r){var a=Math.cos(t),o=Math.sin(t),s=i/e*t,c=Math.cos(s);r.x=n*(2+c)*.5*a,r.y=n*(2+c)*o*.5,r.z=n*Math.sin(s)*.5}this.setIndex(c),this.addAttribute("position",new jr(l,3)),this.addAttribute("normal",new jr(u,3)),this.addAttribute("uv",new jr(h,2))}function Hs(t,e,i,n,r){Or.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new Gs(t,e,i,n,r)),this.mergeVertices()}function Gs(t,e,i,n,r){qr.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},t=t||1,e=e||.4,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var a,o,s=[],c=[],l=[],u=[],h=new Ge,d=new Ge,p=new Ge;for(a=0;a<=i;a++)for(o=0;o<=n;o++){var f=o/n*r,m=a/i*Math.PI*2;d.x=(t+e*Math.cos(m))*Math.cos(f),d.y=(t+e*Math.cos(m))*Math.sin(f),d.z=e*Math.sin(m),c.push(d.x,d.y,d.z),h.x=t*Math.cos(f),h.y=t*Math.sin(f),p.subVectors(d,h).normalize(),l.push(p.x,p.y,p.z),u.push(o/n),u.push(a/i)}for(a=1;a<=i;a++)for(o=1;o<=n;o++){var g=(n+1)*a+o-1,v=(n+1)*(a-1)+o-1,y=(n+1)*(a-1)+o,_=(n+1)*a+o;s.push(g,v,_),s.push(v,y,_)}this.setIndex(s),this.addAttribute("position",new jr(c,3)),this.addAttribute("normal",new jr(l,3)),this.addAttribute("uv",new jr(u,2))}Object.assign(rs.prototype,{isFogExp2:!0,clone:function(){return new rs(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(as.prototype,{isFog:!0,clone:function(){return new as(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),os.prototype=Object.assign(Object.create(Lr.prototype),{constructor:os,isScene:!0,copy:function(t,e){return Lr.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=Lr.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(ss.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(ss.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.stride:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),Object.defineProperties(cs.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(cs.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this}}),ls.prototype=Object.create(Kr.prototype),ls.prototype.constructor=ls,ls.prototype.isSpriteMaterial=!0,ls.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this},us.prototype=Object.assign(Object.create(Lr.prototype),{constructor:us,isSprite:!0,raycast:function(){var t=new Ge,e=new Ge,i=new Ge,n=new je,r=new je,a=new ni,o=new Ge,s=new Ge,c=new Ge,l=new je,u=new je,h=new je;function d(t,e,i,o,s,c){n.subVectors(t,i).addScalar(.5).multiply(o),void 0!==s?(r.x=c*n.x-s*n.y,r.y=s*n.x+c*n.y):r.copy(n),t.copy(e),t.x+=r.x,t.y+=r.y,t.applyMatrix4(a)}return function(n,r){e.setFromMatrixScale(this.matrixWorld),a.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld),i.setFromMatrixPosition(this.modelViewMatrix);var p,f,m=this.material.rotation;0!==m&&(f=Math.cos(m),p=Math.sin(m));var g=this.center;d(o.set(-.5,-.5,0),i,g,e,p,f),d(s.set(.5,-.5,0),i,g,e,p,f),d(c.set(.5,.5,0),i,g,e,p,f),l.set(0,0),u.set(1,0),h.set(1,1);var v=n.ray.intersectTriangle(o,s,c,!1,t);if(null!==v||(d(s.set(-.5,.5,0),i,g,e,p,f),u.set(0,1),v=n.ray.intersectTriangle(o,c,s,!1,t),null!==v)){var y=n.ray.origin.distanceTo(t);y<n.near||y>n.far||r.push({distance:y,point:t.clone(),uv:na.getUV(t,o,s,c,l,u,h,new je),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return Lr.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}}),hs.prototype=Object.assign(Object.create(Lr.prototype),{constructor:hs,copy:function(t){Lr.prototype.copy.call(this,t,!1);for(var e=t.levels,i=0,n=e.length;i<n;i++){var r=e[i];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,n=0;n<i.length;n++)if(e<i[n].distance)break;i.splice(n,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,i=1,n=e.length;i<n;i++)if(t<e[i].distance)break;return e[i-1].object},raycast:function(){var t=new Ge;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(t);this.getObjectForDistance(n).raycast(e,i)}}(),update:function(){var t=new Ge,e=new Ge;return function(i){var n=this.levels;if(n.length>1){t.setFromMatrixPosition(i.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var r=t.distanceTo(e);n[0].object.visible=!0;for(var a=1,o=n.length;a<o;a++){if(!(r>=n[a].distance))break;n[a-1].object.visible=!1,n[a].object.visible=!0}for(;a<o;a++)n[a].object.visible=!1}}}(),toJSON:function(t){var e=Lr.prototype.toJSON.call(this,t);e.object.levels=[];for(var i=this.levels,n=0,r=i.length;n<r;n++){var a=i[n];e.object.levels.push({object:a.object.uuid,distance:a.distance})}return e}}),ds.prototype=Object.assign(Object.create(aa.prototype),{constructor:ds,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new Xe,e=this.geometry.attributes.skinWeight,i=0,n=e.count;i<n;i++){t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.w=e.getW(i);var r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(i,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){aa.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(ps.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new ni;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){var t,e,i;for(e=0,i=this.bones.length;e<i;e++)t=this.bones[e],t&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,i=this.bones.length;e<i;e++)t=this.bones[e],t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new ni,e=new ni;return function(){for(var i=this.bones,n=this.boneInverses,r=this.boneMatrices,a=this.boneTexture,o=0,s=i.length;o<s;o++){var c=i[o]?i[o].matrixWorld:e;t.multiplyMatrices(c,n[o]),t.toArray(r,16*o)}void 0!==a&&(a.needsUpdate=!0)}}(),clone:function(){return new ps(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,i=this.bones.length;e<i;e++){var n=this.bones[e];if(n.name===t)return n}}}),fs.prototype=Object.assign(Object.create(Lr.prototype),{constructor:fs,isBone:!0}),ms.prototype=Object.create(Kr.prototype),ms.prototype.constructor=ms,ms.prototype.isLineBasicMaterial=!0,ms.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},gs.prototype=Object.assign(Object.create(Lr.prototype),{constructor:gs,isLine:!0,computeLineDistances:function(){var t=new Ge,e=new Ge;return function(){var i=this.geometry;if(i.isBufferGeometry)if(null===i.index){for(var n=i.attributes.position,r=[0],a=1,o=n.count;a<o;a++)t.fromBufferAttribute(n,a-1),e.fromBufferAttribute(n,a),r[a]=r[a-1],r[a]+=t.distanceTo(e);i.addAttribute("lineDistance",new jr(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(i.isGeometry){var s=i.vertices;r=i.lineDistances;r[0]=0;for(a=1,o=s.length;a<o;a++)r[a]=r[a-1],r[a]+=s[a-1].distanceTo(s[a])}return this}}(),raycast:function(){var t=new ni,e=new ia,i=new ti;return function(n,r){var a=n.linePrecision,o=this.geometry,s=this.matrixWorld;if(null===o.boundingSphere&&o.computeBoundingSphere(),i.copy(o.boundingSphere),i.applyMatrix4(s),i.radius+=a,!1!==n.ray.intersectsSphere(i)){t.getInverse(s),e.copy(n.ray).applyMatrix4(t);var c=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=c*c,u=new Ge,h=new Ge,d=new Ge,p=new Ge,f=this&&this.isLineSegments?2:1;if(o.isBufferGeometry){var m=o.index,g=o.attributes,v=g.position.array;if(null!==m)for(var y=m.array,_=0,b=y.length-1;_<b;_+=f){var w=y[_],T=y[_+1];u.fromArray(v,3*w),h.fromArray(v,3*T);var x=e.distanceSqToSegment(u,h,p,d);if(!(x>l)){p.applyMatrix4(this.matrixWorld);var S=n.ray.origin.distanceTo(p);S<n.near||S>n.far||r.push({distance:S,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else for(_=0,b=v.length/3-1;_<b;_+=f){u.fromArray(v,3*_),h.fromArray(v,3*_+3);x=e.distanceSqToSegment(u,h,p,d);if(!(x>l)){p.applyMatrix4(this.matrixWorld);S=n.ray.origin.distanceTo(p);S<n.near||S>n.far||r.push({distance:S,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}else if(o.isGeometry){var E=o.vertices,M=E.length;for(_=0;_<M-1;_+=f){x=e.distanceSqToSegment(E[_],E[_+1],p,d);if(!(x>l)){p.applyMatrix4(this.matrixWorld);S=n.ray.origin.distanceTo(p);S<n.near||S>n.far||r.push({distance:S,point:d.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),vs.prototype=Object.assign(Object.create(gs.prototype),{constructor:vs,isLineSegments:!0,computeLineDistances:function(){var t=new Ge,e=new Ge;return function(){var i=this.geometry;if(i.isBufferGeometry)if(null===i.index){for(var n=i.attributes.position,r=[],a=0,o=n.count;a<o;a+=2)t.fromBufferAttribute(n,a),e.fromBufferAttribute(n,a+1),r[a]=0===a?0:r[a-1],r[a+1]=r[a]+t.distanceTo(e);i.addAttribute("lineDistance",new jr(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(i.isGeometry){var s=i.vertices;for(r=i.lineDistances,a=0,o=s.length;a<o;a+=2)t.copy(s[a]),e.copy(s[a+1]),r[a]=0===a?0:r[a-1],r[a+1]=r[a]+t.distanceTo(e)}return this}}()}),ys.prototype=Object.assign(Object.create(gs.prototype),{constructor:ys,isLineLoop:!0}),_s.prototype=Object.create(Kr.prototype),_s.prototype.constructor=_s,_s.prototype.isPointsMaterial=!0,_s.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this},bs.prototype=Object.assign(Object.create(Lr.prototype),{constructor:bs,isPoints:!0,raycast:function(){var t=new ni,e=new ia,i=new ti;return function(n,r){var a=this,o=this.geometry,s=this.matrixWorld,c=n.params.Points.threshold;if(null===o.boundingSphere&&o.computeBoundingSphere(),i.copy(o.boundingSphere),i.applyMatrix4(s),i.radius+=c,!1!==n.ray.intersectsSphere(i)){t.getInverse(s),e.copy(n.ray).applyMatrix4(t);var l=c/((this.scale.x+this.scale.y+this.scale.z)/3),u=l*l,h=new Ge,d=new Ge;if(o.isBufferGeometry){var p=o.index,f=o.attributes,m=f.position.array;if(null!==p)for(var g=p.array,v=0,y=g.length;v<y;v++){var _=g[v];h.fromArray(m,3*_),T(h,_)}else{v=0;for(var b=m.length/3;v<b;v++)h.fromArray(m,3*v),T(h,v)}}else{var w=o.vertices;for(v=0,b=w.length;v<b;v++)T(w[v],v)}}function T(t,i){var o=e.distanceSqToPoint(t);if(o<u){e.closestPointToPoint(t,d),d.applyMatrix4(s);var c=n.ray.origin.distanceTo(d);if(c<n.near||c>n.far)return;r.push({distance:c,distanceToRay:Math.sqrt(o),point:d.clone(),index:i,face:null,object:a})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ws.prototype=Object.assign(Object.create(Ye.prototype),{constructor:ws,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Ts.prototype=Object.create(Ye.prototype),Ts.prototype.constructor=Ts,Ts.prototype.isCompressedTexture=!0,xs.prototype=Object.create(Ye.prototype),xs.prototype.constructor=xs,xs.prototype.isCanvasTexture=!0,Ss.prototype=Object.create(Ye.prototype),Ss.prototype.constructor=Ss,Ss.prototype.isDepthTexture=!0,Es.prototype=Object.create(qr.prototype),Es.prototype.constructor=Es,Ms.prototype=Object.create(Or.prototype),Ms.prototype.constructor=Ms,Cs.prototype=Object.create(qr.prototype),Cs.prototype.constructor=Cs,As.prototype=Object.create(Or.prototype),As.prototype.constructor=As,ks.prototype=Object.create(qr.prototype),ks.prototype.constructor=ks,Ls.prototype=Object.create(Or.prototype),Ls.prototype.constructor=Ls,Ps.prototype=Object.create(ks.prototype),Ps.prototype.constructor=Ps,Os.prototype=Object.create(Or.prototype),Os.prototype.constructor=Os,Rs.prototype=Object.create(ks.prototype),Rs.prototype.constructor=Rs,Is.prototype=Object.create(Or.prototype),Is.prototype.constructor=Is,Ds.prototype=Object.create(ks.prototype),Ds.prototype.constructor=Ds,Us.prototype=Object.create(Or.prototype),Us.prototype.constructor=Us,Ns.prototype=Object.create(ks.prototype),Ns.prototype.constructor=Ns,Bs.prototype=Object.create(Or.prototype),Bs.prototype.constructor=Bs,Fs.prototype=Object.create(qr.prototype),Fs.prototype.constructor=Fs,Fs.prototype.toJSON=function(){var t=qr.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},zs.prototype=Object.create(Or.prototype),zs.prototype.constructor=zs,js.prototype=Object.create(qr.prototype),js.prototype.constructor=js,Hs.prototype=Object.create(Or.prototype),Hs.prototype.constructor=Hs,Gs.prototype=Object.create(qr.prototype),Gs.prototype.constructor=Gs;var Vs={triangulate:function(t,e,i){i=i||2;var n,r,a,o,s,c,l,u=e&&e.length,h=u?e[0]*i:t.length,d=Ws(t,0,h,i,!0),p=[];if(!d)return p;if(u&&(d=Ks(t,e,d,i)),t.length>80*i){n=a=t[0],r=o=t[1];for(var f=i;f<h;f+=i)s=t[f],c=t[f+1],s<n&&(n=s),c<r&&(r=c),s>a&&(a=s),c>o&&(o=c);l=Math.max(a-n,o-r),l=0!==l?1/l:0}return Ys(d,p,i,n,r,l),p}};function Ws(t,e,i,n,r){var a,o;if(r===yc(t,e,i,n)>0)for(a=e;a<i;a+=n)o=mc(a,t[a],t[a+1],o);else for(a=i-n;a>=e;a-=n)o=mc(a,t[a],t[a+1],o);return o&&lc(o,o.next)&&(gc(o),o=o.next),o}function qs(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!lc(n,n.next)&&0!==cc(n.prev,n,n.next))n=n.next;else{if(gc(n),n=e=n.prev,n===n.next)break;i=!0}}while(i||n!==e);return e}function Ys(t,e,i,n,r,a,o){if(t){!o&&a&&ic(t,n,r,a);var s,c,l=t;while(t.prev!==t.next)if(s=t.prev,c=t.next,a?$s(t,n,r,a):Xs(t))e.push(s.i/i),e.push(t.i/i),e.push(c.i/i),gc(t),t=c.next,l=c.next;else if(t=c,t===l){o?1===o?(t=Zs(t,e,i),Ys(t,e,i,n,r,a,2)):2===o&&Js(t,e,i,n,r,a):Ys(qs(t),e,i,n,r,a,1);break}}}function Xs(t){var e=t.prev,i=t,n=t.next;if(cc(e,i,n)>=0)return!1;var r=t.next.next;while(r!==t.prev){if(oc(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&cc(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function $s(t,e,i,n){var r=t.prev,a=t,o=t.next;if(cc(r,a,o)>=0)return!1;var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,c=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,l=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,u=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,h=rc(s,c,e,i,n),d=rc(l,u,e,i,n),p=t.nextZ;while(p&&p.z<=d){if(p!==t.prev&&p!==t.next&&oc(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&cc(p.prev,p,p.next)>=0)return!1;p=p.nextZ}p=t.prevZ;while(p&&p.z>=h){if(p!==t.prev&&p!==t.next&&oc(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&cc(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function Zs(t,e,i){var n=t;do{var r=n.prev,a=n.next.next;!lc(r,a)&&uc(r,n,n.next,a)&&dc(r,a)&&dc(a,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(a.i/i),gc(n),gc(n.next),n=t=a),n=n.next}while(n!==t);return n}function Js(t,e,i,n,r,a){var o=t;do{var s=o.next.next;while(s!==o.prev){if(o.i!==s.i&&sc(o,s)){var c=fc(o,s);return o=qs(o,o.next),c=qs(c,c.next),Ys(o,e,i,n,r,a),void Ys(c,e,i,n,r,a)}s=s.next}o=o.next}while(o!==t)}function Ks(t,e,i,n){var r,a,o,s,c,l=[];for(r=0,a=e.length;r<a;r++)o=e[r]*n,s=r<a-1?e[r+1]*n:t.length,c=Ws(t,o,s,n,!1),c===c.next&&(c.steiner=!0),l.push(ac(c));for(l.sort(Qs),r=0;r<l.length;r++)tc(l[r],i),i=qs(i,i.next);return i}function Qs(t,e){return t.x-e.x}function tc(t,e){if(e=ec(t,e),e){var i=fc(e,t);qs(i,i.next)}}function ec(t,e){var i,n=e,r=t.x,a=t.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>o){if(o=s,s===r){if(a===n.y)return n;if(a===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===o)return i.prev;var c,l=i,u=i.x,h=i.y,d=1/0;n=i.next;while(n!==l)r>=n.x&&n.x>=u&&r!==n.x&&oc(a<h?r:o,a,u,h,a<h?o:r,a,n.x,n.y)&&(c=Math.abs(a-n.y)/(r-n.x),(c<d||c===d&&n.x>i.x)&&dc(n,t)&&(i=n,d=c)),n=n.next;return i}function ic(t,e,i,n){var r=t;do{null===r.z&&(r.z=rc(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,nc(r)}function nc(t){var e,i,n,r,a,o,s,c,l=1;do{i=t,t=null,a=null,o=0;while(i){for(o++,n=i,s=0,e=0;e<l;e++)if(s++,n=n.nextZ,!n)break;c=l;while(s>0||c>0&&n)0!==s&&(0===c||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,c--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;i=n}a.nextZ=null,l*=2}while(o>1);return t}function rc(t,e,i,n,r){return t=32767*(t-i)*r,e=32767*(e-n)*r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function ac(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function oc(t,e,i,n,r,a,o,s){return(r-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(n-s)-(i-o)*(e-s)>=0&&(i-o)*(a-s)-(r-o)*(n-s)>=0}function sc(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!hc(t,e)&&dc(t,e)&&dc(e,t)&&pc(t,e)}function cc(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function lc(t,e){return t.x===e.x&&t.y===e.y}function uc(t,e,i,n){return!!(lc(t,e)&&lc(i,n)||lc(t,n)&&lc(i,e))||cc(t,e,i)>0!==cc(t,e,n)>0&&cc(i,n,t)>0!==cc(i,n,e)>0}function hc(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&uc(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function dc(t,e){return cc(t.prev,t,t.next)<0?cc(t,e,t.next)>=0&&cc(t,t.prev,e)>=0:cc(t,e,t.prev)<0||cc(t,t.next,e)<0}function pc(t,e){var i=t,n=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{i.y>a!==i.next.y>a&&i.next.y!==i.y&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}function fc(t,e){var i=new vc(t.i,t.x,t.y),n=new vc(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,a.next=n,n.prev=a,n}function mc(t,e,i,n){var r=new vc(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function gc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function vc(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function yc(t,e,i,n){for(var r=0,a=e,o=i-n;a<i;a+=n)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}var _c={area:function(t){for(var e=t.length,i=0,n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},isClockWise:function(t){return _c.area(t)<0},triangulateShape:function(t,e){var i=[],n=[],r=[];bc(t),wc(i,t);var a=t.length;e.forEach(bc);for(var o=0;o<e.length;o++)n.push(a),a+=e[o].length,wc(i,e[o]);var s=Vs.triangulate(i,n);for(o=0;o<s.length;o+=3)r.push(s.slice(o,o+3));return r}};function bc(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function wc(t,e){for(var i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}function Tc(t,e){Or.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new xc(t,e)),this.mergeVertices()}function xc(t,e){qr.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var i=this,n=[],r=[],a=0,o=t.length;a<o;a++){var s=t[a];c(s)}function c(t){var a=[],o=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1,c=void 0!==e.depth?e.depth:100,l=void 0===e.bevelEnabled||e.bevelEnabled,u=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:u-2,d=void 0!==e.bevelSegments?e.bevelSegments:3,p=e.extrudePath,f=void 0!==e.UVGenerator?e.UVGenerator:Sc;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=e.amount);var m,g,v,y,_,b,w,T,x=!1;p&&(m=p.getSpacedPoints(s),x=!0,l=!1,g=p.computeFrenetFrames(s,!1),v=new Ge,y=new Ge,_=new Ge),l||(d=0,u=0,h=0);var S=t.extractPoints(o),E=S.shape,M=S.holes,C=!_c.isClockWise(E);if(C)for(E=E.reverse(),w=0,T=M.length;w<T;w++)b=M[w],_c.isClockWise(b)&&(M[w]=b.reverse());var A=_c.triangulateShape(E,M),k=E;for(w=0,T=M.length;w<T;w++)b=M[w],E=E.concat(b);function L(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}var P,O,R,I,D,U,N=E.length,B=A.length;function F(t,e,i){var n,r,a,o=t.x-e.x,s=t.y-e.y,c=i.x-t.x,l=i.y-t.y,u=o*o+s*s,h=o*l-s*c;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(u),p=Math.sqrt(c*c+l*l),f=e.x-s/d,m=e.y+o/d,g=i.x-l/p,v=i.y+c/p,y=((g-f)*l-(v-m)*c)/(o*l-s*c);n=f+o*y-t.x,r=m+s*y-t.y;var _=n*n+r*r;if(_<=2)return new je(n,r);a=Math.sqrt(_/2)}else{var b=!1;o>Number.EPSILON?c>Number.EPSILON&&(b=!0):o<-Number.EPSILON?c<-Number.EPSILON&&(b=!0):Math.sign(s)===Math.sign(l)&&(b=!0),b?(n=-s,r=o,a=Math.sqrt(u)):(n=o,r=s,a=Math.sqrt(u/2))}return new je(n/a,r/a)}for(var z=[],j=0,H=k.length,G=H-1,V=j+1;j<H;j++,G++,V++)G===H&&(G=0),V===H&&(V=0),z[j]=F(k[j],k[G],k[V]);var W,q,Y=[],X=z.concat();for(w=0,T=M.length;w<T;w++){for(b=M[w],W=[],j=0,H=b.length,G=H-1,V=j+1;j<H;j++,G++,V++)G===H&&(G=0),V===H&&(V=0),W[j]=F(b[j],b[G],b[V]);Y.push(W),X=X.concat(W)}for(P=0;P<d;P++){for(R=P/d,I=u*Math.cos(R*Math.PI/2),O=h*Math.sin(R*Math.PI/2),j=0,H=k.length;j<H;j++)D=L(k[j],z[j],O),K(D.x,D.y,-I);for(w=0,T=M.length;w<T;w++)for(b=M[w],W=Y[w],j=0,H=b.length;j<H;j++)D=L(b[j],W[j],O),K(D.x,D.y,-I)}for(O=h,j=0;j<N;j++)D=l?L(E[j],X[j],O):E[j],x?(y.copy(g.normals[0]).multiplyScalar(D.x),v.copy(g.binormals[0]).multiplyScalar(D.y),_.copy(m[0]).add(y).add(v),K(_.x,_.y,_.z)):K(D.x,D.y,0);for(q=1;q<=s;q++)for(j=0;j<N;j++)D=l?L(E[j],X[j],O):E[j],x?(y.copy(g.normals[q]).multiplyScalar(D.x),v.copy(g.binormals[q]).multiplyScalar(D.y),_.copy(m[q]).add(y).add(v),K(_.x,_.y,_.z)):K(D.x,D.y,c/s*q);for(P=d-1;P>=0;P--){for(R=P/d,I=u*Math.cos(R*Math.PI/2),O=h*Math.sin(R*Math.PI/2),j=0,H=k.length;j<H;j++)D=L(k[j],z[j],O),K(D.x,D.y,c+I);for(w=0,T=M.length;w<T;w++)for(b=M[w],W=Y[w],j=0,H=b.length;j<H;j++)D=L(b[j],W[j],O),x?K(D.x,D.y+m[s-1].y,m[s-1].x+I):K(D.x,D.y,c+I)}function $(){var t=n.length/3;if(l){var e=0,r=N*e;for(j=0;j<B;j++)U=A[j],Q(U[2]+r,U[1]+r,U[0]+r);for(e=s+2*d,r=N*e,j=0;j<B;j++)U=A[j],Q(U[0]+r,U[1]+r,U[2]+r)}else{for(j=0;j<B;j++)U=A[j],Q(U[2],U[1],U[0]);for(j=0;j<B;j++)U=A[j],Q(U[0]+N*s,U[1]+N*s,U[2]+N*s)}i.addGroup(t,n.length/3-t,0)}function Z(){var t=n.length/3,e=0;for(J(k,e),e+=k.length,w=0,T=M.length;w<T;w++)b=M[w],J(b,e),e+=b.length;i.addGroup(t,n.length/3-t,1)}function J(t,e){var i,n;j=t.length;while(--j>=0){i=j,n=j-1,n<0&&(n=t.length-1);var r=0,a=s+2*d;for(r=0;r<a;r++){var o=N*r,c=N*(r+1),l=e+i+o,u=e+n+o,h=e+n+c,p=e+i+c;tt(l,u,h,p)}}}function K(t,e,i){a.push(t),a.push(e),a.push(i)}function Q(t,e,r){et(t),et(e),et(r);var a=n.length/3,o=f.generateTopUV(i,n,a-3,a-2,a-1);it(o[0]),it(o[1]),it(o[2])}function tt(t,e,r,a){et(t),et(e),et(a),et(e),et(r),et(a);var o=n.length/3,s=f.generateSideWallUV(i,n,o-6,o-3,o-2,o-1);it(s[0]),it(s[1]),it(s[3]),it(s[1]),it(s[2]),it(s[3])}function et(t){n.push(a[3*t+0]),n.push(a[3*t+1]),n.push(a[3*t+2])}function it(t){r.push(t.x),r.push(t.y)}$(),Z()}this.addAttribute("position",new jr(n,3)),this.addAttribute("uv",new jr(r,2)),this.computeVertexNormals()}Tc.prototype=Object.create(Or.prototype),Tc.prototype.constructor=Tc,Tc.prototype.toJSON=function(){var t=Or.prototype.toJSON.call(this),e=this.parameters.shapes,i=this.parameters.options;return Ec(e,i,t)},xc.prototype=Object.create(qr.prototype),xc.prototype.constructor=xc,xc.prototype.toJSON=function(){var t=qr.prototype.toJSON.call(this),e=this.parameters.shapes,i=this.parameters.options;return Ec(e,i,t)};var Sc={generateTopUV:function(t,e,i,n,r){var a=e[3*i],o=e[3*i+1],s=e[3*n],c=e[3*n+1],l=e[3*r],u=e[3*r+1];return[new je(a,o),new je(s,c),new je(l,u)]},generateSideWallUV:function(t,e,i,n,r,a){var o=e[3*i],s=e[3*i+1],c=e[3*i+2],l=e[3*n],u=e[3*n+1],h=e[3*n+2],d=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*a],g=e[3*a+1],v=e[3*a+2];return Math.abs(s-u)<.01?[new je(o,1-c),new je(l,1-h),new je(d,1-f),new je(m,1-v)]:[new je(s,1-c),new je(u,1-h),new je(p,1-f),new je(g,1-v)]}};function Ec(t,e,i){if(i.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var a=t[n];i.shapes.push(a.uuid)}else i.shapes.push(t.uuid);return void 0!==e.extrudePath&&(i.options.extrudePath=e.extrudePath.toJSON()),i}function Mc(t,e){Or.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Cc(t,e)),this.mergeVertices()}function Cc(t,e){e=e||{};var i=e.font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Or;var n=i.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),xc.call(this,n,e),this.type="TextBufferGeometry"}function Ac(t,e,i,n,r,a,o){Or.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new kc(t,e,i,n,r,a,o)),this.mergeVertices()}function kc(t,e,i,n,r,a,o){qr.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},t=t||1,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;var s,c,l=a+o,u=0,h=[],d=new Ge,p=new Ge,f=[],m=[],g=[],v=[];for(c=0;c<=i;c++){var y=[],_=c/i,b=0==c?.5/e:c==i?-.5/e:0;for(s=0;s<=e;s++){var w=s/e;d.x=-t*Math.cos(n+w*r)*Math.sin(a+_*o),d.y=t*Math.cos(a+_*o),d.z=t*Math.sin(n+w*r)*Math.sin(a+_*o),m.push(d.x,d.y,d.z),p.copy(d).normalize(),g.push(p.x,p.y,p.z),v.push(w+b,1-_),y.push(u++)}h.push(y)}for(c=0;c<i;c++)for(s=0;s<e;s++){var T=h[c][s+1],x=h[c][s],S=h[c+1][s],E=h[c+1][s+1];(0!==c||a>0)&&f.push(T,x,E),(c!==i-1||l<Math.PI)&&f.push(x,S,E)}this.setIndex(f),this.addAttribute("position",new jr(m,3)),this.addAttribute("normal",new jr(g,3)),this.addAttribute("uv",new jr(v,2))}function Lc(t,e,i,n,r,a){Or.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new Pc(t,e,i,n,r,a)),this.mergeVertices()}function Pc(t,e,i,n,r,a){qr.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},t=t||.5,e=e||1,r=void 0!==r?r:0,a=void 0!==a?a:2*Math.PI,i=void 0!==i?Math.max(3,i):8,n=void 0!==n?Math.max(1,n):1;var o,s,c,l=[],u=[],h=[],d=[],p=t,f=(e-t)/n,m=new Ge,g=new je;for(s=0;s<=n;s++){for(c=0;c<=i;c++)o=r+c/i*a,m.x=p*Math.cos(o),m.y=p*Math.sin(o),u.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,d.push(g.x,g.y);p+=f}for(s=0;s<n;s++){var v=s*(i+1);for(c=0;c<i;c++){o=c+v;var y=o,_=o+i+1,b=o+i+2,w=o+1;l.push(y,_,w),l.push(_,b,w)}}this.setIndex(l),this.addAttribute("position",new jr(u,3)),this.addAttribute("normal",new jr(h,3)),this.addAttribute("uv",new jr(d,2))}function Oc(t,e,i,n){Or.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},this.fromBufferGeometry(new Rc(t,e,i,n)),this.mergeVertices()}function Rc(t,e,i,n){qr.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},e=Math.floor(e)||12,i=i||0,n=n||2*Math.PI,n=ze.clamp(n,0,2*Math.PI);var r,a,o,s=[],c=[],l=[],u=1/e,h=new Ge,d=new je;for(a=0;a<=e;a++){var p=i+a*u*n,f=Math.sin(p),m=Math.cos(p);for(o=0;o<=t.length-1;o++)h.x=t[o].x*f,h.y=t[o].y,h.z=t[o].x*m,c.push(h.x,h.y,h.z),d.x=a/e,d.y=o/(t.length-1),l.push(d.x,d.y)}for(a=0;a<e;a++)for(o=0;o<t.length-1;o++){r=o+a*t.length;var g=r,v=r+t.length,y=r+t.length+1,_=r+1;s.push(g,v,_),s.push(v,y,_)}if(this.setIndex(s),this.addAttribute("position",new jr(c,3)),this.addAttribute("uv",new jr(l,2)),this.computeVertexNormals(),n===2*Math.PI){var b=this.attributes.normal.array,w=new Ge,T=new Ge,x=new Ge;for(r=e*t.length*3,a=0,o=0;a<t.length;a++,o+=3)w.x=b[o+0],w.y=b[o+1],w.z=b[o+2],T.x=b[r+o+0],T.y=b[r+o+1],T.z=b[r+o+2],x.addVectors(w,T).normalize(),b[o+0]=b[r+o+0]=x.x,b[o+1]=b[r+o+1]=x.y,b[o+2]=b[r+o+2]=x.z}}function Ic(t,e){Or.call(this),this.type="ShapeGeometry","object"===typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Dc(t,e)),this.mergeVertices()}function Dc(t,e){qr.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var i=[],n=[],r=[],a=[],o=0,s=0;if(!1===Array.isArray(t))l(t);else for(var c=0;c<t.length;c++)l(t[c]),this.addGroup(o,s,c),o+=s,s=0;function l(t){var o,c,l,u=n.length/3,h=t.extractPoints(e),d=h.shape,p=h.holes;for(!1===_c.isClockWise(d)&&(d=d.reverse()),o=0,c=p.length;o<c;o++)l=p[o],!0===_c.isClockWise(l)&&(p[o]=l.reverse());var f=_c.triangulateShape(d,p);for(o=0,c=p.length;o<c;o++)l=p[o],d=d.concat(l);for(o=0,c=d.length;o<c;o++){var m=d[o];n.push(m.x,m.y,0),r.push(0,0,1),a.push(m.x,m.y)}for(o=0,c=f.length;o<c;o++){var g=f[o],v=g[0]+u,y=g[1]+u,_=g[2]+u;i.push(v,y,_),s+=3}}this.setIndex(i),this.addAttribute("position",new jr(n,3)),this.addAttribute("normal",new jr(r,3)),this.addAttribute("uv",new jr(a,2))}function Uc(t,e){if(e.shapes=[],Array.isArray(t))for(var i=0,n=t.length;i<n;i++){var r=t[i];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}function Nc(t,e){qr.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var i,n,r,a,o=[],s=Math.cos(ze.DEG2RAD*e),c=[0,0],l={},u=["a","b","c"];t.isBufferGeometry?(a=new Or,a.fromBufferGeometry(t)):a=t.clone(),a.mergeVertices(),a.computeFaceNormals();for(var h=a.vertices,d=a.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)i=m[u[g]],n=m[u[(g+1)%3]],c[0]=Math.min(i,n),c[1]=Math.max(i,n),r=c[0]+","+c[1],void 0===l[r]?l[r]={index1:c[0],index2:c[1],face1:p,face2:void 0}:l[r].face2=p;for(r in l){var v=l[r];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=h[v.index1];o.push(y.x,y.y,y.z),y=h[v.index2],o.push(y.x,y.y,y.z)}}this.addAttribute("position",new jr(o,3))}function Bc(t,e,i,n,r,a,o,s){Or.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Fc(t,e,i,n,r,a,o,s)),this.mergeVertices()}function Fc(t,e,i,n,r,a,o,s){qr.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s};var c=this;t=void 0!==t?t:1,e=void 0!==e?e:1,i=i||1,n=Math.floor(n)||8,r=Math.floor(r)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var l=[],u=[],h=[],d=[],p=0,f=[],m=i/2,g=0;function v(){var a,v,y=new Ge,_=new Ge,b=0,w=(e-t)/i;for(v=0;v<=r;v++){var T=[],x=v/r,S=x*(e-t)+t;for(a=0;a<=n;a++){var E=a/n,M=E*s+o,C=Math.sin(M),A=Math.cos(M);_.x=S*C,_.y=-x*i+m,_.z=S*A,u.push(_.x,_.y,_.z),y.set(C,w,A).normalize(),h.push(y.x,y.y,y.z),d.push(E,1-x),T.push(p++)}f.push(T)}for(a=0;a<n;a++)for(v=0;v<r;v++){var k=f[v][a],L=f[v+1][a],P=f[v+1][a+1],O=f[v][a+1];l.push(k,L,O),l.push(L,P,O),b+=6}c.addGroup(g,b,0),g+=b}function y(i){var r,a,f,v=new je,y=new Ge,_=0,b=!0===i?t:e,w=!0===i?1:-1;for(a=p,r=1;r<=n;r++)u.push(0,m*w,0),h.push(0,w,0),d.push(.5,.5),p++;for(f=p,r=0;r<=n;r++){var T=r/n,x=T*s+o,S=Math.cos(x),E=Math.sin(x);y.x=b*E,y.y=m*w,y.z=b*S,u.push(y.x,y.y,y.z),h.push(0,w,0),v.x=.5*S+.5,v.y=.5*E*w+.5,d.push(v.x,v.y),p++}for(r=0;r<n;r++){var M=a+r,C=f+r;!0===i?l.push(C,C+1,M):l.push(C+1,C,M),_+=3}c.addGroup(g,_,!0===i?1:2),g+=_}v(),!1===a&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(l),this.addAttribute("position",new jr(u,3)),this.addAttribute("normal",new jr(h,3)),this.addAttribute("uv",new jr(d,2))}function zc(t,e,i,n,r,a,o){Bc.call(this,0,t,e,i,n,r,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:o}}function jc(t,e,i,n,r,a,o){Fc.call(this,0,t,e,i,n,r,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:o}}function Hc(t,e,i,n){Or.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new Gc(t,e,i,n)),this.mergeVertices()}function Gc(t,e,i,n){qr.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},t=t||1,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r,a,o=[],s=[],c=[],l=[],u=new Ge,h=new je;for(s.push(0,0,0),c.push(0,0,1),l.push(.5,.5),a=0,r=3;a<=e;a++,r+=3){var d=i+a/e*n;u.x=t*Math.cos(d),u.y=t*Math.sin(d),s.push(u.x,u.y,u.z),c.push(0,0,1),h.x=(s[r]/t+1)/2,h.y=(s[r+1]/t+1)/2,l.push(h.x,h.y)}for(r=1;r<=e;r++)o.push(r,r+1,0);this.setIndex(o),this.addAttribute("position",new jr(s,3)),this.addAttribute("normal",new jr(c,3)),this.addAttribute("uv",new jr(l,2))}Mc.prototype=Object.create(Or.prototype),Mc.prototype.constructor=Mc,Cc.prototype=Object.create(xc.prototype),Cc.prototype.constructor=Cc,Ac.prototype=Object.create(Or.prototype),Ac.prototype.constructor=Ac,kc.prototype=Object.create(qr.prototype),kc.prototype.constructor=kc,Lc.prototype=Object.create(Or.prototype),Lc.prototype.constructor=Lc,Pc.prototype=Object.create(qr.prototype),Pc.prototype.constructor=Pc,Oc.prototype=Object.create(Or.prototype),Oc.prototype.constructor=Oc,Rc.prototype=Object.create(qr.prototype),Rc.prototype.constructor=Rc,Ic.prototype=Object.create(Or.prototype),Ic.prototype.constructor=Ic,Ic.prototype.toJSON=function(){var t=Or.prototype.toJSON.call(this),e=this.parameters.shapes;return Uc(e,t)},Dc.prototype=Object.create(qr.prototype),Dc.prototype.constructor=Dc,Dc.prototype.toJSON=function(){var t=qr.prototype.toJSON.call(this),e=this.parameters.shapes;return Uc(e,t)},Nc.prototype=Object.create(qr.prototype),Nc.prototype.constructor=Nc,Bc.prototype=Object.create(Or.prototype),Bc.prototype.constructor=Bc,Fc.prototype=Object.create(qr.prototype),Fc.prototype.constructor=Fc,zc.prototype=Object.create(Bc.prototype),zc.prototype.constructor=zc,jc.prototype=Object.create(Fc.prototype),jc.prototype.constructor=jc,Hc.prototype=Object.create(Or.prototype),Hc.prototype.constructor=Hc,Gc.prototype=Object.create(qr.prototype),Gc.prototype.constructor=Gc;var Vc=Object.freeze({WireframeGeometry:Es,ParametricGeometry:Ms,ParametricBufferGeometry:Cs,TetrahedronGeometry:Ls,TetrahedronBufferGeometry:Ps,OctahedronGeometry:Os,OctahedronBufferGeometry:Rs,IcosahedronGeometry:Is,IcosahedronBufferGeometry:Ds,DodecahedronGeometry:Us,DodecahedronBufferGeometry:Ns,PolyhedronGeometry:As,PolyhedronBufferGeometry:ks,TubeGeometry:Bs,TubeBufferGeometry:Fs,TorusKnotGeometry:zs,TorusKnotBufferGeometry:js,TorusGeometry:Hs,TorusBufferGeometry:Gs,TextGeometry:Mc,TextBufferGeometry:Cc,SphereGeometry:Ac,SphereBufferGeometry:kc,RingGeometry:Lc,RingBufferGeometry:Pc,PlaneGeometry:$r,PlaneBufferGeometry:Zr,LatheGeometry:Oc,LatheBufferGeometry:Rc,ShapeGeometry:Ic,ShapeBufferGeometry:Dc,ExtrudeGeometry:Tc,ExtrudeBufferGeometry:xc,EdgesGeometry:Nc,ConeGeometry:zc,ConeBufferGeometry:jc,CylinderGeometry:Bc,CylinderBufferGeometry:Fc,CircleGeometry:Hc,CircleBufferGeometry:Gc,BoxGeometry:Yr,BoxBufferGeometry:Xr});function Wc(t){Kr.call(this),this.type="ShadowMaterial",this.color=new wr(0),this.transparent=!0,this.setValues(t)}function qc(t){ea.call(this,t),this.type="RawShaderMaterial"}function Yc(t){Kr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new wr(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Be,this.normalScale=new je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Xc(t){Yc.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function $c(t){Kr.call(this),this.type="MeshPhongMaterial",this.color=new wr(16777215),this.specular=new wr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Be,this.normalScale=new je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=tt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Zc(t){$c.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function Jc(t){Kr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Be,this.normalScale=new je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Kc(t){Kr.call(this),this.type="MeshLambertMaterial",this.color=new wr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=tt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Qc(t){Kr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new wr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Be,this.normalScale=new je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.lights=!1,this.setValues(t)}function tl(t){ms.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}Wc.prototype=Object.create(Kr.prototype),Wc.prototype.constructor=Wc,Wc.prototype.isShadowMaterial=!0,Wc.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.color.copy(t.color),this},qc.prototype=Object.create(ea.prototype),qc.prototype.constructor=qc,qc.prototype.isRawShaderMaterial=!0,Yc.prototype=Object.create(Kr.prototype),Yc.prototype.constructor=Yc,Yc.prototype.isMeshStandardMaterial=!0,Yc.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Xc.prototype=Object.create(Yc.prototype),Xc.prototype.constructor=Xc,Xc.prototype.isMeshPhysicalMaterial=!0,Xc.prototype.copy=function(t){return Yc.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},$c.prototype=Object.create(Kr.prototype),$c.prototype.constructor=$c,$c.prototype.isMeshPhongMaterial=!0,$c.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Zc.prototype=Object.create($c.prototype),Zc.prototype.constructor=Zc,Zc.prototype.isMeshToonMaterial=!0,Zc.prototype.copy=function(t){return $c.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},Jc.prototype=Object.create(Kr.prototype),Jc.prototype.constructor=Jc,Jc.prototype.isMeshNormalMaterial=!0,Jc.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Kc.prototype=Object.create(Kr.prototype),Kc.prototype.constructor=Kc,Kc.prototype.isMeshLambertMaterial=!0,Kc.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Qc.prototype=Object.create(Kr.prototype),Qc.prototype.constructor=Qc,Qc.prototype.isMeshMatcapMaterial=!0,Qc.prototype.copy=function(t){return Kr.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},tl.prototype=Object.create(ms.prototype),tl.prototype.constructor=tl,tl.prototype.isLineDashedMaterial=!0,tl.prototype.copy=function(t){return ms.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var el=Object.freeze({ShadowMaterial:Wc,SpriteMaterial:ls,RawShaderMaterial:qc,ShaderMaterial:ea,PointsMaterial:_s,MeshPhysicalMaterial:Xc,MeshStandardMaterial:Yc,MeshPhongMaterial:$c,MeshToonMaterial:Zc,MeshNormalMaterial:Jc,MeshLambertMaterial:Kc,MeshDepthMaterial:jo,MeshDistanceMaterial:Ho,MeshBasicMaterial:ra,MeshMatcapMaterial:Qc,LineDashedMaterial:tl,LineBasicMaterial:ms,Material:Kr}),il={arraySlice:function(t,e,i){return il.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==i?i:t.length)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,i){return t[e]-t[i]}for(var i=t.length,n=new Array(i),r=0;r!==i;++r)n[r]=r;return n.sort(e),n},sortedArray:function(t,e,i){for(var n=t.length,r=new t.constructor(n),a=0,o=0;o!==n;++a)for(var s=i[a]*e,c=0;c!==e;++c)r[o++]=t[s+c];return r},flattenJSON:function(t,e,i,n){var r=1,a=t[0];while(void 0!==a&&void 0===a[n])a=t[r++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o))do{o=a[n],void 0!==o&&(e.push(a.time),i.push.apply(i,o)),a=t[r++]}while(void 0!==a);else if(void 0!==o.toArray)do{o=a[n],void 0!==o&&(e.push(a.time),o.toArray(i,i.length)),a=t[r++]}while(void 0!==a);else do{o=a[n],void 0!==o&&(e.push(a.time),i.push(o)),a=t[r++]}while(void 0!==a)}}};function nl(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i}function rl(t,e,i,n){nl.call(this,t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function al(t,e,i,n){nl.call(this,t,e,i,n)}function ol(t,e,i,n){nl.call(this,t,e,i,n)}function sl(t,e,i,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=il.convertArray(e,this.TimeBufferType),this.values=il.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function cl(t,e,i){sl.call(this,t,e,i)}function ll(t,e,i,n){sl.call(this,t,e,i,n)}function ul(t,e,i,n){sl.call(this,t,e,i,n)}function hl(t,e,i,n){nl.call(this,t,e,i,n)}function dl(t,e,i,n){sl.call(this,t,e,i,n)}function pl(t,e,i,n){sl.call(this,t,e,i,n)}function fl(t,e,i,n){sl.call(this,t,e,i,n)}function ml(t,e,i){this.name=t,this.tracks=i,this.duration=void 0!==e?e:-1,this.uuid=ze.generateUUID(),this.duration<0&&this.resetDuration()}function gl(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ul;case"vector":case"vector2":case"vector3":case"vector4":return fl;case"color":return ll;case"quaternion":return dl;case"bool":case"boolean":return cl;case"string":return pl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function vl(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=gl(t.type);if(void 0===t.times){var i=[],n=[];il.flattenJSON(t.keys,i,n,"value"),t.times=i,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}Object.assign(nl.prototype,{evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{var a;i:{n:if(!(t<n)){for(var o=i+2;;){if(void 0===n){if(t<r)break n;return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,t,r)}if(i===o)break;if(r=n,n=e[++i],t<n)break e}a=e.length;break i}if(t>=r)break t;var s=e[1];t<s&&(i=2,r=s);for(o=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===o)break;if(n=r,r=e[--i-1],t>=r)break e}a=i,i=0}while(i<a){var c=i+a>>>1;t<e[c]?a=c:i=c+1}if(n=e[i],r=e[i-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,r,t)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n,a=0;a!==n;++a)e[a]=i[r+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(nl.prototype,{beforeStart_:nl.prototype.copySampleValue_,afterEnd_:nl.prototype.copySampleValue_}),rl.prototype=Object.assign(Object.create(nl.prototype),{constructor:rl,DefaultSettings_:{endingStart:Te,endingEnd:Te},intervalChanged_:function(t,e,i){var n=this.parameterPositions,r=t-2,a=t+1,o=n[r],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case xe:r=t,o=2*e-i;break;case Se:r=n.length-2,o=e+n[r]-n[r+1];break;default:r=t,o=i}if(void 0===s)switch(this.getSettings_().endingEnd){case xe:a=t,s=2*i-e;break;case Se:a=1,s=i+n[1]-n[0];break;default:a=t-1,s=e}var c=.5*(i-e),l=this.valueSize;this._weightPrev=c/(e-o),this._weightNext=c/(s-i),this._offsetPrev=r*l,this._offsetNext=a*l},interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=s-o,l=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(i-e)/(n-e),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f,b=0;b!==o;++b)r[b]=g*a[l+b]+v*a[c+b]+y*a[s+b]+_*a[u+b];return r}}),al.prototype=Object.assign(Object.create(nl.prototype),{constructor:al,interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=s-o,l=(i-e)/(n-e),u=1-l,h=0;h!==o;++h)r[h]=a[c+h]*u+a[s+h]*l;return r}}),ol.prototype=Object.assign(Object.create(nl.prototype),{constructor:ol,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(sl,{toJSON:function(t){var e,i=t.constructor;if(void 0!==i.toJSON)e=i.toJSON(t);else{e={name:t.name,times:il.convertArray(t.times,Array),values:il.convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e}}),Object.assign(sl.prototype,{constructor:sl,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:be,InterpolantFactoryMethodDiscrete:function(t){return new ol(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new al(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new rl(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case _e:e=this.InterpolantFactoryMethodDiscrete;break;case be:e=this.InterpolantFactoryMethodLinear;break;case we:e=this.InterpolantFactoryMethodSmooth;break}if(void 0===e){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=e,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return _e;case this.InterpolantFactoryMethodLinear:return be;case this.InterpolantFactoryMethodSmooth:return we}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]*=t;return this},trim:function(t,e){var i=this.times,n=i.length,r=0,a=n-1;while(r!==n&&i[r]<t)++r;while(-1!==a&&i[a]>e)--a;if(++a,0!==r||a!==n){r>=a&&(a=Math.max(a,1),r=a-1);var o=this.getValueSize();this.times=il.arraySlice(i,r,a),this.values=il.arraySlice(this.values,r*o,a*o)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==r;o++){var s=i[o];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==n&&il.isTypedArray(n)){o=0;for(var c=n.length;o!==c;++o){var l=n[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,i=this.getValueSize(),n=this.getInterpolation()===we,r=1,a=t.length-1,o=1;o<a;++o){var s=!1,c=t[o],l=t[o+1];if(c!==l&&(1!==o||c!==c[0]))if(n)s=!0;else for(var u=o*i,h=u-i,d=u+i,p=0;p!==i;++p){var f=e[u+p];if(f!==e[h+p]||f!==e[d+p]){s=!0;break}}if(s){if(o!==r){t[r]=t[o];var m=o*i,g=r*i;for(p=0;p!==i;++p)e[g+p]=e[m+p]}++r}}if(a>0){t[r]=t[a];for(m=a*i,g=r*i,p=0;p!==i;++p)e[g+p]=e[m+p];++r}return r!==t.length&&(this.times=il.arraySlice(t,0,r),this.values=il.arraySlice(e,0,r*i)),this},clone:function(){var t=il.arraySlice(this.times,0),e=il.arraySlice(this.values,0),i=this.constructor,n=new i(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}),cl.prototype=Object.assign(Object.create(sl.prototype),{constructor:cl,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:_e,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ll.prototype=Object.assign(Object.create(sl.prototype),{constructor:ll,ValueTypeName:"color"}),ul.prototype=Object.assign(Object.create(sl.prototype),{constructor:ul,ValueTypeName:"number"}),hl.prototype=Object.assign(Object.create(nl.prototype),{constructor:hl,interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=(i-e)/(n-e),l=s+o;s!==l;s+=4)He.slerpFlat(r,0,a,s-o,a,s,c);return r}}),dl.prototype=Object.assign(Object.create(sl.prototype),{constructor:dl,ValueTypeName:"quaternion",DefaultInterpolation:be,InterpolantFactoryMethodLinear:function(t){return new hl(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),pl.prototype=Object.assign(Object.create(sl.prototype),{constructor:pl,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:_e,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),fl.prototype=Object.assign(Object.create(sl.prototype),{constructor:fl,ValueTypeName:"vector"}),Object.assign(ml,{parse:function(t){for(var e=[],i=t.tracks,n=1/(t.fps||1),r=0,a=i.length;r!==a;++r)e.push(vl(i[r]).scale(n));return new ml(t.name,t.duration,e)},toJSON:function(t){for(var e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid},r=0,a=i.length;r!==a;++r)e.push(sl.toJSON(i[r]));return n},CreateFromMorphTargetSequence:function(t,e,i,n){for(var r=e.length,a=[],o=0;o<r;o++){var s=[],c=[];s.push((o+r-1)%r,o,(o+1)%r),c.push(0,1,0);var l=il.getKeyframeOrder(s);s=il.sortedArray(s,1,l),c=il.sortedArray(c,1,l),n||0!==s[0]||(s.push(r),c.push(c[0])),a.push(new ul(".morphTargetInfluences["+e[o].name+"]",s,c).scale(1/i))}return new ml(t,-1,a)},findByName:function(t,e){var i=t;if(!Array.isArray(t)){var n=t;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===e)return i[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],c=s.name.match(r);if(c&&c.length>1){var l=c[1],u=n[l];u||(n[l]=u=[]),u.push(s)}}var h=[];for(var l in n)h.push(ml.CreateFromMorphTargetSequence(l,n[l],e,i));return h},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var i=function(t,e,i,n,r){if(0!==i.length){var a=[],o=[];il.flattenJSON(i,a,o,n),0!==a.length&&r.push(new t(e,a,o))}},n=[],r=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.hierarchy||[],c=0;c<s.length;c++){var l=s[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var u={},h=0;h<l.length;h++)if(l[h].morphTargets)for(var d=0;d<l[h].morphTargets.length;d++)u[l[h].morphTargets[d]]=-1;for(var p in u){var f=[],m=[];for(d=0;d!==l[h].morphTargets.length;++d){var g=l[h];f.push(g.time),m.push(g.morphTarget===p?1:0)}n.push(new ul(".morphTargetInfluence["+p+"]",f,m))}a=u.length*(o||1)}else{var v=".bones["+e[c].name+"]";i(fl,v+".position",l,"pos",n),i(dl,v+".quaternion",l,"rot",n),i(fl,v+".scale",l,"scl",n)}}if(0===n.length)return null;var y=new ml(r,a,n);return y}}),Object.assign(ml.prototype,{resetDuration:function(){for(var t=this.tracks,e=0,i=0,n=t.length;i!==n;++i){var r=this.tracks[i];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new ml(this.name,this.duration,t)}});var yl={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function _l(t,e,i){var n=this,r=!1,a=0,o=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){o++,!1===r&&void 0!==n.onStart&&n.onStart(t,a,o),r=!0},this.itemEnd=function(t){a++,void 0!==n.onProgress&&n.onProgress(t,a,o),a===o&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}var bl=new _l,wl={};function Tl(t){this.manager=void 0!==t?t:bl}function xl(t){this.manager=void 0!==t?t:bl}function Sl(t){this.manager=void 0!==t?t:bl,this._parser=null}function El(t){this.manager=void 0!==t?t:bl,this._parser=null}function Ml(t){this.manager=void 0!==t?t:bl}function Cl(t){this.manager=void 0!==t?t:bl}function Al(t){this.manager=void 0!==t?t:bl}function kl(){this.type="Curve",this.arcLengthDivisions=200}function Ll(t,e,i,n,r,a,o,s){kl.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=i||1,this.yRadius=n||1,this.aStartAngle=r||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function Pl(t,e,i,n,r,a){Ll.call(this,t,e,i,i,n,r,a),this.type="ArcCurve"}function Ol(){var t=0,e=0,i=0,n=0;function r(r,a,o,s){t=r,e=o,i=-3*r+3*a-2*o-s,n=2*r-2*a+o+s}return{initCatmullRom:function(t,e,i,n,a){r(e,i,a*(i-t),a*(n-e))},initNonuniformCatmullRom:function(t,e,i,n,a,o,s){var c=(e-t)/a-(i-t)/(a+o)+(i-e)/o,l=(i-e)/o-(n-e)/(o+s)+(n-i)/s;c*=o,l*=o,r(e,i,c,l)},calc:function(r){var a=r*r,o=a*r;return t+e*r+i*a+n*o}}}Object.assign(Tl.prototype,{load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,a=yl.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout(function(){e&&e(a),r.manager.itemEnd(t)},0),a;if(void 0===wl[t]){var o=/^data:(.*?)(;base64)?,(.*)$/,s=t.match(o);if(s){var c=s[1],l=!!s[2],u=s[3];u=decodeURIComponent(u),l&&(u=atob(u));try{var h,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var p=new Uint8Array(u.length),f=0;f<u.length;f++)p[f]=u.charCodeAt(f);h="blob"===d?new Blob([p.buffer],{type:c}):p.buffer;break;case"document":var m=new DOMParser;h=m.parseFromString(u,c);break;case"json":h=JSON.parse(u);break;default:h=u;break}setTimeout(function(){e&&e(h),r.manager.itemEnd(t)},0)}catch(y){setTimeout(function(){n&&n(y),r.manager.itemError(t),r.manager.itemEnd(t)},0)}}else{wl[t]=[],wl[t].push({onLoad:e,onProgress:i,onError:n});var g=new XMLHttpRequest;for(var v in g.open("GET",t,!0),g.addEventListener("load",function(e){var i=this.response;yl.add(t,i);var n=wl[t];if(delete wl[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var a=0,o=n.length;a<o;a++){var s=n[a];s.onLoad&&s.onLoad(i)}r.manager.itemEnd(t)}else{for(a=0,o=n.length;a<o;a++){s=n[a];s.onError&&s.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}},!1),g.addEventListener("progress",function(e){for(var i=wl[t],n=0,r=i.length;n<r;n++){var a=i[n];a.onProgress&&a.onProgress(e)}},!1),g.addEventListener("error",function(e){var i=wl[t];delete wl[t];for(var n=0,a=i.length;n<a;n++){var o=i[n];o.onError&&o.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)},!1),g.addEventListener("abort",function(e){var i=wl[t];delete wl[t];for(var n=0,a=i.length;n<a;n++){var o=i[n];o.onError&&o.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)},!1),void 0!==this.responseType&&(g.responseType=this.responseType),void 0!==this.withCredentials&&(g.withCredentials=this.withCredentials),g.overrideMimeType&&g.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)g.setRequestHeader(v,this.requestHeader[v]);g.send(null)}return r.manager.itemStart(t),g}wl[t].push({onLoad:e,onProgress:i,onError:n})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(xl.prototype,{load:function(t,e,i,n){var r=this,a=new Tl(r.manager);a.setPath(r.path),a.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){for(var e=[],i=0;i<t.length;i++){var n=ml.parse(t[i]);e.push(n)}return e},setPath:function(t){return this.path=t,this}}),Object.assign(Sl.prototype,{load:function(t,e,i,n){var r=this,a=[],o=new Ts;o.image=a;var s=new Tl(this.manager);function c(c){s.load(t[c],function(t){var i=r._parser(t,!0);a[c]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},l+=1,6===l&&(1===i.mipmapCount&&(o.minFilter=xt),o.format=i.format,o.needsUpdate=!0,e&&e(o))},i,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,u=0,h=t.length;u<h;++u)c(u);else s.load(t,function(t){var i=r._parser(t,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,s=0;s<n;s++){a[s]={mipmaps:[]};for(var c=0;c<i.mipmapCount;c++)a[s].mipmaps.push(i.mipmaps[s*i.mipmapCount+c]),a[s].format=i.format,a[s].width=i.width,a[s].height=i.height}else o.image.width=i.width,o.image.height=i.height,o.mipmaps=i.mipmaps;1===i.mipmapCount&&(o.minFilter=xt),o.format=i.format,o.needsUpdate=!0,e&&e(o)},i,n);return o},setPath:function(t){return this.path=t,this}}),Object.assign(El.prototype,{load:function(t,e,i,n){var r=this,a=new Ke,o=new Tl(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(t,function(t){var i=r._parser(t);i&&(void 0!==i.image?a.image=i.image:void 0!==i.data&&(a.image.width=i.width,a.image.height=i.height,a.image.data=i.data),a.wrapS=void 0!==i.wrapS?i.wrapS:yt,a.wrapT=void 0!==i.wrapT?i.wrapT:yt,a.magFilter=void 0!==i.magFilter?i.magFilter:xt,a.minFilter=void 0!==i.minFilter?i.minFilter:Et,a.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(a.format=i.format),void 0!==i.type&&(a.type=i.type),void 0!==i.mipmaps&&(a.mipmaps=i.mipmaps),1===i.mipmapCount&&(a.minFilter=xt),a.needsUpdate=!0,e&&e(a,i))},i,n),a},setPath:function(t){return this.path=t,this}}),Object.assign(Ml.prototype,{crossOrigin:"anonymous",load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,a=yl.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout(function(){e&&e(a),r.manager.itemEnd(t)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",c,!1),yl.add(t,this),e&&e(this),r.manager.itemEnd(t)}function c(e){o.removeEventListener("load",s,!1),o.removeEventListener("error",c,!1),n&&n(e),r.manager.itemError(t),r.manager.itemEnd(t)}return o.addEventListener("load",s,!1),o.addEventListener("error",c,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(t),o.src=t,o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Cl.prototype,{crossOrigin:"anonymous",load:function(t,e,i,n){var r=new va,a=new Ml(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(i){a.load(t[i],function(t){r.images[i]=t,o++,6===o&&(r.needsUpdate=!0,e&&e(r))},void 0,n)}for(var c=0;c<t.length;++c)s(c);return r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Al.prototype,{crossOrigin:"anonymous",load:function(t,e,i,n){var r=new Ye,a=new Ml(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,function(i){r.image=i;var n=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);r.format=n?Ft:zt,r.needsUpdate=!0,void 0!==e&&e(r)},i,n),r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(kl.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var i=this.getUtoTmapping(t);return this.getPoint(i,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,n=[],r=this.getPoint(0),a=0;for(n.push(0),i=1;i<=t;i++)e=this.getPoint(i/t),a+=e.distanceTo(r),n.push(a),r=e;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var i,n=this.getLengths(),r=0,a=n.length;i=e||t*n[a-1];var o,s=0,c=a-1;while(s<=c)if(r=Math.floor(s+(c-s)/2),o=n[r]-i,o<0)s=r+1;else{if(!(o>0)){c=r;break}c=r-1}if(r=c,n[r]===i)return r/(a-1);var l=n[r],u=n[r+1],h=u-l,d=(i-l)/h,p=(r+d)/(a-1);return p},getTangent:function(t){var e=1e-4,i=t-e,n=t+e;i<0&&(i=0),n>1&&(n=1);var r=this.getPoint(i),a=this.getPoint(n),o=a.clone().sub(r);return o.normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var i,n,r,a=new Ge,o=[],s=[],c=[],l=new Ge,u=new ni;for(i=0;i<=t;i++)n=i/t,o[i]=this.getTangentAt(n),o[i].normalize();s[0]=new Ge,c[0]=new Ge;var h=Number.MAX_VALUE,d=Math.abs(o[0].x),p=Math.abs(o[0].y),f=Math.abs(o[0].z);for(d<=h&&(h=d,a.set(1,0,0)),p<=h&&(h=p,a.set(0,1,0)),f<=h&&a.set(0,0,1),l.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],l),c[0].crossVectors(o[0],s[0]),i=1;i<=t;i++)s[i]=s[i-1].clone(),c[i]=c[i-1].clone(),l.crossVectors(o[i-1],o[i]),l.length()>Number.EPSILON&&(l.normalize(),r=Math.acos(ze.clamp(o[i-1].dot(o[i]),-1,1)),s[i].applyMatrix4(u.makeRotationAxis(l,r))),c[i].crossVectors(o[i],s[i]);if(!0===e)for(r=Math.acos(ze.clamp(s[0].dot(s[t]),-1,1)),r/=t,o[0].dot(l.crossVectors(s[0],s[t]))>0&&(r=-r),i=1;i<=t;i++)s[i].applyMatrix4(u.makeRotationAxis(o[i],r*i)),c[i].crossVectors(o[i],s[i]);return{tangents:o,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Ll.prototype=Object.create(kl.prototype),Ll.prototype.constructor=Ll,Ll.prototype.isEllipseCurve=!0,Ll.prototype.getPoint=function(t,e){var i=e||new je,n=2*Math.PI,r=this.aEndAngle-this.aStartAngle,a=Math.abs(r)<Number.EPSILON;while(r<0)r+=n;while(r>n)r-=n;r<Number.EPSILON&&(r=a?0:n),!0!==this.aClockwise||a||(r===n?r=-n:r-=n);var o=this.aStartAngle+t*r,s=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var l=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=s-this.aX,d=c-this.aY;s=h*l-d*u+this.aX,c=h*u+d*l+this.aY}return i.set(s,c)},Ll.prototype.copy=function(t){return kl.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Ll.prototype.toJSON=function(){var t=kl.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Ll.prototype.fromJSON=function(t){return kl.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Pl.prototype=Object.create(Ll.prototype),Pl.prototype.constructor=Pl,Pl.prototype.isArcCurve=!0;var Rl=new Ge,Il=new Ol,Dl=new Ol,Ul=new Ol;function Nl(t,e,i,n){kl.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=i||"centripetal",this.tension=n||.5}function Bl(t,e,i,n,r){var a=.5*(n-e),o=.5*(r-i),s=t*t,c=t*s;return(2*i-2*n+a+o)*c+(-3*i+3*n-2*a-o)*s+a*t+i}function Fl(t,e){var i=1-t;return i*i*e}function zl(t,e){return 2*(1-t)*t*e}function jl(t,e){return t*t*e}function Hl(t,e,i,n){return Fl(t,e)+zl(t,i)+jl(t,n)}function Gl(t,e){var i=1-t;return i*i*i*e}function Vl(t,e){var i=1-t;return 3*i*i*t*e}function Wl(t,e){return 3*(1-t)*t*t*e}function ql(t,e){return t*t*t*e}function Yl(t,e,i,n,r){return Gl(t,e)+Vl(t,i)+Wl(t,n)+ql(t,r)}function Xl(t,e,i,n){kl.call(this),this.type="CubicBezierCurve",this.v0=t||new je,this.v1=e||new je,this.v2=i||new je,this.v3=n||new je}function $l(t,e,i,n){kl.call(this),this.type="CubicBezierCurve3",this.v0=t||new Ge,this.v1=e||new Ge,this.v2=i||new Ge,this.v3=n||new Ge}function Zl(t,e){kl.call(this),this.type="LineCurve",this.v1=t||new je,this.v2=e||new je}function Jl(t,e){kl.call(this),this.type="LineCurve3",this.v1=t||new Ge,this.v2=e||new Ge}function Kl(t,e,i){kl.call(this),this.type="QuadraticBezierCurve",this.v0=t||new je,this.v1=e||new je,this.v2=i||new je}function Ql(t,e,i){kl.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Ge,this.v1=e||new Ge,this.v2=i||new Ge}function tu(t){kl.call(this),this.type="SplineCurve",this.points=t||[]}Nl.prototype=Object.create(kl.prototype),Nl.prototype.constructor=Nl,Nl.prototype.isCatmullRomCurve3=!0,Nl.prototype.getPoint=function(t,e){var i,n,r,a,o=e||new Ge,s=this.points,c=s.length,l=(c-(this.closed?0:1))*t,u=Math.floor(l),h=l-u;if(this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/c)+1)*c:0===h&&u===c-1&&(u=c-2,h=1),this.closed||u>0?i=s[(u-1)%c]:(Rl.subVectors(s[0],s[1]).add(s[0]),i=Rl),n=s[u%c],r=s[(u+1)%c],this.closed||u+2<c?a=s[(u+2)%c]:(Rl.subVectors(s[c-1],s[c-2]).add(s[c-1]),a=Rl),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(i.distanceToSquared(n),d),f=Math.pow(n.distanceToSquared(r),d),m=Math.pow(r.distanceToSquared(a),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),Il.initNonuniformCatmullRom(i.x,n.x,r.x,a.x,p,f,m),Dl.initNonuniformCatmullRom(i.y,n.y,r.y,a.y,p,f,m),Ul.initNonuniformCatmullRom(i.z,n.z,r.z,a.z,p,f,m)}else"catmullrom"===this.curveType&&(Il.initCatmullRom(i.x,n.x,r.x,a.x,this.tension),Dl.initCatmullRom(i.y,n.y,r.y,a.y,this.tension),Ul.initCatmullRom(i.z,n.z,r.z,a.z,this.tension));return o.set(Il.calc(h),Dl.calc(h),Ul.calc(h)),o},Nl.prototype.copy=function(t){kl.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Nl.prototype.toJSON=function(){var t=kl.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++){var n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Nl.prototype.fromJSON=function(t){kl.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push((new Ge).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Xl.prototype=Object.create(kl.prototype),Xl.prototype.constructor=Xl,Xl.prototype.isCubicBezierCurve=!0,Xl.prototype.getPoint=function(t,e){var i=e||new je,n=this.v0,r=this.v1,a=this.v2,o=this.v3;return i.set(Yl(t,n.x,r.x,a.x,o.x),Yl(t,n.y,r.y,a.y,o.y)),i},Xl.prototype.copy=function(t){return kl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Xl.prototype.toJSON=function(){var t=kl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Xl.prototype.fromJSON=function(t){return kl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},$l.prototype=Object.create(kl.prototype),$l.prototype.constructor=$l,$l.prototype.isCubicBezierCurve3=!0,$l.prototype.getPoint=function(t,e){var i=e||new Ge,n=this.v0,r=this.v1,a=this.v2,o=this.v3;return i.set(Yl(t,n.x,r.x,a.x,o.x),Yl(t,n.y,r.y,a.y,o.y),Yl(t,n.z,r.z,a.z,o.z)),i},$l.prototype.copy=function(t){return kl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},$l.prototype.toJSON=function(){var t=kl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},$l.prototype.fromJSON=function(t){return kl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Zl.prototype=Object.create(kl.prototype),Zl.prototype.constructor=Zl,Zl.prototype.isLineCurve=!0,Zl.prototype.getPoint=function(t,e){var i=e||new je;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i},Zl.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Zl.prototype.getTangent=function(){var t=this.v2.clone().sub(this.v1);return t.normalize()},Zl.prototype.copy=function(t){return kl.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Zl.prototype.toJSON=function(){var t=kl.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Zl.prototype.fromJSON=function(t){return kl.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Jl.prototype=Object.create(kl.prototype),Jl.prototype.constructor=Jl,Jl.prototype.isLineCurve3=!0,Jl.prototype.getPoint=function(t,e){var i=e||new Ge;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i},Jl.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Jl.prototype.copy=function(t){return kl.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Jl.prototype.toJSON=function(){var t=kl.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Jl.prototype.fromJSON=function(t){return kl.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Kl.prototype=Object.create(kl.prototype),Kl.prototype.constructor=Kl,Kl.prototype.isQuadraticBezierCurve=!0,Kl.prototype.getPoint=function(t,e){var i=e||new je,n=this.v0,r=this.v1,a=this.v2;return i.set(Hl(t,n.x,r.x,a.x),Hl(t,n.y,r.y,a.y)),i},Kl.prototype.copy=function(t){return kl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Kl.prototype.toJSON=function(){var t=kl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Kl.prototype.fromJSON=function(t){return kl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Ql.prototype=Object.create(kl.prototype),Ql.prototype.constructor=Ql,Ql.prototype.isQuadraticBezierCurve3=!0,Ql.prototype.getPoint=function(t,e){var i=e||new Ge,n=this.v0,r=this.v1,a=this.v2;return i.set(Hl(t,n.x,r.x,a.x),Hl(t,n.y,r.y,a.y),Hl(t,n.z,r.z,a.z)),i},Ql.prototype.copy=function(t){return kl.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ql.prototype.toJSON=function(){var t=kl.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ql.prototype.fromJSON=function(t){return kl.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},tu.prototype=Object.create(kl.prototype),tu.prototype.constructor=tu,tu.prototype.isSplineCurve=!0,tu.prototype.getPoint=function(t,e){var i=e||new je,n=this.points,r=(n.length-1)*t,a=Math.floor(r),o=r-a,s=n[0===a?a:a-1],c=n[a],l=n[a>n.length-2?n.length-1:a+1],u=n[a>n.length-3?n.length-1:a+2];return i.set(Bl(o,s.x,c.x,l.x,u.x),Bl(o,s.y,c.y,l.y,u.y)),i},tu.prototype.copy=function(t){kl.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push(n.clone())}return this},tu.prototype.toJSON=function(){var t=kl.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++){var n=this.points[e];t.points.push(n.toArray())}return t},tu.prototype.fromJSON=function(t){kl.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push((new je).fromArray(n))}return this};var eu=Object.freeze({ArcCurve:Pl,CatmullRomCurve3:Nl,CubicBezierCurve:Xl,CubicBezierCurve3:$l,EllipseCurve:Ll,LineCurve:Zl,LineCurve3:Jl,QuadraticBezierCurve:Kl,QuadraticBezierCurve3:Ql,SplineCurve:tu});function iu(){kl.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function nu(t){iu.call(this),this.type="Path",this.currentPoint=new je,t&&this.setFromPoints(t)}function ru(t){nu.call(this,t),this.uuid=ze.generateUUID(),this.type="Shape",this.holes=[]}function au(t,e){Lr.call(this),this.type="Light",this.color=new wr(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function ou(t,e,i){au.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Lr.DefaultUp),this.updateMatrix(),this.groundColor=new wr(e)}function su(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new je(512,512),this.map=null,this.matrix=new ni}function cu(){su.call(this,new $o(50,1,.5,500))}function lu(t,e,i,n,r,a){au.call(this,t,e),this.type="SpotLight",this.position.copy(Lr.DefaultUp),this.updateMatrix(),this.target=new Lr,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==a?a:1,this.shadow=new cu}function uu(t,e,i,n){au.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new su(new $o(90,1,.5,500))}function hu(t,e,i,n,r,a){Xo.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==i?i:1,this.bottom=void 0!==n?n:-1,this.near=void 0!==r?r:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function du(){su.call(this,new hu(-5,5,5,-5,.5,500))}function pu(t,e){au.call(this,t,e),this.type="DirectionalLight",this.position.copy(Lr.DefaultUp),this.updateMatrix(),this.target=new Lr,this.shadow=new du}function fu(t,e){au.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function mu(t,e,i,n){au.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}function gu(t){this.manager=void 0!==t?t:bl,this.textures={}}iu.prototype=Object.assign(Object.create(kl.prototype),{constructor:iu,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Zl(e,t))},getPoint:function(t){var e=t*this.getLength(),i=this.getCurveLengths(),n=0;while(n<i.length){if(i[n]>=e){var r=i[n]-e,a=this.curves[n],o=a.getLength(),s=0===o?0:1-r/o;return a.getPointAt(s)}n++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,i=[],n=0,r=this.curves;n<r.length;n++)for(var a=r[n],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),c=0;c<s.length;c++){var l=s[c];e&&e.equals(l)||(i.push(l),e=l)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(t){kl.prototype.copy.call(this,t),this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=kl.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,i=this.curves.length;e<i;e++){var n=this.curves[e];t.curves.push(n.toJSON())}return t},fromJSON:function(t){kl.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var n=t.curves[e];this.curves.push((new eu[n.type]).fromJSON(n))}return this}}),nu.prototype=Object.assign(Object.create(iu.prototype),{constructor:nu,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var i=new Zl(this.currentPoint.clone(),new je(t,e));this.curves.push(i),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,i,n){var r=new Kl(this.currentPoint.clone(),new je(t,e),new je(i,n));this.curves.push(r),this.currentPoint.set(i,n)},bezierCurveTo:function(t,e,i,n,r,a){var o=new Xl(this.currentPoint.clone(),new je(t,e),new je(i,n),new je(r,a));this.curves.push(o),this.currentPoint.set(r,a)},splineThru:function(t){var e=[this.currentPoint.clone()].concat(t),i=new tu(e);this.curves.push(i),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,i,n,r,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+o,e+s,i,n,r,a)},absarc:function(t,e,i,n,r,a){this.absellipse(t,e,i,i,n,r,a)},ellipse:function(t,e,i,n,r,a,o,s){var c=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(t+c,e+l,i,n,r,a,o,s)},absellipse:function(t,e,i,n,r,a,o,s){var c=new Ll(t,e,i,n,r,a,o,s);if(this.curves.length>0){var l=c.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(c);var u=c.getPoint(1);this.currentPoint.copy(u)},copy:function(t){return iu.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=iu.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return iu.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),ru.prototype=Object.assign(Object.create(nu.prototype),{constructor:ru,getPointsHoles:function(t){for(var e=[],i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){nu.prototype.copy.call(this,t),this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var n=t.holes[e];this.holes.push(n.clone())}return this},toJSON:function(){var t=nu.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,i=this.holes.length;e<i;e++){var n=this.holes[e];t.holes.push(n.toJSON())}return t},fromJSON:function(t){nu.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var n=t.holes[e];this.holes.push((new nu).fromJSON(n))}return this}}),au.prototype=Object.assign(Object.create(Lr.prototype),{constructor:au,isLight:!0,copy:function(t){return Lr.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=Lr.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),ou.prototype=Object.assign(Object.create(au.prototype),{constructor:ou,isHemisphereLight:!0,copy:function(t){return au.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(su.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),cu.prototype=Object.assign(Object.create(su.prototype),{constructor:cu,isSpotLightShadow:!0,update:function(t){var e=this.camera,i=2*ze.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;i===e.fov&&n===e.aspect&&r===e.far||(e.fov=i,e.aspect=n,e.far=r,e.updateProjectionMatrix())}}),lu.prototype=Object.assign(Object.create(au.prototype),{constructor:lu,isSpotLight:!0,copy:function(t){return au.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),uu.prototype=Object.assign(Object.create(au.prototype),{constructor:uu,isPointLight:!0,copy:function(t){return au.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),hu.prototype=Object.assign(Object.create(Xo.prototype),{constructor:hu,isOrthographicCamera:!0,copy:function(t,e){return Xo.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,i,n,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-t,a=i+t,o=n+e,s=n-e;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),u=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;r+=u*(this.view.offsetX/c),a=r+u*(this.view.width/c),o-=h*(this.view.offsetY/l),s=o-h*(this.view.height/l)}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){var e=Lr.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),du.prototype=Object.assign(Object.create(su.prototype),{constructor:du}),pu.prototype=Object.assign(Object.create(au.prototype),{constructor:pu,isDirectionalLight:!0,copy:function(t){return au.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),fu.prototype=Object.assign(Object.create(au.prototype),{constructor:fu,isAmbientLight:!0}),mu.prototype=Object.assign(Object.create(au.prototype),{constructor:mu,isRectAreaLight:!0,copy:function(t){return au.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=au.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Object.assign(gu.prototype,{load:function(t,e,i,n){var r=this,a=new Tl(r.manager);a.setPath(r.path),a.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=this.textures;function i(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var n=new el[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearCoat&&(n.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(n.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.vertexColors&&(n.vertexColors=t.vertexColors),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.combine&&(n.combine=t.combine),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.polygonOffset&&(n.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(n.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(n.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.uniforms)for(var r in t.uniforms){var a=t.uniforms[r];switch(n.uniforms[r]={},a.type){case"t":n.uniforms[r].value=i(a.value);break;case"c":n.uniforms[r].value=(new wr).setHex(a.value);break;case"v2":n.uniforms[r].value=(new je).fromArray(a.value);break;case"v3":n.uniforms[r].value=(new Ge).fromArray(a.value);break;case"v4":n.uniforms[r].value=(new Xe).fromArray(a.value);break;case"m3":n.uniforms[r].value=(new Ve).fromArray(a.value);case"m4":n.uniforms[r].value=(new ni).fromArray(a.value);break;default:n.uniforms[r].value=a.value}}if(void 0!==t.defines&&(n.defines=t.defines),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var o in t.extensions)n.extensions[o]=t.extensions[o];if(void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=i(t.map)),void 0!==t.alphaMap&&(n.alphaMap=i(t.alphaMap),n.transparent=!0),void 0!==t.bumpMap&&(n.bumpMap=i(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=i(t.normalMap)),void 0!==t.normalMapType&&(n.normalMapType=t.normalMapType),void 0!==t.normalScale){var s=t.normalScale;!1===Array.isArray(s)&&(s=[s,s]),n.normalScale=(new je).fromArray(s)}return void 0!==t.displacementMap&&(n.displacementMap=i(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=i(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=i(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=i(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=i(t.specularMap)),void 0!==t.envMap&&(n.envMap=i(t.envMap)),void 0!==t.envMapIntensity&&(n.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.lightMap&&(n.lightMap=i(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=i(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=i(t.gradientMap)),n},setPath:function(t){return this.path=t,this},setTextures:function(t){return this.textures=t,this}});var vu={decodeText:function(t){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",i=0,n=t.length;i<n;i++)e+=String.fromCharCode(t[i]);return decodeURIComponent(escape(e))},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function yu(t){this.manager=void 0!==t?t:bl}Object.assign(yu.prototype,{load:function(t,e,i,n){var r=this,a=new Tl(r.manager);a.setPath(r.path),a.load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=new qr,i=t.data.index;if(void 0!==i){var n=new _u[i.type](i.array);e.setIndex(new Rr(n,1))}var r=t.data.attributes;for(var a in r){var o=r[a],s=(n=new _u[o.type](o.array),new Rr(n,o.itemSize,o.normalized));void 0!==o.name&&(s.name=o.name),e.addAttribute(a,s)}var c=t.data.morphAttributes;if(c)for(var a in c){for(var l=c[a],u=[],h=0,d=l.length;h<d;h++){o=l[h],n=new _u[o.type](o.array),s=new Rr(n,o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),u.push(s)}e.morphAttributes[a]=u}var p=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==p){h=0;for(var f=p.length;h!==f;++h){var m=p[h];e.addGroup(m.start,m.count,m.materialIndex)}}var g=t.data.boundingSphere;if(void 0!==g){var v=new Ge;void 0!==g.center&&v.fromArray(g.center),e.boundingSphere=new ti(v,g.radius)}return t.name&&(e.name=t.name),t.userData&&(e.userData=t.userData),e},setPath:function(t){return this.path=t,this}});var _u={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function bu(t){this.manager=void 0!==t?t:bl,this.resourcePath=""}Object.assign(bu.prototype,{crossOrigin:"anonymous",load:function(t,e,i,n){var r=this,a=void 0===this.path?vu.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||a;var o=new Tl(r.manager);o.setPath(this.path),o.load(t,function(i){var a=null;try{a=JSON.parse(i)}catch(s){return void 0!==n&&n(s),void console.error("THREE:ObjectLoader: Can't parse "+t+".",s.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?r.parse(a,e):console.error("THREE.ObjectLoader: Can't load "+t)},i,n)},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setCrossOrigin:function(t){return this.crossOrigin=t,this},parse:function(t,e){var i=this.parseShape(t.shapes),n=this.parseGeometries(t.geometries,i),r=this.parseImages(t.images,function(){void 0!==e&&e(s)}),a=this.parseTextures(t.textures,r),o=this.parseMaterials(t.materials,a),s=this.parseObject(t.object,n,o);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var i=0,n=t.length;i<n;i++){var r=(new ru).fromJSON(t[i]);e[r.uuid]=r}return e},parseGeometries:function(t,e){var i={};if(void 0!==t)for(var n=new yu,r=0,a=t.length;r<a;r++){var o,s=t[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new Vc[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new Vc[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new Vc[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new Vc[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new Vc[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new Vc[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new Vc[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new Vc[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new Vc[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new Vc[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new Vc[s.type]((new eu[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new Vc[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new Vc[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var c=[],l=0,u=s.shapes.length;l<u;l++){var h=e[s.shapes[l]];c.push(h)}o=new Vc[s.type](c,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(c=[],l=0,u=s.shapes.length;l<u;l++){h=e[s.shapes[l]];c.push(h)}var d=s.options.extrudePath;void 0!==d&&(s.options.extrudePath=(new eu[d.type]).fromJSON(d)),o=new Vc[s.type](c,s.options);break;case"BufferGeometry":o=n.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var p=new THREE.LegacyJSONLoader;o=p.parse(s,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),i[s.uuid]=o}return i},parseMaterials:function(t,e){var i={},n={};if(void 0!==t){var r=new gu;r.setTextures(e);for(var a=0,o=t.length;a<o;a++){var s=t[a];if("MultiMaterial"===s.type){for(var c=[],l=0;l<s.materials.length;l++){var u=s.materials[l];void 0===i[u.uuid]&&(i[u.uuid]=r.parse(u)),c.push(i[u.uuid])}n[s.uuid]=c}else void 0===i[s.uuid]&&(i[s.uuid]=r.parse(s)),n[s.uuid]=i[s.uuid]}}return n},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],r=ml.parse(n);void 0!==n.uuid&&(r.uuid=n.uuid),e.push(r)}return e},parseImages:function(t,e){var i=this,n={};function r(t){return i.manager.itemStart(t),o.load(t,function(){i.manager.itemEnd(t)},void 0,function(){i.manager.itemError(t),i.manager.itemEnd(t)})}if(void 0!==t&&t.length>0){var a=new _l(e),o=new Ml(a);o.setCrossOrigin(this.crossOrigin);for(var s=0,c=t.length;s<c;s++){var l=t[s],u=l.url;if(Array.isArray(u)){n[l.uuid]=[];for(var h=0,d=u.length;h<d;h++){var p=u[h],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:i.resourcePath+p;n[l.uuid].push(r(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:i.resourcePath+l.url;n[l.uuid]=r(f)}}}return n},parseTextures:function(t,e){function i(t,e){return"number"===typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var n={};if(void 0!==t)for(var r=0,a=t.length;r<a;r++){var o,s=t[r];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),o=Array.isArray(e[s.image])?new va(e[s.image]):new Ye(e[s.image]),o.needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=i(s.mapping,Tu)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=i(s.wrap[0],xu),o.wrapT=i(s.wrap[1],xu)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=i(s.minFilter,Su)),void 0!==s.magFilter&&(o.magFilter=i(s.magFilter,Su)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),n[s.uuid]=o}return n},parseObject:function(t,e,i){var n;function r(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function a(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],n=0,r=t.length;n<r;n++){var a=t[n];void 0===i[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),e.push(i[a])}return e}return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]}}switch(t.type){case"Scene":n=new os,void 0!==t.background&&Number.isInteger(t.background)&&(n.background=new wr(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?n.fog=new as(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(n.fog=new rs(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":n=new $o(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(n.focus=t.focus),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.filmGauge&&(n.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(n.filmOffset=t.filmOffset),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"OrthographicCamera":n=new hu(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"AmbientLight":n=new fu(t.color,t.intensity);break;case"DirectionalLight":n=new pu(t.color,t.intensity);break;case"PointLight":n=new uu(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":n=new mu(t.color,t.intensity,t.width,t.height);break;case"SpotLight":n=new lu(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":n=new ou(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=r(t.geometry),s=a(t.material);n=o.bones&&o.bones.length>0?new ds(o,s):new aa(o,s),void 0!==t.drawMode&&n.setDrawMode(t.drawMode);break;case"LOD":n=new hs;break;case"Line":n=new gs(r(t.geometry),a(t.material),t.mode);break;case"LineLoop":n=new ys(r(t.geometry),a(t.material));break;case"LineSegments":n=new vs(r(t.geometry),a(t.material));break;case"PointCloud":case"Points":n=new bs(r(t.geometry),a(t.material));break;case"Sprite":n=new us(a(t.material));break;case"Group":n=new Yo;break;default:n=new Lr}if(n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),void 0!==t.matrix?(n.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(n.matrixAutoUpdate=t.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.rotation&&n.rotation.fromArray(t.rotation),void 0!==t.quaternion&&n.quaternion.fromArray(t.quaternion),void 0!==t.scale&&n.scale.fromArray(t.scale)),void 0!==t.castShadow&&(n.castShadow=t.castShadow),void 0!==t.receiveShadow&&(n.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(n.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(n.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&n.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(n.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.frustumCulled&&(n.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(n.renderOrder=t.renderOrder),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.layers&&(n.layers.mask=t.layers),void 0!==t.children)for(var c=t.children,l=0;l<c.length;l++)n.add(this.parseObject(c[l],e,i));if("LOD"===t.type)for(var u=t.levels,h=0;h<u.length;h++){var d=u[h],p=n.getObjectByProperty("uuid",d.object);void 0!==p&&n.addLevel(p,d.distance)}return n}});var wu,Tu={UVMapping:lt,CubeReflectionMapping:ut,CubeRefractionMapping:ht,EquirectangularReflectionMapping:dt,EquirectangularRefractionMapping:pt,SphericalReflectionMapping:ft,CubeUVReflectionMapping:mt,CubeUVRefractionMapping:gt},xu={RepeatWrapping:vt,ClampToEdgeWrapping:yt,MirroredRepeatWrapping:_t},Su={NearestFilter:bt,NearestMipMapNearestFilter:wt,NearestMipMapLinearFilter:Tt,LinearFilter:xt,LinearMipMapNearestFilter:St,LinearMipMapLinearFilter:Et};function Eu(t){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:bl,this.options=void 0}function Mu(){this.type="ShapePath",this.color=new wr,this.subPaths=[],this.currentPath=null}function Cu(t){this.type="Font",this.data=t}function Au(t,e,i){for(var n=Array.from?Array.from(t):String(t).split(""),r=e/i.resolution,a=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*r,o=[],s=0,c=0,l=0;l<n.length;l++){var u=n[l];if("\n"===u)s=0,c-=a;else{var h=ku(u,r,s,c,i);s+=h.offsetX,o.push(h.path)}}return o}function ku(t,e,i,n,r){var a=r.glyphs[t]||r.glyphs["?"];if(a){var o,s,c,l,u,h,d,p,f=new Mu;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=m.length;g<v;){var y=m[g++];switch(y){case"m":o=m[g++]*e+i,s=m[g++]*e+n,f.moveTo(o,s);break;case"l":o=m[g++]*e+i,s=m[g++]*e+n,f.lineTo(o,s);break;case"q":c=m[g++]*e+i,l=m[g++]*e+n,u=m[g++]*e+i,h=m[g++]*e+n,f.quadraticCurveTo(u,h,c,l);break;case"b":c=m[g++]*e+i,l=m[g++]*e+n,u=m[g++]*e+i,h=m[g++]*e+n,d=m[g++]*e+i,p=m[g++]*e+n,f.bezierCurveTo(u,h,d,p,c,l);break}}return{offsetX:a.ha*e,path:f}}}function Lu(t){this.manager=void 0!==t?t:bl}function Pu(){}Eu.prototype={constructor:Eu,setOptions:function(t){return this.options=t,this},load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,a=yl.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout(function(){e&&e(a),r.manager.itemEnd(t)},0),a;fetch(t).then(function(t){return t.blob()}).then(function(t){return void 0===r.options?createImageBitmap(t):createImageBitmap(t,r.options)}).then(function(i){yl.add(t,i),e&&e(i),r.manager.itemEnd(t)}).catch(function(e){n&&n(e),r.manager.itemError(t),r.manager.itemEnd(t)}),r.manager.itemStart(t)},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(Mu.prototype,{moveTo:function(t,e){this.currentPath=new nu,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,i,n){this.currentPath.quadraticCurveTo(t,e,i,n)},bezierCurveTo:function(t,e,i,n,r,a){this.currentPath.bezierCurveTo(t,e,i,n,r,a)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function i(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i],a=new ru;a.curves=r.curves,e.push(a)}return e}function n(t,e){for(var i=e.length,n=!1,r=i-1,a=0;a<i;r=a++){var o=e[r],s=e[a],c=s.x-o.x,l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=e[a],c=-c,s=e[r],l=-l),t.y<o.y||t.y>s.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var u=l*(t.x-o.x)-c*(t.y-o.y);if(0===u)return!0;if(u<0)continue;n=!n}}else{if(t.y!==o.y)continue;if(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x)return!0}}return n}var r=_c.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===e)return i(a);var o,s,c,l=[];if(1===a.length)return s=a[0],c=new ru,c.curves=s.curves,l.push(c),l;var u=!r(a[0].getPoints());u=t?!u:u;var h,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=a.length;v<y;v++)s=a[v],h=s.getPoints(),o=r(h),o=t?!o:o,o?(!u&&f[g]&&g++,f[g]={s:new ru,p:h},f[g].s.curves=s.curves,u&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!f[0])return i(a);if(f.length>1){for(var _=!1,b=[],w=0,T=f.length;w<T;w++)p[w]=[];for(w=0,T=f.length;w<T;w++)for(var x=m[w],S=0;S<x.length;S++){for(var E=x[S],M=!0,C=0;C<f.length;C++)n(E.p,f[C].p)&&(w!==C&&b.push({froms:w,tos:C,hole:S}),M?(M=!1,p[C].push(E)):_=!0);M&&p[w].push(E)}b.length>0&&(_||(m=p))}v=0;for(var A=f.length;v<A;v++){c=f[v].s,l.push(c),d=m[v];for(var k=0,L=d.length;k<L;k++)c.holes.push(d[k].h)}return l}}),Object.assign(Cu.prototype,{isFont:!0,generateShapes:function(t,e){void 0===e&&(e=100);for(var i=[],n=Au(t,e,this.data),r=0,a=n.length;r<a;r++)Array.prototype.push.apply(i,n[r].toShapes());return i}}),Object.assign(Lu.prototype,{load:function(t,e,i,n){var r=this,a=new Tl(this.manager);a.setPath(this.path),a.load(t,function(t){var i;try{i=JSON.parse(t)}catch(a){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(t.substring(65,t.length-2))}var n=r.parse(i);e&&e(n)},i,n)},parse:function(t){return new Cu(t)},setPath:function(t){return this.path=t,this}}),Pu.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,i=0,n=e.length;i<n;i+=2){var r=e[i],a=e[i+1];if(r.test(t))return a}return null}},Object.assign(Pu.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,i){for(var n=[],r=0;r<t.length;++r)n[r]=this.createMaterial(t[r],e,i);return n},createMaterial:function(){var t={NoBlending:S,NormalBlending:E,AdditiveBlending:M,SubtractiveBlending:C,MultiplyBlending:A,CustomBlending:k},e=new wr,i=new Al,n=new gu;return function(r,a,o){var s={};function c(t,e,n,r,c){var l,u=a+t,h=Pu.Handlers.get(u);null!==h?l=h.load(u):(i.setCrossOrigin(o),l=i.load(u)),void 0!==e&&(l.repeat.fromArray(e),1!==e[0]&&(l.wrapS=vt),1!==e[1]&&(l.wrapT=vt)),void 0!==n&&l.offset.fromArray(n),void 0!==r&&("repeat"===r[0]&&(l.wrapS=vt),"mirror"===r[0]&&(l.wrapS=_t),"repeat"===r[1]&&(l.wrapT=vt),"mirror"===r[1]&&(l.wrapT=_t)),void 0!==c&&(l.anisotropy=c);var d=ze.generateUUID();return s[d]=l,d}var l={uuid:ze.generateUUID(),type:"MeshLambertMaterial"};for(var u in r){var h=r[u];switch(u){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":l.name=h;break;case"blending":l.blending=t[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",u,"is no longer supported.");break;case"colorDiffuse":l.color=e.fromArray(h).getHex();break;case"colorSpecular":l.specular=e.fromArray(h).getHex();break;case"colorEmissive":l.emissive=e.fromArray(h).getHex();break;case"specularCoef":l.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(l.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(l.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(l.type="MeshStandardMaterial");break;case"mapDiffuse":l.map=c(h,r.mapDiffuseRepeat,r.mapDiffuseOffset,r.mapDiffuseWrap,r.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":l.emissiveMap=c(h,r.mapEmissiveRepeat,r.mapEmissiveOffset,r.mapEmissiveWrap,r.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":l.lightMap=c(h,r.mapLightRepeat,r.mapLightOffset,r.mapLightWrap,r.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":l.aoMap=c(h,r.mapAORepeat,r.mapAOOffset,r.mapAOWrap,r.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":l.bumpMap=c(h,r.mapBumpRepeat,r.mapBumpOffset,r.mapBumpWrap,r.mapBumpAnisotropy);break;case"mapBumpScale":l.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":l.normalMap=c(h,r.mapNormalRepeat,r.mapNormalOffset,r.mapNormalWrap,r.mapNormalAnisotropy);break;case"mapNormalFactor":l.normalScale=h;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":l.specularMap=c(h,r.mapSpecularRepeat,r.mapSpecularOffset,r.mapSpecularWrap,r.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":l.metalnessMap=c(h,r.mapMetalnessRepeat,r.mapMetalnessOffset,r.mapMetalnessWrap,r.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":l.roughnessMap=c(h,r.mapRoughnessRepeat,r.mapRoughnessOffset,r.mapRoughnessWrap,r.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":l.alphaMap=c(h,r.mapAlphaRepeat,r.mapAlphaOffset,r.mapAlphaWrap,r.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":l.side=v;break;case"doubleSided":l.side=y;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),l.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":l[u]=h;break;case"vertexColors":!0===h&&(l.vertexColors=x),"face"===h&&(l.vertexColors=T);break;default:console.error("THREE.Loader.createMaterial: Unsupported",u,h);break}}return"MeshBasicMaterial"===l.type&&delete l.emissive,"MeshPhongMaterial"!==l.type&&delete l.specular,l.opacity<1&&(l.transparent=!0),n.setTextures(s),n.parse(l)}}()});var Ou={getContext:function(){return void 0===wu&&(wu=new(window.AudioContext||window.webkitAudioContext)),wu},setContext:function(t){wu=t}};function Ru(t){this.manager=void 0!==t?t:bl}function Iu(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new $o,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new $o,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Du(t,e,i,n){Lr.call(this),this.type="CubeCamera";var r=90,a=1,o=new $o(r,a,t,e);o.up.set(0,-1,0),o.lookAt(new Ge(1,0,0)),this.add(o);var s=new $o(r,a,t,e);s.up.set(0,-1,0),s.lookAt(new Ge(-1,0,0)),this.add(s);var c=new $o(r,a,t,e);c.up.set(0,0,1),c.lookAt(new Ge(0,1,0)),this.add(c);var l=new $o(r,a,t,e);l.up.set(0,0,-1),l.lookAt(new Ge(0,-1,0)),this.add(l);var u=new $o(r,a,t,e);u.up.set(0,-1,0),u.lookAt(new Ge(0,0,1)),this.add(u);var h=new $o(r,a,t,e);h.up.set(0,-1,0),h.lookAt(new Ge(0,0,-1)),this.add(h),n=n||{format:Ft,magFilter:xt,minFilter:xt},this.renderTarget=new Je(i,i,n),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=t.getRenderTarget(),n=this.renderTarget,r=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,o),t.setRenderTarget(n,1),t.render(e,s),t.setRenderTarget(n,2),t.render(e,c),t.setRenderTarget(n,3),t.render(e,l),t.setRenderTarget(n,4),t.render(e,u),n.texture.generateMipmaps=r,t.setRenderTarget(n,5),t.render(e,h),t.setRenderTarget(i)},this.clear=function(t,e,i,n){for(var r=t.getRenderTarget(),a=this.renderTarget,o=0;o<6;o++)t.setRenderTarget(a,o),t.clear(e,i,n);t.setRenderTarget(r)}}function Uu(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Nu(){Lr.call(this),this.type="AudioListener",this.context=Ou.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0}function Bu(t){Lr.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Fu(t){Bu.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function zu(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function ju(t,e,i){this.binding=t,this.valueSize=i;var n,r=Float64Array;switch(e){case"quaternion":n=this._slerp;break;case"string":case"bool":r=Array,n=this._select;break;default:n=this._lerp}this.buffer=new r(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(Ru.prototype,{load:function(t,e,i,n){var r=new Tl(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.load(t,function(t){var i=t.slice(0),n=Ou.getContext();n.decodeAudioData(i,function(t){e(t)})},i,n)},setPath:function(t){return this.path=t,this}}),Object.assign(Iu.prototype,{update:function(){var t,e,i,n,r,a,o,s,c=new ni,l=new ni;return function(u){var h=t!==this||e!==u.focus||i!==u.fov||n!==u.aspect*this.aspect||r!==u.near||a!==u.far||o!==u.zoom||s!==this.eyeSep;if(h){t=this,e=u.focus,i=u.fov,n=u.aspect*this.aspect,r=u.near,a=u.far,o=u.zoom;var d=u.projectionMatrix.clone();s=this.eyeSep/2;var p,f,m=s*r/e,g=r*Math.tan(ze.DEG2RAD*i*.5)/o;l.elements[12]=-s,c.elements[12]=s,p=-g*n+m,f=g*n+m,d.elements[0]=2*r/(f-p),d.elements[8]=(f+p)/(f-p),this.cameraL.projectionMatrix.copy(d),p=-g*n-m,f=g*n-m,d.elements[0]=2*r/(f-p),d.elements[8]=(f+p)/(f-p),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(u.matrixWorld).multiply(l),this.cameraR.matrixWorld.copy(u.matrixWorld).multiply(c)}}()}),Du.prototype=Object.create(Lr.prototype),Du.prototype.constructor=Du,Object.assign(Uu.prototype,{start:function(){this.startTime=("undefined"===typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"===typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),Nu.prototype=Object.assign(Object.create(Lr.prototype),{constructor:Nu,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(){var t=new Ge,e=new He,i=new Ge,n=new Ge,r=new Uu;return function(a){Lr.prototype.updateMatrixWorld.call(this,a);var o=this.context.listener,s=this.up;if(this.timeDelta=r.getDelta(),this.matrixWorld.decompose(t,e,i),n.set(0,0,-1).applyQuaternion(e),o.positionX){var c=this.context.currentTime+this.timeDelta;o.positionX.linearRampToValueAtTime(t.x,c),o.positionY.linearRampToValueAtTime(t.y,c),o.positionZ.linearRampToValueAtTime(t.z,c),o.forwardX.linearRampToValueAtTime(n.x,c),o.forwardY.linearRampToValueAtTime(n.y,c),o.forwardZ.linearRampToValueAtTime(n.z,c),o.upX.linearRampToValueAtTime(s.x,c),o.upY.linearRampToValueAtTime(s.y,c),o.upZ.linearRampToValueAtTime(s.z,c)}else o.setPosition(t.x,t.y,t.z),o.setOrientation(n.x,n.y,n.z,s.x,s.y,s.z)}}()}),Bu.prototype=Object.assign(Object.create(Lr.prototype),{constructor:Bu,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}),Fu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Fu,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,e,i){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=i,this},updateMatrixWorld:function(){var t=new Ge,e=new He,i=new Ge,n=new Ge;return function(r){if(Lr.prototype.updateMatrixWorld.call(this,r),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(t,e,i),n.set(0,0,1).applyQuaternion(e);var a=this.panner;if(a.positionX){var o=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(t.x,o),a.positionY.linearRampToValueAtTime(t.y,o),a.positionZ.linearRampToValueAtTime(t.z,o),a.orientationX.linearRampToValueAtTime(n.x,o),a.orientationY.linearRampToValueAtTime(n.y,o),a.orientationZ.linearRampToValueAtTime(n.z,o)}else a.setPosition(t.x,t.y,t.z),a.setOrientation(n.x,n.y,n.z)}}}()}),Object.assign(zu.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),i=0;i<e.length;i++)t+=e[i];return t/e.length}}),Object.assign(ju.prototype,{accumulate:function(t,e){var i=this.buffer,n=this.valueSize,r=t*n+n,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==n;++o)i[r+o]=i[o];a=e}else{a+=e;var s=e/a;this._mixBufferRegion(i,r,0,s,n)}this.cumulativeWeight=a},apply:function(t){var e=this.valueSize,i=this.buffer,n=t*e+e,r=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,r<1){var o=3*e;this._mixBufferRegion(i,n,o,1-r,e)}for(var s=e,c=e+e;s!==c;++s)if(i[s]!==i[s+e]){a.setValue(i,n);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,i=this.valueSize,n=3*i;t.getValue(e,n);for(var r=i,a=n;r!==a;++r)e[r]=e[n+r%i];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,i,n,r){if(n>=.5)for(var a=0;a!==r;++a)t[e+a]=t[i+a]},_slerp:function(t,e,i,n){He.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,i,n,r){for(var a=1-n,o=0;o!==r;++o){var s=e+o;t[s]=t[s]*a+t[i+o]*n}}});var Hu,Gu,Vu="\\[\\]\\.:\\/";function Wu(t,e,i){var n=i||qu.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}function qu(t,e,i){this.path=e,this.parsedPath=i||qu.parseTrackName(e),this.node=qu.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Yu(){this.uuid=ze.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,i=arguments.length;e!==i;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function Xu(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null;for(var n=e.tracks,r=n.length,a=new Array(r),o={endingStart:Te,endingEnd:Te},s=0;s!==r;++s){var c=n[s].createInterpolant(null);a[s]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ve,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function $u(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Zu(t){"string"===typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Ju(){qr.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Ku(t,e,i){ss.call(this,t,e),this.meshPerAttribute=i||1}function Qu(t,e,i,n){"number"===typeof i&&(n=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Rr.call(this,t,e,i),this.meshPerAttribute=n||1}function th(t,e,i,n){this.ray=new ia(t,e),this.near=i||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function eh(t,e){return t.distance-e.distance}function ih(t,e,i,n){if(!1!==t.visible&&(t.raycast(e,i),!0===n))for(var r=t.children,a=0,o=r.length;a<o;a++)ih(r[a],e,i,!0)}function nh(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this}function rh(t,e,i){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==i?i:0,this}function ah(t,e){this.min=void 0!==t?t:new je(1/0,1/0),this.max=void 0!==e?e:new je(-1/0,-1/0)}function oh(t,e){this.start=void 0!==t?t:new Ge,this.end=void 0!==e?e:new Ge}function sh(t){Lr.call(this),this.material=t,this.render=function(){}}function ch(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==i?i:16711680,a=void 0!==n?n:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var c=new qr,l=new jr(2*o*3,3);c.addAttribute("position",l),vs.call(this,c,new ms({color:r,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function lh(t,e){Lr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var i=new qr,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,a=1,o=32;r<o;r++,a++){var s=r/o*Math.PI*2,c=a/o*Math.PI*2;n.push(Math.cos(s),Math.sin(s),1,Math.cos(c),Math.sin(c),1)}i.addAttribute("position",new jr(n,3));var l=new ms({fog:!1});this.cone=new vs(i,l),this.add(this.cone),this.update()}function uh(t){var e=[];t&&t.isBone&&e.push(t);for(var i=0;i<t.children.length;i++)e.push.apply(e,uh(t.children[i]));return e}function hh(t){for(var e=uh(t),i=new qr,n=[],r=[],a=new wr(0,0,1),o=new wr(0,1,0),s=0;s<e.length;s++){var c=e[s];c.parent&&c.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(a.r,a.g,a.b),r.push(o.r,o.g,o.b))}i.addAttribute("position",new jr(n,3)),i.addAttribute("color",new jr(r,3));var l=new ms({vertexColors:x,depthTest:!1,depthWrite:!1,transparent:!0});vs.call(this,i,l),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function dh(t,e,i){this.light=t,this.light.updateMatrixWorld(),this.color=i;var n=new kc(e,4,2),r=new ra({wireframe:!0,fog:!1});aa.call(this,n,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function ph(t,e){this.type="RectAreaLightHelper",this.light=t,this.color=e;var i=[1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],n=new qr;n.addAttribute("position",new jr(i,3)),n.computeBoundingSphere();var r=new ms({fog:!1});gs.call(this,n,r);var a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],o=new qr;o.addAttribute("position",new jr(a,3)),o.computeBoundingSphere(),this.add(new aa(o,new ra({side:v,fog:!1}))),this.update()}function fh(t,e,i){Lr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;var n=new Rs(e);n.rotateY(.5*Math.PI),this.material=new ra({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=x);var r=n.getAttribute("position"),a=new Float32Array(3*r.count);n.addAttribute("color",new Rr(a,3)),this.add(new aa(n,this.material)),this.update()}function mh(t,e,i,n){t=t||10,e=e||10,i=new wr(void 0!==i?i:4473924),n=new wr(void 0!==n?n:8947848);for(var r=e/2,a=t/e,o=t/2,s=[],c=[],l=0,u=0,h=-o;l<=e;l++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var d=l===r?i:n;d.toArray(c,u),u+=3,d.toArray(c,u),u+=3,d.toArray(c,u),u+=3,d.toArray(c,u),u+=3}var p=new qr;p.addAttribute("position",new jr(s,3)),p.addAttribute("color",new jr(c,3));var f=new ms({vertexColors:x});vs.call(this,p,f)}function gh(t,e,i,n,r,a){t=t||10,e=e||16,i=i||8,n=n||64,r=new wr(void 0!==r?r:4473924),a=new wr(void 0!==a?a:8947848);var o,s,c,l,u,h,d,p=[],f=[];for(l=0;l<=e;l++)c=l/e*(2*Math.PI),o=Math.sin(c)*t,s=Math.cos(c)*t,p.push(0,0,0),p.push(o,0,s),d=1&l?r:a,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(l=0;l<=i;l++)for(d=1&l?r:a,h=t-t/i*l,u=0;u<n;u++)c=u/n*(2*Math.PI),o=Math.sin(c)*h,s=Math.cos(c)*h,p.push(o,0,s),f.push(d.r,d.g,d.b),c=(u+1)/n*(2*Math.PI),o=Math.sin(c)*h,s=Math.cos(c)*h,p.push(o,0,s),f.push(d.r,d.g,d.b);var m=new qr;m.addAttribute("position",new jr(p,3)),m.addAttribute("color",new jr(f,3));var g=new ms({vertexColors:x});vs.call(this,m,g)}function vh(t,e,i,n){this.audio=t,this.range=e||1,this.divisionsInnerAngle=i||16,this.divisionsOuterAngle=n||2;var r=new qr,a=this.divisionsInnerAngle+2*this.divisionsOuterAngle,o=new Float32Array(3*(3*a+3));r.addAttribute("position",new Rr(o,3));var s=new ms({color:65280}),c=new ms({color:16776960});gs.call(this,r,[c,s]),this.update()}function yh(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==i?i:16776960,a=void 0!==n?n:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new qr,l=new jr(2*o*3,3);c.addAttribute("position",l),vs.call(this,c,new ms({color:r,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function _h(t,e,i){Lr.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,void 0===e&&(e=1);var n=new qr;n.addAttribute("position",new jr([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var r=new ms({fog:!1});this.lightPlane=new gs(n,r),this.add(this.lightPlane),n=new qr,n.addAttribute("position",new jr([0,0,0,0,0,1],3)),this.targetLine=new gs(n,r),this.add(this.targetLine),this.update()}function bh(t){var e=new qr,i=new ms({color:16777215,vertexColors:T}),n=[],r=[],a={},o=new wr(16755200),s=new wr(16711680),c=new wr(43775),l=new wr(16777215),u=new wr(3355443);function h(t,e,i){d(t,i),d(e,i)}function d(t,e){n.push(0,0,0),r.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(n.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",c),h("u2","u3",c),h("u3","u1",c),h("c","t",l),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),e.addAttribute("position",new jr(n,3)),e.addAttribute("color",new jr(r,3)),vs.call(this,e,i),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function wh(t,e){this.object=t,void 0===e&&(e=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new qr;r.setIndex(new Rr(i,1)),r.addAttribute("position",new Rr(n,3)),vs.call(this,r,new ms({color:e})),this.matrixAutoUpdate=!1,this.update()}function Th(t,e){this.type="Box3Helper",this.box=t;var i=void 0!==e?e:16776960,n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],a=new qr;a.setIndex(new Rr(n,1)),a.addAttribute("position",new jr(r,3)),vs.call(this,a,new ms({color:i})),this.geometry.computeBoundingSphere()}function xh(t,e,i){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var n=void 0!==i?i:16776960,r=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],a=new qr;a.addAttribute("position",new jr(r,3)),a.computeBoundingSphere(),gs.call(this,a,new ms({color:n}));var o=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],s=new qr;s.addAttribute("position",new jr(o,3)),s.computeBoundingSphere(),this.add(new aa(s,new ra({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}function Sh(t,e,i,n,r,a){Lr.call(this),void 0===t&&(t=new Ge(0,0,1)),void 0===e&&(e=new Ge(0,0,0)),void 0===i&&(i=1),void 0===n&&(n=16776960),void 0===r&&(r=.2*i),void 0===a&&(a=.2*r),void 0===Hu&&(Hu=new qr,Hu.addAttribute("position",new jr([0,0,0,0,1,0],3)),Gu=new Fc(0,.5,1,5,1),Gu.translate(0,-.5,0)),this.position.copy(e),this.line=new gs(Hu,new ms({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new aa(Gu,new ra({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,r,a)}function Eh(t){t=t||1;var e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new qr;n.addAttribute("position",new jr(e,3)),n.addAttribute("color",new jr(i,3));var r=new ms({vertexColors:x});vs.call(this,n,r)}function Mh(t,e,i,n,r,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Mr(t,e,i,r,a,o)}Object.assign(Wu.prototype,{getValue:function(t,e){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}}),Object.assign(qu,{Composite:Wu,create:function(t,e,i){return t&&t.isAnimationObjectGroup?new qu.Composite(t,e,i):new qu(t,e,i)},sanitizeNodeName:function(){var t=new RegExp("["+Vu+"]","g");return function(e){return e.replace(/\s/g,"_").replace(t,"")}}(),parseTrackName:function(){var t="[^"+Vu+"]",e="[^"+Vu.replace("\\.","")+"]",i=/((?:WC+[\/:])*)/.source.replace("WC",t),n=/(WCOD+)?/.source.replace("WCOD",e),r=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",t),a=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",t),o=new RegExp("^"+i+n+r+a+"$"),s=["material","materials","bones"];return function(t){var e=o.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var r=i.nodeName.substring(n+1);-1!==s.indexOf(r)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}}(),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=t.skeleton.getBoneByName(e);if(void 0!==i)return i}if(t.children){var n=function(t){for(var i=0;i<t.length;i++){var r=t[i];if(r.name===e||r.uuid===e)return r;var a=n(r.children);if(a)return a}return null},r=n(t.children);if(r)return r}return null}}),Object.assign(qu.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)t[e++]=i[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,r=e.propertyIndex;if(t||(t=qu.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var a=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var s=t[n];if(void 0!==s){var c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===r){r=o;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===r){r=o;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}else{var u=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+n+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(qu.prototype,{_getValue_unbound:qu.prototype.getValue,_setValue_unbound:qu.prototype.setValue}),Object.assign(Yu.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,c=void 0,l=0,u=arguments.length;l!==u;++l){var h=arguments[l],d=h.uuid,p=n[d];if(void 0===p){p=e++,n[d]=p,t.push(h);for(var f=0,m=s;f!==m;++f)o[f].push(new qu(h,r[f],a[f]))}else if(p<i){c=t[p];var g=--i,v=t[g];n[v.uuid]=p,t[p]=v,n[d]=g,t[g]=h;for(f=0,m=s;f!==m;++f){var y=o[f],_=y[g],b=y[p];y[p]=_,void 0===b&&(b=new qu(h,r[f],a[f])),y[g]=b}}else t[p]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,r=n.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],c=s.uuid,l=i[c];if(void 0!==l&&l>=e){var u=e++,h=t[u];i[h.uuid]=l,t[l]=h,i[c]=u,t[u]=s;for(var d=0,p=r;d!==p;++d){var f=n[d],m=f[u],g=f[l];f[l]=m,f[u]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,a=r.length,o=0,s=arguments.length;o!==s;++o){var c=arguments[o],l=c.uuid,u=n[l];if(void 0!==u)if(delete n[l],u<i){var h=--i,d=t[h],p=--e,f=t[p];n[d.uuid]=u,t[u]=d,n[f.uuid]=h,t[h]=f,t.pop();for(var m=0,g=a;m!==g;++m){var v=r[m],y=v[h],_=v[p];v[u]=y,v[h]=_,v.pop()}}else{p=--e,f=t[p];n[f.uuid]=u,t[u]=f,t.pop();for(m=0,g=a;m!==g;++m){v=r[m];v[u]=v[p],v.pop()}}}this.nCachedObjects_=i},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,n=i[t],r=this._bindings;if(void 0!==n)return r[n];var a=this._paths,o=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,u=new Array(c);n=r.length,i[t]=n,a.push(t),o.push(e),r.push(u);for(var h=l,d=s.length;h!==d;++h){var p=s[h];u[h]=new qu(p,t,e)}return u},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){var n=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o],c=t[o];e[c]=i,a[i]=s,a.pop(),r[i]=r[o],r.pop(),n[i]=n[o],n.pop()}}}),Object.assign(Xu.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){var n=this._clip.duration,r=t._clip.duration,a=r/n,o=n/r;t.warp(1,a,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,i){var n=this._mixer,r=n.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,c=a.sampleValues;return s[0]=r,s[1]=r+i,c[0]=t/o,c[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,n){if(this.enabled){var r=this._startTime;if(null!==r){var a=(t-r)*i;if(a<0||0===i)return;this._startTime=null,e=i*a}e*=this._updateTimeScale(t);var o=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var c=this._interpolants,l=this._propertyBindings,u=0,h=c.length;u!==h;++u)c[u].evaluate(o),l[u].accumulate(n,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t,i=this._clip.duration,n=this.loop,r=this._loopCount,a=n===ye;if(0===t)return-1===r?e:a&&1===(1&r)?i-e:e;if(n===ge){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=i)e=i;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),e>=i||e<0){var o=Math.floor(e/i);e-=i*o,r+=Math.abs(o);var s=this.repetitions-r;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var c=t<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}if(a&&1===(1&r))return this.time=e,i-e}return this.time=e,e},_setEndings:function(t,e,i){var n=this._interpolantSettings;i?(n.endingStart=xe,n.endingEnd=xe):(n.endingStart=t?this.zeroSlopeAtStart?xe:Te:Se,n.endingEnd=e?this.zeroSlopeAtEnd?xe:Te:Se)},_scheduleFading:function(t,e,i){var n=this._mixer,r=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=e,o[1]=r+t,s[1]=i,this}}),$u.prototype=Object.assign(Object.create(n.prototype),{constructor:$u,_bindAction:function(t,e){var i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,a=t._propertyBindings,o=t._interpolants,s=i.uuid,c=this._bindingsByRootAndName,l=c[s];void 0===l&&(l={},c[s]=l);for(var u=0;u!==r;++u){var h=n[u],d=h.name,p=l[d];if(void 0!==p)a[u]=p;else{if(p=a[u],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=e&&e._propertyBindings[u].binding.parsedPath;p=new ju(qu.create(i,d,f),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,s,d),a[u]=p}o[u].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}for(var r=t._propertyBindings,a=0,o=r.length;a!==o;++a){var s=r[a];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0===--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,i){var n=this._actions,r=this._actionsByClip,a=r[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=a;else{var o=a.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=n.length,n.push(t),a.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=this._actions,i=e[e.length-1],n=t._cacheIndex;i._cacheIndex=n,e[n]=i,e.pop(),t._cacheIndex=null;var r=t._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,c=s[s.length-1],l=t._byClipCacheIndex;c._byClipCacheIndex=l,s[l]=c,s.pop(),t._byClipCacheIndex=null;var u=o.actionByRoot,h=(t._localRoot||this._root).uuid;delete u[h],0===s.length&&delete a[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0===--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_addInactiveBinding:function(t,e,i){var n=this._bindingsByRootAndName,r=n[e],a=this._bindings;void 0===r&&(r={},n[e]=r),r[i]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=t.binding,n=i.rootNode.uuid,r=i.path,a=this._bindingsByRootAndName,o=a[n],s=e[e.length-1],c=t._cacheIndex;s._cacheIndex=c,e[c]=s,e.pop(),delete o[r];t:{for(var l in o)break t;delete a[n]}},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&(i=new al(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=e,t[e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];t.__cacheIndex=n,e[n]=t,r.__cacheIndex=i,e[i]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var i=e||this._root,n=i.uuid,r="string"===typeof t?ml.findByName(i,t):t,a=null!==r?r.uuid:t,o=this._actionsByClip[a],s=null;if(void 0!==o){var c=o.actionByRoot[n];if(void 0!==c)return c;s=o.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var l=new Xu(this,r,e);return this._bindAction(l,s),this._addInactiveAction(l,a,n),l},existingAction:function(t,e){var i=e||this._root,n=i.uuid,r="string"===typeof t?ml.findByName(i,t):t,a=r?r.uuid:t,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[n]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==e;++r)t[r].reset();for(r=0;r!==n;++r)i[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),a=this._accuIndex^=1,o=0;o!==i;++o){var s=e[o];s._update(n,t,r,a)}var c=this._bindings,l=this._nActiveBindings;for(o=0;o!==l;++o)c[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,i=t.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){for(var a=r.knownActions,o=0,s=a.length;o!==s;++o){var c=a[o];this._deactivateAction(c);var l=c._cacheIndex,u=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=l,e[l]=u,e.pop(),this._removeInactiveBindingsForAction(c)}delete n[i]}},uncacheRoot:function(t){var e=t.uuid,i=this._actionsByClip;for(var n in i){var r=i[n].actionByRoot,a=r[e];void 0!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}var o=this._bindingsByRootAndName,s=o[e];if(void 0!==s)for(var c in s){var l=s[c];l.restoreOriginalState(),this._removeInactiveBinding(l)}},uncacheAction:function(t,e){var i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),Zu.prototype.clone=function(){return new Zu(void 0===this.value.clone?this.value:this.value.clone())},Ju.prototype=Object.assign(Object.create(qr.prototype),{constructor:Ju,isInstancedBufferGeometry:!0,copy:function(t){return qr.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Ku.prototype=Object.assign(Object.create(ss.prototype),{constructor:Ku,isInstancedInterleavedBuffer:!0,copy:function(t){return ss.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Qu.prototype=Object.assign(Object.create(Rr.prototype),{constructor:Qu,isInstancedBufferAttribute:!0,copy:function(t){return Rr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(th.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,i){var n=i||[];return ih(t,this,n,e),n.sort(eh),n},intersectObjects:function(t,e,i){var n=i||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var r=0,a=t.length;r<a;r++)ih(t[r],this,n,e);return n.sort(eh),n}}),Object.assign(nh.prototype,{set:function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(ze.clamp(e/this.radius,-1,1))),this}}),Object.assign(rh.prototype,{set:function(t,e,i){return this.radius=t,this.theta=e,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,i){return this.radius=Math.sqrt(t*t+i*i),this.theta=Math.atan2(t,i),this.y=e,this}}),Object.assign(ah.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new je;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new je),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new je),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new je),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new je),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new je;return function(e){var i=t.copy(e).clamp(this.min,this.max);return i.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(oh.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Ge),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Ge),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Ge),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new Ge,e=new Ge;return function(i,n){t.subVectors(i,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),a=e.dot(t),o=a/r;return n&&(o=ze.clamp(o,0,1)),o}}(),closestPointToPoint:function(t,e,i){var n=this.closestPointToPointParameter(t,e);return void 0===i&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new Ge),this.delta(i).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),sh.prototype=Object.create(Lr.prototype),sh.prototype.constructor=sh,sh.prototype.isImmediateRenderObject=!0,ch.prototype=Object.create(vs.prototype),ch.prototype.constructor=ch,ch.prototype.update=function(){var t=new Ge,e=new Ge,i=new Ve;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var s=o.vertices,c=o.faces,l=0,u=0,h=c.length;u<h;u++)for(var d=c[u],p=0,f=d.vertexNormals.length;p<f;p++){var m=s[d[n[p]]],g=d.vertexNormals[p];t.copy(m).applyMatrix4(r),e.copy(g).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),a.setXYZ(l,t.x,t.y,t.z),l+=1,a.setXYZ(l,e.x,e.y,e.z),l+=1}else if(o&&o.isBufferGeometry){var v=o.attributes.position,y=o.attributes.normal;for(l=0,p=0,f=v.count;p<f;p++)t.set(v.getX(p),v.getY(p),v.getZ(p)).applyMatrix4(r),e.set(y.getX(p),y.getY(p),y.getZ(p)),e.applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),a.setXYZ(l,t.x,t.y,t.z),l+=1,a.setXYZ(l,e.x,e.y,e.z),l+=1}a.needsUpdate=!0}}(),lh.prototype=Object.create(Lr.prototype),lh.prototype.constructor=lh,lh.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},lh.prototype.update=function(){var t=new Ge;return function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,i=e*Math.tan(this.light.angle);this.cone.scale.set(i,i,e),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),hh.prototype=Object.create(vs.prototype),hh.prototype.constructor=hh,hh.prototype.updateMatrixWorld=function(){var t=new Ge,e=new ni,i=new ni;return function(n){var r=this.bones,a=this.geometry,o=a.getAttribute("position");i.getInverse(this.root.matrixWorld);for(var s=0,c=0;s<r.length;s++){var l=r[s];l.parent&&l.parent.isBone&&(e.multiplyMatrices(i,l.matrixWorld),t.setFromMatrixPosition(e),o.setXYZ(c,t.x,t.y,t.z),e.multiplyMatrices(i,l.parent.matrixWorld),t.setFromMatrixPosition(e),o.setXYZ(c+1,t.x,t.y,t.z),c+=2)}a.getAttribute("position").needsUpdate=!0,Lr.prototype.updateMatrixWorld.call(this,n)}}(),dh.prototype=Object.create(aa.prototype),dh.prototype.constructor=dh,dh.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},dh.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},ph.prototype=Object.create(gs.prototype),ph.prototype.constructor=ph,ph.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var t=this.material.color,e=Math.max(t.r,t.g,t.b);e>1&&t.multiplyScalar(1/e),this.children[0].material.color.copy(this.material.color)}},ph.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()},fh.prototype=Object.create(Lr.prototype),fh.prototype.constructor=fh,fh.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},fh.prototype.update=function(){var t=new Ge,e=new wr,i=new wr;return function(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var r=n.geometry.getAttribute("color");e.copy(this.light.color),i.copy(this.light.groundColor);for(var a=0,o=r.count;a<o;a++){var s=a<o/2?e:i;r.setXYZ(a,s.r,s.g,s.b)}r.needsUpdate=!0}n.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),mh.prototype=Object.assign(Object.create(vs.prototype),{constructor:mh,copy:function(t){return vs.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),gh.prototype=Object.create(vs.prototype),gh.prototype.constructor=gh,vh.prototype=Object.create(gs.prototype),vh.prototype.constructor=vh,vh.prototype.update=function(){var t,e,i=this.audio,n=this.range,r=this.divisionsInnerAngle,a=this.divisionsOuterAngle,o=ze.degToRad(i.panner.coneInnerAngle),s=ze.degToRad(i.panner.coneOuterAngle),c=o/2,l=s/2,u=0,h=0,d=this.geometry,p=d.attributes.position;function f(i,r,a,o){var s=(r-i)/a;for(p.setXYZ(u,0,0,0),h++,t=i;t<r;t+=s)e=u+h,p.setXYZ(e,Math.sin(t)*n,0,Math.cos(t)*n),p.setXYZ(e+1,Math.sin(Math.min(t+s,r))*n,0,Math.cos(Math.min(t+s,r))*n),p.setXYZ(e+2,0,0,0),h+=3;d.addGroup(u,h,o),u+=h,h=0}d.clearGroups(),f(-l,-c,a,0),f(-c,c,r,1),f(c,l,a,0),p.needsUpdate=!0,o===s&&(this.material[0].visible=!1)},vh.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},yh.prototype=Object.create(vs.prototype),yh.prototype.constructor=yh,yh.prototype.update=function(){var t=new Ge,e=new Ge,i=new Ve;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,r=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,s=a.faces,c=0,l=0,u=s.length;l<u;l++){var h=s[l],d=h.normal;t.copy(o[h.a]).add(o[h.b]).add(o[h.c]).divideScalar(3).applyMatrix4(n),e.copy(d).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),r.setXYZ(c,t.x,t.y,t.z),c+=1,r.setXYZ(c,e.x,e.y,e.z),c+=1}r.needsUpdate=!0}}(),_h.prototype=Object.create(Lr.prototype),_h.prototype.constructor=_h,_h.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},_h.prototype.update=function(){var t=new Ge,e=new Ge,i=new Ge;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(e,t),this.lightPlane.lookAt(e),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(e),this.targetLine.scale.z=i.length()}}(),bh.prototype=Object.create(vs.prototype),bh.prototype.constructor=bh,bh.prototype.update=function(){var t,e,i=new Ge,n=new Xo;function r(r,a,o,s){i.set(a,o,s).unproject(n);var c=e[r];if(void 0!==c)for(var l=t.getAttribute("position"),u=0,h=c.length;u<h;u++)l.setXYZ(c[u],i.x,i.y,i.z)}return function(){t=this.geometry,e=this.pointMap;var i=1,a=1;n.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),r("c",0,0,-1),r("t",0,0,1),r("n1",-i,-a,-1),r("n2",i,-a,-1),r("n3",-i,a,-1),r("n4",i,a,-1),r("f1",-i,-a,1),r("f2",i,-a,1),r("f3",-i,a,1),r("f4",i,a,1),r("u1",.7*i,1.1*a,-1),r("u2",.7*-i,1.1*a,-1),r("u3",0,2*a,-1),r("cf1",-i,0,1),r("cf2",i,0,1),r("cf3",0,-a,1),r("cf4",0,a,1),r("cn1",-i,0,-1),r("cn2",i,0,-1),r("cn3",0,-a,-1),r("cn4",0,a,-1),t.getAttribute("position").needsUpdate=!0}}(),wh.prototype=Object.create(vs.prototype),wh.prototype.constructor=wh,wh.prototype.update=function(){var t=new Qe;return function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){var i=t.min,n=t.max,r=this.geometry.attributes.position,a=r.array;a[0]=n.x,a[1]=n.y,a[2]=n.z,a[3]=i.x,a[4]=n.y,a[5]=n.z,a[6]=i.x,a[7]=i.y,a[8]=n.z,a[9]=n.x,a[10]=i.y,a[11]=n.z,a[12]=n.x,a[13]=n.y,a[14]=i.z,a[15]=i.x,a[16]=n.y,a[17]=i.z,a[18]=i.x,a[19]=i.y,a[20]=i.z,a[21]=n.x,a[22]=i.y,a[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),wh.prototype.setFromObject=function(t){return this.object=t,this.update(),this},wh.prototype.copy=function(t){return vs.prototype.copy.call(this,t),this.object=t.object,this},wh.prototype.clone=function(){return(new this.constructor).copy(this)},Th.prototype=Object.create(vs.prototype),Th.prototype.constructor=Th,Th.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),Lr.prototype.updateMatrixWorld.call(this,t))},xh.prototype=Object.create(gs.prototype),xh.prototype.constructor=xh,xh.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?v:g,this.lookAt(this.plane.normal),Lr.prototype.updateMatrixWorld.call(this,t)},Sh.prototype=Object.create(Lr.prototype),Sh.prototype.constructor=Sh,Sh.prototype.setDirection=function(){var t,e=new Ge;return function(i){i.y>.99999?this.quaternion.set(0,0,0,1):i.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(i.z,0,-i.x).normalize(),t=Math.acos(i.y),this.quaternion.setFromAxisAngle(e,t))}}(),Sh.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},Sh.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},Sh.prototype.copy=function(t){return Lr.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},Sh.prototype.clone=function(){return(new this.constructor).copy(this)},Eh.prototype=Object.create(vs.prototype),Eh.prototype.constructor=Eh;var Ch=0,Ah=1;function kh(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function Lh(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function Ph(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new bs(t,e)}function Oh(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new us(t)}function Rh(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new bs(t,e)}function Ih(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new _s(t)}function Dh(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new _s(t)}function Uh(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new _s(t)}function Nh(t,e,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Ge(t,e,i)}function Bh(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new Rr(t,e).setDynamic(!0)}function Fh(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Ir(t,e)}function zh(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Dr(t,e)}function jh(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Ur(t,e)}function Hh(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Nr(t,e)}function Gh(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Br(t,e)}function Vh(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Fr(t,e)}function Wh(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new zr(t,e)}function qh(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new jr(t,e)}function Yh(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Hr(t,e)}function Xh(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Nl.call(this,t),this.type="catmullrom",this.closed=!0}function $h(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Nl.call(this,t),this.type="catmullrom"}function Zh(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Nl.call(this,t),this.type="catmullrom"}function Jh(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Eh(t)}function Kh(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new wh(t,e)}function Qh(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new vs(new Nc(t.geometry),new ms({color:void 0!==e?e:16777215}))}function td(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new vs(new Es(t.geometry),new ms({color:void 0!==e?e:16777215}))}function ed(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Tl(t)}function id(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new El(t)}kl.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(kl.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(iu.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new Or,i=0,n=t.length;i<n;i++){var r=t[i];e.vertices.push(new Ge(r.x,r.y,r.z||0))}return e}}),Object.assign(nu.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Xh.prototype=Object.create(Nl.prototype),$h.prototype=Object.create(Nl.prototype),Zh.prototype=Object.create(Nl.prototype),Object.assign(Zh.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),mh.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},hh.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Pu.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),vu.extractUrlBase(t)}}),Object.assign(bu.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(ah.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Qe.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),oh.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(ze,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),ze.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),ze.ceilPowerOfTwo(t)}}),Object.assign(Ve.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(ni.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new Ge),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,i,n,r,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,i,r,a)}}),ei.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},He.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(ia.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(na.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(na,{barycoordFromPoint:function(t,e,i,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),na.getBarycoord(t,e,i,n,r)},normal:function(t,e,i,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),na.getNormal(t,e,i,n)}}),Object.assign(ru.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Tc(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Ic(this,t)}}),Object.assign(je.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ge.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Xe.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Or.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(Lr.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(Lr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(hs.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(ps.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),ds.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(kl.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),$o.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(au.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Rr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(qr.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(qr.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(xc.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Zu.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Kr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new wr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===_}}}),Object.defineProperties($c.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ea.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(ns.prototype,{clearTarget:function(t,e,i,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,i,n)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")}}),Object.defineProperties(ns.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Go.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Je.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties($e.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(es.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),Bu.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this,i=new Ru;return i.load(t,function(t){e.setBuffer(t)}),this},zu.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Du.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var nd={merge:function(t,e,i){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};function rd(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function ad(){console.error("THREE.CanvasRenderer has been removed")}function od(){console.error("THREE.JSONLoader has been removed.")}We.crossOrigin=void 0,We.loadTexture=function(t,e,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new Al;r.setCrossOrigin(this.crossOrigin);var a=r.load(t,i,void 0,n);return e&&(a.mapping=e),a},We.loadTextureCube=function(t,e,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Cl;r.setCrossOrigin(this.crossOrigin);var a=r.load(t,i,void 0,n);return e&&(a.mapping=e),a},We.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},We.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var sd={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function cd(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}},"0335":function(t,e,i){(function(e){var n,r="undefined"!==typeof e?e:"undefined"!==typeof window?window:{},a=i(1);"undefined"!==typeof document?n=document:(n=r["__GLOBAL_DOCUMENT_CACHE@4"],n||(n=r["__GLOBAL_DOCUMENT_CACHE@4"]=a)),t.exports=n}).call(this,i("66fa"))},"0466":function(t,e,i){var n=i("ecdc"),r=t.exports={WebVTT:i("5886"),VTTCue:i("f07d"),VTTRegion:i("4e43")};n.vttjs=r,n.WebVTT=r.WebVTT;var a=r.VTTCue,o=r.VTTRegion,s=n.VTTCue,c=n.VTTRegion;r.shim=function(){n.VTTCue=a,n.VTTRegion=o},r.restore=function(){n.VTTCue=s,n.VTTRegion=c},n.VTTCue||r.shim()},"0630":function(t,e){function i(t,e){var i,n=null;try{i=JSON.parse(t,e)}catch(r){n=r}return[n,i]}t.exports=i},"06b9":function(t,e,i){"use strict";var n=i("43f5"),r=i("51df").handleRollover,a={};a.ts=i("774fb"),a.aac=i("e7ea");var o=9e4,s=188,c=71,l=function(t,e){var i,n,r=0,o=s;while(o<t.byteLength)if(t[r]!==c||t[o]!==c)r++,o++;else{switch(i=t.subarray(r,o),n=a.ts.parseType(i,e.pid),n){case"pat":e.pid||(e.pid=a.ts.parsePat(i));break;case"pmt":e.table||(e.table=a.ts.parsePmt(i));break;default:break}if(e.pid&&e.table)return;r+=s,o+=s}},u=function(t,e,i){var n,r,o,l,u,h=0,d=s,p=!1;while(d<=t.byteLength)if(t[h]!==c||t[d]!==c&&d!==t.byteLength)h++,d++;else{switch(n=t.subarray(h,d),r=a.ts.parseType(n,e.pid),r){case"pes":o=a.ts.parsePesType(n,e.table),l=a.ts.parsePayloadUnitStartIndicator(n),"audio"===o&&l&&(u=a.ts.parsePesTime(n),u&&(u.type="audio",i.audio.push(u),p=!0));break;default:break}if(p)break;h+=s,d+=s}d=t.byteLength,h=d-s,p=!1;while(h>=0)if(t[h]!==c||t[d]!==c&&d!==t.byteLength)h--,d--;else{switch(n=t.subarray(h,d),r=a.ts.parseType(n,e.pid),r){case"pes":o=a.ts.parsePesType(n,e.table),l=a.ts.parsePayloadUnitStartIndicator(n),"audio"===o&&l&&(u=a.ts.parsePesTime(n),u&&(u.type="audio",i.audio.push(u),p=!0));break;default:break}if(p)break;h-=s,d-=s}},h=function(t,e,i){var n,r,o,l,u,h,d,p,f=0,m=s,g=!1,v={data:[],size:0};while(m<t.byteLength)if(t[f]!==c||t[m]!==c)f++,m++;else{switch(n=t.subarray(f,m),r=a.ts.parseType(n,e.pid),r){case"pes":if(o=a.ts.parsePesType(n,e.table),l=a.ts.parsePayloadUnitStartIndicator(n),"video"===o&&(l&&!g&&(u=a.ts.parsePesTime(n),u&&(u.type="video",i.video.push(u),g=!0)),!i.firstKeyFrame)){if(l&&0!==v.size){h=new Uint8Array(v.size),d=0;while(v.data.length)p=v.data.shift(),h.set(p,d),d+=p.byteLength;a.ts.videoPacketContainsKeyFrame(h)&&(i.firstKeyFrame=a.ts.parsePesTime(h),i.firstKeyFrame.type="video"),v.size=0}v.data.push(n),v.size+=n.byteLength}break;default:break}if(g&&i.firstKeyFrame)break;f+=s,m+=s}m=t.byteLength,f=m-s,g=!1;while(f>=0)if(t[f]!==c||t[m]!==c)f--,m--;else{switch(n=t.subarray(f,m),r=a.ts.parseType(n,e.pid),r){case"pes":o=a.ts.parsePesType(n,e.table),l=a.ts.parsePayloadUnitStartIndicator(n),"video"===o&&l&&(u=a.ts.parsePesTime(n),u&&(u.type="video",i.video.push(u),g=!0));break;default:break}if(g)break;f-=s,m-=s}},d=function(t,e){if(t.audio&&t.audio.length){var i=e;"undefined"===typeof i&&(i=t.audio[0].dts),t.audio.forEach(function(t){t.dts=r(t.dts,i),t.pts=r(t.pts,i),t.dtsTime=t.dts/o,t.ptsTime=t.pts/o})}if(t.video&&t.video.length){var n=e;if("undefined"===typeof n&&(n=t.video[0].dts),t.video.forEach(function(t){t.dts=r(t.dts,n),t.pts=r(t.pts,n),t.dtsTime=t.dts/o,t.ptsTime=t.pts/o}),t.firstKeyFrame){var a=t.firstKeyFrame;a.dts=r(a.dts,n),a.pts=r(a.pts,n),a.dtsTime=a.dts/o,a.ptsTime=a.dts/o}}},p=function(t){var e,i=!1,n=0,r=null,s=null,c=0,l=0;while(t.length-l>=3){var u=a.aac.parseType(t,l);switch(u){case"timed-metadata":if(t.length-l<10){i=!0;break}if(c=a.aac.parseId3TagSize(t,l),c>t.length){i=!0;break}null===s&&(e=t.subarray(l,l+c),s=a.aac.parseAacTimestamp(e)),l+=c;break;case"audio":if(t.length-l<7){i=!0;break}if(c=a.aac.parseAdtsSize(t,l),c>t.length){i=!0;break}null===r&&(e=t.subarray(l,l+c),r=a.aac.parseSampleRate(e)),n++,l+=c;break;default:l++;break}if(i)return null}if(null===r||null===s)return null;var h=o/r,d={audio:[{type:"audio",dts:s,pts:s},{type:"audio",dts:s+1024*n*h,pts:s+1024*n*h}]};return d},f=function(t){var e={pid:null,table:null},i={};for(var r in l(t,e),e.table)if(e.table.hasOwnProperty(r)){var a=e.table[r];switch(a){case n.H264_STREAM_TYPE:i.video=[],h(t,e,i),0===i.video.length&&delete i.video;break;case n.ADTS_STREAM_TYPE:i.audio=[],u(t,e,i),0===i.audio.length&&delete i.audio;break;default:break}}return i},m=function(t,e){var i,n=a.aac.isLikelyAacData(t);return i=n?p(t):f(t),i&&(i.audio||i.video)?(d(i,e),i):null};t.exports={inspect:m,parseAudioPes_:u}},1:function(t,e){},1169:function(t,e,i){"use strict";var n,r,a,o=i("6f40"),s=i("5409"),c=i("43f5"),l=i("51df").TimestampRolloverStream,u=i("43f5"),h=188,d=71;n=function(){var t=new Uint8Array(h),e=0;n.prototype.init.call(this),this.push=function(i){var n,r=0,a=h;e?(n=new Uint8Array(i.byteLength+e),n.set(t.subarray(0,e)),n.set(i,e),e=0):n=i;while(a<n.byteLength)n[r]!==d||n[a]!==d?(r++,a++):(this.trigger("data",n.subarray(r,a)),r+=h,a+=h);r<n.byteLength&&(t.set(n.subarray(r),0),e=n.byteLength-r)},this.flush=function(){e===h&&t[0]===d&&(this.trigger("data",t),e=0),this.trigger("done")}},n.prototype=new o,r=function(){var t,e,i,n;r.prototype.init.call(this),n=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,t=function(t,n){var r=0;n.payloadUnitStartIndicator&&(r+=t[r]+1),"pat"===n.type?e(t.subarray(r),n):i(t.subarray(r),n)},e=function(t,e){e.section_number=t[7],e.last_section_number=t[8],n.pmtPid=(31&t[10])<<8|t[11],e.pmtPid=n.pmtPid},i=function(t,e){var i,r,a,o;if(1&t[5]){n.programMapTable={video:null,audio:null,"timed-metadata":{}},i=(15&t[1])<<8|t[2],r=3+i-4,a=(15&t[10])<<8|t[11],o=12+a;while(o<r){var s=t[o],l=(31&t[o+1])<<8|t[o+2];s===c.H264_STREAM_TYPE&&null===n.programMapTable.video?n.programMapTable.video=l:s===c.ADTS_STREAM_TYPE&&null===n.programMapTable.audio?n.programMapTable.audio=l:s===c.METADATA_STREAM_TYPE&&(n.programMapTable["timed-metadata"][l]=s),o+=5+((15&t[o+3])<<8|t[o+4])}e.programMapTable=n.programMapTable}},this.push=function(e){var i={},n=4;if(i.payloadUnitStartIndicator=!!(64&e[1]),i.pid=31&e[1],i.pid<<=8,i.pid|=e[2],(48&e[3])>>>4>1&&(n+=e[n]+1),0===i.pid)i.type="pat",t(e.subarray(n),i),this.trigger("data",i);else if(i.pid===this.pmtPid){i.type="pmt",t(e.subarray(n),i),this.trigger("data",i);while(this.packetsWaitingForPmt.length)this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}else void 0===this.programMapTable?this.packetsWaitingForPmt.push([e,n,i]):this.processPes_(e,n,i)},this.processPes_=function(t,e,i){i.pid===this.programMapTable.video?i.streamType=c.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?i.streamType=c.ADTS_STREAM_TYPE:i.streamType=this.programMapTable["timed-metadata"][i.pid],i.type="pes",i.data=t.subarray(e),this.trigger("data",i)}},r.prototype=new o,r.STREAM_TYPES={h264:27,adts:15},a=function(){var t=this,e={data:[],size:0},i={data:[],size:0},n={data:[],size:0},r=function(t,e){var i;e.packetLength=6+(t[4]<<8|t[5]),e.dataAlignmentIndicator=0!==(4&t[6]),i=t[7],192&i&&(e.pts=(14&t[9])<<27|(255&t[10])<<20|(254&t[11])<<12|(255&t[12])<<5|(254&t[13])>>>3,e.pts*=4,e.pts+=(6&t[13])>>>1,e.dts=e.pts,64&i&&(e.dts=(14&t[14])<<27|(255&t[15])<<20|(254&t[16])<<12|(255&t[17])<<5|(254&t[18])>>>3,e.dts*=4,e.dts+=(6&t[18])>>>1)),e.data=t.subarray(9+t[8])},o=function(e,i,n){var a,o=new Uint8Array(e.size),s={type:i},c=0,l=0,u=!1;if(e.data.length&&!(e.size<9)){for(s.trackId=e.data[0].pid,c=0;c<e.data.length;c++)a=e.data[c],o.set(a.data,l),l+=a.data.byteLength;r(o,s),u="video"===i||s.packetLength<=e.size,(n||u)&&(e.size=0,e.data.length=0),u&&t.trigger("data",s)}};a.prototype.init.call(this),this.push=function(r){({pat:function(){},pes:function(){var t,a;switch(r.streamType){case c.H264_STREAM_TYPE:case u.H264_STREAM_TYPE:t=e,a="video";break;case c.ADTS_STREAM_TYPE:t=i,a="audio";break;case c.METADATA_STREAM_TYPE:t=n,a="timed-metadata";break;default:return}r.payloadUnitStartIndicator&&o(t,a,!0),t.data.push(r),t.size+=r.data.byteLength},pmt:function(){var e={type:"metadata",tracks:[]},i=r.programMapTable;null!==i.video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.video,codec:"avc",type:"video"}),null!==i.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.audio,codec:"adts",type:"audio"}),t.trigger("data",e)}})[r.type]()},this.flush=function(){o(e,"video"),o(i,"audio"),o(n,"timed-metadata"),this.trigger("done")}},a.prototype=new o;var p={PAT_PID:0,MP2T_PACKET_LENGTH:h,TransportPacketStream:n,TransportParseStream:r,ElementaryStream:a,TimestampRolloverStream:l,CaptionStream:s.CaptionStream,Cea608Stream:s.Cea608Stream,MetadataStream:i("644f")};for(var f in c)c.hasOwnProperty(f)&&(p[f]=c[f]);t.exports=p},1685:function(t,e,i){"use strict";var n=i("5f3b"),r=n("%Object%"),a=n("%TypeError%"),o=n("%String%"),s=i("743c"),c=i("6d85"),l=i("75fa"),u=i("af00"),h=i("ad12"),d=i("2b42"),p=i("69c8"),f=i("fb81"),m={ToPrimitive:p,ToBoolean:function(t){return!!t},ToNumber:function(t){return+t},ToInteger:function(t){var e=this.ToNumber(t);return c(e)?0:0!==e&&l(e)?u(e)*Math.floor(Math.abs(e)):e},ToInt32:function(t){return this.ToNumber(t)>>0},ToUint32:function(t){return this.ToNumber(t)>>>0},ToUint16:function(t){var e=this.ToNumber(t);if(c(e)||0===e||!l(e))return 0;var i=u(e)*Math.floor(Math.abs(e));return h(i,65536)},ToString:function(t){return o(t)},ToObject:function(t){return this.CheckObjectCoercible(t),r(t)},CheckObjectCoercible:function(t,e){if(null==t)throw new a(e||"Cannot call method on "+t);return t},IsCallable:d,SameValue:function(t,e){return t===e?0!==t||1/t===1/e:c(t)&&c(e)},Type:function(t){return null===t?"Null":"undefined"===typeof t?"Undefined":"function"===typeof t||"object"===typeof t?"Object":"number"===typeof t?"Number":"boolean"===typeof t?"Boolean":"string"===typeof t?"String":void 0},IsPropertyDescriptor:function(t){if("Object"!==this.Type(t))return!1;var e={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var i in t)if(f(t,i)&&!e[i])return!1;var n=f(t,"[[Value]]"),r=f(t,"[[Get]]")||f(t,"[[Set]]");if(n&&r)throw new a("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(t){return"undefined"!==typeof t&&(s(this,"Property Descriptor","Desc",t),!(!f(t,"[[Get]]")&&!f(t,"[[Set]]")))},IsDataDescriptor:function(t){return"undefined"!==typeof t&&(s(this,"Property Descriptor","Desc",t),!(!f(t,"[[Value]]")&&!f(t,"[[Writable]]")))},IsGenericDescriptor:function(t){return"undefined"!==typeof t&&(s(this,"Property Descriptor","Desc",t),!this.IsAccessorDescriptor(t)&&!this.IsDataDescriptor(t))},FromPropertyDescriptor:function(t){if("undefined"===typeof t)return t;if(s(this,"Property Descriptor","Desc",t),this.IsDataDescriptor(t))return{value:t["[[Value]]"],writable:!!t["[[Writable]]"],enumerable:!!t["[[Enumerable]]"],configurable:!!t["[[Configurable]]"]};if(this.IsAccessorDescriptor(t))return{get:t["[[Get]]"],set:t["[[Set]]"],enumerable:!!t["[[Enumerable]]"],configurable:!!t["[[Configurable]]"]};throw new a("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(t){if("Object"!==this.Type(t))throw new a("ToPropertyDescriptor requires an object");var e={};if(f(t,"enumerable")&&(e["[[Enumerable]]"]=this.ToBoolean(t.enumerable)),f(t,"configurable")&&(e["[[Configurable]]"]=this.ToBoolean(t.configurable)),f(t,"value")&&(e["[[Value]]"]=t.value),f(t,"writable")&&(e["[[Writable]]"]=this.ToBoolean(t.writable)),f(t,"get")){var i=t.get;if("undefined"!==typeof i&&!this.IsCallable(i))throw new TypeError("getter must be a function");e["[[Get]]"]=i}if(f(t,"set")){var n=t.set;if("undefined"!==typeof n&&!this.IsCallable(n))throw new a("setter must be a function");e["[[Set]]"]=n}if((f(e,"[[Get]]")||f(e,"[[Set]]"))&&(f(e,"[[Value]]")||f(e,"[[Writable]]")))throw new a("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return e}};t.exports=m},"18e6":function(t,e,i){"use strict";var n,r=i("6f40"),a=i("e7ea");n=function(){var t=new Uint8Array,e=0;n.prototype.init.call(this),this.setTimestamp=function(t){e=t},this.push=function(i){var n,r,o,s,c=0,l=0;t.length?(s=t.length,t=new Uint8Array(i.byteLength+s),t.set(t.subarray(0,s)),t.set(i,s)):t=i;while(t.length-l>=3)if(t[l]!=="I".charCodeAt(0)||t[l+1]!=="D".charCodeAt(0)||t[l+2]!=="3".charCodeAt(0))if(255!==(255&t[l])||240!==(240&t[l+1]))l++;else{if(t.length-l<7)break;if(c=a.parseAdtsSize(t,l),l+c>t.length)break;o={type:"audio",data:t.subarray(l,l+c),pts:e,dts:e},this.trigger("data",o),l+=c}else{if(t.length-l<10)break;if(c=a.parseId3TagSize(t,l),l+c>t.length)break;r={type:"timed-metadata",data:t.subarray(l,l+c)},this.trigger("data",r),l+=c}n=t.length-l,t=n>0?t.subarray(l):new Uint8Array}},n.prototype=new r,t.exports=n},"1d53":function(t,e,i){"use strict";var n=i("3cea"),r=i("1685"),a=n.call(Function.call,String.prototype.replace),o=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,s=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;t.exports=function(){var t=r.ToString(r.CheckObjectCoercible(this));return a(a(t,o,""),s,"")}},"1edb":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAXCAYAAADk3wSdAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkVFMUVDNzdGMUQxOTExRTlBMkFFOTFDRUEyNkM5ODk0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkVFMUVDNzgwMUQxOTExRTlBMkFFOTFDRUEyNkM5ODk0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RUUxRUM3N0QxRDE5MTFFOUEyQUU5MUNFQTI2Qzk4OTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RUUxRUM3N0UxRDE5MTFFOUEyQUU5MUNFQTI2Qzk4OTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4mR4axAAACDUlEQVR42qzUzUtUURjH8TvXccq3FmohoZlShoKGtHIluIoQgjCojbuW/Q25EXQrtHNhIC6TVkGgKJJiCyMCI6LElMREU7PScbzH7xO/C5fLxB2HDnxm7mHmPOfteW7KOffY87wuXMdXrCIF3/t3O0FW3+dwHsuYxEaajzbMowRLeJ4Q1OEANajFtp77UI+nFvQQb3FFq/zkJbcm3EMnPmACo+jHQ1vNb5Qig/KEYLaDZgyhG19wCwP4gTH73de2fQ1wCUFtZz1owAsMYxwXcAfrNpHvna05KdUisuqXqG8CmzmIDEqaxG57RqvtRSNasYeXurimcPv7+Kkfk1b6GYNY1IW9xxMc4b7FSCsdOnBNQVsi2wkv50RZklFO2qU809nuarJHijWaVgp16w82uCyWp059C5bTOfpa2YEmsrGbGLF4KSqqmod2pVOgS3CRlVrKXcQDrGEON3ED01jQf1e06r8psoPZWNrEL8eO5K5Sxy7jkia3FHoXT8V8t52LqcJtbOENKlWOGZV4S75kTmp2+FfxCq/1XK2z/YPL+HjWoOHq93Vm35Ulx/iVrwoLqahAKtW3C62QePEUHDQaPEyxIF+wYoIW3AoJGhZC8D+D+jq7XKSfihRHUUH3lKPtKuFdvQeOdL7pYoJaxU0p0Xv14rHcrVNG5IpJfqdSnNKLJ6sC8FSm3+IDTgUYAMbKhrsDf1m8AAAAAElFTkSuQmCC"},"1f90":function(t,e){function i(t){return t.replace(/\n\r?\s*/g,"")}t.exports=function(t){for(var e="",n=0;n<arguments.length;n++)e+=i(t[n])+(arguments[n+1]||"");return e}},"2b42":function(t,e,i){"use strict";var n=Function.prototype.toString,r=/^\s*class\b/,a=function(t){try{var e=n.call(t);return r.test(e)}catch(i){return!1}},o=function(t){try{return!a(t)&&(n.call(t),!0)}catch(e){return!1}},s=Object.prototype.toString,c="[object Function]",l="[object GeneratorFunction]",u="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag;t.exports=function(t){if(!t)return!1;if("function"!==typeof t&&"object"!==typeof t)return!1;if("function"===typeof t&&!t.prototype)return!0;if(u)return o(t);if(a(t))return!1;var e=s.call(t);return e===c||e===l}},"3a5b":function(t,e,i){"use strict";var n=i("3cea"),r=i("c892"),a=i("1d53"),o=i("dab2"),s=i("71ef"),c=n.call(Function.call,o());r(c,{getPolyfill:o,implementation:a,shim:s}),t.exports=c},"3b01":function(t,e){var i=function(t){var e,i,n=[],r=[];for(n.byteLength=0,e=0;e<t.length;e++)i=t[e],"access_unit_delimiter_rbsp"===i.nalUnitType?(n.length&&(n.duration=i.dts-n.dts,r.push(n)),n=[i],n.byteLength=i.data.byteLength,n.pts=i.pts,n.dts=i.dts):("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(n.keyFrame=!0),n.duration=i.dts-n.dts,n.byteLength+=i.data.byteLength,n.push(i));return r.length&&(!n.duration||n.duration<=0)&&(n.duration=r[r.length-1].duration),r.push(n),r},n=function(t){var e,i,n=[],r=[];for(n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=t[0].pts,n.dts=t[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=t[0].pts,r.dts=t[0].dts,e=0;e<t.length;e++)i=t[e],i.keyFrame?(n.length&&(r.push(n),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration),n=[i],n.nalCount=i.length,n.byteLength=i.byteLength,n.pts=i.pts,n.dts=i.dts,n.duration=i.duration):(n.duration+=i.duration,n.nalCount+=i.length,n.byteLength+=i.byteLength,n.push(i));return r.length&&n.duration<=0&&(n.duration=r[r.length-1].duration),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration,r.push(n),r},r=function(t){var e;return!t[0][0].keyFrame&&t.length>1&&(e=t.shift(),t.byteLength-=e.byteLength,t.nalCount-=e.nalCount,t[0][0].dts=e.dts,t[0][0].pts=e.pts,t[0][0].duration+=e.duration),t},a=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},o=function(t,e){var i=a();return i.dataOffset=e,i.compositionTimeOffset=t.pts-t.dts,i.duration=t.duration,i.size=4*t.length,i.size+=t.byteLength,t.keyFrame&&(i.flags.dependsOn=2,i.flags.isNonSyncSample=0),i},s=function(t,e){var i,n,r,a,s,c=e||0,l=[];for(i=0;i<t.length;i++)for(a=t[i],n=0;n<a.length;n++)s=a[n],r=o(s,c),c+=r.size,l.push(r);return l},c=function(t){var e,i,n,r,a,o,s=0,c=t.byteLength,l=t.nalCount,u=c+4*l,h=new Uint8Array(u),d=new DataView(h.buffer);for(e=0;e<t.length;e++)for(r=t[e],i=0;i<r.length;i++)for(a=r[i],n=0;n<a.length;n++)o=a[n],d.setUint32(s,o.data.byteLength),s+=4,h.set(o.data,s),s+=o.data.byteLength;return h};t.exports={groupNalsIntoFrames:i,groupFramesIntoGops:n,extendFirstKeyFrame:r,generateSampleTable:s,concatenateNalData:c}},"3cea":function(t,e,i){"use strict";var n=i("a95f");t.exports=Function.prototype.bind||n},"3daa":function(t,e,i){"use strict";var n,r,a,o,s=i("6f40"),c=i("f41e"),l=i("3b01"),u=i("651d"),h=i("f45a"),d=i("1169"),p=i("a49b"),f=i("94f2").H264Stream,m=i("18e6"),g=i("e7ea").isLikelyAacData,v=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],y=["width","height","profileIdc","levelIdc","profileCompatibility"],_=function(t,e){var i;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0};r=function(t,e){var i=[],n=0,a=0,o=0,s=1/0;e=e||{},r.prototype.init.call(this),this.push=function(e){h.collectDtsInfo(t,e),t&&v.forEach(function(i){t[i]=e[i]}),i.push(e)},this.setEarliestDts=function(e){a=e-t.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(t){s=t},this.setAudioAppendStart=function(t){o=t},this.flush=function(){var r,l,d,p;0!==i.length?(r=u.trimAdtsFramesByEarliestDts(i,t,a),t.baseMediaDecodeTime=h.calculateTrackBaseMediaDecodeTime(t,e.keepOriginalTimestamps),u.prefixWithSilence(t,r,o,s),t.samples=u.generateSampleTable(r),d=c.mdat(u.concatenateFrameData(r)),i=[],l=c.moof(n,[t]),p=new Uint8Array(l.byteLength+d.byteLength),n++,p.set(l),p.set(d,l.byteLength),h.clearDtsInfo(t),this.trigger("data",{track:t,boxes:p}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")}},r.prototype=new s,n=function(t,e){var i,r,a=0,o=[],s=[];e=e||{},n.prototype.init.call(this),delete t.minPTS,this.gopCache_=[],this.push=function(e){h.collectDtsInfo(t,e),"seq_parameter_set_rbsp"!==e.nalUnitType||i||(i=e.config,t.sps=[e.data],y.forEach(function(e){t[e]=i[e]},this)),"pic_parameter_set_rbsp"!==e.nalUnitType||r||(r=e.data,t.pps=[e.data]),o.push(e)},this.flush=function(){var i,n,r,u,d,p;while(o.length){if("access_unit_delimiter_rbsp"===o[0].nalUnitType)break;o.shift()}if(0===o.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(i=l.groupNalsIntoFrames(o),r=l.groupFramesIntoGops(i),r[0][0].keyFrame||(n=this.getGopForFusion_(o[0],t),n?(r.unshift(n),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.pts=n.pts,r.dts=n.dts,r.duration+=n.duration):r=l.extendFirstKeyFrame(r)),s.length){var f;if(f=e.alignGopsAtEnd?this.alignGopsAtEnd_(r):this.alignGopsAtStart_(r),!f)return this.gopCache_.unshift({gop:r.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),o=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");h.clearDtsInfo(t),r=f}h.collectDtsInfo(t,r),t.samples=l.generateSampleTable(r),d=c.mdat(l.concatenateNalData(r)),t.baseMediaDecodeTime=h.calculateTrackBaseMediaDecodeTime(t,e.keepOriginalTimestamps),this.trigger("processedGopsInfo",r.map(function(t){return{pts:t.pts,dts:t.dts,byteLength:t.byteLength}})),this.gopCache_.unshift({gop:r.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),o=[],this.trigger("baseMediaDecodeTime",t.baseMediaDecodeTime),this.trigger("timelineStartInfo",t.timelineStartInfo),u=c.moof(a,[t]),p=new Uint8Array(u.byteLength+d.byteLength),a++,p.set(u),p.set(d,u.byteLength),this.trigger("data",{track:t,boxes:p}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){h.clearDtsInfo(t),i=void 0,r=void 0},this.getGopForFusion_=function(e){var i,n,r,a,o,s=45e3,c=1e4,l=1/0;for(o=0;o<this.gopCache_.length;o++)a=this.gopCache_[o],r=a.gop,t.pps&&_(t.pps[0],a.pps[0])&&t.sps&&_(t.sps[0],a.sps[0])&&(r.dts<t.timelineStartInfo.dts||(i=e.dts-r.dts-r.duration,i>=-c&&i<=s&&(!n||l>i)&&(n=a,l=i)));return n?n.gop:null},this.alignGopsAtStart_=function(t){var e,i,n,r,a,o,c,l;a=t.byteLength,o=t.nalCount,c=t.duration,e=i=0;while(e<s.length&&i<t.length){if(n=s[e],r=t[i],n.pts===r.pts)break;r.pts>n.pts?e++:(i++,a-=r.byteLength,o-=r.nalCount,c-=r.duration)}return 0===i?t:i===t.length?null:(l=t.slice(i),l.byteLength=a,l.duration=c,l.nalCount=o,l.pts=l[0].pts,l.dts=l[0].dts,l)},this.alignGopsAtEnd_=function(t){var e,i,n,r,a,o,c;e=s.length-1,i=t.length-1,a=null,o=!1;while(e>=0&&i>=0){if(n=s[e],r=t[i],n.pts===r.pts){o=!0;break}n.pts>r.pts?e--:(e===s.length-1&&(a=i),i--)}if(!o&&null===a)return null;if(c=o?i:a,0===c)return t;var l=t.slice(c),u=l.reduce(function(t,e){return t.byteLength+=e.byteLength,t.duration+=e.duration,t.nalCount+=e.nalCount,t},{byteLength:0,duration:0,nalCount:0});return l.byteLength=u.byteLength,l.duration=u.duration,l.nalCount=u.nalCount,l.pts=l[0].pts,l.dts=l[0].dts,l},this.alignGopsWith=function(t){s=t}},n.prototype=new s,o=function(t,e){this.numberOfTracks=0,this.metadataStream=e,t=t||{},"undefined"!==typeof t.remux?this.remuxTracks=!!t.remux:this.remuxTracks=!0,"boolean"===typeof t.keepOriginalTimestamps&&(this.keepOriginalTimestamps=t.keepOriginalTimestamps),this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,o.prototype.init.call(this),this.push=function(t){return t.text?this.pendingCaptions.push(t):t.frames?this.pendingMetadata.push(t):(this.pendingTracks.push(t.track),this.pendingBoxes.push(t.boxes),this.pendingBytes+=t.boxes.byteLength,"video"===t.track.type&&(this.videoTrack=t.track),void("audio"===t.track.type&&(this.audioTrack=t.track)))}},o.prototype=new s,o.prototype.flush=function(t){var e,i,n,r,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==t&&"AudioSegmentStream"!==t)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,y.forEach(function(t){o.info[t]=this.videoTrack[t]},this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,v.forEach(function(t){o.info[t]=this.audioTrack[t]},this)),1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,n=c.initSegment(this.pendingTracks),o.initSegment=new Uint8Array(n.byteLength),o.initSegment.set(n),o.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)o.data.set(this.pendingBoxes[r],a),a+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)e=this.pendingCaptions[r],e.startTime=e.startPts,this.keepOriginalTimestamps||(e.startTime-=s),e.startTime/=9e4,e.endTime=e.endPts,this.keepOriginalTimestamps||(e.endTime-=s),e.endTime/=9e4,o.captionStreams[e.stream]=!0,o.captions.push(e);for(r=0;r<this.pendingMetadata.length;r++)i=this.pendingMetadata[r],i.cueTime=i.pts,this.keepOriginalTimestamps||(i.cueTime-=s),i.cueTime/=9e4,o.metadata.push(i);o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},a=function(t){var e,i,s=this,c=!0;a.prototype.init.call(this),t=t||{},this.baseMediaDecodeTime=t.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var e={};this.transmuxPipeline_=e,e.type="aac",e.metadataStream=new d.MetadataStream,e.aacStream=new m,e.audioTimestampRolloverStream=new d.TimestampRolloverStream("audio"),e.timedMetadataTimestampRolloverStream=new d.TimestampRolloverStream("timed-metadata"),e.adtsStream=new p,e.coalesceStream=new o(t,e.metadataStream),e.headOfPipeline=e.aacStream,e.aacStream.pipe(e.audioTimestampRolloverStream).pipe(e.adtsStream),e.aacStream.pipe(e.timedMetadataTimestampRolloverStream).pipe(e.metadataStream).pipe(e.coalesceStream),e.metadataStream.on("timestamp",function(t){e.aacStream.setTimestamp(t.timeStamp)}),e.aacStream.on("data",function(n){"timed-metadata"!==n.type||e.audioSegmentStream||(i=i||{timelineStartInfo:{baseMediaDecodeTime:s.baseMediaDecodeTime},codec:"adts",type:"audio"},e.coalesceStream.numberOfTracks++,e.audioSegmentStream=new r(i,t),e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream))}),e.coalesceStream.on("data",this.trigger.bind(this,"data")),e.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var a={};this.transmuxPipeline_=a,a.type="ts",a.metadataStream=new d.MetadataStream,a.packetStream=new d.TransportPacketStream,a.parseStream=new d.TransportParseStream,a.elementaryStream=new d.ElementaryStream,a.videoTimestampRolloverStream=new d.TimestampRolloverStream("video"),a.audioTimestampRolloverStream=new d.TimestampRolloverStream("audio"),a.timedMetadataTimestampRolloverStream=new d.TimestampRolloverStream("timed-metadata"),a.adtsStream=new p,a.h264Stream=new f,a.captionStream=new d.CaptionStream,a.coalesceStream=new o(t,a.metadataStream),a.headOfPipeline=a.packetStream,a.packetStream.pipe(a.parseStream).pipe(a.elementaryStream),a.elementaryStream.pipe(a.videoTimestampRolloverStream).pipe(a.h264Stream),a.elementaryStream.pipe(a.audioTimestampRolloverStream).pipe(a.adtsStream),a.elementaryStream.pipe(a.timedMetadataTimestampRolloverStream).pipe(a.metadataStream).pipe(a.coalesceStream),a.h264Stream.pipe(a.captionStream).pipe(a.coalesceStream),a.elementaryStream.on("data",function(o){var c;if("metadata"===o.type){c=o.tracks.length;while(c--)e||"video"!==o.tracks[c].type?i||"audio"!==o.tracks[c].type||(i=o.tracks[c],i.timelineStartInfo.baseMediaDecodeTime=s.baseMediaDecodeTime):(e=o.tracks[c],e.timelineStartInfo.baseMediaDecodeTime=s.baseMediaDecodeTime);e&&!a.videoSegmentStream&&(a.coalesceStream.numberOfTracks++,a.videoSegmentStream=new n(e,t),a.videoSegmentStream.on("timelineStartInfo",function(t){i&&(i.timelineStartInfo=t,a.audioSegmentStream.setEarliestDts(t.dts))}),a.videoSegmentStream.on("processedGopsInfo",s.trigger.bind(s,"gopInfo")),a.videoSegmentStream.on("baseMediaDecodeTime",function(t){i&&a.audioSegmentStream.setVideoBaseMediaDecodeTime(t)}),a.h264Stream.pipe(a.videoSegmentStream).pipe(a.coalesceStream)),i&&!a.audioSegmentStream&&(a.coalesceStream.numberOfTracks++,a.audioSegmentStream=new r(i,t),a.adtsStream.pipe(a.audioSegmentStream).pipe(a.coalesceStream))}}),a.coalesceStream.on("data",this.trigger.bind(this,"data")),a.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(n){var r=this.transmuxPipeline_;t.keepOriginalTimestamps||(this.baseMediaDecodeTime=n),i&&(i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,h.clearDtsInfo(i),t.keepOriginalTimestamps||(i.timelineStartInfo.baseMediaDecodeTime=n),r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity()),e&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[],r.videoTimestampRolloverStream.discontinuity()),e.timelineStartInfo.dts=void 0,e.timelineStartInfo.pts=void 0,h.clearDtsInfo(e),r.captionStream.reset(),t.keepOriginalTimestamps||(e.timelineStartInfo.baseMediaDecodeTime=n)),r.timedMetadataTimestampRolloverStream&&r.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(t){i&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(t)},this.alignGopsWith=function(t){e&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(t)},this.push=function(t){if(c){var e=g(t);e&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():e||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),c=!1}this.transmuxPipeline_.headOfPipeline.push(t)},this.flush=function(){c=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},a.prototype=new s,t.exports={Transmuxer:a,VideoSegmentStream:n,AudioSegmentStream:r,AUDIO_PROPERTIES:v,VIDEO_PROPERTIES:y}},"3e37":function(t,e,i){"use strict";(function(t){i.d(e,"a",function(){return it}),i.d(e,"b",function(){return nt});var n=i("ecdc"),r=i.n(n),a=function(t){return!!t&&"object"===typeof t},o=function t(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.reduce(function(e,i){return Object.keys(i).forEach(function(n){Array.isArray(e[n])&&Array.isArray(i[n])?e[n]=e[n].concat(i[n]):a(e[n])&&a(i[n])?e[n]=t(e[n],i[n]):e[n]=i[n]}),e},{})},s=function(t){return Object.keys(t).map(function(e){return t[e]})},c=function(t,e){for(var i=[],n=t;n<e;n++)i.push(n);return i},l=function(t){return t.reduce(function(t,e){return t.concat(e)},[])},u=function(t){if(!t.length)return[];for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e},h=function(t,e){return t.reduce(function(t,i,n){return i[e]&&t.push(n),t},[])},d=function(t){var e=s(t.reduce(function(t,e){var i,n=e.attributes.id+(e.attributes.lang||"");t[n]?(e.segments[0].discontinuity=!0,(i=t[n].segments).push.apply(i,e.segments),e.attributes.contentProtection&&(t[n].attributes.contentProtection=e.attributes.contentProtection)):t[n]=e;return t},{}));return e.map(function(t){return t.discontinuityStarts=h(t.segments,"discontinuity"),t})},p=function(t){var e,i=t.attributes,n=t.segments,r={attributes:(e={NAME:i.id,BANDWIDTH:i.bandwidth,CODECS:i.codecs},e["PROGRAM-ID"]=1,e),uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1};return i.contentProtection&&(r.contentProtection=i.contentProtection),r},f=function(t){var e,i=t.attributes,n=t.segments;return"undefined"===typeof n&&(n=[{uri:i.baseUrl,timeline:i.periodIndex,resolvedUri:i.baseUrl||"",duration:i.sourceDuration,number:0}],i.duration=i.sourceDuration),{attributes:(e={NAME:i.id,BANDWIDTH:i.bandwidth},e["PROGRAM-ID"]=1,e),uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:i.baseUrl||"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1}},m=function(t){return t.reduce(function(t,e){var i=e.attributes.role&&e.attributes.role.value||"main",n=e.attributes.lang||"",r="main";return n&&(r=e.attributes.lang+" ("+i+")"),t[r]&&t[r].playlists[0].attributes.BANDWIDTH>e.attributes.bandwidth?t:(t[r]={language:n,autoselect:!0,default:"main"===i,playlists:[p(e)],uri:""},t)},{})},g=function(t){return t.reduce(function(t,e){var i=e.attributes.lang||"text";return t[i]?t:(t[i]={language:i,default:!1,autoselect:!1,playlists:[f(e)],uri:""},t)},{})},v=function(t){var e,i=t.attributes,n=t.segments,r={attributes:(e={NAME:i.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:i.width,height:i.height},CODECS:i.codecs,BANDWIDTH:i.bandwidth},e["PROGRAM-ID"]=1,e),uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1};return i.contentProtection&&(r.contentProtection=i.contentProtection),r},y=function(t){var e;if(!t.length)return{};var i=t[0].attributes,n=i.sourceDuration,r=i.minimumUpdatePeriod,a=void 0===r?0:r,o=function(t){var e=t.attributes;return"video/mp4"===e.mimeType||"video"===e.contentType},s=function(t){var e=t.attributes;return"audio/mp4"===e.mimeType||"audio"===e.contentType},c=function(t){var e=t.attributes;return"text/vtt"===e.mimeType||"text"===e.contentType},l=d(t.filter(o)).map(v),u=d(t.filter(s)),h=t.filter(c),p={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(e={AUDIO:{},VIDEO:{}},e["CLOSED-CAPTIONS"]={},e.SUBTITLES={},e),uri:"",duration:n,playlists:l,minimumUpdatePeriod:1e3*a};return u.length&&(p.mediaGroups.AUDIO.audio=m(u)),h.length&&(p.mediaGroups.SUBTITLES.subs=g(h)),p};"undefined"!==typeof window?window:"undefined"!==typeof t||"undefined"!==typeof self&&self;function _(t,e){return e={exports:{}},t(e,e.exports),e.exports}var b=_(function(t,e){(function(e){var i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,n=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(t,e,i){if(i=i||{},t=t.trim(),e=e.trim(),!e){if(!i.alwaysNormalize)return t;var r=o.parseURL(t);if(!r)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=o.parseURL(e);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):e;var s=o.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var c=n.exec(s.path);s.netLoc=c[1],s.path=c[2]}s.netLoc&&!s.path&&(s.path="/");var l={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var u=s.path,h=u.substring(0,u.lastIndexOf("/")+1)+a.path;l.path=o.normalizePath(h)}else l.path=s.path,a.params||(l.params=s.params,a.query||(l.query=s.query));return null===l.path&&(l.path=i.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(l)},parseURL:function(t){var e=i.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){t=t.split("").reverse().join("").replace(r,"");while(t.length!==(t=t.replace(a,"")).length);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=o})()}),w=function(t,e){return/^[a-z]+:/i.test(e)?e:(/\/\//i.test(t)||(t=b.buildAbsoluteURL(r.a.location.href,t)),b.buildAbsoluteURL(t,e))},T=function(t){var e=t.baseUrl,i=void 0===e?"":e,n=t.source,r=void 0===n?"":n,a=t.range,o=void 0===a?"":a,s={uri:r,resolvedUri:w(i||"",r)};if(o){var c=o.split("-"),l=parseInt(c[0],10),u=parseInt(c[1],10);s.byterange={length:u-l,offset:l}}return s},x=function(t,e,i){var n=t.NOW,r=t.clientOffset,a=t.availabilityStartTime,o=t.timescale,s=void 0===o?1:o,c=t.start,l=void 0===c?0:c,u=t.minimumUpdatePeriod,h=void 0===u?0:u,d=(n+r)/1e3,p=a+l,f=d+h,m=f-p;return Math.ceil((m*s-e)/i)},S=function(t,e){for(var i=t.type,n=void 0===i?"static":i,r=t.minimumUpdatePeriod,a=void 0===r?0:r,o=t.media,s=void 0===o?"":o,c=t.sourceDuration,l=t.timescale,u=void 0===l?1:l,h=t.startNumber,d=void 0===h?1:h,p=t.periodIndex,f=[],m=-1,g=0;g<e.length;g++){var v=e[g],y=v.d,_=v.r||0,b=v.t||0;m<0&&(m=b),b&&b>m&&(m=b);var w=void 0;if(_<0){var T=g+1;w=T===e.length?"dynamic"===n&&a>0&&s.indexOf("$Number$")>0?x(t,m,y):(c*u-m)/y:(e[T].t-m)/y}else w=_+1;var S=d+f.length+w,E=d+f.length;while(E<S)f.push({number:E,duration:y/u,time:m,timeline:p}),m+=y,E++}return f},E={static:function(t){var e=t.duration,i=t.timescale,n=void 0===i?1:i,r=t.sourceDuration;return{start:0,end:Math.ceil(r/(e/n))}},dynamic:function(t){var e=t.NOW,i=t.clientOffset,n=t.availabilityStartTime,r=t.timescale,a=void 0===r?1:r,o=t.duration,s=t.start,c=void 0===s?0:s,l=t.minimumUpdatePeriod,u=void 0===l?0:l,h=t.timeShiftBufferDepth,d=void 0===h?1/0:h,p=(e+i)/1e3,f=n+c,m=p+u,g=m-f,v=Math.ceil(g*a/o),y=Math.floor((p-f-d)*a/o),_=Math.floor((p-f)*a/o);return{start:Math.max(0,y),end:Math.min(v,_)}}},M=function(t){return function(e,i){var n=t.duration,r=t.timescale,a=void 0===r?1:r,o=t.periodIndex,s=t.startNumber,c=void 0===s?1:s;return{number:c+e,duration:n/a,timeline:o,time:i*n}}},C=function(t){var e=t.type,i=void 0===e?"static":e,n=t.duration,r=t.timescale,a=void 0===r?1:r,o=t.sourceDuration,s=E[i](t),l=s.start,u=s.end,h=c(l,u).map(M(t));if("static"===i){var d=h.length-1;h[d].duration=o-n/a*d}return h},A=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,k=function(t){return function(e,i,n,r){if("$$"===e)return"$";if("undefined"===typeof t[i])return e;var a=""+t[i];return"RepresentationID"===i?a:(r=n?parseInt(r,10):1,a.length>=r?a:""+new Array(r-a.length+1).join("0")+a)}},L=function(t,e){return t.replace(A,k(e))},P=function(t,e){return t.duration||e?t.duration?C(t):S(t,e):[{number:t.startNumber||1,duration:t.sourceDuration,time:0,timeline:t.periodIndex}]},O=function(t,e){var i={RepresentationID:t.id,Bandwidth:t.bandwidth||0},n=t.initialization,r=void 0===n?{sourceURL:"",range:""}:n,a=T({baseUrl:t.baseUrl,source:L(r.sourceURL,i),range:r.range}),o=P(t,e);return o.map(function(e){i.Number=e.number,i.Time=e.time;var n=L(t.media||"",i);return{uri:n,timeline:e.timeline,duration:e.duration,resolvedUri:w(t.baseUrl||"",n),map:a,number:e.number}})},R={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},I=function(t,e){var i=t.baseUrl,n=t.initialization,r=void 0===n?{}:n,a=T({baseUrl:i,source:r.sourceURL,range:r.range}),o=T({baseUrl:i,source:e.media,range:e.mediaRange});return o.map=a,o},D=function(t,e){var i=t.duration,n=t.segmentUrls,r=void 0===n?[]:n;if(!i&&!e||i&&e)throw new Error(R.SEGMENT_TIME_UNSPECIFIED);var a,o=r.map(function(e){return I(t,e)});i&&(a=C(t)),e&&(a=S(t,e));var s=a.map(function(t,e){if(o[e]){var i=o[e];return i.timeline=t.timeline,i.duration=t.duration,i.number=t.number,i}}).filter(function(t){return t});return s},U=function(t){var e=t.baseUrl,i=t.initialization,n=void 0===i?{}:i,r=t.sourceDuration,a=t.timescale,o=void 0===a?1:a,s=t.indexRange,c=void 0===s?"":s,l=t.duration;if(!e)throw new Error(R.NO_BASE_URL);var u=T({baseUrl:e,source:n.sourceURL,range:n.range}),h=T({baseUrl:e,source:e,range:c});if(h.map=u,l){var d=C(t);d.length&&(h.duration=d[0].duration,h.timeline=d[0].timeline)}else r&&(h.duration=r/o,h.timeline=0);return h.number=0,[h]},N=function(t){var e,i,n=t.attributes,r=t.segmentInfo;if(r.template?(i=O,e=o(n,r.template)):r.base?(i=U,e=o(n,r.base)):r.list&&(i=D,e=o(n,r.list)),!i)return{attributes:n};var a=i(e,r.timeline);if(e.duration){var s=e,c=s.duration,l=s.timescale,u=void 0===l?1:l;e.duration=c/u}else a.length?e.duration=a.reduce(function(t,e){return Math.max(t,Math.ceil(e.duration))},0):e.duration=0;return{attributes:e,segments:a}},B=function(t){return t.map(N)},F=function(t,e){return u(t.childNodes).filter(function(t){var i=t.tagName;return i===e})},z=function(t){return t.textContent.trim()},j=function(t){var e=31536e3,i=2592e3,n=86400,r=3600,a=60,o=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/,s=o.exec(t);if(!s)return 0;var c=s.slice(1),l=c[0],u=c[1],h=c[2],d=c[3],p=c[4],f=c[5];return parseFloat(l||0)*e+parseFloat(u||0)*i+parseFloat(h||0)*n+parseFloat(d||0)*r+parseFloat(p||0)*a+parseFloat(f||0)},H=function(t){var e=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;return e.test(t)&&(t+="Z"),Date.parse(t)},G={mediaPresentationDuration:function(t){return j(t)},availabilityStartTime:function(t){return H(t)/1e3},minimumUpdatePeriod:function(t){return j(t)},timeShiftBufferDepth:function(t){return j(t)},start:function(t){return j(t)},width:function(t){return parseInt(t,10)},height:function(t){return parseInt(t,10)},bandwidth:function(t){return parseInt(t,10)},startNumber:function(t){return parseInt(t,10)},timescale:function(t){return parseInt(t,10)},duration:function(t){var e=parseInt(t,10);return isNaN(e)?j(t):e},d:function(t){return parseInt(t,10)},t:function(t){return parseInt(t,10)},r:function(t){return parseInt(t,10)},DEFAULT:function(t){return t}},V=function(t){return t&&t.attributes?u(t.attributes).reduce(function(t,e){var i=G[e.name]||G.DEFAULT;return t[e.name]=i(e.value),t},{}):{}};function W(t){for(var e=r.a.atob(t),i=new Uint8Array(e.length),n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i}var q={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},Y=function(t,e){return e.length?l(t.map(function(t){return e.map(function(e){return w(t,z(e))})})):t},X=function(t){var e=F(t,"SegmentTemplate")[0],i=F(t,"SegmentList")[0],n=i&&F(i,"SegmentURL").map(function(t){return o({tag:"SegmentURL"},V(t))}),r=F(t,"SegmentBase")[0],a=i||e,s=a&&F(a,"SegmentTimeline")[0],c=i||r||e,l=c&&F(c,"Initialization")[0],u=e&&V(e);u&&l?u.initialization=l&&V(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});var h={template:u,timeline:s&&F(s,"S").map(function(t){return V(t)}),list:i&&o(V(i),{segmentUrls:n,initialization:V(l)}),base:r&&o(V(r),{initialization:V(l)})};return Object.keys(h).forEach(function(t){h[t]||delete h[t]}),h},$=function(t,e,i){return function(n){var r=F(n,"BaseURL"),a=Y(e,r),s=o(t,V(n)),c=X(n);return a.map(function(t){return{segmentInfo:o(i,c),attributes:o(s,{baseUrl:t})}})}},Z=function(t){return t.reduce(function(t,e){var i=V(e),n=q[i.schemeIdUri];if(n){t[n]={attributes:i};var r=F(e,"cenc:pssh")[0];if(r){var a=z(r),o=a&&W(a);t[n].pssh=o}}return t},{})},J=function(t,e,i){return function(n){var r=V(n),a=Y(e,F(n,"BaseURL")),s=F(n,"Role")[0],c={role:V(s)},u=o(t,r,c),h=Z(F(n,"ContentProtection"));Object.keys(h).length&&(u=o(u,{contentProtection:h}));var d=X(n),p=F(n,"Representation"),f=o(i,d);return l(p.map($(u,a,f)))}},K=function(t,e){return function(i,n){var a=Y(e,F(i,"BaseURL")),s=V(i),c=parseInt(s.id,10),u=r.a.isNaN(c)?n:c,h=o(t,{periodIndex:u}),d=F(i,"AdaptationSet"),p=X(i);return l(d.map(J(h,a,p)))}},Q=function(t,e){void 0===e&&(e={});var i=e,n=i.manifestUri,r=void 0===n?"":n,a=i.NOW,o=void 0===a?Date.now():a,s=i.clientOffset,c=void 0===s?0:s,u=F(t,"Period");if(!u.length)throw new Error(R.INVALID_NUMBER_OF_PERIOD);var h=V(t),d=Y([r],F(t,"BaseURL"));return h.sourceDuration=h.mediaPresentationDuration||0,h.NOW=o,h.clientOffset=c,l(u.map(K(h,d)))},tt=function(t){if(""===t)throw new Error(R.DASH_EMPTY_MANIFEST);var e=new r.a.DOMParser,i=e.parseFromString(t,"application/xml"),n=i&&"MPD"===i.documentElement.tagName?i.documentElement:null;if(!n||n&&n.getElementsByTagName("parsererror").length>0)throw new Error(R.DASH_INVALID_XML);return n},et=function(t){var e=F(t,"UTCTiming")[0];if(!e)return null;var i=V(e);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(R.UNSUPPORTED_UTC_TIMING_SCHEME)}return i},it=function(t,e){return y(B(Q(tt(t),e)))},nt=function(t){return et(tt(t))}}).call(this,i("66fa"))},"43f5":function(t,e,i){"use strict";t.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},4531:function(t,e,i){"use strict";var n;n=function(t){var e=t.byteLength,i=0,n=0;this.length=function(){return 8*e},this.bitsAvailable=function(){return 8*e+n},this.loadWord=function(){var r=t.byteLength-e,a=new Uint8Array(4),o=Math.min(4,e);if(0===o)throw new Error("no bytes available");a.set(t.subarray(r,r+o)),i=new DataView(a.buffer).getUint32(0),n=8*o,e-=o},this.skipBits=function(t){var r;n>t?(i<<=t,n-=t):(t-=n,r=Math.floor(t/8),t-=8*r,e-=r,this.loadWord(),i<<=t,n-=t)},this.readBits=function(t){var r=Math.min(n,t),a=i>>>32-r;return n-=r,n>0?i<<=r:e>0&&this.loadWord(),r=t-r,r>0?a<<r|this.readBits(r):a},this.skipLeadingZeros=function(){var t;for(t=0;t<n;++t)if(0!==(i&2147483648>>>t))return i<<=t,n-=t,t;return this.loadWord(),t+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var t=this.skipLeadingZeros();return this.readBits(t+1)-1},this.readExpGolomb=function(){var t=this.readUnsignedExpGolomb();return 1&t?1+t>>>1:-1*(t>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()},t.exports=n},"4e43":function(t,e){var i={"":!0,up:!0};function n(t){if("string"!==typeof t)return!1;var e=i[t.toLowerCase()];return!!e&&t.toLowerCase()}function r(t){return"number"===typeof t&&t>=0&&t<=100}function a(){var t=100,e=3,i=0,a=100,o=0,s=100,c="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!r(e))throw new Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return e},set:function(t){if("number"!==typeof t)throw new TypeError("Lines must be set to a number.");e=t}},regionAnchorY:{enumerable:!0,get:function(){return a},set:function(t){if(!r(t))throw new Error("RegionAnchorX must be between 0 and 100.");a=t}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(t){if(!r(t))throw new Error("RegionAnchorY must be between 0 and 100.");i=t}},viewportAnchorY:{enumerable:!0,get:function(){return s},set:function(t){if(!r(t))throw new Error("ViewportAnchorY must be between 0 and 100.");s=t}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(t){if(!r(t))throw new Error("ViewportAnchorX must be between 0 and 100.");o=t}},scroll:{enumerable:!0,get:function(){return c},set:function(t){var e=n(t);if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");c=e}}})}t.exports=a},"51df":function(t,e,i){"use strict";var n=i("6f40"),r=8589934592,a=4294967296,o=function(t,e){var i=1;t>e&&(i=-1);while(Math.abs(e-t)>a)t+=i*r;return t},s=function(t){var e,i;s.prototype.init.call(this),this.type_=t,this.push=function(t){t.type===this.type_&&(void 0===i&&(i=t.dts),t.dts=o(t.dts,i),t.pts=o(t.pts,i),e=t.dts,this.trigger("data",t))},this.flush=function(){i=e,this.trigger("done")},this.discontinuity=function(){i=void 0,e=void 0}};s.prototype=new n,t.exports={TimestampRolloverStream:s,handleRollover:o}},5409:function(t,e,i){"use strict";var n=i("6f40"),r=i("ce02"),a=function(){a.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new h(0,0),new h(0,1),new h(1,0),new h(1,1)],this.reset(),this.ccStreams_.forEach(function(t){t.on("data",this.trigger.bind(this,"data")),t.on("done",this.trigger.bind(this,"done"))},this)};a.prototype=new n,a.prototype.push=function(t){var e,i,n;if("sei_rbsp"===t.nalUnitType&&(e=r.parseSei(t.escapedRBSP),e.payloadType===r.USER_DATA_REGISTERED_ITU_T_T35&&(i=r.parseUserData(e),i)))if(t.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(t.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));n=r.parseCaptionPackets(t.pts,i),this.captionPackets_=this.captionPackets_.concat(n),this.latestDts_!==t.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=t.dts}},a.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(t,e){t.presortIndex=e}),this.captionPackets_.sort(function(t,e){return t.pts===e.pts?t.presortIndex-e.presortIndex:t.pts-e.pts}),this.captionPackets_.forEach(function(t){t.type<2&&this.dispatchCea608Packet(t)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(t){t.flush()},this)):this.ccStreams_.forEach(function(t){t.flush()},this)},a.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(t){t.reset()})},a.prototype.dispatchCea608Packet=function(t){this.setsChannel1Active(t)?this.activeCea608Channel_[t.type]=0:this.setsChannel2Active(t)&&(this.activeCea608Channel_[t.type]=1),null!==this.activeCea608Channel_[t.type]&&this.ccStreams_[(t.type<<1)+this.activeCea608Channel_[t.type]].push(t)},a.prototype.setsChannel1Active=function(t){return 4096===(30720&t.ccData)},a.prototype.setsChannel2Active=function(t){return 6144===(30720&t.ccData)};var o={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},s=function(t){return null===t?"":(t=o[t]||t,String.fromCharCode(t))},c=14,l=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],u=function(){var t=[],e=c+1;while(e--)t.push("");return t},h=function(t,e){h.prototype.init.call(this),this.field_=t||0,this.dataChannel_=e||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(t){var e,i,n,r,a;if(e=32639&t.ccData,e!==this.lastControlCode_){if(4096===(61440&e)?this.lastControlCode_=e:e!==this.PADDING_&&(this.lastControlCode_=null),n=e>>>8,r=255&e,e!==this.PADDING_)if(e===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(e===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(t.pts),this.flushDisplayed(t.pts),i=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=i,this.startPts_=t.pts;else if(e===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(t.pts);else if(e===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(t.pts);else if(e===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(t.pts);else if(e===this.CARRIAGE_RETURN_)this.clearFormatting(t.pts),this.flushDisplayed(t.pts),this.shiftRowsUp_(),this.startPts_=t.pts;else if(e===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(e===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(t.pts),this.displayed_=u();else if(e===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=u();else if(e===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(t.pts),this.displayed_=u()),this.mode_="paintOn",this.startPts_=t.pts;else if(this.isSpecialCharacter(n,r))n=(3&n)<<8,a=s(n|r),this[this.mode_](t.pts,a),this.column_++;else if(this.isExtCharacter(n,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),n=(3&n)<<8,a=s(n|r),this[this.mode_](t.pts,a),this.column_++;else if(this.isMidRowCode(n,r))this.clearFormatting(t.pts),this[this.mode_](t.pts," "),this.column_++,14===(14&r)&&this.addFormatting(t.pts,["i"]),1===(1&r)&&this.addFormatting(t.pts,["u"]);else if(this.isOffsetControlCode(n,r))this.column_+=3&r;else if(this.isPAC(n,r)){var o=l.indexOf(7968&e);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(t.pts,o)),o!==this.row_&&(this.clearFormatting(t.pts),this.row_=o),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(t.pts,["u"]),16===(16&e)&&(this.column_=4*((14&e)>>1)),this.isColorPAC(r)&&14===(14&r)&&this.addFormatting(t.pts,["i"])}else this.isNormalChar(n)&&(0===r&&(r=null),a=s(n),a+=s(r),this[this.mode_](t.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};h.prototype=new n,h.prototype.flushDisplayed=function(t){var e=this.displayed_.map(function(t){try{return t.trim()}catch(e){return console.error("Skipping malformed caption."),""}}).join("\n").replace(/^\n+|\n+$/g,"");e.length&&this.trigger("data",{startPts:this.startPts_,endPts:t,text:e,stream:this.name_})},h.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=u(),this.nonDisplayed_=u(),this.lastControlCode_=null,this.column_=0,this.row_=c,this.rollUpRows_=2,this.formatting_=[]},h.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},h.prototype.isSpecialCharacter=function(t,e){return t===this.EXT_&&e>=48&&e<=63},h.prototype.isExtCharacter=function(t,e){return(t===this.EXT_+1||t===this.EXT_+2)&&e>=32&&e<=63},h.prototype.isMidRowCode=function(t,e){return t===this.EXT_&&e>=32&&e<=47},h.prototype.isOffsetControlCode=function(t,e){return t===this.OFFSET_&&e>=33&&e<=35},h.prototype.isPAC=function(t,e){return t>=this.BASE_&&t<this.BASE_+8&&e>=64&&e<=127},h.prototype.isColorPAC=function(t){return t>=64&&t<=79||t>=96&&t<=127},h.prototype.isNormalChar=function(t){return t>=32&&t<=127},h.prototype.setRollUp=function(t,e){if("rollUp"!==this.mode_&&(this.row_=c,this.mode_="rollUp",this.flushDisplayed(t),this.nonDisplayed_=u(),this.displayed_=u()),void 0!==e&&e!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[e-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";void 0===e&&(e=this.row_),this.topRow_=e-this.rollUpRows_+1},h.prototype.addFormatting=function(t,e){this.formatting_=this.formatting_.concat(e);var i=e.reduce(function(t,e){return t+"<"+e+">"},"");this[this.mode_](t,i)},h.prototype.clearFormatting=function(t){if(this.formatting_.length){var e=this.formatting_.reverse().reduce(function(t,e){return t+"</"+e+">"},"");this.formatting_=[],this[this.mode_](t,e)}},h.prototype.popOn=function(t,e){var i=this.nonDisplayed_[this.row_];i+=e,this.nonDisplayed_[this.row_]=i},h.prototype.rollUp=function(t,e){var i=this.displayed_[this.row_];i+=e,this.displayed_[this.row_]=i},h.prototype.shiftRowsUp_=function(){var t;for(t=0;t<this.topRow_;t++)this.displayed_[t]="";for(t=this.row_+1;t<c+1;t++)this.displayed_[t]="";for(t=this.topRow_;t<this.row_;t++)this.displayed_[t]=this.displayed_[t+1];this.displayed_[this.row_]=""},h.prototype.paintOn=function(t,e){var i=this.displayed_[this.row_];i+=e,this.displayed_[this.row_]=i},t.exports={CaptionStream:a,Cea608Stream:h}},5498:function(t,e,i){"use strict";var n,r,a,o,s,c=i("595f").toUnsigned;n=function(t,e){var i,a,o,s,l,u=[];if(!e.length)return null;for(i=0;i<t.byteLength;)a=c(t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3]),o=r(t.subarray(i+4,i+8)),s=a>1?i+a:t.byteLength,o===e[0]&&(1===e.length?u.push(t.subarray(i+8,s)):(l=n(t.subarray(i+8,s),e.slice(1)),l.length&&(u=u.concat(l)))),i=s;return u},r=function(t){var e="";return e+=String.fromCharCode(t[0]),e+=String.fromCharCode(t[1]),e+=String.fromCharCode(t[2]),e+=String.fromCharCode(t[3]),e},a=function(t){var e={},i=n(t,["moov","trak"]);return i.reduce(function(t,e){var i,r,a,o,s;return i=n(e,["tkhd"])[0],i?(r=i[0],a=0===r?12:20,o=c(i[a]<<24|i[a+1]<<16|i[a+2]<<8|i[a+3]),s=n(e,["mdia","mdhd"])[0],s?(r=s[0],a=0===r?12:20,t[o]=c(s[a]<<24|s[a+1]<<16|s[a+2]<<8|s[a+3]),t):null):null},e)},o=function(t,e){var i,r,a;return i=n(e,["moof","traf"]),r=[].concat.apply([],i.map(function(e){return n(e,["tfhd"]).map(function(i){var r,a,o;return r=c(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),a=t[r]||9e4,o=n(e,["tfdt"]).map(function(t){var e,i;return e=t[0],i=c(t[4]<<24|t[5]<<16|t[6]<<8|t[7]),1===e&&(i*=Math.pow(2,32),i+=c(t[8]<<24|t[9]<<16|t[10]<<8|t[11])),i})[0],o=o||1/0,o/a})})),a=Math.min.apply(null,r),isFinite(a)?a:0},s=function(t){var e=n(t,["moov","trak"]),i=[];return e.forEach(function(t){var e=n(t,["mdia","hdlr"]),a=n(t,["tkhd"]);e.forEach(function(t,e){var n,o,s,c=r(t.subarray(8,12)),l=a[e];"vide"===c&&(n=new DataView(l.buffer,l.byteOffset,l.byteLength),o=n.getUint8(0),s=0===o?n.getUint32(12):n.getUint32(20),i.push(s))})}),i},t.exports={findBox:n,parseType:r,timescale:a,startTime:o,videoTrackIds:s}},5886:function(t,e){var i=Object.create||function(){function t(){}return function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();function n(t,e){this.name="ParsingError",this.code=t.code,this.message=e||t.message}function r(t){function e(t,e,i,n){return 3600*(0|t)+60*(0|e)+(0|i)+(0|n)/1e3}var i=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?e(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?e(i[1],i[2],0,i[4]):e(0,i[1],i[2],i[4]):null}function a(){this.values=i(null)}function o(t,e,i,n){var r=n?t.split(n):[t];for(var a in r)if("string"===typeof r[a]){var o=r[a].split(i);if(2===o.length){var s=o[0],c=o[1];e(s,c)}}}function s(t,e,i){var s=t;function c(){var e=r(t);if(null===e)throw new n(n.Errors.BadTimeStamp,"Malformed timestamp: "+s);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function l(t,e){var n=new a;o(t,function(t,e){switch(t){case"region":for(var r=i.length-1;r>=0;r--)if(i[r].id===e){n.set(t,i[r].region);break}break;case"vertical":n.alt(t,e,["rl","lr"]);break;case"line":var a=e.split(","),o=a[0];n.integer(t,o),n.percent(t,o)&&n.set("snapToLines",!1),n.alt(t,o,["auto"]),2===a.length&&n.alt("lineAlign",a[1],["start","middle","end"]);break;case"position":a=e.split(","),n.percent(t,a[0]),2===a.length&&n.alt("positionAlign",a[1],["start","middle","end"]);break;case"size":n.percent(t,e);break;case"align":n.alt(t,e,["start","middle","end","left","right"]);break}},/:/,/\s/),e.region=n.get("region",null),e.vertical=n.get("vertical",""),e.line=n.get("line","auto"),e.lineAlign=n.get("lineAlign","start"),e.snapToLines=n.get("snapToLines",!0),e.size=n.get("size",100),e.align=n.get("align","middle"),e.position=n.get("position",{start:0,left:0,middle:50,end:100,right:100},e.align),e.positionAlign=n.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},e.align)}function u(){t=t.replace(/^\s+/,"")}if(u(),e.startTime=c(),u(),"--\x3e"!==t.substr(0,3))throw new n(n.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+s);t=t.substr(3),u(),e.endTime=c(),u(),l(t,e)}n.prototype=i(Error.prototype),n.prototype.constructor=n,n.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},a.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,i){return i?this.has(t)?this.values[t]:e[i]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,i){for(var n=0;n<i.length;++n)if(e===i[n]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e),e>=0&&e<=100))&&(this.set(t,e),!0)}};var c={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"","&rlm;":"","&nbsp;":""},l={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},u={v:"title",lang:"lang"},h={rt:"ruby"};function d(t,e){function i(){if(!e)return null;function t(t){return e=e.substr(t.length),t}var i=e.match(/^([^<]*)(<[^>]*>?)?/);return t(i[1]?i[1]:i[2])}function n(t){return c[t]}function a(t){while(y=t.match(/&(amp|lt|gt|lrm|rlm|nbsp);/))t=t.replace(y[0],n);return t}function o(t,e){return!h[e.localName]||h[e.localName]===t.localName}function s(e,i){var n=l[e];if(!n)return null;var r=t.document.createElement(n);r.localName=n;var a=u[e];return a&&i&&(r[a]=i.trim()),r}var d,p=t.document.createElement("div"),f=p,m=[];while(null!==(d=i()))if("<"!==d[0])f.appendChild(t.document.createTextNode(a(d)));else{if("/"===d[1]){m.length&&m[m.length-1]===d.substr(2).replace(">","")&&(m.pop(),f=f.parentNode);continue}var g,v=r(d.substr(1,d.length-2));if(v){g=t.document.createProcessingInstruction("timestamp",v),f.appendChild(g);continue}var y=d.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!y)continue;if(g=s(y[1],y[3]),!g)continue;if(!o(f,g))continue;y[2]&&(g.className=y[2].substr(1).replace("."," ")),m.push(y[1]),f.appendChild(g),f=g}return p}var p=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function f(t){for(var e=0;e<p.length;e++){var i=p[e];if(t>=i[0]&&t<=i[1])return!0}return!1}function m(t){var e,i=[],n="";if(!t||!t.childNodes)return"ltr";function r(t,e){for(var i=e.childNodes.length-1;i>=0;i--)t.push(e.childNodes[i])}function a(t){if(!t||!t.length)return null;var e=t.pop(),i=e.textContent||e.innerText;if(i){var n=i.match(/^.*(\n|\r)/);return n?(t.length=0,n[0]):i}return"ruby"===e.tagName?a(t):e.childNodes?(r(t,e),a(t)):void 0}r(i,t);while(n=a(i))for(var o=0;o<n.length;o++)if(e=n.charCodeAt(o),f(e))return"rtl";return"ltr"}function g(t){if("number"===typeof t.line&&(t.snapToLines||t.line>=0&&t.line<=100))return t.line;if(!t.track||!t.track.textTrackList||!t.track.textTrackList.mediaElement)return-1;for(var e=t.track,i=e.textTrackList,n=0,r=0;r<i.length&&i[r]!==e;r++)"showing"===i[r].mode&&n++;return-1*++n}function v(){}function y(t,e,i){v.call(this),this.cue=e,this.cueDiv=d(t,e.text);var n={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(n,this.cueDiv),this.div=t.document.createElement("div"),n={direction:m(this.cueDiv),writingMode:""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===e.align?"center":e.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(n),this.div.appendChild(this.cueDiv);var r=0;switch(e.positionAlign){case"start":r=e.position;break;case"middle":r=e.position-e.size/2;break;case"end":r=e.position-e.size;break}""===e.vertical?this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(t){this.applyStyles({top:this.formatStyle(t.top,"px"),bottom:this.formatStyle(t.bottom,"px"),left:this.formatStyle(t.left,"px"),right:this.formatStyle(t.right,"px"),height:this.formatStyle(t.height,"px"),width:this.formatStyle(t.width,"px")})}}function _(t){var e,i,n,r;if(t.div){i=t.div.offsetHeight,n=t.div.offsetWidth,r=t.div.offsetTop;var a=(a=t.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();t=t.div.getBoundingClientRect(),e=a?Math.max(a[0]&&a[0].height||0,t.height/a.length):0}this.left=t.left,this.right=t.right,this.top=t.top||r,this.height=t.height||i,this.bottom=t.bottom||r+(t.height||i),this.width=t.width||n,this.lineHeight=void 0!==e?e:t.lineHeight}function b(t,e,i,n){function r(t,e){for(var r,a=new _(t),o=1,s=0;s<e.length;s++){while(t.overlapsOppositeAxis(i,e[s])||t.within(i)&&t.overlapsAny(n))t.move(e[s]);if(t.within(i))return t;var c=t.intersectPercentage(i);o>c&&(r=new _(t),o=c),t=new _(a)}return r||a}var a=new _(e),o=e.cue,s=g(o),c=[];if(o.snapToLines){var l;switch(o.vertical){case"":c=["+y","-y"],l="height";break;case"rl":c=["+x","-x"],l="width";break;case"lr":c=["-x","+x"],l="width";break}var u=a.lineHeight,h=u*Math.round(s),d=i[l]+u,p=c[0];Math.abs(h)>d&&(h=h<0?-1:1,h*=Math.ceil(d/u)*u),s<0&&(h+=""===o.vertical?i.height:i.width,c=c.reverse()),a.move(p,h)}else{var f=a.lineHeight/i.height*100;switch(o.lineAlign){case"middle":s-=f/2;break;case"end":s-=f;break}switch(o.vertical){case"":e.applyStyles({top:e.formatStyle(s,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(s,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(s,"%")});break}c=["+y","-x","+x","-y"],a=new _(e)}var m=r(a,c);e.move(m.toCSSCompatValues(i))}function w(){}v.prototype.applyStyles=function(t,e){for(var i in e=e||this.div,t)t.hasOwnProperty(i)&&(e.style[i]=t[i])},v.prototype.formatStyle=function(t,e){return 0===t?0:t+e},y.prototype=i(v.prototype),y.prototype.constructor=y,_.prototype.move=function(t,e){switch(e=void 0!==e?e:this.lineHeight,t){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e;break}},_.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top},_.prototype.overlapsAny=function(t){for(var e=0;e<t.length;e++)if(this.overlaps(t[e]))return!0;return!1},_.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right},_.prototype.overlapsOppositeAxis=function(t,e){switch(e){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}},_.prototype.intersectPercentage=function(t){var e=Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left)),i=Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top)),n=e*i;return n/(this.height*this.width)},_.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}},_.getSimpleBoxPosition=function(t){var e=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,i=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,n=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t;var r={left:t.left,right:t.right,top:t.top||n,height:t.height||e,bottom:t.bottom||n+(t.height||e),width:t.width||i};return r},w.StringDecoder=function(){return{decode:function(t){if(!t)return"";if("string"!==typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}},w.convertCueToDOMTree=function(t,e){return t&&e?d(t,e):null};var T=.05,x="sans-serif",S="1.5%";w.processCues=function(t,e,i){if(!t||!e||!i)return null;while(i.firstChild)i.removeChild(i.firstChild);var n=t.document.createElement("div");function r(t){for(var e=0;e<t.length;e++)if(t[e].hasBeenReset||!t[e].displayState)return!0;return!1}if(n.style.position="absolute",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0",n.style.margin=S,i.appendChild(n),r(e)){var a=[],o=_.getSimpleBoxPosition(n),s=Math.round(o.height*T*100)/100,c={font:s+"px "+x};(function(){for(var i,r,s=0;s<e.length;s++)r=e[s],i=new y(t,r,c),n.appendChild(i.div),b(t,i,o,a),r.displayState=i.div,a.push(_.getSimpleBoxPosition(i))})()}else for(var l=0;l<e.length;l++)n.appendChild(e[l].displayState)},w.Parser=function(t,e,i){i||(i=e,e={}),e||(e={}),this.window=t,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]},w.Parser.prototype={reportOrThrowError:function(t){if(!(t instanceof n))throw t;this.onparsingerror&&this.onparsingerror(t)},parse:function(t){var e=this;function i(){var t=e.buffer,i=0;while(i<t.length&&"\r"!==t[i]&&"\n"!==t[i])++i;var n=t.substr(0,i);return"\r"===t[i]&&++i,"\n"===t[i]&&++i,e.buffer=t.substr(i),n}function c(t){var i=new a;if(o(t,function(t,e){switch(t){case"id":i.set(t,e);break;case"width":i.percent(t,e);break;case"lines":i.integer(t,e);break;case"regionanchor":case"viewportanchor":var n=e.split(",");if(2!==n.length)break;var r=new a;if(r.percent("x",n[0]),r.percent("y",n[1]),!r.has("x")||!r.has("y"))break;i.set(t+"X",r.get("x")),i.set(t+"Y",r.get("y"));break;case"scroll":i.alt(t,e,["up"]);break}},/=/,/\s/),i.has("id")){var n=new(e.vttjs.VTTRegion||e.window.VTTRegion);n.width=i.get("width",100),n.lines=i.get("lines",3),n.regionAnchorX=i.get("regionanchorX",0),n.regionAnchorY=i.get("regionanchorY",100),n.viewportAnchorX=i.get("viewportanchorX",0),n.viewportAnchorY=i.get("viewportanchorY",100),n.scroll=i.get("scroll",""),e.onregion&&e.onregion(n),e.regionList.push({id:i.get("id"),region:n})}}function l(t){var i=new a;o(t,function(t,e){switch(t){case"MPEGT":i.integer(t+"S",e);break;case"LOCA":i.set(t+"L",r(e));break}},/[^\d]:/,/,/),e.ontimestampmap&&e.ontimestampmap({MPEGTS:i.get("MPEGTS"),LOCAL:i.get("LOCAL")})}function u(t){t.match(/X-TIMESTAMP-MAP/)?o(t,function(t,e){switch(t){case"X-TIMESTAMP-MAP":l(e);break}},/=/):o(t,function(t,e){switch(t){case"Region":c(e);break}},/:/)}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{var h;if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;h=i();var d=h.match(/^WEBVTT([ \t].*)?$/);if(!d||!d[0])throw new n(n.Errors.BadSignature);e.state="HEADER"}var p=!1;while(e.buffer){if(!/\r\n|\n/.test(e.buffer))return this;switch(p?p=!1:h=i(),e.state){case"HEADER":/:/.test(h)?u(h):h||(e.state="ID");continue;case"NOTE":h||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(h)){e.state="NOTE";break}if(!h)continue;if(e.cue=new(e.vttjs.VTTCue||e.window.VTTCue)(0,0,""),e.state="CUE",-1===h.indexOf("--\x3e")){e.cue.id=h;continue}case"CUE":try{s(h,e.cue,e.regionList)}catch(m){e.reportOrThrowError(m),e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var f=-1!==h.indexOf("--\x3e");if(!h||f&&(p=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+="\n"),e.cue.text+=h;continue;case"BADCUE":h||(e.state="ID");continue}}}catch(m){e.reportOrThrowError(m),"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||"HEADER"===t.state)&&(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new n(n.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}},t.exports=w},"595f":function(t,e){var i=function(t){return t>>>0};t.exports={toUnsigned:i}},"5f3b":function(t,e,i){"use strict";var n,r,a,o,s=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator,l=Object.getPrototypeOf||function(t){return t.__proto__},u=r?l(r):n,h=a?a.constructor:n,d=o?l(o):n,p=o?o():n,f="undefined"===typeof Uint8Array?n:l(Uint8Array),m={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"===typeof ArrayBuffer?n:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"===typeof ArrayBuffer?n:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":c?l([][Symbol.iterator]()):n,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":n,"$ %AsyncFunction%":h,"$ %AsyncFunctionPrototype%":h?h.prototype:n,"$ %AsyncGenerator%":o?l(p):n,"$ %AsyncGeneratorFunction%":d,"$ %AsyncGeneratorPrototype%":d?d.prototype:n,"$ %AsyncIteratorPrototype%":p&&c&&Symbol.asyncIterator?p[Symbol.asyncIterator]():n,"$ %Atomics%":"undefined"===typeof Atomics?n:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"===typeof DataView?n:DataView,"$ %DataViewPrototype%":"undefined"===typeof DataView?n:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"===typeof Float32Array?n:Float32Array,"$ %Float32ArrayPrototype%":"undefined"===typeof Float32Array?n:Float32Array.prototype,"$ %Float64Array%":"undefined"===typeof Float64Array?n:Float64Array,"$ %Float64ArrayPrototype%":"undefined"===typeof Float64Array?n:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":r?l(r()):n,"$ %GeneratorFunction%":u,"$ %GeneratorPrototype%":u?u.prototype:n,"$ %Int8Array%":"undefined"===typeof Int8Array?n:Int8Array,"$ %Int8ArrayPrototype%":"undefined"===typeof Int8Array?n:Int8Array.prototype,"$ %Int16Array%":"undefined"===typeof Int16Array?n:Int16Array,"$ %Int16ArrayPrototype%":"undefined"===typeof Int16Array?n:Int8Array.prototype,"$ %Int32Array%":"undefined"===typeof Int32Array?n:Int32Array,"$ %Int32ArrayPrototype%":"undefined"===typeof Int32Array?n:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":c?l(l([][Symbol.iterator]())):n,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"===typeof Map?n:Map,"$ %MapIteratorPrototype%":"undefined"!==typeof Map&&c?l((new Map)[Symbol.iterator]()):n,"$ %MapPrototype%":"undefined"===typeof Map?n:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"===typeof Promise?n:Promise,"$ %PromisePrototype%":"undefined"===typeof Promise?n:Promise.prototype,"$ %PromiseProto_then%":"undefined"===typeof Promise?n:Promise.prototype.then,"$ %Promise_all%":"undefined"===typeof Promise?n:Promise.all,"$ %Promise_reject%":"undefined"===typeof Promise?n:Promise.reject,"$ %Promise_resolve%":"undefined"===typeof Promise?n:Promise.resolve,"$ %Proxy%":"undefined"===typeof Proxy?n:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"===typeof Reflect?n:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"===typeof Set?n:Set,"$ %SetIteratorPrototype%":"undefined"!==typeof Set&&c?l((new Set)[Symbol.iterator]()):n,"$ %SetPrototype%":"undefined"===typeof Set?n:Set.prototype,"$ %SharedArrayBuffer%":"undefined"===typeof SharedArrayBuffer?n:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"===typeof SharedArrayBuffer?n:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":c?l(""[Symbol.iterator]()):n,"$ %StringPrototype%":String.prototype,"$ %Symbol%":c?Symbol:n,"$ %SymbolPrototype%":c?Symbol.prototype:n,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":s,"$ %TypedArray%":f,"$ %TypedArrayPrototype%":f?f.prototype:n,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"===typeof Uint8Array?n:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"===typeof Uint8Array?n:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"===typeof Uint8ClampedArray?n:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"===typeof Uint8ClampedArray?n:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"===typeof Uint16Array?n:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"===typeof Uint16Array?n:Uint16Array.prototype,"$ %Uint32Array%":"undefined"===typeof Uint32Array?n:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"===typeof Uint32Array?n:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"===typeof WeakMap?n:WeakMap,"$ %WeakMapPrototype%":"undefined"===typeof WeakMap?n:WeakMap.prototype,"$ %WeakSet%":"undefined"===typeof WeakSet?n:WeakSet,"$ %WeakSetPrototype%":"undefined"===typeof WeakSet?n:WeakSet.prototype};t.exports=function(t,e){if(arguments.length>1&&"boolean"!==typeof e)throw new TypeError('"allowMissing" argument must be a boolean');var i="$ "+t;if(!(i in m))throw new SyntaxError("intrinsic "+t+" does not exist!");if("undefined"===typeof m[i]&&!e)throw new TypeError("intrinsic "+t+" exists, but is not available. Please file an issue!");return m[i]}},"644f":function(t,e,i){"use strict";var n,r=i("6f40"),a=i("43f5"),o=function(t,e,i){var n,r="";for(n=e;n<i;n++)r+="%"+("00"+t[n].toString(16)).slice(-2);return r},s=function(t,e,i){return decodeURIComponent(o(t,e,i))},c=function(t,e,i){return unescape(o(t,e,i))},l=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},u={TXXX:function(t){var e;if(3===t.data[0]){for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=s(t.data,1,e),t.value=s(t.data,e+1,t.data.length).replace(/\0*$/,"");break}t.data=t.value}},WXXX:function(t){var e;if(3===t.data[0])for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=s(t.data,1,e),t.url=s(t.data,e+1,t.data.length);break}},PRIV:function(t){var e;for(e=0;e<t.data.length;e++)if(0===t.data[e]){t.owner=c(t.data,0,e);break}t.privateData=t.data.subarray(e+1),t.data=t.privateData}};n=function(t){var e,i={debug:!(!t||!t.debug),descriptor:t&&t.descriptor},r=0,o=[],s=0;if(n.prototype.init.call(this),this.dispatchType=a.METADATA_STREAM_TYPE.toString(16),i.descriptor)for(e=0;e<i.descriptor.length;e++)this.dispatchType+=("00"+i.descriptor[e].toString(16)).slice(-2);this.push=function(t){var e,n,a,c,h,d;if("timed-metadata"===t.type)if(t.dataAlignmentIndicator&&(s=0,o.length=0),0===o.length&&(t.data.length<10||t.data[0]!=="I".charCodeAt(0)||t.data[1]!=="D".charCodeAt(0)||t.data[2]!=="3".charCodeAt(0)))i.debug&&console.log("Skipping unrecognized metadata packet");else if(o.push(t),s+=t.data.byteLength,1===o.length&&(r=l(t.data.subarray(6,10)),r+=10),!(s<r)){for(e={data:new Uint8Array(r),frames:[],pts:o[0].pts,dts:o[0].dts},h=0;h<r;)e.data.set(o[0].data.subarray(0,r-h),h),h+=o[0].data.byteLength,s-=o[0].data.byteLength,o.shift();n=10,64&e.data[5]&&(n+=4,n+=l(e.data.subarray(10,14)),r-=l(e.data.subarray(16,20)));do{if(a=l(e.data.subarray(n+4,n+8)),a<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if(d=String.fromCharCode(e.data[n],e.data[n+1],e.data[n+2],e.data[n+3]),c={id:d,data:e.data.subarray(n+10,n+a+10)},c.key=c.id,u[c.id]&&(u[c.id](c),"com.apple.streaming.transportStreamTimestamp"===c.owner)){var p=c.data,f=(1&p[3])<<30|p[4]<<22|p[5]<<14|p[6]<<6|p[7]>>>2;f*=4,f+=3&p[7],c.timeStamp=f,void 0===e.pts&&void 0===e.dts&&(e.pts=c.timeStamp,e.dts=c.timeStamp),this.trigger("timestamp",c)}e.frames.push(c),n+=10,n+=a}while(n<r);this.trigger("data",e)}}},n.prototype=new r,t.exports=n},"651d":function(t,e,i){var n=i("9921"),r=i("ddbb"),a=9e4,o=function(t){var e,i,n=0;for(e=0;e<t.length;e++)i=t[e],n+=i.data.byteLength;return n},s=function(t,e,i,o){var s,c,l,u=0,h=0,d=0,p=0;if(e.length&&(s=r.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate),u=Math.ceil(a/(t.samplerate/1024)),i&&o&&(h=s-Math.max(i,o),d=Math.floor(h/u),p=d*u),!(d<1||p>a/2))){for(c=n[t.samplerate],c||(c=e[0].data),l=0;l<d;l++)e.splice(l,0,{data:c});t.baseMediaDecodeTime-=Math.floor(r.videoTsToAudioTs(p,t.samplerate))}},c=function(t,e,i){return e.minSegmentDts>=i?t:(e.minSegmentDts=1/0,t.filter(function(t){return t.dts>=i&&(e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),e.minSegmentPts=e.minSegmentDts,!0)}))},l=function(t){var e,i,n=[];for(e=0;e<t.length;e++)i=t[e],n.push({size:i.data.byteLength,duration:1024});return n},u=function(t){var e,i,n=0,r=new Uint8Array(o(t));for(e=0;e<t.length;e++)i=t[e],r.set(i.data,n),n+=i.data.byteLength;return r};t.exports={prefixWithSilence:s,trimAdtsFramesByEarliestDts:c,generateSampleTable:l,concatenateFrameData:u}},"65dd":function(t,e,i){"use strict";var n=i("df3d"),r=i.n(n);r.a},6891:function(t,e){t.exports=function(t){return null===t||"function"!==typeof t&&"object"!==typeof t}},"69c8":function(t,e,i){"use strict";var n=Object.prototype.toString,r=i("6891"),a=i("2b42"),o={"[[DefaultValue]]":function(t){var e;if(e=arguments.length>1?arguments[1]:"[object Date]"===n.call(t)?String:Number,e===String||e===Number){var i,o,s=e===String?["toString","valueOf"]:["valueOf","toString"];for(o=0;o<s.length;++o)if(a(t[s[o]])&&(i=t[s[o]](),r(i)))return i;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")}};t.exports=function(t){return r(t)?t:arguments.length>1?o["[[DefaultValue]]"](t,arguments[1]):o["[[DefaultValue]]"](t)}},"6c83":function(t,e,i){"use strict";var n=Array.prototype.slice,r=i("001b"),a=Object.keys,o=a?function(t){return a(t)}:i("7bce"),s=Object.keys;o.shim=function(){if(Object.keys){var t=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);t||(Object.keys=function(t){return r(t)?s(n.call(t)):s(t)})}else Object.keys=o;return Object.keys||o},t.exports=o},"6d85":function(t,e){t.exports=Number.isNaN||function(t){return t!==t}},"6f40":function(t,e,i){"use strict";var n=function(){this.init=function(){var t={};this.on=function(e,i){t[e]||(t[e]=[]),t[e]=t[e].concat(i)},this.off=function(e,i){var n;return!!t[e]&&(n=t[e].indexOf(i),t[e]=t[e].slice(),t[e].splice(n,1),n>-1)},this.trigger=function(e){var i,n,r,a;if(i=t[e],i)if(2===arguments.length)for(r=i.length,n=0;n<r;++n)i[n].call(this,arguments[1]);else{for(a=[],n=arguments.length,n=1;n<arguments.length;++n)a.push(arguments[n]);for(r=i.length,n=0;n<r;++n)i[n].apply(this,a)}},this.dispose=function(){t={}}}};n.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),t},n.prototype.push=function(t){this.trigger("data",t)},n.prototype.flush=function(t){this.trigger("done",t)},t.exports=n},"71ef":function(t,e,i){"use strict";var n=i("c892"),r=i("dab2");t.exports=function(){var t=r();return n(String.prototype,{trim:t},{trim:function(){return String.prototype.trim!==t}}),t}},"743c":function(t,e,i){"use strict";var n=i("5f3b"),r=n("%TypeError%"),a=n("%SyntaxError%"),o=i("fb81"),s={"Property Descriptor":function(t,e){if("Object"!==t.Type(e))return!1;var i={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in e)if(o(e,n)&&!i[n])return!1;var a=o(e,"[[Value]]"),s=o(e,"[[Get]]")||o(e,"[[Set]]");if(a&&s)throw new r("Property Descriptors may not be both accessor and data descriptors");return!0}};t.exports=function(t,e,i,n){var o=s[e];if("function"!==typeof o)throw new a("unknown record type: "+e);if(!o(t,n))throw new r(i+" must be a "+e);console.log(o(t,n),n)}},"75b6":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAWCAYAAAAvg9c4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkVFRTk3QzE3MUQxOTExRTlBQzc3OTMyM0MyODdFNDFGIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkVFRTk3QzE4MUQxOTExRTlBQzc3OTMyM0MyODdFNDFGIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RUVFOTdDMTUxRDE5MTFFOUFDNzc5MzIzQzI4N0U0MUYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RUVFOTdDMTYxRDE5MTFFOUFDNzc5MzIzQzI4N0U0MUYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5/wai+AAACsklEQVR42oTVa2jNcRzH8fM/neOSY9bYhmWr5TJmUhiSDHFabOUBpsz1gbRonrsUj5RLhAektZVFnogHQ7LIdSKXaAwp9/vcxjYc768+/9PPv2P71au1c/7/7//7/35/39/xEolEKMWKogBzMBED4Om7NjxAA87jS/BmL0XQ3liIpXiDJtzDB/REPiZgNG5jJx53FbQPVmAxjuOsbniHX7qmL4agCCvxTIHvJKNYUEclGrEJ6YHvUonr+u3I9j8PO1kOVQ3tyVvRGup+ncJhFOrev8sNWqr/j+BHoCQjMRXjkBUIfFQlmqFrQxEnuGX6XsV3m1aGuarjV1xGLV6oztbAh5ikHXPdzzQDMXwTf1vNx1o1agtOYjo2or/zcEumE+lupp6y/Y2f+ixHQa1uh/AUV9GM9SjGGZUqoRieW9NWZRjTK9saqGxu6vXatdFv4ZMeGnXeNKrPk0E7NSWZGKvPXuEzxusB/vKbZd9/Rz8MV8Ytwe6fRode2WrzRJ21IGtQjtVYoo3epFItQB7O+dsw4gRtVo0qdGE9Dmo0p2CYam613YeXmqpyveWx/01UD1ThBqqRgzDyUYZiRDRts9GAAxjhxnEz9bTvrC69sA0l6rjf9TRUKvM4slGlezztgn8OFKvLOp1Al3AFg9S4LNU/oQFo0Y6wSZuMR9itnZEMGlczbNvUKbO3qrkFHqztZrvkterarsyL1LxcTVqd3TRNGdpBsl9d9dcYydVcd6hBd20cNWmN+rsMy+0Qt0zrdfEOZ+7t6fM072ENRpsyj2mjW6ATuOBMYLUd3nbRKNTodLc1U69jPyEXNVFWw49qYJ6yL9G5kKmflufqRallukdjVqvur9LpvgHXujhL7S02q4k1KssiK5MFLVDahcrEmrTLH7luVpoaPEsluY+9fwQYAIxWPtuyEeYTAAAAAElFTkSuQmCC"},"75fa":function(t,e){var i=Number.isNaN||function(t){return t!==t};t.exports=Number.isFinite||function(t){return"number"===typeof t&&!i(t)&&t!==1/0&&t!==-1/0}},"774fb":function(t,e,i){"use strict";var n=i("43f5"),r=function(t){var e=31&t[1];return e<<=8,e|=t[2],e},a=function(t){return!!(64&t[1])},o=function(t){var e=0;return(48&t[3])>>>4>1&&(e+=t[4]+1),e},s=function(t,e){var i=r(t);return 0===i?"pat":i===e?"pmt":e?"pes":null},c=function(t){var e=a(t),i=4+o(t);return e&&(i+=t[i]+1),(31&t[i+10])<<8|t[i+11]},l=function(t){var e={},i=a(t),n=4+o(t);if(i&&(n+=t[n]+1),1&t[n+5]){var r,s,c;r=(15&t[n+1])<<8|t[n+2],s=3+r-4,c=(15&t[n+10])<<8|t[n+11];var l=12+c;while(l<s){var u=n+l;e[(31&t[u+1])<<8|t[u+2]]=t[u],l+=5+((15&t[u+3])<<8|t[u+4])}return e}},u=function(t,e){var i=r(t),a=e[i];switch(a){case n.H264_STREAM_TYPE:return"video";case n.ADTS_STREAM_TYPE:return"audio";case n.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},h=function(t){var e=a(t);if(!e)return null;var i=4+o(t);if(i>=t.byteLength)return null;var n,r=null;return n=t[i+7],192&n&&(r={},r.pts=(14&t[i+9])<<27|(255&t[i+10])<<20|(254&t[i+11])<<12|(255&t[i+12])<<5|(254&t[i+13])>>>3,r.pts*=4,r.pts+=(6&t[i+13])>>>1,r.dts=r.pts,64&n&&(r.dts=(14&t[i+14])<<27|(255&t[i+15])<<20|(254&t[i+16])<<12|(255&t[i+17])<<5|(254&t[i+18])>>>3,r.dts*=4,r.dts+=(6&t[i+18])>>>1)),r},d=function(t){switch(t){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},p=function(t){for(var e,i=4+o(t),n=t.subarray(i),r=0,a=0,s=!1;a<n.byteLength-3;a++)if(1===n[a+2]){r=a+5;break}while(r<n.byteLength)switch(n[r]){case 0:if(0!==n[r-1]){r+=2;break}if(0!==n[r-2]){r++;break}a+3!==r-2&&(e=d(31&n[a+3]),"slice_layer_without_partitioning_rbsp_idr"===e&&(s=!0));do{r++}while(1!==n[r]&&r<n.length);a=r-2,r+=3;break;case 1:if(0!==n[r-1]||0!==n[r-2]){r+=3;break}e=d(31&n[a+3]),"slice_layer_without_partitioning_rbsp_idr"===e&&(s=!0),a=r-2,r+=3;break;default:r+=3;break}return n=n.subarray(a),r-=a,a=0,n&&n.byteLength>3&&(e=d(31&n[a+3]),"slice_layer_without_partitioning_rbsp_idr"===e&&(s=!0)),s};t.exports={parseType:s,parsePat:c,parsePmt:l,parsePayloadUnitStartIndicator:a,parsePesType:u,parsePesTime:h,videoPacketContainsKeyFrame:p}},"7bce":function(t,e,i){"use strict";var n;if(!Object.keys){var r=Object.prototype.hasOwnProperty,a=Object.prototype.toString,o=i("001b"),s=Object.prototype.propertyIsEnumerable,c=!s.call({toString:null},"toString"),l=s.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(t){var e=t.constructor;return e&&e.prototype===t},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"===typeof window)return!1;for(var t in window)try{if(!d["$"+t]&&r.call(window,t)&&null!==window[t]&&"object"===typeof window[t])try{h(window[t])}catch(e){return!0}}catch(e){return!0}return!1}(),f=function(t){if("undefined"===typeof window||!p)return h(t);try{return h(t)}catch(e){return!1}};n=function(t){var e=null!==t&&"object"===typeof t,i="[object Function]"===a.call(t),n=o(t),s=e&&"[object String]"===a.call(t),h=[];if(!e&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var d=l&&i;if(s&&t.length>0&&!r.call(t,0))for(var p=0;p<t.length;++p)h.push(String(p));if(n&&t.length>0)for(var m=0;m<t.length;++m)h.push(String(m));else for(var g in t)d&&"prototype"===g||!r.call(t,g)||h.push(String(g));if(c)for(var v=f(t),y=0;y<u.length;++y)v&&"constructor"===u[y]||!r.call(t,u[y])||h.push(u[y]);return h}}t.exports=n},"82c6":function(t,e,i){t.exports={generator:i("f41e"),probe:i("5498"),Transmuxer:i("3daa").Transmuxer,AudioSegmentStream:i("3daa").AudioSegmentStream,VideoSegmentStream:i("3daa").VideoSegmentStream,CaptionParser:i("8733")}},"836d":function(t,e){t.exports=n;var i=Object.prototype.toString;function n(t){var e=i.call(t);return"[object Function]"===e||"function"===typeof t&&"[object RegExp]"!==e||"undefined"!==typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}},8733:function(t,e,i){"use strict";var n=i("ce02").discardEmulationPreventionBytes,r=i("5409").CaptionStream,a=i("5498"),o=i("ca11"),s=function(t,e){for(var i=t,n=0;n<e.length;n++){var r=e[n];if(i<r.size)return r;i-=r.size}return null},c=function(t,e,i){var r,a,o,c,l=new DataView(t.buffer,t.byteOffset,t.byteLength),u=[];for(a=0;a+4<t.length;a+=o)if(o=l.getUint32(a),a+=4,!(o<=0))switch(31&t[a]){case 6:var h=t.subarray(a+1,a+1+o),d=s(a,e);r={nalUnitType:"sei_rbsp",size:o,data:h,escapedRBSP:n(h),trackId:i},d?(r.pts=d.pts,r.dts=d.dts,c=d):(r.pts=c.pts,r.dts=c.dts),u.push(r);break;default:break}return u},l=function(t,e,i){var n=e,r=i.defaultSampleDuration||0,a=i.defaultSampleSize||0,s=i.trackId,c=[];return t.forEach(function(t){var e=o.parseTrun(t),i=e.samples;i.forEach(function(t){void 0===t.duration&&(t.duration=r),void 0===t.size&&(t.size=a),t.trackId=s,t.dts=n,void 0===t.compositionTimeOffset&&(t.compositionTimeOffset=0),t.pts=n+t.compositionTimeOffset,n+=t.duration}),c=c.concat(i)}),c},u=function(t,e){var i=a.findBox(t,["moof","traf"]),n=a.findBox(t,["mdat"]),r={},s=[];return n.forEach(function(t,e){var n=i[e];s.push({mdat:t,traf:n})}),s.forEach(function(t){var i,n,s=t.mdat,u=t.traf,h=a.findBox(u,["tfhd"]),d=o.parseTfhd(h[0]),p=d.trackId,f=a.findBox(u,["tfdt"]),m=f.length>0?o.parseTfdt(f[0]).baseMediaDecodeTime:0,g=a.findBox(u,["trun"]);e===p&&g.length>0&&(i=l(g,m,d),n=c(s,i,p),r[p]||(r[p]=[]),r[p]=r[p].concat(n))}),r},h=function(t,e,i){var n;return e?(n=u(t,e),{seiNals:n[e],timescale:i}):null},d=function(){var t,e,i,n,a,o=!1;this.isInitialized=function(){return o},this.init=function(){t=new r,o=!0,t.on("data",function(t){t.startTime=t.startPts/n,t.endTime=t.endPts/n,a.captions.push(t),a.captionStreams[t.stream]=!0})},this.isNewInit=function(t,e){return!(t&&0===t.length||e&&"object"===typeof e&&0===Object.keys(e).length)&&(i!==t[0]||n!==e[i])},this.parse=function(t,r,o){var s;if(!this.isInitialized())return null;if(!r||!o)return null;if(this.isNewInit(r,o))i=r[0],n=o[i];else if(!i||!n)return e.push(t),null;while(e.length>0){var c=e.shift();this.parse(c,r,o)}return s=h(t,i,n),null!==s&&s.seiNals?(this.pushNals(s.seiNals),this.flushStream(),a):null},this.pushNals=function(e){if(!this.isInitialized()||!e||0===e.length)return null;e.forEach(function(e){t.push(e)})},this.flushStream=function(){if(!this.isInitialized())return null;t.flush()},this.clearParsedCaptions=function(){a.captions=[],a.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;t.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){e=[],i=null,n=null,a?this.clearParsedCaptions():a={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()};t.exports=d},"94f2":function(t,e,i){"use strict";var n,r,a,o=i("6f40"),s=i("4531");r=function(){var t,e,i=0;r.prototype.init.call(this),this.push=function(n){var r;for(e?(r=new Uint8Array(e.byteLength+n.data.byteLength),r.set(e),r.set(n.data,e.byteLength),e=r):e=n.data;i<e.byteLength-3;i++)if(1===e[i+2]){t=i+5;break}while(t<e.byteLength)switch(e[t]){case 0:if(0!==e[t-1]){t+=2;break}if(0!==e[t-2]){t++;break}i+3!==t-2&&this.trigger("data",e.subarray(i+3,t-2));do{t++}while(1!==e[t]&&t<e.length);i=t-2,t+=3;break;case 1:if(0!==e[t-1]||0!==e[t-2]){t+=3;break}this.trigger("data",e.subarray(i+3,t-2)),i=t-2,t+=3;break;default:t+=3;break}e=e.subarray(i),t-=i,i=0},this.flush=function(){e&&e.byteLength>3&&this.trigger("data",e.subarray(i+3)),e=null,i=0,this.trigger("done")}},r.prototype=new o,a={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},n=function(){var t,e,i,o,c,l,u,h=new r;n.prototype.init.call(this),t=this,this.push=function(t){"video"===t.type&&(e=t.trackId,i=t.pts,o=t.dts,h.push(t))},h.on("data",function(n){var r={trackId:e,pts:i,dts:o,data:n};switch(31&n[0]){case 5:r.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:r.nalUnitType="sei_rbsp",r.escapedRBSP=c(n.subarray(1));break;case 7:r.nalUnitType="seq_parameter_set_rbsp",r.escapedRBSP=c(n.subarray(1)),r.config=l(r.escapedRBSP);break;case 8:r.nalUnitType="pic_parameter_set_rbsp";break;case 9:r.nalUnitType="access_unit_delimiter_rbsp";break;default:break}t.trigger("data",r)}),h.on("done",function(){t.trigger("done")}),this.flush=function(){h.flush()},u=function(t,e){var i,n,r=8,a=8;for(i=0;i<t;i++)0!==a&&(n=e.readExpGolomb(),a=(r+n+256)%256),r=0===a?r:a},c=function(t){var e,i,n=t.byteLength,r=[],a=1;while(a<n-2)0===t[a]&&0===t[a+1]&&3===t[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return t;e=n-r.length,i=new Uint8Array(e);var o=0;for(a=0;a<e;o++,a++)o===r[0]&&(o++,r.shift()),i[a]=t[o];return i},l=function(t){var e,i,n,r,o,c,l,h,d,p,f,m,g,v,y=0,_=0,b=0,w=0,T=1;if(e=new s(t),i=e.readUnsignedByte(),r=e.readUnsignedByte(),n=e.readUnsignedByte(),e.skipUnsignedExpGolomb(),a[i]&&(o=e.readUnsignedExpGolomb(),3===o&&e.skipBits(1),e.skipUnsignedExpGolomb(),e.skipUnsignedExpGolomb(),e.skipBits(1),e.readBoolean()))for(f=3!==o?8:12,v=0;v<f;v++)e.readBoolean()&&u(v<6?16:64,e);if(e.skipUnsignedExpGolomb(),c=e.readUnsignedExpGolomb(),0===c)e.readUnsignedExpGolomb();else if(1===c)for(e.skipBits(1),e.skipExpGolomb(),e.skipExpGolomb(),l=e.readUnsignedExpGolomb(),v=0;v<l;v++)e.skipExpGolomb();if(e.skipUnsignedExpGolomb(),e.skipBits(1),h=e.readUnsignedExpGolomb(),d=e.readUnsignedExpGolomb(),p=e.readBits(1),0===p&&e.skipBits(1),e.skipBits(1),e.readBoolean()&&(y=e.readUnsignedExpGolomb(),_=e.readUnsignedExpGolomb(),b=e.readUnsignedExpGolomb(),w=e.readUnsignedExpGolomb()),e.readBoolean()&&e.readBoolean()){switch(g=e.readUnsignedByte(),g){case 1:m=[1,1];break;case 2:m=[12,11];break;case 3:m=[10,11];break;case 4:m=[16,11];break;case 5:m=[40,33];break;case 6:m=[24,11];break;case 7:m=[20,11];break;case 8:m=[32,11];break;case 9:m=[80,33];break;case 10:m=[18,11];break;case 11:m=[15,11];break;case 12:m=[64,33];break;case 13:m=[160,99];break;case 14:m=[4,3];break;case 15:m=[3,2];break;case 16:m=[2,1];break;case 255:m=[e.readUnsignedByte()<<8|e.readUnsignedByte(),e.readUnsignedByte()<<8|e.readUnsignedByte()];break}m&&(T=m[0]/m[1])}return{profileIdc:i,levelIdc:n,profileCompatibility:r,width:Math.ceil((16*(h+1)-2*y-2*_)*T),height:(2-p)*(d+1)*16-2*b-2*w}}},n.prototype=new o,t.exports={H264Stream:n,NalByteStream:r}},9921:function(t,e){var i=[33,16,5,32,164,27],n=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],r=function(t){var e=[];while(t--)e.push(0);return e},a=function(t){return Object.keys(t).reduce(function(e,i){return e[i]=new Uint8Array(t[i].reduce(function(t,e){return t.concat(e)},[])),e},{})},o={96000:[i,[227,64],r(154),[56]],88200:[i,[231],r(170),[56]],64000:[i,[248,192],r(240),[56]],48000:[i,[255,192],r(268),[55,148,128],r(54),[112]],44100:[i,[255,192],r(268),[55,163,128],r(84),[112]],32000:[i,[255,192],r(268),[55,234],r(226),[112]],24000:[i,[255,192],r(268),[55,255,128],r(268),[111,112],r(126),[224]],16000:[i,[255,192],r(268),[55,255,128],r(268),[111,255],r(269),[223,108],r(195),[1,192]],12000:[n,r(268),[3,127,248],r(268),[6,255,240],r(268),[13,255,224],r(268),[27,253,128],r(259),[56]],11025:[n,r(268),[3,127,248],r(268),[6,255,240],r(268),[13,255,224],r(268),[27,255,192],r(268),[55,175,128],r(108),[112]],8000:[n,r(268),[3,121,16],r(47),[7]]};t.exports=a(o)},a49b:function(t,e,i){"use strict";var n,r=i("6f40"),a=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];n=function(){var t;n.prototype.init.call(this),this.push=function(e){var i,n,r,o,s,c,l=0,u=0;if("audio"===e.type){t?(o=t,t=new Uint8Array(o.byteLength+e.data.byteLength),t.set(o),t.set(e.data,o.byteLength)):t=e.data;while(l+5<t.length)if(255===t[l]&&240===(246&t[l+1])){if(n=2*(1&~t[l+1]),i=(3&t[l+3])<<11|t[l+4]<<3|(224&t[l+5])>>5,s=1024*(1+(3&t[l+6])),c=9e4*s/a[(60&t[l+2])>>>2],r=l+i,t.byteLength<r)return;if(this.trigger("data",{pts:e.pts+u*c,dts:e.dts+u*c,sampleCount:s,audioobjecttype:1+(t[l+2]>>>6&3),channelcount:(1&t[l+2])<<2|(192&t[l+3])>>>6,samplerate:a[(60&t[l+2])>>>2],samplingfrequencyindex:(60&t[l+2])>>>2,samplesize:16,data:t.subarray(l+7+n,r)}),t.byteLength===r)return void(t=void 0);u++,t=t.subarray(r)}else l++}},this.flush=function(){this.trigger("done")}},n.prototype=new r,t.exports=n},a95f:function(t,e,i){"use strict";var n="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,a=Object.prototype.toString,o="[object Function]";t.exports=function(t){var e=this;if("function"!==typeof e||a.call(e)!==o)throw new TypeError(n+e);for(var i,s=r.call(arguments,1),c=function(){if(this instanceof i){var n=e.apply(this,s.concat(r.call(arguments)));return Object(n)===n?n:this}return e.apply(t,s.concat(r.call(arguments)))},l=Math.max(0,e.length-s.length),u=[],h=0;h<l;h++)u.push("$"+h);if(i=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(c),e.prototype){var d=function(){};d.prototype=e.prototype,i.prototype=new d,d.prototype=null}return i}},ad12:function(t,e){t.exports=function(t,e){var i=t%e;return Math.floor(i>=0?i:i+e)}},af00:function(t,e){t.exports=function(t){return t>=0?1:-1}},b30d:function(t,e,i){var n,r,a;
/*!
 * Photo Sphere Viewer 3.5.1
 * Copyright (c) 2014-2015 Jrmy Heleine
 * Copyright (c) 2015-2019 Damien "Mistic" Sorel
 * Licensed under MIT (https://opensource.org/licenses/MIT)
 */
/*!
 * Photo Sphere Viewer 3.5.1
 * Copyright (c) 2014-2015 Jrmy Heleine
 * Copyright (c) 2015-2019 Damien "Mistic" Sorel
 * Licensed under MIT (https://opensource.org/licenses/MIT)
 */
(function(o,s){r=[i("011f"),i("e0ad"),i("d5b8")],n=s,a="function"===typeof n?n.apply(e,r):n,void 0===a||(t.exports=a)})(0,function(t,e,i){"use strict";function n(e){if(!(this instanceof n))return new n(e);if(n.SYSTEM.loaded||n._loadSystem(),this.config=M.clone(n.DEFAULTS),M.deepmerge(this.config,e),!e.container)throw new S("No value given for container.");if(!n.SYSTEM.isCanvasSupported)throw new S("Canvas is not supported.");if((!n.SYSTEM.isWebGLSupported||!this.config.webgl)&&!M.checkTHREE("CanvasRenderer","Projector"))throw new S("Missing Three.js components: CanvasRenderer, Projector. Get them from three.js-examples package.");if(this.config.longitude_range&&2!==this.config.longitude_range.length&&(this.config.longitude_range=null,console.warn("PhotoSphereViewer: longitude_range must have exactly two elements.")),this.config.latitude_range?2!==this.config.latitude_range.length?(this.config.latitude_range=null,console.warn("PhotoSphereViewer: latitude_range must have exactly two elements.")):this.config.latitude_range[0]>this.config.latitude_range[1]&&(this.config.latitude_range=[this.config.latitude_range[1],this.config.latitude_range[0]],console.warn("PhotoSphereViewer: latitude_range values must be ordered.")):void 0===this.config.tilt_up_max&&void 0===this.config.tilt_down_max||(this.config.latitude_range=[void 0!==this.config.tilt_down_max?this.config.tilt_down_max-Math.PI/4:-M.HalfPI,void 0!==this.config.tilt_up_max?this.config.tilt_up_max+Math.PI/4:M.HalfPI],console.warn("PhotoSphereViewer: tilt_up_max and tilt_down_max are deprecated, use latitude_range instead.")),this.config.max_fov<this.config.min_fov){var r=this.config.max_fov;this.config.max_fov=this.config.min_fov,this.config.min_fov=r,console.warn("PhotoSphereViewer: max_fov cannot be lower than min_fov.")}this.config.cache_texture&&(!M.isInteger(this.config.cache_texture)||this.config.cache_texture<0)&&(this.config.cache_texture=n.DEFAULTS.cache_texture,console.warn("PhotoSphereViewer: invalid value for cache_texture")),"panorama_roll"in this.config&&(this.config.sphere_correction.roll=this.config.panorama_roll,console.warn("PhotoSphereViewer: panorama_roll is deprecated, use sphere_correction.roll instead")),"gyroscope"in this.config&&console.warn("PhotoSphereViewer: gyroscope is deprecated, the control is automatically created if DeviceOrientationControls.js is loaded"),!0===this.config.keyboard&&(this.config.keyboard=M.clone(n.DEFAULTS.keyboard)),this.config.min_fov=M.bound(this.config.min_fov,1,179),this.config.max_fov=M.bound(this.config.max_fov,1,179),null===this.config.default_fov?this.config.default_fov=this.config.max_fov/2+this.config.min_fov/2:this.config.default_fov=M.bound(this.config.default_fov,this.config.min_fov,this.config.max_fov),null===this.config.anim_lat?this.config.anim_lat=this.config.default_lat:this.config.anim_lat=M.parseAngle(this.config.anim_lat,!0),this.config.longitude_range&&(this.config.longitude_range=this.config.longitude_range.map(function(t){return M.parseAngle(t)})),this.config.latitude_range&&(this.config.latitude_range=this.config.latitude_range.map(function(t){return M.parseAngle(t,!0)})),this.config.anim_speed=M.parseSpeed(this.config.anim_speed),this.config.caption&&!this.config.navbar&&(this.config.navbar=["caption"]),!0===this.config.fisheye?this.config.fisheye=1:!1===this.config.fisheye&&(this.config.fisheye=0),this.parent="string"===typeof e.container?document.getElementById(e.container):e.container,this.container=null,this.loader=null,this.navbar=null,this.hud=null,this.panel=null,this.tooltip=null,this.notification=null,this.overlay=null,this.canvas_container=null,this.renderer=null,this.stereoEffect=null,this.noSleep=null,this.scene=null,this.camera=null,this.mesh=null,this.raycaster=null,this.doControls=null,this.prop={needsUpdate:!0,isCubemap:void 0,position:{longitude:0,latitude:0},ready:!1,direction:null,anim_speed:0,zoom_lvl:0,vFov:0,hFov:0,aspect:0,move_speed:.1,moving:!1,zooming:!1,start_mouse_x:0,start_mouse_y:0,mouse_x:0,mouse_y:0,mouse_history:[],gyro_alpha_offset:0,pinch_dist:0,main_reqid:null,orientation_cb:null,autorotate_cb:null,animation_promise:null,loading_promise:null,start_timeout:null,dblclick_data:null,dblclick_timeout:null,cache:[],size:{width:0,height:0},pano_data:{full_width:0,full_height:0,cropped_width:0,cropped_height:0,cropped_x:0,cropped_y:0}},Object.keys(n.TEMPLATES).forEach(function(t){this.config.templates[t]||(this.config.templates[t]=n.TEMPLATES[t]),"string"===typeof this.config.templates[t]&&(this.config.templates[t]=i.template(this.config.templates[t]))},this),this.parent.photoSphereViewer=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),null!==this.config.size&&this._setViewerSize(this.config.size),this._onResize();var c=(this.config.default_fov-this.config.min_fov)/(this.config.max_fov-this.config.min_fov)*100;this.config.default_zoom_lvl=c-2*(c-50),this.prop.move_speed=t.Math.degToRad(this.config.move_speed/n.SYSTEM.pixelRatio),this.loader=new o(this),this.loader.hide(),this.navbar=new s(this),this.navbar.hide(),this.hud=new a(this),this.hud.hide(),this.panel=new h(this),this.tooltip=new d(this.hud),this.notification=new l(this),this.overlay=new u(this),this._bindEvents(),this.config.panorama&&this.setPanorama(this.config.panorama),this.once("render",function(){this.config.navbar&&(this.container.classList.add("psv-container--has-navbar"),this.navbar.show()),this.hud.show(),this.config.markers&&(this.config.markers.forEach(function(t){this.hud.addMarker(t,!1)},this),this.hud.renderMarkers()),!1!==this.config.time_anim&&(this.prop.start_timeout=window.setTimeout(this.startAutorotate.bind(this),this.config.time_anim)),setTimeout(function(){this._run(),this.trigger("ready")}.bind(this),0)}.bind(this)),n.SYSTEM.touchEnabled.then(function(t){t&&this.container.classList.add("psv-is-touch")}.bind(this))}function r(t){this.psv=t instanceof n?t:t.psv,this.parent=t,this.container=null,this.visible=!0,this.constructor.publicMethods&&this.constructor.publicMethods.forEach(function(t){this.psv[t]=this[t].bind(this)},this)}function a(t){r.call(this,t),this.svgContainer=null,this.markers={},this.currentMarker=null,this.hoveringMarker=null,this.prop={panelOpened:!1,panelOpening:!1,markersButton:this.psv.navbar.getNavbarButton("markers",!0)},this.create()}function o(t){r.call(this,t),this.canvas=null,this.loader=null,this.create()}function s(t){if(r.call(this,t),this.config=this.psv.config.navbar,this.items=[],!0===this.config)this.config=M.clone(n.DEFAULTS.navbar);else if("string"===typeof this.config)this.config=this.config.split(" ");else if(!Array.isArray(this.config)){console.warn('PhotoSphereViewer: hashmap form of "navbar" is deprecated, use an array instead.');var e=this.config;this.config=[],M.forEach(e,function(t,e){t&&this.config.push(e)}.bind(this)),this.config.sort(function(t,e){return n.DEFAULTS.navbar.indexOf(t)-n.DEFAULTS.navbar.indexOf(e)})}this.create()}function c(t,e){r.call(this,t),this.content=null,this.button=null,this.prop={caption:"",width:0},this.create(),this.setCaption(e)}function l(t){r.call(this,t),this.create()}function u(t){r.call(this,t),this.create(),this.hide()}function h(t){r.call(this,t),this.content=null,this.prop={mouse_x:0,mouse_y:0,mousedown:!1,opened:!1},this.create()}function d(t){r.call(this,t),this.config=this.psv.config.tooltip,this.prop={timeout:null},this.create()}function p(t){r.call(this,t),this.id=void 0,this.constructor.id&&(this.id=this.constructor.id),this.enabled=!0}function f(t){p.call(this,t),this.create()}function m(t){p.call(this,t),this.create()}function g(t,e){p.call(this,t),this.config=e,this.config.id&&(this.id=this.config.id),this.create()}function v(t){p.call(this,t),this.create()}function y(t){p.call(this,t),this.create()}function _(t){p.call(this,t),this.create()}function b(t){p.call(this,t),this.create()}function w(t){p.call(this,t),this.create()}function T(t){p.call(this,t),this.zoom_range=null,this.zoom_value=null,this.prop={mousedown:!1,buttondown:!1,longPressInterval:null,longPressTimeout:null},this.create()}function x(t){if(!(this instanceof x))return new x(t);this._cancelled=!1,this._resolved=!1;var e=this;this._promise=new Promise(function(t,i){e._resolve=t,e._reject=i}),t&&(t.easing&&"string"!==typeof t.easing||(t.easing=x.easings[t.easing||"linear"]),this._start=null,this._options=t,t.delay?this._delayTimeout=window.setTimeout(function(){this._delayTimeout=null,window.requestAnimationFrame(this._run.bind(this))}.bind(this),t.delay):window.requestAnimationFrame(this._run.bind(this)))}function S(t){this.message=t,"captureStackTrace"in Error?Error.captureStackTrace(this,S):this.stack=(new Error).stack}function E(t,e){if(!t.id)throw new S("missing marker id");if(t.image&&(!t.width||!t.height))throw new S("missing marker width/height");if((t.image||t.html)&&(!t.hasOwnProperty("x")||!t.hasOwnProperty("y"))&&(!t.hasOwnProperty("latitude")||!t.hasOwnProperty("longitude")))throw new S("missing marker position, latitude/longitude or x/y");this.psv=e,this.visible=!0,this._dynamicSize=!1;var i,n=t.id,r=E.getType(t,!1);Object.defineProperties(this,{id:{configurable:!1,enumerable:!0,get:function(){return n},set:function(){}},type:{configurable:!1,enumerable:!0,get:function(){return r},set:function(){}},$el:{configurable:!1,enumerable:!0,get:function(){return i},set:function(){}},_def:{configurable:!1,enumerable:!0,get:function(){return this[r]},set:function(t){this[r]=t}}}),i=this.isNormal()?document.createElement("div"):this.isPolygon()?document.createElementNS(M.svgNS,"polygon"):this.isPolyline()?document.createElementNS(M.svgNS,"polyline"):document.createElementNS(M.svgNS,this.type),i.id="psv-marker-"+this.id,i.psvMarker=this,this.update(t)}e.mixin(n),n.prototype._run=function(t){this.trigger("before-render",t||+new Date),this.prop.needsUpdate&&(this._render(),this.prop.needsUpdate=!1),this.prop.main_reqid=window.requestAnimationFrame(this._run.bind(this))},n.prototype._render=function(){this.prop.direction=this.sphericalCoordsToVector3(this.prop.position),this.camera.position.set(0,0,0),this.camera.lookAt(this.prop.direction),this.config.fisheye&&this.camera.position.copy(this.prop.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.aspect=this.prop.aspect,this.camera.fov=this.prop.vFov,this.camera.updateProjectionMatrix(),(this.stereoEffect||this.renderer).render(this.scene,this.camera),this.trigger("render")},n.prototype._loadXMP=function(t){return this.config.usexmpdata?new Promise(function(e){var i=0,n=new XMLHttpRequest;this.config.with_credentials&&(n.withCredentials=!0),n.onreadystatechange=function(){if(4===n.readyState){if(200!==n.status&&201!==n.status&&202!==n.status&&0!==n.status)throw this.container.textContent="Cannot load image",new S("Cannot load image");this.loader.setProgress(100);var t=n.responseText,r=t.indexOf("<x:xmpmeta"),a=t.indexOf("</x:xmpmeta>"),o=t.substring(r,a),s=null;-1!==r&&-1!==a&&-1!==o.indexOf("GPano:")&&(s={full_width:parseInt(M.getXMPValue(o,"FullPanoWidthPixels")),full_height:parseInt(M.getXMPValue(o,"FullPanoHeightPixels")),cropped_width:parseInt(M.getXMPValue(o,"CroppedAreaImageWidthPixels")),cropped_height:parseInt(M.getXMPValue(o,"CroppedAreaImageHeightPixels")),cropped_x:parseInt(M.getXMPValue(o,"CroppedAreaLeftPixels")),cropped_y:parseInt(M.getXMPValue(o,"CroppedAreaTopPixels"))},s.full_width&&s.full_height&&s.cropped_width&&s.cropped_height||(console.warn("PhotoSphereViewer: invalid XMP data"),s=null)),e(s)}else 3===n.readyState&&this.loader.setProgress(i+=10)}.bind(this),n.onprogress=function(t){if(t.lengthComputable){var e=parseInt(t.loaded/t.total*100);e>i&&(i=e,this.loader.setProgress(i))}}.bind(this),n.onerror=function(t){throw this.container.textContent="Cannot load image",reject(t),new S("Cannot load image")}.bind(this),n.open("GET",t,!0),n.send(null)}.bind(this)):Promise.resolve(null)},n.prototype._loadTexture=function(t){var e=[];if(Array.isArray(t)){if(6!==t.length)throw new S("Must provide exactly 6 image paths when using cubemap.");for(var i=0;i<6;i++)e[i]=t[n.CUBE_MAP[i]];t=e}else if("object"===typeof t){if(!n.CUBE_HASHMAP.every(function(e){return!!t[e]}))throw new S("Must provide exactly left, front, right, back, top, bottom when using cubemap.");n.CUBE_HASHMAP.forEach(function(i,n){e[n]=t[i]}),t=e}if(Array.isArray(t)){if(!1===this.prop.isCubemap)throw new S("The viewer was initialized with an equirectangular panorama, cannot switch to cubemap.");return this.config.fisheye&&console.warn("PhotoSphereViewer: fisheye effect with cubemap texture can generate distorsions."),this.config.cache_texture===n.DEFAULTS.cache_texture&&(this.config.cache_texture*=6),this.prop.isCubemap=!0,this._loadCubemapTexture(t)}if(!0===this.prop.isCubemap)throw new S("The viewer was initialized with an cubemap, cannot switch to equirectangular panorama.");return this.prop.isCubemap=!1,this._loadEquirectangularTexture(t)},n.prototype._loadEquirectangularTexture=function(e){if(this.config.cache_texture){var i=this.getPanoramaCache(e);if(i)return this.prop.pano_data=i.pano_data,Promise.resolve(i.image)}return this._loadXMP(e).then(function(i){return new Promise(function(r,a){var o=new t.ImageLoader,s=i?100:0;this.config.with_credentials?o.setCrossOrigin("use-credentials"):o.setCrossOrigin("anonymous");var c=function(a){var o;s=100,this.loader.setProgress(s),this.trigger("panorama-load-progress",e,s),!i&&this.config.pano_data&&(i=M.clone(this.config.pano_data)),i||(i={full_width:a.width,full_height:a.height,cropped_width:a.width,cropped_height:a.height,cropped_x:0,cropped_y:0}),this.prop.pano_data=i;var c=Math.min(i.full_width,n.SYSTEM.maxTextureWidth)/i.full_width;if(1!==c||i.cropped_width!==i.full_width||i.cropped_height!==i.full_height){var l=M.clone(i);l.full_width*=c,l.full_height*=c,l.cropped_width*=c,l.cropped_height*=c,l.cropped_x*=c,l.cropped_y*=c,a.width=l.cropped_width,a.height=l.cropped_height;var u=document.createElement("canvas");u.width=l.full_width,u.height=l.full_height;var h=u.getContext("2d");h.drawImage(a,l.cropped_x,l.cropped_y,l.cropped_width,l.cropped_height),o=new t.Texture(u)}else o=new t.Texture(a);o.needsUpdate=!0,o.minFilter=t.LinearFilter,o.generateMipmaps=!1,this.config.cache_texture&&this._putPanoramaCache({panorama:e,image:o,pano_data:i}),r(o)},l=function(t){if(t.lengthComputable){var i=parseInt(t.loaded/t.total*100);i>s&&(s=i,this.loader.setProgress(s),this.trigger("panorama-load-progress",e,s))}},u=function(t){throw this.container.textContent="Cannot load image",a(t),new S("Cannot load image")};o.load(e,c.bind(this),l.bind(this),u.bind(this))}.bind(this))}.bind(this))},n.prototype._loadCubemapTexture=function(e){return new Promise(function(i,r){var a=new t.ImageLoader,o=[0,0,0,0,0,0],s=[],c=0;this.config.with_credentials?a.setCrossOrigin("use-credentials"):a.setCrossOrigin("anonymous");for(var l=function(){s.forEach(function(e){e.needsUpdate=!0,e.minFilter=t.LinearFilter,e.generateMipmaps=!1}),i(s)},u=function(i,r){c++,o[i]=100,this.loader.setProgress(M.sum(o)/6),this.trigger("panorama-load-progress",e[i],o[i]);var a=Math.min(r.width,n.SYSTEM.maxTextureWidth/2)/r.width;if(1!==a){var u=document.createElement("canvas");u.width=r.width*a,u.height=r.height*a;var h=u.getContext("2d");h.drawImage(r,0,0,u.width,u.height),s[i]=new t.Texture(u)}else s[i]=new t.Texture(r);this.config.cache_texture&&this._putPanoramaCache({panorama:e[i],image:s[i]}),6===c&&l()},h=function(t,i){if(i.lengthComputable){var n=parseInt(i.loaded/i.total*100);n>o[t]&&(o[t]=n,this.loader.setProgress(M.sum(o)/6),this.trigger("panorama-load-progress",e[t],o[t]))}},d=function(t,e){throw this.container.textContent="Cannot load image",r(e),new S("Cannot load image "+t)},p=0;p<6;p++){if(this.config.cache_texture){var f=this.getPanoramaCache(e[p]);if(f){c++,o[p]=100,s[p]=f.image;continue}}a.load(e[p],u.bind(this,p),h.bind(this,p),d.bind(this,p))}6===c&&i(s)}.bind(this))},n.prototype._setTexture=function(t){if(this.scene||this._createScene(),this.prop.isCubemap)for(var e=0;e<6;e++)this.mesh.material[e].map&&this.mesh.material[e].map.dispose(),this.mesh.material[e].map=t[e];else this.mesh.material.map&&this.mesh.material.map.dispose(),this.mesh.material.map=t;this.trigger("panorama-loaded"),this._render()},n.prototype._createScene=function(){this.raycaster=new t.Raycaster,this.renderer=n.SYSTEM.isWebGLSupported&&this.config.webgl?new t.WebGLRenderer:new t.CanvasRenderer,this.renderer.setSize(this.prop.size.width,this.prop.size.height),this.renderer.setPixelRatio(n.SYSTEM.pixelRatio);var e=n.SPHERE_RADIUS;this.prop.isCubemap&&(e*=Math.sqrt(3)),this.config.fisheye&&(e+=n.SPHERE_RADIUS),this.camera=new t.PerspectiveCamera(this.config.default_fov,this.prop.size.width/this.prop.size.height,1,e),this.camera.position.set(0,0,0),this.scene=new t.Scene,this.scene.add(this.camera),this.prop.isCubemap?this.mesh=this._createCubemap():this.mesh=this._createSphere(),this.scene.add(this.mesh),this.canvas_container=document.createElement("div"),this.canvas_container.className="psv-canvas-container",this.renderer.domElement.className="psv-canvas",this.container.appendChild(this.canvas_container),this.canvas_container.appendChild(this.renderer.domElement)},n.prototype._createSphere=function(e){e=e||1;var i=new t.SphereGeometry(n.SPHERE_RADIUS*e,n.SPHERE_VERTICES,n.SPHERE_VERTICES,-M.HalfPI),r=new t.MeshBasicMaterial({side:t.DoubleSide,overdraw:n.SYSTEM.isWebGLSupported&&this.config.webgl?0:1}),a=new t.Mesh(i,r);return a.scale.x=-1,a},n.prototype._setSphereCorrection=function(t,e){this.cleanSphereCorrection(e),t.rotation.set(e.tilt,e.pan,e.roll)},n.prototype._createCubemap=function(e){e=e||1;for(var i=new t.BoxGeometry(2*n.SPHERE_RADIUS*e,2*n.SPHERE_RADIUS*e,2*n.SPHERE_RADIUS*e,n.CUBE_VERTICES,n.CUBE_VERTICES,n.CUBE_VERTICES),r=[],a=0;a<6;a++)r.push(new t.MeshBasicMaterial({side:t.BackSide,overdraw:n.SYSTEM.isWebGLSupported&&this.config.webgl?0:1}));var o=new t.Mesh(i,r);return o.position.x-=n.SPHERE_RADIUS*e,o.position.y-=n.SPHERE_RADIUS*e,o.position.z-=n.SPHERE_RADIUS*e,o.applyMatrix((new t.Matrix4).makeScale(1,1,-1)),o},n.prototype._transition=function(e,i){var n,r=this.isExtendedPosition(i),a=void 0!==i.zoom;if(this.prop.isCubemap?(r&&(console.warn("PhotoSphereViewer: cannot perform cubemap transition to different position."),r=!1),n=this._createCubemap(.9),n.material.forEach(function(t,i){t.map=e[i],t.transparent=!0,t.opacity=0})):(n=this._createSphere(.9),n.material.map=e,n.material.transparent=!0,n.material.opacity=0,i.sphere_correction&&this._setSphereCorrection(n,i.sphere_correction)),r){this.cleanPosition(i);var o=new t.Vector3(0,1,0);n.rotateOnWorldAxis(o,i.longitude-this.prop.position.longitude);var s=new t.Vector3(0,1,0).cross(this.camera.getWorldDirection()).normalize();n.rotateOnWorldAxis(s,i.latitude-this.prop.position.latitude),(this.config.latitude_range||this.config.longitude_range)&&(this.config.longitude_range=this.config.latitude_range=null,console.warn("PhotoSphereViewer: trying to perform transition with longitude_range and/or latitude_range, ranges cleared."))}return this.scene.add(n),this.needsUpdate(),new x({properties:{opacity:{start:0,end:1},zoom:a?{start:this.prop.zoom_lvl,end:i.zoom}:void 0},duration:this.config.transition.duration,easing:"outCubic",onTick:function(t){if(this.prop.isCubemap)for(var e=0;e<6;e++)n.material[e].opacity=t.opacity;else n.material.opacity=t.opacity;a&&this.zoom(t.zoom),this.needsUpdate()}.bind(this)}).then(function(){this._setTexture(e),this.scene.remove(n),n.geometry.dispose(),n.geometry=null,r&&this.rotate(i),i.sphere_correction?this._setSphereCorrection(this.mesh,i.sphere_correction):this._setSphereCorrection(this.mesh,{})}.bind(this))},n.prototype._reverseAutorotate=function(){var t=this,e=-this.config.anim_speed,i=this.config.longitude_range;this.config.longitude_range=null,new x({properties:{speed:{start:this.config.anim_speed,end:0}},duration:300,easing:"inSine",onTick:function(e){t.config.anim_speed=e.speed}}).then(function(){return new x({properties:{speed:{start:0,end:e}},duration:300,easing:"outSine",onTick:function(e){t.config.anim_speed=e.speed}})}).then(function(){t.config.longitude_range=i,t.config.anim_speed=e})},n.prototype._putPanoramaCache=function(t){if(!this.config.cache_texture)throw new S("Cannot add panorama to cache, cache_texture is disabled");var e=this.getPanoramaCache(t.panorama);e?(e.image=t.image,e.pano_data=t.pano_data):(this.prop.cache=this.prop.cache.slice(0,this.config.cache_texture-1),this.prop.cache.unshift(t)),this.trigger("panorama-cached",t.panorama)},n.prototype._stopAll=function(){this.stopAutorotate(),this.stopAnimation(),this.stopGyroscopeControl(),this.stopStereoView()},n.MOVE_THRESHOLD=4,n.ANGLE_THRESHOLD=.003,n.DBLCLICK_DELAY=300,n.INERTIA_WINDOW=300,n.SPHERE_RADIUS=100,n.SPHERE_VERTICES=64,n.CUBE_VERTICES=8,n.CUBE_MAP=[0,2,4,5,3,1],n.CUBE_HASHMAP=["left","right","top","bottom","back","front"],n.SYSTEM={loaded:!1,pixelRatio:1,isWebGLSupported:!1,isCanvasSupported:!1,deviceOrientationSupported:null,maxTextureWidth:0,mouseWheelEvent:null,fullscreenEvent:null},n.ICONS={},n.DEFAULTS={panorama:null,container:null,caption:null,usexmpdata:!0,pano_data:null,webgl:!0,min_fov:30,max_fov:90,default_fov:null,default_long:0,default_lat:0,sphere_correction:{pan:0,tilt:0,roll:0},longitude_range:null,latitude_range:null,move_speed:1,zoom_speed:2,time_anim:2e3,anim_speed:"2rpm",anim_lat:null,fisheye:!1,navbar:["autorotate","zoom","download","markers","caption","gyroscope","stereo","fullscreen"],tooltip:{offset:5,arrow_size:7,delay:100},lang:{autorotate:"Automatic rotation",zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",download:"Download",fullscreen:"Fullscreen",markers:"Markers",gyroscope:"Gyroscope",stereo:"Stereo view",stereo_notification:"Click anywhere to exit stereo view.",please_rotate:["Please rotate your device","(or tap to continue)"],two_fingers:["Use two fingers to navigate"]},mousewheel:!0,mousewheel_factor:1,mousemove:!0,mousemove_hover:!1,touchmove_two_fingers:!1,keyboard:{ArrowUp:"rotateLatitudeUp",ArrowDown:"rotateLatitudeDown",ArrowRight:"rotateLongitudeRight",ArrowLeft:"rotateLongitudeLeft",PageUp:"zoomIn",PageDown:"zoomOut","+":"zoomIn","-":"zoomOut"," ":"toggleAutorotate"},move_inertia:!0,click_event_on_marker:!1,transition:{duration:1500,loader:!0},loading_img:null,loading_txt:"Loading...",size:null,cache_texture:0,templates:{},markers:[],with_credentials:!1},n.TEMPLATES={markersList:'<div class="psv-markers-list-container">   <h1 class="psv-markers-list-title">{{= it.config.lang.markers }}</h1>   <ul class="psv-markers-list">   {{~ it.markers: marker }}     <li data-psv-marker="{{= marker.id }}" class="psv-markers-list-item {{? marker.className }}{{= marker.className }}{{?}}">       {{? marker.image }}<img class="psv-markers-list-image" src="{{= marker.image }}"/>{{?}}       <p class="psv-markers-list-name">{{? marker.tooltip }}{{= marker.tooltip.content }}{{?? marker.html }}{{= marker.html }}{{??}}{{= marker.id }}{{?}}</p>     </li>   {{~}}   </ul> </div>'},n.prototype._bindEvents=function(){window.addEventListener("resize",this),this.config.mousemove&&(this.hud.container.style.cursor="move",this.config.mousemove_hover?(this.hud.container.addEventListener("mouseenter",this),this.hud.container.addEventListener("mouseleave",this)):(this.hud.container.addEventListener("mousedown",this),window.addEventListener("mouseup",this)),this.hud.container.addEventListener("touchstart",this),window.addEventListener("touchend",this),this.hud.container.addEventListener("mousemove",this),this.hud.container.addEventListener("touchmove",this)),n.SYSTEM.fullscreenEvent&&document.addEventListener(n.SYSTEM.fullscreenEvent,this),this.config.mousewheel&&this.hud.container.addEventListener(n.SYSTEM.mouseWheelEvent,this),this.on("_side-reached",function(t){this.isAutorotateEnabled()&&("left"!==t&&"right"!==t||this._reverseAutorotate())})},n.prototype._unbindEvents=function(){window.removeEventListener("resize",this),this.config.mousemove&&(this.hud.container.removeEventListener("mousedown",this),this.hud.container.removeEventListener("mouseenter",this),this.hud.container.removeEventListener("touchstart",this),window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this),this.hud.container.removeEventListener("mouseleave",this),this.hud.container.removeEventListener("mousemove",this),this.hud.container.removeEventListener("touchmove",this)),n.SYSTEM.fullscreenEvent&&document.removeEventListener(n.SYSTEM.fullscreenEvent,this),this.config.mousewheel&&this.hud.container.removeEventListener(n.SYSTEM.mouseWheelEvent,this),this.off("_side-reached")},n.prototype.handleEvent=function(t){switch(t.type){case"resize":M.throttle(this._onResize(),50);break;case"keydown":this._onKeyDown(t);break;case"mousedown":this._onMouseDown(t);break;case"mouseenter":this._onMouseDown(t);break;case"touchstart":this._onTouchStart(t);break;case"mouseup":this._onMouseUp(t);break;case"mouseleave":this._onMouseUp(t);break;case"touchend":this._onTouchEnd(t);break;case"mousemove":this._onMouseMove(t);break;case"touchmove":this._onTouchMove(t);break;case n.SYSTEM.fullscreenEvent:this._fullscreenToggled();break;case n.SYSTEM.mouseWheelEvent:this._onMouseWheel(t);break}},n.prototype._onResize=function(){this.container.clientWidth===this.prop.size.width&&this.container.clientHeight===this.prop.size.height||(this.prop.size.width=parseInt(this.container.clientWidth),this.prop.size.height=parseInt(this.container.clientHeight),this.prop.aspect=this.prop.size.width/this.prop.size.height,this.needsUpdate(),this.renderer&&(this.stereoEffect||this.renderer).setSize(this.prop.size.width,this.prop.size.height),this.trigger("size-updated",this.getSize()))},n.prototype._onKeyDown=function(t){var e=0,i=0,n=0,r=M.getEventKey(t),a=this.config.keyboard[r];switch(a){case"rotateLatitudeUp":i=.01;break;case"rotateLatitudeDown":i=-.01;break;case"rotateLongitudeRight":e=.01;break;case"rotateLongitudeLeft":e=-.01;break;case"zoomIn":n=1;break;case"zoomOut":n=-1;break;case"toggleAutorotate":this.toggleAutorotate();break}0!==n?this.zoom(this.prop.zoom_lvl+n*this.config.zoom_speed):0===i&&0===e||this.rotate({longitude:this.prop.position.longitude+e*this.prop.move_speed*this.prop.hFov,latitude:this.prop.position.latitude+i*this.prop.move_speed*this.prop.vFov})},n.prototype._onMouseDown=function(t){this._startMove(t)},n.prototype._onMouseUp=function(t){this._stopMove(t),this.isStereoEnabled()&&this.stopStereoView()},n.prototype._onMouseMove=function(t){0!==t.buttons?(t.preventDefault(),this._move(t)):this.config.mousemove_hover&&this._moveAbsolute(t)},n.prototype._onTouchStart=function(t){1===t.touches.length?this.config.touchmove_two_fingers||this._startMove(t.touches[0]):2===t.touches.length&&this._startMoveZoom(t)},n.prototype._onTouchEnd=function(t){1===t.touches.length?this._stopMoveZoom():0===t.touches.length&&(this._stopMove(t.changedTouches[0]),this.config.touchmove_two_fingers&&this.overlay.hideOverlay())},n.prototype._onTouchMove=function(t){1===t.touches.length?this.config.touchmove_two_fingers?this.overlay.showOverlay({image:n.ICONS["gesture.svg"],text:this.config.lang.two_fingers[0]}):(t.preventDefault(),this._move(t.touches[0])):2===t.touches.length&&(t.preventDefault(),this._moveZoom(t))},n.prototype._startMove=function(t){this.stopAutorotate(),this.stopAnimation().then(function(){this.prop.mouse_x=this.prop.start_mouse_x=parseInt(t.clientX),this.prop.mouse_y=this.prop.start_mouse_y=parseInt(t.clientY),this.prop.moving=!0,this.prop.zooming=!1,this.prop.mouse_history.length=0,this._logMouseMove(t)}.bind(this))},n.prototype._startMoveZoom=function(t){var e=[{x:parseInt(t.touches[0].clientX),y:parseInt(t.touches[0].clientY)},{x:parseInt(t.touches[1].clientX),y:parseInt(t.touches[1].clientY)}];this.prop.pinch_dist=Math.sqrt(Math.pow(e[0].x-e[1].x,2)+Math.pow(e[0].y-e[1].y,2)),this.prop.mouse_x=this.prop.start_mouse_x=(e[0].x+e[1].x)/2,this.prop.mouse_y=this.prop.start_mouse_x=(e[0].y+e[1].y)/2,this.prop.moving=!0,this.prop.zooming=!0},n.prototype._stopMove=function(t){M.getClosest(t.target,".psv-hud")&&this.prop.moving&&(Math.abs(t.clientX-this.prop.start_mouse_x)<n.MOVE_THRESHOLD&&Math.abs(t.clientY-this.prop.start_mouse_y)<n.MOVE_THRESHOLD?(this._click(t),this.prop.moving=!1):this.config.move_inertia&&!this.isGyroscopeEnabled()?(this._logMouseMove(t),this._stopMoveInertia(t)):this.prop.moving=!1,this.prop.mouse_history.length=0)},n.prototype._stopMoveZoom=function(){this.prop.mouse_history.length=0,this.prop.moving=!1,this.prop.zooming=!1},n.prototype._stopMoveInertia=function(t){var e={x:t.clientX-this.prop.mouse_history[0][1],y:t.clientY-this.prop.mouse_history[0][2]},i=Math.sqrt(e.x*e.x+e.y*e.y);this.prop.animation_promise=new x({properties:{clientX:{start:t.clientX,end:t.clientX+e.x},clientY:{start:t.clientY,end:t.clientY+e.y}},duration:i*n.INERTIA_WINDOW/100,easing:"outCirc",onTick:function(t){this._move(t,!1)}.bind(this)}).finally(function(){this.prop.moving=!1}.bind(this))},n.prototype._click=function(t){var e=this.container.getBoundingClientRect(),i={target:t.target,client_x:t.clientX,client_y:t.clientY,viewer_x:parseInt(t.clientX-e.left),viewer_y:parseInt(t.clientY-e.top)},r=this.viewerCoordsToVector3({x:i.viewer_x,y:i.viewer_y});if(r){var a=this.vector3ToSphericalCoords(r);if(i.longitude=a.longitude,i.latitude=a.latitude,!this.prop.isCubemap){var o=this.sphericalCoordsToTextureCoords({longitude:i.longitude,latitude:i.latitude});i.texture_x=o.x,i.texture_y=o.y}this.prop.dblclick_timeout?(Math.abs(this.prop.dblclick_data.client_x-i.client_x)<n.MOVE_THRESHOLD&&Math.abs(this.prop.dblclick_data.client_y-i.client_y)<n.MOVE_THRESHOLD&&this.trigger("dblclick",this.prop.dblclick_data),clearTimeout(this.prop.dblclick_timeout),this.prop.dblclick_timeout=null,this.prop.dblclick_data=null):(this.trigger("click",i),this.prop.dblclick_data=M.clone(i),this.prop.dblclick_timeout=setTimeout(function(){this.prop.dblclick_timeout=null,this.prop.dblclick_data=null}.bind(this),n.DBLCLICK_DELAY))}},n.prototype._move=function(t,e){if(this.prop.moving){var i=parseInt(t.clientX),r=parseInt(t.clientY),a={longitude:(i-this.prop.mouse_x)/this.prop.size.width*this.prop.move_speed*this.prop.hFov*n.SYSTEM.pixelRatio,latitude:(r-this.prop.mouse_y)/this.prop.size.height*this.prop.move_speed*this.prop.vFov*n.SYSTEM.pixelRatio};this.isGyroscopeEnabled()?this.prop.gyro_alpha_offset+=a.longitude:this.rotate({longitude:this.prop.position.longitude-a.longitude,latitude:this.prop.position.latitude+a.latitude}),this.prop.mouse_x=i,this.prop.mouse_y=r,!1!==e&&this._logMouseMove(t)}},n.prototype._moveAbsolute=function(t){this.prop.moving&&this.rotate({longitude:((t.clientX-this.container.offsetLeft)/this.container.offsetWidth-.5)*M.TwoPI,latitude:-((t.clientY-this.container.offsetTop)/this.container.offsetHeight-.5)*Math.PI})},n.prototype._moveZoom=function(t){if(this.prop.zooming&&this.prop.moving){var e=[{x:parseInt(t.touches[0].clientX),y:parseInt(t.touches[0].clientY)},{x:parseInt(t.touches[1].clientX),y:parseInt(t.touches[1].clientY)}],i=Math.sqrt(Math.pow(e[0].x-e[1].x,2)+Math.pow(e[0].y-e[1].y,2)),n=80*(i-this.prop.pinch_dist)/this.prop.size.width;this.zoom(this.prop.zoom_lvl+n),this._move({clientX:(e[0].x+e[1].x)/2,clientY:(e[0].y+e[1].y)/2}),this.prop.pinch_dist=i}},n.prototype._onMouseWheel=function(t){t.preventDefault(),t.stopPropagation();var e=5*M.normalizeWheel(t).spinY;0!==e&&this.zoom(this.prop.zoom_lvl-e*this.config.mousewheel_factor)},n.prototype._fullscreenToggled=function(){var t=this.isFullscreenEnabled();this.config.keyboard&&(t?this.startKeyboardControl():this.stopKeyboardControl()),this.trigger("fullscreen-updated",t)},n.prototype._logMouseMove=function(t){var e=Date.now();this.prop.mouse_history.push([e,t.clientX,t.clientY]);for(var i=null,r=0;r<this.prop.mouse_history.length;)this.prop.mouse_history[0][r]<e-n.INERTIA_WINDOW?this.prop.mouse_history.splice(r,1):i&&this.prop.mouse_history[0][r]-i>n.INERTIA_WINDOW/10?(this.prop.mouse_history.splice(0,r),r=0,i=this.prop.mouse_history[0][r]):(r++,i=this.prop.mouse_history[0][r])},n.prototype.load=function(){if(!this.config.panorama)throw new S("No value given for panorama.");return this.setPanorama(this.config.panorama,!1)},n.prototype.getPosition=function(){return{longitude:this.prop.position.longitude,latitude:this.prop.position.latitude}},n.prototype.getZoomLevel=function(){return this.prop.zoom_lvl},n.prototype.getSize=function(){return{width:this.prop.size.width,height:this.prop.size.height}},n.prototype.isAutorotateEnabled=function(){return!!this.prop.autorotate_cb},n.prototype.isGyroscopeEnabled=function(){return!!this.prop.orientation_cb},n.prototype.isStereoEnabled=function(){return!!this.stereoEffect},n.prototype.isFullscreenEnabled=function(){return M.isFullscreenEnabled(this.container)},n.prototype.needsUpdate=function(){this.prop.needsUpdate=!0},n.prototype.render=function(){this._render()},n.prototype.destroy=function(){window.cancelAnimationFrame(this.prop.main_reqid),this._stopAll(),this.stopKeyboardControl(),this.stopNoSleep(),this.exitFullscreen(),this.unlockOrientation(),this._unbindEvents(),this.tooltip&&this.tooltip.destroy(),this.notification&&this.notification.destroy(),this.hud&&this.hud.destroy(),this.loader&&this.loader.destroy(),this.navbar&&this.navbar.destroy(),this.panel&&this.panel.destroy(),this.overlay&&this.overlay.destroy(),this.scene&&M.cleanTHREEScene(this.scene),this.canvas_container&&this.container.removeChild(this.canvas_container),this.parent.removeChild(this.container),delete this.parent.photoSphereViewer,delete this.parent,delete this.container,delete this.loader,delete this.navbar,delete this.hud,delete this.panel,delete this.tooltip,delete this.notification,delete this.overlay,delete this.canvas_container,delete this.renderer,delete this.noSleep,delete this.scene,delete this.camera,delete this.mesh,delete this.raycaster,delete this.passes,delete this.config,this.prop.cache.length=0},n.prototype.setPanorama=function(t,e,i){if(null!==this.prop.loading_promise)throw new S("Loading already in progress");"boolean"===typeof e&&(i=e,e=void 0),e||this.scene?e||(e={}):e={longitude:this.config.default_long,latitude:this.config.default_lat,zoom:this.config.default_zoom_lvl,sphere_correction:this.config.sphere_correction};var n=this.isExtendedPosition(e),r="zoom"in e;(n||r)&&this._stopAll(),this.config.panorama=t;var a=function(){this.loader.hide(),this.canvas_container.style.opacity=1,this.prop.loading_promise=null}.bind(this);return i&&this.config.transition&&this.scene?(this.config.transition.loader&&this.loader.show(),this.prop.loading_promise=this._loadTexture(this.config.panorama).then(function(t){return this.loader.hide(),this._transition(t,e)}.bind(this)).then(a,a)):(this.loader.show(),this.canvas_container&&(this.canvas_container.style.opacity=0),this.prop.loading_promise=this._loadTexture(this.config.panorama).then(function(t){this._setTexture(t),e.sphere_correction&&!this.prop.isCubemap&&this._setSphereCorrection(this.mesh,e.sphere_correction),n&&this.rotate(e),r&&this.zoom(e.zoom)}.bind(this)).then(a,a)),this.prop.loading_promise},n.prototype.startAutorotate=function(){this._stopAll(),this.prop.autorotate_cb=this._getAutorotateUpdate(),this.on("before-render",this.prop.autorotate_cb),this.trigger("autorotate",!0)},n.prototype._getAutorotateUpdate=function(){var t,e;return function(i){e=void 0===t?0:i-t,t=i,this.rotate({longitude:this.prop.position.longitude+this.config.anim_speed*e/1e3,latitude:this.prop.position.latitude-(this.prop.position.latitude-this.config.anim_lat)/200})}},n.prototype.stopAutorotate=function(){this.prop.start_timeout&&(window.clearTimeout(this.prop.start_timeout),this.prop.start_timeout=null),this.isAutorotateEnabled()&&(this.off("before-render",this.prop.autorotate_cb),this.prop.autorotate_cb=null,this.trigger("autorotate",!1))},n.prototype.toggleAutorotate=function(){this.isAutorotateEnabled()?this.stopAutorotate():this.startAutorotate()},n.prototype.startGyroscopeControl=function(){if(M.checkTHREE("DeviceOrientationControls"))return n.SYSTEM.deviceOrientationSupported.then(function(e){if(!e)return console.warn("PhotoSphereViewer: gyroscope not available"),Promise.reject();this._stopAll(),this.doControls=new t.DeviceOrientationControls(this.camera),this.doControls.alphaOffset=this.prop.position.longitude,this.doControls.update();var i=this.camera.getWorldDirection(new t.Vector3),n=this.vector3ToSphericalCoords(i);this.prop.gyro_alpha_offset=n.longitude,this.prop.orientation_cb=this._getOrientationUpdate(),this.on("before-render",this.prop.orientation_cb),this.trigger("gyroscope-updated",!0)}.bind(this));throw new S("Missing Three.js components: DeviceOrientationControls. Get them from three.js-examples package.")},n.prototype._getOrientationUpdate=function(){return function(){this.doControls.alphaOffset=this.prop.gyro_alpha_offset,this.doControls.update(),this.camera.getWorldDirection(this.prop.direction),this.prop.direction.multiplyScalar(n.SPHERE_RADIUS);var t=this.vector3ToSphericalCoords(this.prop.direction);this.prop.position.longitude=t.longitude,this.prop.position.latitude=t.latitude,this.needsUpdate()}},n.prototype.stopGyroscopeControl=function(){this.isGyroscopeEnabled()&&(this.off("before-render",this.prop.orientation_cb),this.prop.orientation_cb=null,this.doControls.disconnect(),this.doControls=null,this.trigger("gyroscope-updated",!1))},n.prototype.toggleGyroscopeControl=function(){this.isGyroscopeEnabled()?this.stopGyroscopeControl():this.startGyroscopeControl()},n.prototype.startNoSleep=function(){"NoSleep"in window?(this.noSleep||(this.noSleep=new NoSleep),this.noSleep.enable()):console.warn("PhotoSphereViewer: NoSleep is not available")},n.prototype.stopNoSleep=function(){this.noSleep&&this.noSleep.disable()},n.prototype.startStereoView=function(){if(!M.checkTHREE("DeviceOrientationControls","StereoEffect"))throw new S("Missing Three.js components: StereoEffect, DeviceOrientationControls. Get them from three.js-examples package.");this.startNoSleep(),this.enterFullscreen(),this.lockOrientation(),this.startGyroscopeControl().then(function(){this.stereoEffect=new t.StereoEffect(this.renderer),this.needsUpdate(),this.hud.hide(),this.navbar.hide(),this.panel.hidePanel(),this.trigger("stereo-updated",!0),this.notification.showNotification({content:this.config.lang.stereo_notification,timeout:3e3})}.bind(this),function(){this.unlockOrientation(),this.exitFullscreen(),this.stopNoSleep()}.bind(this))},n.prototype.stopStereoView=function(){this.isStereoEnabled()&&(this.stereoEffect=null,this.needsUpdate(),this.hud.show(),this.navbar.show(),this.unlockOrientation(),this.exitFullscreen(),this.stopNoSleep(),this.stopGyroscopeControl(),this.trigger("stereo-updated",!1))},n.prototype.lockOrientation=function(){var t,e=function(){this.isStereoEnabled()&&window.innerHeight>window.innerWidth&&this.overlay.showOverlay({image:n.ICONS["mobile-rotate.svg"],text:this.config.lang.please_rotate[0],subtext:this.config.lang.please_rotate[1]}),t&&window.clearTimeout(t)};window.screen&&window.screen.orientation?(window.screen.orientation.lock("landscape").then(null,e.bind(this)),t=setTimeout(e.bind(this),500)):e.apply(this)},n.prototype.unlockOrientation=function(){window.screen&&window.screen.orientation?window.screen.orientation.unlock():this.overlay.hideOverlay()},n.prototype.toggleStereoView=function(){this.isStereoEnabled()?this.stopStereoView():this.startStereoView()},n.prototype.rotate=function(t,e){this.cleanPosition(t),e||this.applyRanges(t).forEach(this.trigger.bind(this,"_side-reached")),this.prop.position.longitude=t.longitude,this.prop.position.latitude=t.latitude,this.needsUpdate(),this.trigger("position-updated",this.getPosition())},n.prototype.animate=function(t,e){this._stopAll();var i,r=this.isExtendedPosition(t),a="zoom"in t,o={};if(r){this.cleanPosition(t),this.applyRanges(t);var s=this.prop.position,c=Math.abs(t.longitude-s.longitude),l=Math.abs(t.latitude-s.latitude);if(c>=n.ANGLE_THRESHOLD||l>=n.ANGLE_THRESHOLD){var u=M.getShortestArc(this.prop.position.longitude,t.longitude);o.longitude={start:s.longitude,end:s.longitude+u},o.latitude={start:s.latitude,end:t.latitude},i=this.speedToDuration(e,M.getAngle(s,t))}}if(a){var h=Math.abs(t.zoom-this.prop.zoom_lvl);h>=1&&(o.zoom={start:this.prop.zoom_lvl,end:t.zoom},i||(i=this.speedToDuration(e,Math.PI/4*h/100)))}return i?(this.prop.animation_promise=new x({properties:o,duration:i,easing:"inOutSine",onTick:function(t){r&&this.rotate(t,!0),a&&this.zoom(t.zoom)}.bind(this)}),this.prop.animation_promise):(r&&this.rotate(t),a&&this.zoom(t.zoom),x.resolve())},n.prototype.stopAnimation=function(){return this.prop.animation_promise?new Promise(function(t){this.prop.animation_promise.finally(t),this.prop.animation_promise.cancel(),this.prop.animation_promise=null}.bind(this)):Promise.resolve()},n.prototype.zoom=function(e){this.prop.zoom_lvl=M.bound(e,0,100),this.prop.vFov=this.config.max_fov+this.prop.zoom_lvl/100*(this.config.min_fov-this.config.max_fov),this.prop.hFov=t.Math.radToDeg(2*Math.atan(Math.tan(t.Math.degToRad(this.prop.vFov)/2)*this.prop.aspect)),this.needsUpdate(),this.trigger("zoom-updated",this.getZoomLevel())},n.prototype.zoomIn=function(){this.prop.zoom_lvl<100&&this.zoom(this.prop.zoom_lvl+this.config.zoom_speed)},n.prototype.zoomOut=function(){this.prop.zoom_lvl>0&&this.zoom(this.prop.zoom_lvl-this.config.zoom_speed)},n.prototype.resize=function(t){t.width&&(this.container.style.width=t.width),t.height&&(this.container.style.height=t.height),this._onResize()},n.prototype.enterFullscreen=function(){M.requestFullscreen(this.container)},n.prototype.exitFullscreen=function(){this.isFullscreenEnabled()&&M.exitFullscreen()},n.prototype.toggleFullscreen=function(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()},n.prototype.startKeyboardControl=function(){window.addEventListener("keydown",this)},n.prototype.stopKeyboardControl=function(){window.removeEventListener("keydown",this)},n.prototype.preloadPanorama=function(t){if(!this.config.cache_texture)throw new S("Cannot preload panorama, cache_texture is disabled");return this._loadTexture(t)},n.prototype.clearPanoramaCache=function(t){if(!this.config.cache_texture)throw new S("Cannot clear cache, cache_texture is disabled");if(t){for(var e=0,i=this.prop.cache.length;e<i;e++)if(this.prop.cache[e].panorama===t){this.prop.cache.splice(e,1);break}}else this.prop.cache.length=0},n.prototype.getPanoramaCache=function(t){if(!this.config.cache_texture)throw new S("Cannot query cache, cache_texture is disabled");return this.prop.cache.filter(function(e){return e.panorama===t}).shift()},n._loadSystem=function(){var t=n.SYSTEM;t.loaded=!0,t.pixelRatio=window.devicePixelRatio||1,t.isWebGLSupported=M.isWebGLSupported(),t.isCanvasSupported=M.isCanvasSupported(),t.maxTextureWidth=t.isWebGLSupported?M.getMaxTextureWidth():4096,t.mouseWheelEvent=M.mouseWheelEvent(),t.fullscreenEvent=M.fullscreenEvent(),t.deviceOrientationSupported=M.isDeviceOrientationSupported(),t.touchEnabled=M.isTouchEnabled()},n.prototype._setViewerSize=function(t){["width","height"].forEach(function(e){t[e]&&(/^[0-9.]+$/.test(t[e])&&(t[e]+="px"),this.parent.style[e]=t[e])},this)},n.prototype.speedToDuration=function(t,e){if(t&&"number"===typeof t)return Math.abs(t);var i=t?M.parseSpeed(t):this.config.anim_speed;return e/Math.abs(i)*1e3},n.prototype.textureCoordsToSphericalCoords=function(t){if(this.prop.isCubemap)throw new S("Unable to use texture coords with cubemap.");var e=(t.x+this.prop.pano_data.cropped_x)/this.prop.pano_data.full_width*M.TwoPI,i=(t.y+this.prop.pano_data.cropped_y)/this.prop.pano_data.full_height*Math.PI;return{longitude:e>=Math.PI?e-Math.PI:e+Math.PI,latitude:M.HalfPI-i}},n.prototype.sphericalCoordsToTextureCoords=function(t){if(this.prop.isCubemap)throw new S("Unable to use texture coords with cubemap.");var e=t.longitude/M.TwoPI*this.prop.pano_data.full_width,i=t.latitude/Math.PI*this.prop.pano_data.full_height;return{x:parseInt(t.longitude<Math.PI?e+this.prop.pano_data.full_width/2:e-this.prop.pano_data.full_width/2)-this.prop.pano_data.cropped_x,y:parseInt(this.prop.pano_data.full_height/2-i)-this.prop.pano_data.cropped_y}},n.prototype.sphericalCoordsToVector3=function(e){return new t.Vector3(n.SPHERE_RADIUS*-Math.cos(e.latitude)*Math.sin(e.longitude),n.SPHERE_RADIUS*Math.sin(e.latitude),n.SPHERE_RADIUS*Math.cos(e.latitude)*Math.cos(e.longitude))},n.prototype.vector3ToSphericalCoords=function(t){var e=Math.acos(t.y/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)),i=Math.atan2(t.x,t.z);return{longitude:i<0?-i:M.TwoPI-i,latitude:M.HalfPI-e}},n.prototype.viewerCoordsToVector3=function(e){var i=new t.Vector2(2*e.x/this.prop.size.width-1,-2*e.y/this.prop.size.height+1);this.raycaster.setFromCamera(i,this.camera);var n=this.raycaster.intersectObjects(this.scene.children);return 1===n.length?n[0].point:null},n.prototype.vector3ToViewerCoords=function(t){return t=t.clone(),t.project(this.camera),{x:parseInt((t.x+1)/2*this.prop.size.width),y:parseInt((1-t.y)/2*this.prop.size.height)}},n.prototype.cleanPosition=function(t){t.hasOwnProperty("x")&&t.hasOwnProperty("y")&&M.deepmerge(t,this.textureCoordsToSphericalCoords(t)),t.longitude=M.parseAngle(t.longitude),t.latitude=M.parseAngle(t.latitude,!0)},n.prototype.cleanSphereCorrection=function(t){t.pan=M.parseAngle(t.pan||0),t.tilt=M.parseAngle(t.tilt||0,!0),t.roll=M.parseAngle(t.roll||0,!0,!1)},n.prototype.isExtendedPosition=function(t){return[["x","y"],["longitude","latitude"]].some(function(e){return e[0]in t&&e[1]in t})},n.prototype.applyRanges=function(e){var i,n,r=[];return this.config.longitude_range&&(i=M.clone(this.config.longitude_range),n=t.Math.degToRad(this.prop.hFov)/2,i[0]=M.parseAngle(i[0]+n),i[1]=M.parseAngle(i[1]-n),i[0]>i[1]?e.longitude>i[1]&&e.longitude<i[0]&&(e.longitude>i[0]/2+i[1]/2?(e.longitude=i[0],r.push("left")):(e.longitude=i[1],r.push("right"))):e.longitude<i[0]?(e.longitude=i[0],r.push("left")):e.longitude>i[1]&&(e.longitude=i[1],r.push("right"))),this.config.latitude_range&&(i=M.clone(this.config.latitude_range),n=t.Math.degToRad(this.prop.vFov)/2,i[0]=M.parseAngle(Math.min(i[0]+n,i[1]),!0),i[1]=M.parseAngle(Math.max(i[1]-n,i[0]),!0),e.latitude<i[0]?(e.latitude=i[0],r.push("bottom")):e.latitude>i[1]&&(e.latitude=i[1],r.push("top"))),r},r.className=null,r.publicMethods=[],r.prototype.create=function(){this.container=document.createElement("div"),this.constructor.className&&(this.container.className=this.constructor.className),this.parent.container.appendChild(this.container)},r.prototype.destroy=function(){this.parent.container.removeChild(this.container),this.constructor.publicMethods&&this.constructor.publicMethods.forEach(function(t){delete this.psv[t]},this),delete this.container,delete this.psv,delete this.parent},r.prototype.hide=function(){this.container.style.display="none",this.visible=!1},r.prototype.show=function(){this.container.style.display="",this.visible=!0},a.prototype=Object.create(r.prototype),a.prototype.constructor=a,a.className="psv-hud",a.publicMethods=["addMarker","removeMarker","updateMarker","clearMarkers","getMarker","getCurrentMarker","gotoMarker","hideMarker","showMarker","toggleMarker","toggleMarkersList","showMarkersList","hideMarkersList"],a.prototype.create=function(){r.prototype.create.call(this),this.svgContainer=document.createElementNS(M.svgNS,"svg"),this.svgContainer.setAttribute("class","psv-hud-svg-container"),this.container.appendChild(this.svgContainer),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0),this.psv.on("click",this),this.psv.on("dblclick",this),this.psv.on("render",this),this.psv.on("open-panel",this),this.psv.on("close-panel",this)},a.prototype.destroy=function(){this.clearMarkers(!1),this.container.removeEventListener("mouseenter",this),this.container.removeEventListener("mouseleave",this),this.container.removeEventListener("mousemove",this),this.psv.off("click",this),this.psv.off("dblclick",this),this.psv.off("render",this),this.psv.off("open-panel",this),this.psv.off("close-panel",this),delete this.svgContainer,r.prototype.destroy.call(this)},a.prototype.handleEvent=function(t){switch(t.type){case"mouseenter":this._onMouseEnter(t);break;case"mouseleave":this._onMouseLeave(t);break;case"mousemove":this._onMouseMove(t);break;case"click":this._onClick(t.args[0],t,!1);break;case"dblclick":this._onClick(t.args[0],t,!0);break;case"render":this.renderMarkers();break;case"open-panel":this._onPanelOpened();break;case"close-panel":this._onPanelClosed();break}},a.prototype.addMarker=function(t,e){if(!t.id)throw new S("missing marker id");if(this.markers[t.id])throw new S('marker "'+t.id+'" already exists');var i=new E(t,this.psv);return i.isNormal()?this.container.appendChild(i.$el):this.svgContainer.appendChild(i.$el),this.markers[i.id]=i,!1!==e&&this.renderMarkers(),i},a.prototype.getMarker=function(t){var e="object"===typeof t?t.id:t;if(!this.markers[e])throw new S('cannot find marker "'+e+'"');return this.markers[e]},a.prototype.getCurrentMarker=function(){return this.currentMarker},a.prototype.updateMarker=function(t,e){var i=this.getMarker(t);return i.update(t),!1!==e&&this.renderMarkers(),i},a.prototype.removeMarker=function(t,e){t=this.getMarker(t),t.isNormal()?this.container.removeChild(t.$el):this.svgContainer.removeChild(t.$el),this.hoveringMarker===t&&this.psv.tooltip.hideTooltip(),t.destroy(),delete this.markers[t.id],!1!==e&&this.renderMarkers()},a.prototype.clearMarkers=function(t){Object.keys(this.markers).forEach(function(t){this.removeMarker(t,!1)},this),!1!==t&&this.renderMarkers()},a.prototype.gotoMarker=function(t,e){return t=this.getMarker(t),this.psv.animate(t,e).then(function(){this.psv.trigger("goto-marker-done",t)}.bind(this))},a.prototype.hideMarker=function(t){this.getMarker(t).visible=!1,this.renderMarkers()},a.prototype.showMarker=function(t){this.getMarker(t).visible=!0,this.renderMarkers()},a.prototype.toggleMarker=function(t){this.getMarker(t).visible^=!0,this.renderMarkers()},a.prototype.toggleMarkersList=function(){this.prop.panelOpened?this.hideMarkersList():this.showMarkersList()},a.prototype.showMarkersList=function(){var t=[];M.forEach(this.markers,function(e){t.push(e)});var e=this.psv.config.templates.markersList({markers:this.psv.change("render-markers-list",t),config:this.psv.config});this.prop.panelOpening=!0,this.psv.panel.showPanel(e,!0),this.psv.panel.container.querySelector(".psv-markers-list").addEventListener("click",this._onClickItem.bind(this))},a.prototype.hideMarkersList=function(){this.prop.panelOpened&&this.psv.panel.hidePanel()},a.prototype.renderMarkers=function(){if(this.visible){var e=this.psv.isGyroscopeEnabled()?t.Math.radToDeg(this.psv.camera.rotation.z):0;M.forEach(this.markers,function(t){var i=t.visible;if(i&&t.isPoly()){var n=this._getPolyPositions(t);if(i=n.length>(t.isPolygon()?2:1),i){t.position2D=this._getPolyDimensions(t,n);var r=n.map(function(t){return t.x+","+t.y}).join(" ");t.$el.setAttributeNS(null,"points",r)}}else if(i){var a=this._getMarkerPosition(t);if(i=this._isMarkerVisible(t,a),i){t.position2D=a;var o=t.getScale(this.psv.getZoomLevel());t.isSvg()?t.$el.setAttributeNS(null,"transform","translate("+a.x+", "+a.y+")"+(1!==o?" scale("+o+", "+o+")":"")+(!t.lockRotation&&e?" rotate("+e+")":"")):t.$el.style.transform="translate3D("+a.x+"px, "+a.y+"px, 0px)"+(1!==o?" scale("+o+", "+o+")":"")+(!t.lockRotation&&e?" rotateZ("+e+"deg)":"")}}M.toggleClass(t.$el,"psv-marker--visible",i)}.bind(this))}},a.prototype._isMarkerVisible=function(t,e){return t.position3D.dot(this.psv.prop.direction)>0&&e.x+t.width>=0&&e.x-t.width<=this.psv.prop.size.width&&e.y+t.height>=0&&e.y-t.height<=this.psv.prop.size.height},a.prototype._getMarkerPosition=function(t){if(t._dynamicSize){M.toggleClass(t.$el,"psv-marker--transparent",!0);var e=t.$el.style.transform;t.$el.style.transform=null;var i=t.$el.getBoundingClientRect();t.$el.style.transform=e,M.toggleClass(t.$el,"psv-marker--transparent",!1),t.width=i.right-i.left,t.height=i.bottom-i.top}var n=this.psv.vector3ToViewerCoords(t.position3D);return n.x-=t.width*t.anchor.left,n.y-=t.height*t.anchor.top,n},a.prototype._getPolyPositions=function(t){var e=t.positions3D.length,i=t.positions3D.map(function(t){return{vector:t,visible:t.dot(this.psv.prop.direction)>0}},this),n=[];return i.forEach(function(t,r){if(!t.visible){var a=[0===r?i[e-1]:i[r-1],r===e-1?i[0]:i[r+1]];a.forEach(function(e){e.visible&&n.push({visible:e,invisible:t,index:r})})}}),n.reverse().forEach(function(t){i.splice(t.index,0,{vector:this._getPolyIntermediaryPoint(t.visible.vector,t.invisible.vector),visible:!0})},this),i.filter(function(t){return t.visible}).map(function(t){return this.psv.vector3ToViewerCoords(t.vector)},this)},a.prototype._getPolyIntermediaryPoint=function(e,i){var r=this.psv.prop.direction.clone().normalize(),a=(new t.Vector3).crossVectors(e,i).normalize(),o=(new t.Vector3).crossVectors(a,e).normalize(),s=(new t.Vector3).addVectors(e.clone().multiplyScalar(-r.dot(o)),o.clone().multiplyScalar(r.dot(e))).normalize(),c=(new t.Vector3).crossVectors(s,r);return s.applyAxisAngle(c,.01).multiplyScalar(n.SPHERE_RADIUS)},a.prototype._getPolyDimensions=function(t,e){var i=1/0,n=1/0,r=-1/0,a=-1/0;return e.forEach(function(t){i=Math.min(i,t.x),n=Math.min(n,t.y),r=Math.max(r,t.x),a=Math.max(a,t.y)}),t.width=r-i,t.height=a-n,{x:i,y:n}},a.prototype._onMouseEnter=function(t){var e;t.target&&(e=t.target.psvMarker)&&!e.isPoly()&&(this.hoveringMarker=e,this.psv.trigger("over-marker",e),e.tooltip&&this.psv.tooltip.showTooltip({content:e.tooltip.content,position:e.tooltip.position,left:e.position2D.x,top:e.position2D.y,box:{width:e.width,height:e.height}}))},a.prototype._onMouseLeave=function(t){var e;if(t.target&&(e=t.target.psvMarker)){if(e.isPoly()&&t.relatedTarget&&M.hasParent(t.relatedTarget,this.psv.tooltip.container))return;this.psv.trigger("leave-marker",e),this.hoveringMarker=null,this.psv.tooltip.hideTooltip()}},a.prototype._onMouseMove=function(t){var e;if(!this.psv.prop.moving)if(t.target&&(e=t.target.psvMarker)&&e.isPoly()||t.target&&M.hasParent(t.target,this.psv.tooltip.container)&&(e=this.hoveringMarker)){this.hoveringMarker||(this.psv.trigger("over-marker",e),this.hoveringMarker=e);var i=this.psv.container.getBoundingClientRect();e.tooltip&&this.psv.tooltip.showTooltip({content:e.tooltip.content,position:e.tooltip.position,top:t.clientY-i.top-this.psv.config.tooltip.arrow_size/2,left:t.clientX-i.left-this.psv.config.tooltip.arrow_size,box:{width:2*this.psv.config.tooltip.arrow_size,height:2*this.psv.config.tooltip.arrow_size}})}else this.hoveringMarker&&this.hoveringMarker.isPoly()&&(this.psv.trigger("leave-marker",this.hoveringMarker),this.hoveringMarker=null,this.psv.tooltip.hideTooltip())},a.prototype._onClick=function(t,e,i){var n;t.target&&(n=M.getClosest(t.target,".psv-marker"))&&n.psvMarker?(this.currentMarker=n.psvMarker,this.psv.trigger("select-marker",this.currentMarker,i),this.psv.config.click_event_on_marker?t.marker=n.psvMarker:e.stopPropagation()):this.currentMarker&&(this.psv.trigger("unselect-marker",this.currentMarker),this.currentMarker=null),n&&n.psvMarker&&n.psvMarker.content?this.psv.panel.showPanel(n.psvMarker.content):this.psv.panel.prop.opened&&(e.stopPropagation(),this.psv.panel.hidePanel())},a.prototype._onClickItem=function(t){var e;if(t.target&&(e=M.getClosest(t.target,"li"))&&e.dataset.psvMarker){var i=this.getMarker(e.dataset.psvMarker);this.psv.trigger("select-marker-list",i),this.gotoMarker(i,1e3),this.psv.panel.hidePanel()}},a.prototype._onPanelOpened=function(){this.prop.panelOpening?(this.prop.panelOpening=!1,this.prop.panelOpened=!0):this.prop.panelOpened=!1,this.prop.markersButton&&this.prop.markersButton.toggleActive(this.prop.panelOpened)},a.prototype._onPanelClosed=function(){this.prop.panelOpened=!1,this.prop.panelOpening=!1,this.prop.markersButton&&this.prop.markersButton.toggleActive(!1)},o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.className="psv-loader-container",o.prototype.create=function(){r.prototype.create.call(this);var t,e=n.SYSTEM.pixelRatio;if(this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.canvas=document.createElement("canvas"),this.canvas.className="psv-loader-canvas",this.canvas.width=this.loader.clientWidth*e,this.canvas.height=this.loader.clientWidth*e,this.loader.appendChild(this.canvas),this.tickness=(this.loader.offsetWidth-this.loader.clientWidth)/2*e,this.psv.config.loading_img?(t=document.createElement("img"),t.className="psv-loader-image",t.src=this.psv.config.loading_img):this.psv.config.loading_txt&&(t=document.createElement("div"),t.className="psv-loader-text",t.innerHTML=this.psv.config.loading_txt),t){var i=Math.round(Math.sqrt(2*Math.pow((this.canvas.width/2-this.tickness/2)/e,2)));t.style.maxWidth=i+"px",t.style.maxHeight=i+"px",this.loader.appendChild(t)}},o.prototype.destroy=function(){delete this.loader,delete this.canvas,r.prototype.destroy.call(this)},o.prototype.setProgress=function(t){var e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),e.lineWidth=this.tickness,e.strokeStyle=M.getStyle(this.loader,"color"),e.beginPath(),e.arc(this.canvas.width/2,this.canvas.height/2,this.canvas.width/2-this.tickness/2,-Math.PI/2,t/100*2*Math.PI-Math.PI/2),e.stroke()},s.prototype=Object.create(r.prototype),s.prototype.constructor=s,s.className="psv-navbar psv-navbar--open",s.publicMethods=["showNavbar","hideNavbar","toggleNavbar","getNavbarButton"],s.prototype.create=function(){r.prototype.create.call(this),this.config.forEach(function(t){if("object"===typeof t)this.items.push(new g(this,t));else switch(t){case f.id:this.items.push(new f(this));break;case T.id:this.items.push(new T(this));break;case v.id:this.items.push(new v(this));break;case b.id:this.items.push(new b(this));break;case y.id:this.items.push(new y(this));break;case w.id:this.items.push(new w(this));break;case _.id:this.items.push(new _(this));break;case"caption":this.items.push(new c(this,this.psv.config.caption));break;default:if(0!==t.indexOf("spacer"))throw new S("Unknown button "+t);console.warn("PhotoSphereViewer: navbar spacers have been removed.");break}},this)},s.prototype.destroy=function(){this.items.forEach(function(t){t.destroy()}),this.items.length=0,delete this.config,r.prototype.destroy.call(this)},s.prototype.getNavbarButton=function(t,e){var i=null;return this.items.some(function(e){return e.id===t&&(i=e,!0)}),i||e||console.warn('PhotoSphereViewer: button "'+t+'" not found in the navbar.'),i},s.prototype.showNavbar=function(){this.toggleNavbar(!0)},s.prototype.hideNavbar=function(){this.toggleNavbar(!1)},s.prototype.toggleNavbar=function(t){M.toggleClass(this.container,"psv-navbar--open",t)},c.prototype=Object.create(r.prototype),c.prototype.constructor=c,c.className="psv-caption",c.publicMethods=["setCaption"],c.prototype.create=function(){r.prototype.create.call(this),this.button=new m(this),this.button.hide(),this.content=document.createElement("div"),this.content.className="psv-caption-content",this.container.appendChild(this.content),window.addEventListener("resize",this)},c.prototype.destroy=function(){window.removeEventListener("resize",this),delete this.content,r.prototype.destroy.call(this)},c.prototype.handleEvent=function(t){switch(t.type){case"resize":this._onResize();break}},c.prototype.setCaption=function(t){this.prop.caption=t||"",this.content.innerHTML=this.prop.caption,this.content.style.display="",this.prop.width=this.content.offsetWidth,this._onResize()},c.prototype._onResize=function(){var t=parseInt(M.getStyle(this.container,"width"));t>=this.prop.width?(this.button.hide(),this.content.style.display=""):(this.button.show(),this.content.style.display="none")},l.prototype=Object.create(r.prototype),l.prototype.constructor=l,l.className="psv-notification",l.publicMethods=["showNotification","hideNotification","isNotificationVisible"],l.prototype.create=function(){r.prototype.create.call(this),this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",this.hideNotification.bind(this))},l.prototype.destroy=function(){delete this.content,r.prototype.destroy.call(this)},l.prototype.isNotificationVisible=function(){return this.container.classList.contains("psv-notification--visible")},l.prototype.showNotification=function(t){"string"===typeof t&&(t={content:t}),this.content.innerHTML=t.content,this.container.classList.add("psv-notification--visible"),this.psv.trigger("show-notification"),t.timeout&&setTimeout(this.hideNotification.bind(this),t.timeout)},l.prototype.hideNotification=function(){this.isNotificationVisible()&&(this.container.classList.remove("psv-notification--visible"),this.psv.trigger("hide-notification"))},u.prototype=Object.create(r.prototype),u.prototype.constructor=u,u.className="psv-overlay",u.publicMethods=["showOverlay","hideOverlay","isOverlayVisible"],u.prototype.create=function(){r.prototype.create.call(this),this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.subtext=document.createElement("div"),this.subtext.className="psv-overlay-subtext",this.container.appendChild(this.subtext),this.container.addEventListener("click",this.hideOverlay.bind(this))},u.prototype.destroy=function(){delete this.image,delete this.text,delete this.subtext,r.prototype.destroy.call(this)},u.prototype.isOverlayVisible=function(){return this.visible},u.prototype.showOverlay=function(t){"string"===typeof t&&(t={text:t}),this.image.innerHTML=t.image||"",this.text.innerHTML=t.text||"",this.subtext.innerHTML=t.subtext||"",this.show(),this.psv.trigger("show-overlay")},u.prototype.hideOverlay=function(){this.isOverlayVisible()&&(this.hide(),this.psv.trigger("hide-overlay"))},h.prototype=Object.create(r.prototype),h.prototype.constructor=h,h.className="psv-panel",h.publicMethods=["showPanel","hidePanel"],h.prototype.create=function(){r.prototype.create.call(this),this.container.innerHTML='<div class="psv-panel-resizer"></div><div class="psv-panel-close-button"></div><div class="psv-panel-content"></div>',this.content=this.container.querySelector(".psv-panel-content");var t=this.container.querySelector(".psv-panel-close-button");t.addEventListener("click",this.hidePanel.bind(this)),this.psv.config.mousewheel&&this.container.addEventListener(n.SYSTEM.mouseWheelEvent,function(t){t.stopPropagation()});var e=this.container.querySelector(".psv-panel-resizer");e.addEventListener("mousedown",this),e.addEventListener("touchstart",this),this.psv.container.addEventListener("mouseup",this),this.psv.container.addEventListener("touchend",this),this.psv.container.addEventListener("mousemove",this),this.psv.container.addEventListener("touchmove",this)},h.prototype.destroy=function(){this.psv.container.removeEventListener("mousemove",this),this.psv.container.removeEventListener("touchmove",this),this.psv.container.removeEventListener("mouseup",this),this.psv.container.removeEventListener("touchend",this),delete this.prop,delete this.content,r.prototype.destroy.call(this)},h.prototype.handleEvent=function(t){switch(t.type){case"mousedown":this._onMouseDown(t);break;case"touchstart":this._onTouchStart(t);break;case"mousemove":this._onMouseMove(t);break;case"touchmove":this._onTouchMove(t);break;case"mouseup":this._onMouseUp(t);break;case"touchend":this._onMouseUp(t);break}},h.prototype.showPanel=function(t,e){this.content.innerHTML=t,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),M.toggleClass(this.content,"psv-panel-content--no-margin",!0===e),this.prop.opened=!0,this.psv.trigger("open-panel")},h.prototype.hidePanel=function(){this.content.innerHTML=null,this.prop.opened=!1,this.container.classList.remove("psv-panel--open"),this.psv.trigger("close-panel")},h.prototype._onMouseDown=function(t){t.stopPropagation(),this._startResize(t)},h.prototype._onTouchStart=function(t){t.stopPropagation(),this._startResize(t.changedTouches[0])},h.prototype._onMouseUp=function(t){this.prop.mousedown&&(t.stopPropagation(),this.prop.mousedown=!1,this.content.classList.remove("psv-panel-content--no-interaction"))},h.prototype._onMouseMove=function(t){this.prop.mousedown&&(t.stopPropagation(),this._resize(t))},h.prototype._onTouchMove=function(t){this.prop.mousedown&&this._resize(t.touches[0])},h.prototype._startResize=function(t){this.prop.mouse_x=parseInt(t.clientX),this.prop.mouse_y=parseInt(t.clientY),this.prop.mousedown=!0,this.content.classList.add("psv-panel-content--no-interaction")},h.prototype._resize=function(t){var e=parseInt(t.clientX),i=parseInt(t.clientY);this.container.style.width=this.container.offsetWidth-(e-this.prop.mouse_x)+"px",this.prop.mouse_x=e,this.prop.mouse_y=i},d.prototype=Object.create(r.prototype),d.prototype.constructor=d,d.className="psv-tooltip",d.publicMethods=["showTooltip","hideTooltip","isTooltipVisible"],d.leftMap={0:"left",.5:"center",1:"right"},d.topMap={0:"top",.5:"center",1:"bottom"},d.prototype.create=function(){r.prototype.create.call(this),this.container.innerHTML='<div class="psv-tooltip-arrow"></div><div class="psv-tooltip-content"></div>',this.container.style.top="-1000px",this.container.style.left="-1000px",this.content=this.container.querySelector(".psv-tooltip-content"),this.arrow=this.container.querySelector(".psv-tooltip-arrow"),this.psv.on("render",this)},d.prototype.destroy=function(){this.psv.off("render",this),delete this.config,delete this.prop,r.prototype.destroy.call(this)},d.prototype.handleEvent=function(t){switch(t.type){case"render":this.hideTooltip();break}},d.prototype.isTooltipVisible=function(){return this.container.classList.contains("psv-tooltip--visible")},d.prototype.showTooltip=function(t){this.prop.timeout&&(window.clearTimeout(this.prop.timeout),this.prop.timeout=null);var e=this.isTooltipVisible(),i=this.container,n=this.content,r=this.arrow;if(t.position||(t.position=["top","center"]),t.box||(t.box={width:0,height:0}),"string"===typeof t.position){var a=M.parsePosition(t.position);if(!(a.left in d.leftMap)||!(a.top in d.topMap))throw new S('unable to parse tooltip position "'+t.position+'"');t.position=[d.topMap[a.top],d.leftMap[a.left]]}if("center"===t.position[0]&&"center"===t.position[1])throw new S('unable to parse tooltip position "center center"');if(e)for(var o=i.classList.length-1;o>=0;o--){var s=i.classList.item(o);"psv-tooltip"!==s&&"psv-tooltip--visible"!==s&&i.classList.remove(s)}else i.className="psv-tooltip";t.className&&M.addClasses(i,t.className),n.innerHTML=t.content,i.style.top="0px",i.style.left="0px";var c=i.getBoundingClientRect(),l={posClass:t.position.slice(),width:c.right-c.left,height:c.bottom-c.top,top:0,left:0,arrow_top:0,arrow_left:0};this._computeTooltipPosition(l,t);var u=!1;l.top<this.config.offset?(l.posClass[0]="bottom",u=!0):l.top+l.height>this.psv.prop.size.height-this.config.offset&&(l.posClass[0]="top",u=!0),l.left<this.config.offset?(l.posClass[1]="right",u=!0):l.left+l.width>this.psv.prop.size.width-this.config.offset&&(l.posClass[1]="left",u=!0),u&&this._computeTooltipPosition(l,t),i.style.top=l.top+"px",i.style.left=l.left+"px",r.style.top=l.arrow_top+"px",r.style.left=l.arrow_left+"px",i.classList.add("psv-tooltip--"+l.posClass.join("-")),e||(this.prop.timeout=window.setTimeout(function(){i.classList.add("psv-tooltip--visible"),this.prop.timeout=null,this.psv.trigger("show-tooltip")}.bind(this),this.config.delay))},d.prototype.hideTooltip=function(){this.prop.timeout&&(window.clearTimeout(this.prop.timeout),this.prop.timeout=null),this.isTooltipVisible()&&(this.container.classList.remove("psv-tooltip--visible"),this.prop.timeout=window.setTimeout(function(){this.content.innerHTML=null,this.container.style.top="-1000px",this.container.style.left="-1000px",this.prop.timeout=null}.bind(this),this.config.delay),this.psv.trigger("hide-tooltip"))},d.prototype._computeTooltipPosition=function(t,e){var i=!1;switch(t.posClass[0]){case"bottom":t.top=e.top+e.box.height+this.config.offset+this.config.arrow_size,t.arrow_top=2*-this.config.arrow_size,i=!0;break;case"center":t.top=e.top+e.box.height/2-t.height/2,t.arrow_top=t.height/2-this.config.arrow_size;break;case"top":t.top=e.top-t.height-this.config.offset-this.config.arrow_size,t.arrow_top=t.height,i=!0;break}switch(t.posClass[1]){case"right":i?(t.left=e.left+e.box.width/2-this.config.offset-this.config.arrow_size,t.arrow_left=this.config.offset):(t.left=e.left+e.box.width+this.config.offset+this.config.arrow_size,t.arrow_left=2*-this.config.arrow_size);break;case"center":t.left=e.left+e.box.width/2-t.width/2,t.arrow_left=t.width/2-this.config.arrow_size;break;case"left":i?(t.left=e.left-t.width+e.box.width/2+this.config.offset+this.config.arrow_size,t.arrow_left=t.width-this.config.offset-2*this.config.arrow_size):(t.left=e.left-t.width-this.config.offset-this.config.arrow_size,t.arrow_left=t.width);break}},p.prototype=Object.create(r.prototype),p.prototype.constructor=p,p.id=null,p.icon=null,p.iconActive=null,p.prototype.create=function(){r.prototype.create.call(this),this.constructor.icon&&this._setIcon(this.constructor.icon),this.id&&this.psv.config.lang[this.id]&&(this.container.title=this.psv.config.lang[this.id]),this.container.addEventListener("click",function(t){this.enabled&&this._onClick(),t.stopPropagation()}.bind(this));var t=this.supported();"function"===typeof t.then?(this.hide(),t.then(function(t){t&&this.show()}.bind(this))):t||this.hide()},p.prototype.destroy=function(){r.prototype.destroy.call(this)},p.prototype.supported=function(){return!0},p.prototype.toggleActive=function(t){M.toggleClass(this.container,"psv-button--active",t),this.constructor.iconActive&&this._setIcon(t?this.constructor.iconActive:this.constructor.icon)},p.prototype.disable=function(){this.container.classList.add("psv-button--disabled"),this.enabled=!1},p.prototype.enable=function(){this.container.classList.remove("psv-button--disabled"),this.enabled=!0},p.prototype._setIcon=function(t,e){e||(e=this.container),t?(e.innerHTML=n.ICONS[t],e.querySelector("svg").setAttribute("class","psv-button-svg")):e.innerHTML=""},p.prototype._onClick=function(){},f.prototype=Object.create(p.prototype),f.prototype.constructor=f,f.id="autorotate",f.className="psv-button psv-button--hover-scale psv-autorotate-button",f.icon="play.svg",f.iconActive="play-active.svg",f.prototype.create=function(){p.prototype.create.call(this),this.psv.on("autorotate",this)},f.prototype.destroy=function(){this.psv.off("autorotate",this),p.prototype.destroy.call(this)},f.prototype.handleEvent=function(t){switch(t.type){case"autorotate":this.toggleActive(t.args[0]);break}},f.prototype._onClick=function(){this.psv.toggleAutorotate()},m.prototype=Object.create(p.prototype),m.prototype.constructor=m,m.id="markers",m.className="psv-button psv-button--hover-scale psv-caption-button",m.icon="info.svg",m.prototype.create=function(){p.prototype.create.call(this),this.psv.on("hide-notification",this)},m.prototype.destroy=function(){this.psv.off("hide-notification",this),p.prototype.destroy.call(this)},m.prototype.handleEvent=function(t){switch(t.type){case"hide-notification":this.toggleActive(!1);break}},m.prototype._onClick=function(){this.psv.isNotificationVisible()?this.psv.hideNotification():(this.psv.showNotification(this.parent.prop.caption),this.toggleActive(!0))},g.prototype=Object.create(p.prototype),g.prototype.constructor=g,g.className="psv-button psv-custom-button",g.prototype.create=function(){p.prototype.create.call(this),this.config.className&&M.addClasses(this.container,this.config.className),this.config.title&&(this.container.title=this.config.title),this.config.content&&(this.container.innerHTML=this.config.content),!1!==this.config.enabled&&!0!==this.config.disabled||this.disable(),!1!==this.config.visible&&!0!==this.config.hidden||this.hide()},g.prototype.destroy=function(){delete this.config,p.prototype.destroy.call(this)},g.prototype._onClick=function(){this.config.onClick&&this.config.onClick.apply(this.psv)},v.prototype=Object.create(p.prototype),v.prototype.constructor=v,v.id="download",v.className="psv-button psv-button--hover-scale psv-download-button",v.icon="download.svg",v.prototype._onClick=function(){var t=document.createElement("a");t.href=this.psv.config.panorama,t.download=this.psv.config.panorama,this.psv.container.appendChild(t),t.click()},y.prototype=Object.create(p.prototype),y.prototype.constructor=y,y.id="fullscreen",y.className="psv-button psv-button--hover-scale psv-fullscreen-button",y.icon="fullscreen-in.svg",y.iconActive="fullscreen-out.svg",y.prototype.create=function(){p.prototype.create.call(this),this.psv.on("fullscreen-updated",this)},y.prototype.destroy=function(){this.psv.off("fullscreen-updated",this),p.prototype.destroy.call(this)},y.prototype.supported=function(){return!!n.SYSTEM.fullscreenEvent},y.prototype.handleEvent=function(t){switch(t.type){case"fullscreen-updated":this.toggleActive(t.args[0]);break}},y.prototype._onClick=function(){this.psv.toggleFullscreen()},_.prototype=Object.create(p.prototype),_.prototype.constructor=_,_.id="gyroscope",_.className="psv-button psv-button--hover-scale psv-gyroscope-button",_.icon="compass.svg",_.prototype.create=function(){p.prototype.create.call(this),this.psv.on("gyroscope-updated",this)},_.prototype.destroy=function(){this.psv.off("gyroscope-updated",this),p.prototype.destroy.call(this)},_.prototype.supported=function(){return!!M.checkTHREE("DeviceOrientationControls")&&n.SYSTEM.deviceOrientationSupported},_.prototype.handleEvent=function(t){switch(t.type){case"gyroscope-updated":this.toggleActive(t.args[0]);break}},_.prototype._onClick=function(){this.psv.toggleGyroscopeControl()},b.prototype=Object.create(p.prototype),b.prototype.constructor=b,b.id="markers",b.className="psv-button psv-button--hover-scale psv-markers-button",b.icon="pin.svg",b.prototype._onClick=function(){this.psv.hud.toggleMarkersList()},w.prototype=Object.create(p.prototype),w.prototype.constructor=w,w.id="stereo",w.className="psv-button psv-button--hover-scale psv-stereo-button",w.icon="stereo.svg",w.prototype.create=function(){p.prototype.create.call(this),this.psv.on("stereo-updated",this)},w.prototype.destroy=function(){this.psv.off("stereo-updated",this),p.prototype.destroy.call(this)},w.prototype.supported=function(){return!(!n.SYSTEM.fullscreenEvent||!M.checkTHREE("DeviceOrientationControls"))&&n.SYSTEM.deviceOrientationSupported},w.prototype.handleEvent=function(t){switch(t.type){case"stereo-updated":this.toggleActive(t.args[0]);break}},w.prototype._onClick=function(){this.psv.toggleStereoView()},T.prototype=Object.create(p.prototype),T.prototype.constructor=T,T.id="zoom",T.className="psv-button psv-zoom-button",T.prototype.create=function(){p.prototype.create.call(this);var t=document.createElement("div");t.className="psv-zoom-button-minus",t.title=this.psv.config.lang.zoomOut,this._setIcon("zoom-out.svg",t),this.container.appendChild(t);var e=document.createElement("div");e.className="psv-zoom-button-range",this.container.appendChild(e),this.zoom_range=document.createElement("div"),this.zoom_range.className="psv-zoom-button-line",e.appendChild(this.zoom_range),this.zoom_value=document.createElement("div"),this.zoom_value.className="psv-zoom-button-handle",this.zoom_range.appendChild(this.zoom_value);var i=document.createElement("div");i.className="psv-zoom-button-plus",i.title=this.psv.config.lang.zoomIn,this._setIcon("zoom-in.svg",i),this.container.appendChild(i),this.zoom_range.addEventListener("mousedown",this),this.zoom_range.addEventListener("touchstart",this),this.psv.container.addEventListener("mousemove",this),this.psv.container.addEventListener("touchmove",this),this.psv.container.addEventListener("mouseup",this),this.psv.container.addEventListener("touchend",this),t.addEventListener("mousedown",this._zoomOut.bind(this)),i.addEventListener("mousedown",this._zoomIn.bind(this)),this.psv.on("zoom-updated",this),this.psv.once("ready",function(){this._moveZoomValue(this.psv.prop.zoom_lvl)}.bind(this))},T.prototype.destroy=function(){this._stopZoomChange(),this.psv.container.removeEventListener("mousemove",this),this.psv.container.removeEventListener("touchmove",this),this.psv.container.removeEventListener("mouseup",this),this.psv.container.removeEventListener("touchend",this),delete this.zoom_range,delete this.zoom_value,this.psv.off("zoom-updated",this),p.prototype.destroy.call(this)},T.prototype.handleEvent=function(t){switch(t.type){case"mousedown":this._initZoomChangeWithMouse(t);break;case"touchstart":this._initZoomChangeByTouch(t);break;case"mousemove":this._changeZoomWithMouse(t);break;case"touchmove":this._changeZoomByTouch(t);break;case"mouseup":this._stopZoomChange(t);break;case"touchend":this._stopZoomChange(t);break;case"zoom-updated":this._moveZoomValue(t.args[0]);break}},T.prototype._moveZoomValue=function(t){this.zoom_value.style.left=t/100*this.zoom_range.offsetWidth-this.zoom_value.offsetWidth/2+"px"},T.prototype._initZoomChangeWithMouse=function(t){this.enabled&&(this.prop.mousedown=!0,this._changeZoom(t.clientX))},T.prototype._initZoomChangeByTouch=function(t){this.enabled&&(this.prop.mousedown=!0,this._changeZoom(t.changedTouches[0].clientX))},T.prototype._zoomIn=function(){this.enabled&&(this.prop.buttondown=!0,this.psv.zoomIn(),this.prop.longPressTimeout=window.setTimeout(this._startLongPressInterval.bind(this,1),200))},T.prototype._zoomOut=function(){this.enabled&&(this.prop.buttondown=!0,this.psv.zoomOut(),this.prop.longPressTimeout=window.setTimeout(this._startLongPressInterval.bind(this,-1),200))},T.prototype._startLongPressInterval=function(t){this.prop.buttondown&&(this.prop.longPressInterval=window.setInterval(function(){this.psv.zoom(this.psv.prop.zoom_lvl+t)}.bind(this),50))},T.prototype._stopZoomChange=function(){this.enabled&&(window.clearInterval(this.prop.longPressInterval),window.clearTimeout(this.prop.longPressTimeout),this.prop.longPressInterval=null,this.prop.mousedown=!1,this.prop.buttondown=!1)},T.prototype._changeZoomWithMouse=function(t){this.enabled&&(t.preventDefault(),this._changeZoom(t.clientX))},T.prototype._changeZoomByTouch=function(t){this.enabled&&this._changeZoom(t.changedTouches[0].clientX)},T.prototype._changeZoom=function(t){if(this.prop.mousedown){var e=parseInt(t)-this.zoom_range.getBoundingClientRect().left,i=e/this.zoom_range.offsetWidth*100;this.psv.zoom(i)}},x.easings={linear:function(t){return t},inQuad:function(t){return t*t},outQuad:function(t){return t*(2-t)},inOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},inCubic:function(t){return t*t*t},outCubic:function(t){return--t*t*t+1},inOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},inQuart:function(t){return t*t*t*t},outQuart:function(t){return 1- --t*t*t*t},inOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},inQuint:function(t){return t*t*t*t*t},outQuint:function(t){return 1+--t*t*t*t*t},inOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},inSine:function(t){return 1-Math.cos(t*(Math.PI/2))},outSine:function(t){return Math.sin(t*(Math.PI/2))},inOutSine:function(t){return.5-.5*Math.cos(Math.PI*t)},inExpo:function(t){return Math.pow(2,10*(t-1))},outExpo:function(t){return 1-Math.pow(2,-10*t)},inOutExpo:function(t){return t=2*t-1,t<0?.5*Math.pow(2,10*t):1-.5*Math.pow(2,-10*t)},inCirc:function(t){return 1-Math.sqrt(1-t*t)},outCirc:function(t){return t--,Math.sqrt(1-t*t)},inOutCirc:function(t){return t*=2,t<1?.5-.5*Math.sqrt(1-t*t):.5+.5*Math.sqrt(1-(t-=2)*t)}},x.prototype._run=function(t){if(!this._cancelled){null===this._start&&(this._start=t);var e,i=(t-this._start)/this._options.duration,n={};if(i<1){for(e in this._options.properties)this._options.properties[e]&&(n[e]=this._options.properties[e].start+(this._options.properties[e].end-this._options.properties[e].start)*this._options.easing(i));this._options.onTick(n,i),window.requestAnimationFrame(this._run.bind(this))}else{for(e in this._options.properties)this._options.properties[e]&&(n[e]=this._options.properties[e].end);this._options.onTick(n,1),window.requestAnimationFrame(function(){this._resolved=!0,this._resolve()}.bind(this))}}},x.prototype.then=function(t,e){var i=new x;return i._promise.then(null,this.cancel.bind(this)),this._promise.then(function(){i._resolve(t?t():void 0)},function(){i._reject(e?e():void 0)}),i},x.prototype.catch=function(t){return this.then(void 0,t)},x.prototype.finally=function(t){return this.then(t,t)},x.prototype.cancel=function(){this._cancelled||this._resolved||(this._cancelled=!0,this._reject(),this._delayTimeout&&(window.cancelAnimationFrame(this._delayTimeout),this._delayTimeout=null))},S.prototype=Object.create(Error.prototype),S.prototype.name="PSVError",S.prototype.constructor=S,n.Error=S,E.types=["image","html","polygon_px","polygon_rad","polyline_px","polyline_rad","rect","circle","ellipse","path"],E.getType=function(t,e){var i=[];if(E.types.forEach(function(e){t[e]&&i.push(e)}),0===i.length&&!e)throw new S("missing marker content, either "+E.types.join(", "));if(i.length>1)throw new S("multiple marker content, either "+E.types.join(", "));return i[0]},E.prototype.destroy=function(){delete this.$el.psvMarker},E.prototype.isNormal=function(){return"image"===this.type||"html"===this.type},E.prototype.isPoly=function(){return this.isPolygon()||this.isPolyline()},E.prototype.isPolygon=function(){return"polygon_px"===this.type||"polygon_rad"===this.type},E.prototype.isPolyline=function(){return"polyline_px"===this.type||"polyline_rad"===this.type},E.prototype.isSvg=function(){return"rect"===this.type||"circle"===this.type||"ellipse"===this.type||"path"===this.type},E.prototype.getScale=function(t){return Array.isArray(this.scale)?this.scale[0]+(this.scale[1]-this.scale[0])*x.easings.inQuad(t/100):"function"===typeof this.scale?this.scale(t):"number"===typeof this.scale?this.scale*x.easings.inQuad(t/100):1},E.prototype.update=function(t){if(t&&t!==this){var e=E.getType(t,!0);if(void 0!==e&&e!==this.type)throw new S("cannot change marker type");M.deepmerge(this,t)}this.isNormal()?this.$el.setAttribute("class","psv-marker psv-marker--normal"):this.$el.setAttribute("class","psv-marker psv-marker--svg"),this.className&&M.addClasses(this.$el,this.className),this.tooltip&&(M.addClasses(this.$el,"has-tooltip"),"string"===typeof this.tooltip&&(this.tooltip={content:this.tooltip})),this.style&&M.deepmerge(this.$el.style,this.style),this.anchor=M.parsePosition(this.anchor),this.isNormal()?this._updateNormal():this.isPolygon()?this._updatePoly("polygon_rad","polygon_px"):this.isPolyline()?this._updatePoly("polyline_rad","polyline_px"):this._updateSvg()},E.prototype._updateNormal=function(){this.width&&this.height?(this.$el.style.width=this.width+"px",this.$el.style.height=this.height+"px",this._dynamicSize=!1):this._dynamicSize=!0,this.image?this.$el.style.backgroundImage="url("+this.image+")":this.$el.innerHTML=this.html,this.$el.style.transformOrigin=100*this.anchor.left+"% "+100*this.anchor.top+"%",this.psv.cleanPosition(this),this.position3D=this.psv.sphericalCoordsToVector3(this)},E.prototype._updateSvg=function(){switch(this._dynamicSize=!0,this.type){case"rect":"number"===typeof this._def?this._def={x:0,y:0,width:this._def,height:this._def}:Array.isArray(this._def)?this._def={x:0,y:0,width:this._def[0],height:this._def[1]}:this._def.x=this._def.y=0;break;case"circle":"number"===typeof this._def?this._def={cx:this._def,cy:this._def,r:this._def}:Array.isArray(this._def)?this._def={cx:this._def[0],cy:this._def[0],r:this._def[0]}:this._def.cx=this._def.cy=this._def.r;break;case"ellipse":"number"===typeof this._def?this._def={cx:this._def,cy:this._def,rx:this._def,ry:this._def}:Array.isArray(this._def)?this._def={cx:this._def[0],cy:this._def[1],rx:this._def[0],ry:this._def[1]}:(this._def.cx=this._def.rx,this._def.cy=this._def.ry);break;case"path":"string"===typeof this._def&&(this._def={d:this._def});break}Object.getOwnPropertyNames(this._def).forEach(function(t){this.$el.setAttributeNS(null,t,this._def[t])},this),this.svgStyle?Object.getOwnPropertyNames(this.svgStyle).forEach(function(t){this.$el.setAttributeNS(null,M.dasherize(t),this.svgStyle[t])},this):this.$el.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"),this.psv.cleanPosition(this),this.position3D=this.psv.sphericalCoordsToVector3(this)},E.prototype._updatePoly=function(t,e){this._dynamicSize=!0,this.svgStyle?(Object.getOwnPropertyNames(this.svgStyle).forEach(function(t){this.$el.setAttributeNS(null,M.dasherize(t),this.svgStyle[t])},this),this.isPolyline()&&!this.svgStyle.fill&&this.$el.setAttributeNS(null,"fill","none")):this.isPolygon()?this.$el.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline()&&(this.$el.setAttributeNS(null,"fill","none"),this.$el.setAttributeNS(null,"stroke","rgb(0,0,0)")),[this[t],this[e]].forEach(function(t){if(t&&"object"!==typeof t[0])for(var e=0;e<t.length;e++)t.splice(e,2,[t[e],t[e+1]])}),this[e]?this[t]=this[e].map(function(t){var e=this.psv.textureCoordsToSphericalCoords({x:t[0],y:t[1]});return[e.longitude,e.latitude]},this):this[t]=this[t].map(function(t){return[M.parseAngle(t[0]),M.parseAngle(t[1],!0)]}),this.longitude=this[t][0][0],this.latitude=this[t][0][1],this.positions3D=this[t].map(function(t){return this.psv.sphericalCoordsToVector3({longitude:t[0],latitude:t[1]})},this)};var M={};return n.Utils=M,M.TwoPI=2*Math.PI,M.HalfPI=Math.PI/2,M.svgNS="http://www.w3.org/2000/svg",M.checkTHREE=function(e){for(var i=0,n=arguments.length;i<n;i++)if(!(arguments[i]in t))return!1;return!0},M.isCanvasSupported=function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},M.getWebGLCtx=function(){var t=document.createElement("canvas"),e=["webgl","experimental-webgl","moz-webgl","webkit-3d"],i=null;return t.getContext&&e.some(function(e){try{return i=t.getContext(e),i&&"function"===typeof i.getParameter}catch(n){return!1}})?i:null},M.isWebGLSupported=function(){return!!window.WebGLRenderingContext&&null!==M.getWebGLCtx()},M.isDeviceOrientationSupported=function(){return new Promise(function(t){if("DeviceOrientationEvent"in window){var e=function(i){i&&null!==i.alpha&&!isNaN(i.alpha)?t(!0):t(!1),window.removeEventListener("deviceorientation",e)};window.addEventListener("deviceorientation",e,!1),setTimeout(e,2e3)}else t(!1)})},M.isTouchEnabled=function(){return new Promise(function(t){var e=function(i){t(!!i),window.removeEventListener("touchstart",e)};window.addEventListener("touchstart",e,!1),setTimeout(e,1e4)})},M.getMaxTextureWidth=function(){var t=M.getWebGLCtx();return null!==t?t.getParameter(t.MAX_TEXTURE_SIZE):0},M.toggleClass=function(t,e,i){if(t.classList)void 0===i?t.classList.toggle(e):i&&!t.classList.contains(e)?t.classList.add(e):i||t.classList.remove(e);else{var n=t.getAttribute("class")||"",r=-1!==n.indexOf(e),a=new RegExp("(?:^|\\s)"+e+"(?:\\s|$)");void 0!==i&&!i||r?i||(n=n.replace(a," ")):n+=n.length>0?" "+e:e,t.setAttribute("class",n)}},M.addClasses=function(t,e){e&&e.split(" ").forEach(function(e){M.toggleClass(t,e,!0)})},M.removeClasses=function(t,e){e&&e.split(" ").forEach(function(e){M.toggleClass(t,e,!1)})},M.hasParent=function(t,e){do{if(t===e)return!0}while(t=t.parentNode);return!1},M.getClosest=function(t,e){var i=t.matches||t.msMatchesSelector;do{if(i.bind(t)(e))return t}while(t=t instanceof SVGElement?t.parentNode:t.parentElement);return null},M.mouseWheelEvent=function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"},M.getEventKey=function(t){var e=t.key||M.getEventKey.KEYMAP[t.keyCode||t.which];return e&&M.getEventKey.MS_KEYMAP[e]&&(e=M.getEventKey.MS_KEYMAP[e]),e},M.getEventKey.KEYMAP={13:"Enter",27:"Escape",32:" ",33:"PageUp",34:"PageDown",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",46:"Delete",107:"+",109:"-"},M.getEventKey.MS_KEYMAP={Add:"+",Del:"Delete",Down:"ArrowDown",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Spacebar:" ",Subtract:"-",Up:"ArrowUp"},M.fullscreenEvent=function(){var t={exitFullscreen:"fullscreenchange",webkitExitFullscreen:"webkitfullscreenchange",mozCancelFullScreen:"mozfullscreenchange",msExitFullscreen:"MSFullscreenChange"};for(var e in t)if(t.hasOwnProperty(e)&&e in document)return t[e];return null},M.bound=function(t,e,i){return Math.max(e,Math.min(i,t))},M.isInteger=Number.isInteger||function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t},M.sum=function(t){return t.reduce(function(t,e){return t+e},0)},M.dasherize=function(t){return t.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,function(t,e){return(e>0?"-":"")+t.toLowerCase()})},M.getXMPValue=function(t,e){var i;return null!==(i=t.match("<GPano:"+e+">(.*)</GPano:"+e+">"))?i[1]:null!==(i=t.match("GPano:"+e+'="(.*?)"'))?i[1]:null},M.isFullscreenEnabled=function(t){return(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)===t},M.requestFullscreen=function(t){(t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullscreen||t.msRequestFullscreen).call(t)},M.exitFullscreen=function(){(document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen).call(document)},M.getStyle=function(t,e){return window.getComputedStyle(t,null)[e]},M.getShortestArc=function(t,e){var i=[0,M.TwoPI,-M.TwoPI];return i.reduce(function(i,n){return n=e-t+n,Math.abs(n)<Math.abs(i)?n:i},1/0)},M.getAngle=function(t,e){return Math.acos(Math.cos(t.latitude)*Math.cos(e.latitude)*Math.cos(t.longitude-e.longitude)+Math.sin(t.latitude)*Math.sin(e.latitude))},M.parsePosition=function(t){if(!t)return{top:.5,left:.5};if("object"===typeof t)return t;var e=t.toLocaleLowerCase().split(" ").slice(0,2);1===e.length&&(e=void 0!==M.parsePosition.positions[e[0]]?[e[0],"center"]:[e[0],e[0]]);var i="left"!==e[1]&&"right"!==e[1]&&"top"!==e[0]&&"bottom"!==e[0];e=e.map(function(t){return M.parsePosition.positions[t]||t}),i||e.reverse();var n=e.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return n?{left:n[1]/100,top:n[2]/100}:{top:.5,left:.5}},M.parsePosition.positions={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},M.parseSpeed=function(e){if("string"===typeof e){e=e.toString().trim();var i=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),n=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(n.match(/(pm|per minute)$/)&&(i/=60),n){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=t.Math.degToRad(i);break;case"radians per minute":case"radians per second":e=i;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=i*M.TwoPI;break;default:throw new S('unknown speed unit "'+n+'"')}}return e},M.parseAngle=function(e,i,n){if(void 0===n&&(n=i),"string"===typeof e){var r=e.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!r)throw new S('unknown angle "'+e+'"');var a=parseFloat(r[1]),o=r[2];if(o)switch(o){case"deg":case"degs":e=t.Math.degToRad(a);break;case"rad":case"rads":e=a;break;default:throw new S('unknown angle unit "'+o+'"')}else e=a}return e=(i?e+Math.PI:e)%M.TwoPI,e<0&&(e=M.TwoPI+e),i?M.bound(e-Math.PI,-Math.PI/(n?2:1),Math.PI/(n?2:1)):e},M.cleanTHREEScene=function(e){e.children.forEach(function(e){e instanceof t.Mesh&&(e.geometry&&(e.geometry.dispose(),e.geometry=null),e.material&&(e.material.materials?(e.material.materials.forEach(function(t){t.map&&(t.map.dispose(),t.map=null),t.dispose()}),e.material.materials.length=0):(e.material.map&&(e.material.map.dispose(),e.material.map=null),e.material.dispose()),e.material=null))}),e.children.length=0},M.throttle=function(t,e){var i,n,r,a=null,o=0,s=function(){o=Date.now(),a=null,r=t.apply(i,n),a||(i=n=null)};return function(){var c=Date.now();o||(o=c);var l=e-(c-o);return i=this,n=arguments,l<=0||l>e?(a&&(clearTimeout(a),a=null),o=c,r=t.apply(i,n),a||(i=n=null)):a||(a=setTimeout(s,l)),r}},M.isPlainObject=function(t){if("object"===typeof t&&null!==t){if("function"===typeof Object.getPrototypeOf){var e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}return"[object Object]"===Object.prototype.toString.call(t)}return!1},M.deepmerge=function(t,e){var i=e;return function t(e,n){return Array.isArray(n)?(e&&Array.isArray(e)?e.length=0:e=[],n.forEach(function(i,n){e[n]=t(null,i)})):"object"===typeof n?(e&&!Array.isArray(e)||(e={}),Object.keys(n).forEach(function(r){"object"===typeof n[r]&&n[r]&&M.isPlainObject(n[r])?n[r]!=i&&(e[r]?t(e[r],n[r]):e[r]=t(null,n[r])):e[r]=n[r]})):e=n,e}(t,e)},M.clone=function(t){return M.deepmerge(null,t)},M.normalizeWheel=function(t){var e=10,i=40,n=800,r=0,a=0,o=0,s=0;return"detail"in t&&(a=t.detail),"wheelDelta"in t&&(a=-t.wheelDelta/120),"wheelDeltaY"in t&&(a=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(r=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(r=a,a=0),o=r*e,s=a*e,"deltaY"in t&&(s=t.deltaY),"deltaX"in t&&(o=t.deltaX),(o||s)&&t.deltaMode&&(1===t.deltaMode?(o*=i,s*=i):(o*=n,s*=n)),o&&!r&&(r=o<1?-1:1),s&&!a&&(a=s<1?-1:1),{spinX:r,spinY:a,pixelX:o,pixelY:s}},M.forEach=function(t,e){for(var i in t)t.hasOwnProperty(i)&&e(t[i],i)},n.ICONS["compass.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 0a50 50 0 1 0 0 100A50 50 0 0 0 50 0zm0 88.81a38.86 38.86 0 0 1-38.81-38.8 38.86 38.86 0 0 1 38.8-38.82A38.86 38.86 0 0 1 88.82 50 38.87 38.87 0 0 1 50 88.81z"/><path d="M72.07 25.9L40.25 41.06 27.92 74.12l31.82-15.18v-.01l12.32-33.03zM57.84 54.4L44.9 42.58l21.1-10.06-8.17 21.9z"/>\x3c!--Created by iconoci from the Noun Project--\x3e</svg>',n.ICONS["download.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/>\x3c!--Created by Michael Zenaty from the Noun Project--\x3e</svg>',n.ICONS["fullscreen-in.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>',n.ICONS["fullscreen-out.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>',n.ICONS["gesture.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z" fill="#000" fill-rule="evenodd"/>\x3c!--Created by AomAm from the Noun Project--\x3e</svg>',n.ICONS["info.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle cx="39.3" cy="9.2" r="8.2"/>\x3c!--Created by Arafat Uddin from the Noun Project--\x3e</svg>',n.ICONS["mobile-rotate.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M66.7 19a14 14 0 0 1 13.8 12.1l-3.9-2.7c-.5-.3-1.1-.2-1.4.3-.3.5-.2 1.1.3 1.4l5.7 3.9.6.2c.3 0 .6-.2.8-.4l3.9-5.7c.3-.5.2-1.1-.3-1.4-.5-.3-1.1-.2-1.4.3l-2.4 3.5A16 16 0 0 0 66.7 17c-.6 0-1 .4-1 1s.4 1 1 1zM25 15h10c.6 0 1-.4 1-1s-.4-1-1-1H25c-.6 0-1 .4-1 1s.4 1 1 1zm-6.9 30H16l-2 .2a1 1 0 0 0-.8 1.2c.1.5.5.8 1 .8h.2l1.7-.2h2.1c.6 0 1-.4 1-1s-.5-1-1.1-1zm10 0h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.4-1-1-1zM84 45H55V16A11 11 0 0 0 44 5H16A11 11 0 0 0 5 16v68a11 11 0 0 0 11 11h68a11 11 0 0 0 11-11V56a11 11 0 0 0-11-11zM16 93c-5 0-9-4-9-9V53.2c.3-.1.6-.3.7-.6a9.8 9.8 0 0 1 2-3c.4-.4.4-1 0-1.4a1 1 0 0 0-1.4 0l-1.2 1.5V16c0-5 4-9 9-9h28c5 0 9 4 9 9v68c0 5-4 9-9 9H16zm77-9c0 5-4 9-9 9H50.3c2.8-2 4.7-5.3 4.7-9V47h29c5 0 9 4 9 9v28zM38.1 45h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.5-1-1-1zm9.9 0h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.4-1-1-1zm38 19c-.6 0-1 .4-1 1v10c0 .6.4 1 1 1s1-.4 1-1V65c0-.6-.4-1-1-1z"/>\x3c!--Created by Anthony Bresset from the Noun Project--\x3e</svg>',n.ICONS["pin.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M24 0C13.8 0 5.5 8.3 5.5 18.5c0 10.07 17.57 28.64 18.32 29.42a.25.25 0 0 0 .36 0c.75-.78 18.32-19.35 18.32-29.42C42.5 8.3 34.2 0 24 0zm0 7.14a10.35 10.35 0 0 1 0 20.68 10.35 10.35 0 0 1 0-20.68z"/>\x3c!--Created by Daniele Marucci from the Noun Project--\x3e</svg>',n.ICONS["play-active.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 41 41"><path d="M40.5 14.1c-.1-.1-1.2-.5-2.898-1-.102 0-.202-.1-.202-.2C34.5 6.5 28 2 20.5 2S6.6 6.5 3.7 12.9c0 .1-.1.1-.2.2-1.7.6-2.8 1-2.9 1l-.6.3v12.1l.6.2c.1 0 1.1.399 2.7.899.1 0 .2.101.2.199C6.3 34.4 12.9 39 20.5 39c7.602 0 14.102-4.6 16.9-11.1 0-.102.1-.102.199-.2 1.699-.601 2.699-1 2.801-1l.6-.3V14.3l-.5-.2zM6.701 11.5C9.7 7 14.8 4 20.5 4c5.8 0 10.9 3 13.8 7.5.2.3-.1.6-.399.5-3.799-1-8.799-2-13.6-2-4.7 0-9.5 1-13.2 2-.3.1-.5-.2-.4-.5zM25.1 20.3L18.7 24c-.3.2-.7 0-.7-.5v-7.4c0-.4.4-.6.7-.4l6.399 3.8c.301.1.301.6.001.8zm9.4 8.901A16.421 16.421 0 0 1 20.5 37c-5.9 0-11.1-3.1-14-7.898-.2-.302.1-.602.4-.5 3.9 1 8.9 2.1 13.6 2.1 5 0 9.9-1 13.602-2 .298-.1.5.198.398.499z"/>\x3c!--Created by Nick Bluth from the Noun Project--\x3e</svg>',n.ICONS["play.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 41 41"><path d="M40.5 14.1c-.1-.1-1.2-.5-2.899-1-.101 0-.2-.1-.2-.2C34.5 6.5 28 2 20.5 2S6.6 6.5 3.7 12.9c0 .1-.1.1-.2.2-1.7.6-2.8 1-2.9 1l-.6.3v12.1l.6.2c.1 0 1.1.4 2.7.9.1 0 .2.1.2.199C6.3 34.4 12.9 39 20.5 39c7.601 0 14.101-4.6 16.9-11.1 0-.101.1-.101.2-.2 1.699-.6 2.699-1 2.8-1l.6-.3V14.3l-.5-.2zM20.5 4c5.8 0 10.9 3 13.8 7.5.2.3-.1.6-.399.5-3.8-1-8.8-2-13.6-2-4.7 0-9.5 1-13.2 2-.3.1-.5-.2-.4-.5C9.7 7 14.8 4 20.5 4zm0 33c-5.9 0-11.1-3.1-14-7.899-.2-.301.1-.601.4-.5 3.9 1 8.9 2.1 13.6 2.1 5 0 9.9-1 13.601-2 .3-.1.5.2.399.5A16.422 16.422 0 0 1 20.5 37zm18.601-12.1c0 .1-.101.3-.2.3-2.5.9-10.4 3.6-18.4 3.6-7.1 0-15.6-2.699-18.3-3.6C2.1 25.2 2 25 2 24.9V16c0-.1.1-.3.2-.3 2.6-.9 10.6-3.6 18.2-3.6 7.5 0 15.899 2.7 18.5 3.6.1 0 .2.2.2.3v8.9z"/><path d="M18.7 24l6.4-3.7c.3-.2.3-.7 0-.8l-6.4-3.8c-.3-.2-.7 0-.7.4v7.4c0 .5.4.7.7.5z"/>\x3c!--Created by Nick Bluth from the Noun Project--\x3e</svg>',n.ICONS["stereo.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -2 16 16"><path d="M13.104 0H2.896C2.332 0 1 .392 1 .875h14C15 .392 13.668 0 13.104 0zM15 1H1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h3.534a2 2 0 0 0 1.821-1.172l1.19-2.618a.5.5 0 0 1 .91 0l1.19 2.618A2 2 0 0 0 11.466 11H15a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM4 7a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm8 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"/>\x3c!--Created by Idev Batista from the Noun Project--\x3e</svg>',n.ICONS["zoom-in.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>',n.ICONS["zoom-out.svg"]='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path d="M4.006 6.746h7.459V8.73H4.006z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>',n})},c892:function(t,e,i){"use strict";var n=i("6c83"),r="function"===typeof Symbol&&"symbol"===typeof Symbol("foo"),a=Object.prototype.toString,o=Array.prototype.concat,s=Object.defineProperty,c=function(t){return"function"===typeof t&&"[object Function]"===a.call(t)},l=function(){var t={};try{for(var e in s(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(i){return!1}},u=s&&l(),h=function(t,e,i,n){(!(e in t)||c(n)&&n())&&(u?s(t,e,{configurable:!0,enumerable:!1,value:i,writable:!0}):t[e]=i)},d=function(t,e){var i=arguments.length>2?arguments[2]:{},a=n(e);r&&(a=o.call(a,Object.getOwnPropertySymbols(e)));for(var s=0;s<a.length;s+=1)h(t,a[s],e[a[s]],i[a[s]])};d.supportsDescriptors=!!u,t.exports=d},ca11:function(t,e,i){"use strict";var n,r,a=i("5498").parseType,o=function(t){return new Date(1e3*t-20828448e5)},s=function(t){return{isLeading:(12&t[0])>>>2,dependsOn:3&t[0],isDependedOn:(192&t[1])>>>6,hasRedundancy:(48&t[1])>>>4,paddingValue:(14&t[1])>>>1,isNonSyncSample:1&t[1],degradationPriority:t[2]<<8|t[3]}},c=function(t){var e,i,n=new DataView(t.buffer,t.byteOffset,t.byteLength),r=[];for(e=0;e+4<t.length;e+=i)if(i=n.getUint32(e),e+=4,i<=0)r.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&t[e]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+t[e]&31);break}return r},l={avc1:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{dataReferenceIndex:e.getUint16(6),width:e.getUint16(24),height:e.getUint16(26),horizresolution:e.getUint16(28)+e.getUint16(30)/16,vertresolution:e.getUint16(32)+e.getUint16(34)/16,frameCount:e.getUint16(40),depth:e.getUint16(74),config:n(t.subarray(78,t.byteLength))}},avcC:function(t){var e,i,n,r,a=new DataView(t.buffer,t.byteOffset,t.byteLength),o={configurationVersion:t[0],avcProfileIndication:t[1],profileCompatibility:t[2],avcLevelIndication:t[3],lengthSizeMinusOne:3&t[4],sps:[],pps:[]},s=31&t[5];for(n=6,r=0;r<s;r++)i=a.getUint16(n),n+=2,o.sps.push(new Uint8Array(t.subarray(n,n+i))),n+=i;for(e=t[n],n++,r=0;r<e;r++)i=a.getUint16(n),n+=2,o.pps.push(new Uint8Array(t.subarray(n,n+i))),n+=i;return o},btrt:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{bufferSizeDB:e.getUint32(0),maxBitrate:e.getUint32(4),avgBitrate:e.getUint32(8)}},esds:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),esId:t[6]<<8|t[7],streamPriority:31&t[8],decoderConfig:{objectProfileIndication:t[11],streamType:t[12]>>>2&63,bufferSize:t[13]<<16|t[14]<<8|t[15],maxBitrate:t[16]<<24|t[17]<<16|t[18]<<8|t[19],avgBitrate:t[20]<<24|t[21]<<16|t[22]<<8|t[23],decoderConfigDescriptor:{tag:t[24],length:t[25],audioObjectType:t[26]>>>3&31,samplingFrequencyIndex:(7&t[26])<<1|t[27]>>>7&1,channelConfiguration:t[27]>>>3&15}}}},ftyp:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={majorBrand:a(t.subarray(0,4)),minorVersion:e.getUint32(4),compatibleBrands:[]},n=8;while(n<t.byteLength)i.compatibleBrands.push(a(t.subarray(n,n+4))),n+=4;return i},dinf:function(t){return{boxes:n(t)}},dref:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),dataReferences:n(t.subarray(8))}},hdlr:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),handlerType:a(t.subarray(8,12)),name:""},n=8;for(n=24;n<t.byteLength;n++){if(0===t[n]){n++;break}i.name+=String.fromCharCode(t[n])}return i.name=decodeURIComponent(escape(i.name)),i},mdat:function(t){return{byteLength:t.byteLength,nals:c(t)}},mdhd:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n=4,r={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),language:""};return 1===r.version?(n+=4,r.creationTime=o(i.getUint32(n)),n+=8,r.modificationTime=o(i.getUint32(n)),n+=4,r.timescale=i.getUint32(n),n+=8,r.duration=i.getUint32(n)):(r.creationTime=o(i.getUint32(n)),n+=4,r.modificationTime=o(i.getUint32(n)),n+=4,r.timescale=i.getUint32(n),n+=4,r.duration=i.getUint32(n)),n+=4,e=i.getUint16(n),r.language+=String.fromCharCode(96+(e>>10)),r.language+=String.fromCharCode(96+((992&e)>>5)),r.language+=String.fromCharCode(96+(31&e)),r},mdia:function(t){return{boxes:n(t)}},mfhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sequenceNumber:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},minf:function(t){return{boxes:n(t)}},mp4a:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={dataReferenceIndex:e.getUint16(6),channelcount:e.getUint16(16),samplesize:e.getUint16(18),samplerate:e.getUint16(24)+e.getUint16(26)/65536};return t.byteLength>28&&(i.streamDescriptor=n(t.subarray(28))[0]),i},moof:function(t){return{boxes:n(t)}},moov:function(t){return{boxes:n(t)}},mvex:function(t){return{boxes:n(t)}},mvhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,n={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return 1===n.version?(i+=4,n.creationTime=o(e.getUint32(i)),i+=8,n.modificationTime=o(e.getUint32(i)),i+=4,n.timescale=e.getUint32(i),i+=8,n.duration=e.getUint32(i)):(n.creationTime=o(e.getUint32(i)),i+=4,n.modificationTime=o(e.getUint32(i)),i+=4,n.timescale=e.getUint32(i),i+=4,n.duration=e.getUint32(i)),i+=4,n.rate=e.getUint16(i)+e.getUint16(i+2)/16,i+=4,n.volume=e.getUint8(i)+e.getUint8(i+1)/8,i+=2,i+=2,i+=8,n.matrix=new Uint32Array(t.subarray(i,i+36)),i+=36,i+=24,n.nextTrackId=e.getUint32(i),n},pdin:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),rate:e.getUint32(4),initialDelay:e.getUint32(8)}},sdtp:function(t){var e,i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]};for(e=4;e<t.byteLength;e++)i.samples.push({dependsOn:(48&t[e])>>4,isDependedOn:(12&t[e])>>2,hasRedundancy:3&t[e]});return i},sidx:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},r=i.getUint16(22);for(e=24;r;e+=12,r--)n.references.push({referenceType:(128&t[e])>>>7,referencedSize:2147483647&i.getUint32(e),subsegmentDuration:i.getUint32(e+4),startsWithSap:!!(128&t[e+8]),sapType:(112&t[e+8])>>>4,sapDeltaTime:268435455&i.getUint32(e+8)});return n},smhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),balance:t[4]+t[5]/256}},stbl:function(t){return{boxes:n(t)}},stco:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),chunkOffsets:[]},r=i.getUint32(4);for(e=8;r;e+=4,r--)n.chunkOffsets.push(i.getUint32(e));return n},stsc:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n=i.getUint32(4),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleToChunks:[]};for(e=8;n;e+=12,n--)r.sampleToChunks.push({firstChunk:i.getUint32(e),samplesPerChunk:i.getUint32(e+4),sampleDescriptionIndex:i.getUint32(e+8)});return r},stsd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleDescriptions:n(t.subarray(8))}},stsz:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]};for(e=12;e<t.byteLength;e+=4)n.entries.push(i.getUint32(e));return n},stts:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),timeToSamples:[]},r=i.getUint32(4);for(e=8;r;e+=8,r--)n.timeToSamples.push({sampleCount:i.getUint32(e),sampleDelta:i.getUint32(e+4)});return n},styp:function(t){return l.ftyp(t)},tfdt:function(t){var e={version:t[0],flags:new Uint8Array(t.subarray(1,4)),baseMediaDecodeTime:t[4]<<24|t[5]<<16|t[6]<<8|t[7]};return 1===e.version&&(e.baseMediaDecodeTime*=Math.pow(2,32),e.baseMediaDecodeTime+=t[8]<<24|t[9]<<16|t[10]<<8|t[11]),e},tfhd:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:i.getUint32(4)},r=1&n.flags[2],a=2&n.flags[2],o=8&n.flags[2],s=16&n.flags[2],c=32&n.flags[2],l=65536&n.flags[0],u=131072&n.flags[0];return e=8,r&&(e+=4,n.baseDataOffset=i.getUint32(12),e+=4),a&&(n.sampleDescriptionIndex=i.getUint32(e),e+=4),o&&(n.defaultSampleDuration=i.getUint32(e),e+=4),s&&(n.defaultSampleSize=i.getUint32(e),e+=4),c&&(n.defaultSampleFlags=i.getUint32(e)),l&&(n.durationIsEmpty=!0),!r&&u&&(n.baseDataOffsetIsMoof=!0),n},tkhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,n={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return 1===n.version?(i+=4,n.creationTime=o(e.getUint32(i)),i+=8,n.modificationTime=o(e.getUint32(i)),i+=4,n.trackId=e.getUint32(i),i+=4,i+=8,n.duration=e.getUint32(i)):(n.creationTime=o(e.getUint32(i)),i+=4,n.modificationTime=o(e.getUint32(i)),i+=4,n.trackId=e.getUint32(i),i+=4,i+=4,n.duration=e.getUint32(i)),i+=4,i+=8,n.layer=e.getUint16(i),i+=2,n.alternateGroup=e.getUint16(i),i+=2,n.volume=e.getUint8(i)+e.getUint8(i+1)/8,i+=2,i+=2,n.matrix=new Uint32Array(t.subarray(i,i+36)),i+=36,n.width=e.getUint16(i)+e.getUint16(i+2)/16,i+=4,n.height=e.getUint16(i)+e.getUint16(i+2)/16,n},traf:function(t){return{boxes:n(t)}},trak:function(t){return{boxes:n(t)}},trex:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:e.getUint32(4),defaultSampleDescriptionIndex:e.getUint32(8),defaultSampleDuration:e.getUint32(12),defaultSampleSize:e.getUint32(16),sampleDependsOn:3&t[20],sampleIsDependedOn:(192&t[21])>>6,sampleHasRedundancy:(48&t[21])>>4,samplePaddingValue:(14&t[21])>>1,sampleIsDifferenceSample:!!(1&t[21]),sampleDegradationPriority:e.getUint16(22)}},trun:function(t){var e,i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},n=new DataView(t.buffer,t.byteOffset,t.byteLength),r=1&i.flags[2],a=4&i.flags[2],o=1&i.flags[1],c=2&i.flags[1],l=4&i.flags[1],u=8&i.flags[1],h=n.getUint32(4),d=8;r&&(i.dataOffset=n.getInt32(d),d+=4),a&&h&&(e={flags:s(t.subarray(d,d+4))},d+=4,o&&(e.duration=n.getUint32(d),d+=4),c&&(e.size=n.getUint32(d),d+=4),u&&(e.compositionTimeOffset=n.getUint32(d),d+=4),i.samples.push(e),h--);while(h--)e={},o&&(e.duration=n.getUint32(d),d+=4),c&&(e.size=n.getUint32(d),d+=4),l&&(e.flags=s(t.subarray(d,d+4)),d+=4),u&&(e.compositionTimeOffset=n.getUint32(d),d+=4),i.samples.push(e);return i},"url ":function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4))}},vmhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),graphicsmode:e.getUint16(4),opcolor:new Uint16Array([e.getUint16(6),e.getUint16(8),e.getUint16(10)])}}};n=function(t){for(var e,i,n,r,o,s=0,c=[],u=new ArrayBuffer(t.length),h=new Uint8Array(u),d=0;d<t.length;++d)h[d]=t[d];e=new DataView(u);while(s<t.byteLength)i=e.getUint32(s),n=a(t.subarray(s+4,s+8)),r=i>1?s+i:t.byteLength,o=(l[n]||function(t){return{data:t}})(t.subarray(s+8,r)),o.size=i,o.type=n,c.push(o),s=r;return c},r=function(t,e){var i;return e=e||0,i=new Array(2*e+1).join(" "),t.map(function(t,n){return i+t.type+"\n"+Object.keys(t).filter(function(t){return"type"!==t&&"boxes"!==t}).map(function(e){var n=i+"  "+e+": ",r=t[e];if(r instanceof Uint8Array||r instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(t){return" "+("00"+t.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return a?1===a.length?n+"<"+a.join("").slice(1)+">":n+"<\n"+a.map(function(t){return i+"  "+t}).join("\n")+"\n"+i+"  >":n+"<>"}return n+JSON.stringify(r,null,2).split("\n").map(function(t,e){return 0===e?t:i+"  "+t}).join("\n")}).join("\n")+(t.boxes?"\n"+r(t.boxes,e+1):"")}).join("\n")},t.exports={inspect:n,textify:r,parseTfdt:l.tfdt,parseHdlr:l.hdlr,parseTfhd:l.tfhd,parseTrun:l.trun}},ce02:function(t,e,i){"use strict";var n=4,r=128,a=function(t){var e=0,i={payloadType:-1,payloadSize:0},a=0,o=0;while(e<t.byteLength){if(t[e]===r)break;while(255===t[e])a+=255,e++;a+=t[e++];while(255===t[e])o+=255,e++;if(o+=t[e++],!i.payload&&a===n){i.payloadType=a,i.payloadSize=o,i.payload=t.subarray(e,e+o);break}e+=o,a=0,o=0}return i},o=function(t){return 181!==t.payload[0]?null:49!==(t.payload[1]<<8|t.payload[2])?null:"GA94"!==String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])?null:3!==t.payload[7]?null:t.payload.subarray(8,t.payload.length-1)},s=function(t,e){var i,n,r,a,o=[];if(!(64&e[0]))return o;for(n=31&e[0],i=0;i<n;i++)r=3*i,a={type:3&e[r+2],pts:t},4&e[r+2]&&(a.ccData=e[r+3]<<8|e[r+4],o.push(a));return o},c=function(t){var e,i,n=t.byteLength,r=[],a=1;while(a<n-2)0===t[a]&&0===t[a+1]&&3===t[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return t;e=n-r.length,i=new Uint8Array(e);var o=0;for(a=0;a<e;o++,a++)o===r[0]&&(o++,r.shift()),i[a]=t[o];return i};t.exports={parseSei:a,parseUserData:o,parseCaptionPackets:s,discardEmulationPreventionBytes:c,USER_DATA_REGISTERED_ITU_T_T35:n}},d5b8:function(t,e,i){var n;(function(){"use strict";var r,a={name:"doT",version:"1.1.1",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0,log:!0};a.encodeHTMLSource=function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}},r=function(){return this||(0,eval)("this")}(),t.exports?t.exports=a:(n=function(){return a}.call(e,i,e,t),void 0===n||(t.exports=n));var o={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},s=/$^/;function c(t,e,i){return("string"===typeof e?e:e.toString()).replace(t.define||s,function(e,n,r,a){return 0===n.indexOf("def.")&&(n=n.substring(4)),n in i||(":"===r?(t.defineParams&&a.replace(t.defineParams,function(t,e,r){i[n]={arg:e,text:r}}),n in i||(i[n]=a)):new Function("def","def['"+n+"']="+a)(i)),""}).replace(t.use||s,function(e,n){t.useParams&&(n=n.replace(t.useParams,function(t,e,n,r){if(i[n]&&i[n].arg&&r){var a=(n+":"+r).replace(/'|\\/g,"_");return i.__exp=i.__exp||{},i.__exp[a]=i[n].text.replace(new RegExp("(^|[^\\w$])"+i[n].arg+"([^\\w$])","g"),"$1"+r+"$2"),e+"def.__exp['"+a+"']"}}));var r=new Function("def","return "+n)(i);return r?c(t,r,i):r})}function l(t){return t.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}a.template=function(t,e,i){e=e||a.templateSettings;var n,u,h=e.append?o.append:o.split,d=0,p=e.use||e.define?c(e,t,i||{}):t;p=("var out='"+(e.strip?p.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):p).replace(/'|\\/g,"\\$&").replace(e.interpolate||s,function(t,e){return h.start+l(e)+h.end}).replace(e.encode||s,function(t,e){return n=!0,h.startencode+l(e)+h.end}).replace(e.conditional||s,function(t,e,i){return e?i?"';}else if("+l(i)+"){out+='":"';}else{out+='":i?"';if("+l(i)+"){out+='":"';}out+='"}).replace(e.iterate||s,function(t,e,i,n){return e?(d+=1,u=n||"i"+d,e=l(e),"';var arr"+d+"="+e+";if(arr"+d+"){var "+i+","+u+"=-1,l"+d+"=arr"+d+".length-1;while("+u+"<l"+d+"){"+i+"=arr"+d+"["+u+"+=1];out+='"):"';} } out+='"}).replace(e.evaluate||s,function(t,e){return"';"+l(e)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),n&&(e.selfcontained||!r||r._encodeHTML||(r._encodeHTML=a.encodeHTMLSource(e.doNotSkipEncoded)),p="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+a.encodeHTMLSource.toString()+"("+(e.doNotSkipEncoded||"")+"));"+p);try{return new Function(e.varname,p)}catch(f){throw"undefined"!==typeof console&&console.log("Could not create a template function: "+p),f}},a.compile=function(t,e){return a.template(t,null,e)}})()},d7ff:function(t,e){t.exports=n;var i=Object.prototype.hasOwnProperty;function n(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)i.call(n,r)&&(t[r]=n[r])}return t}},dab2:function(t,e,i){"use strict";var n=i("1d53"),r="";t.exports=function(){return String.prototype.trim&&r.trim()===r?String.prototype.trim:n}},ddbb:function(t,e){var i,n,r,a,o,s,c=9e4;i=function(t){return t*c},n=function(t,e){return t*e},r=function(t){return t/c},a=function(t,e){return t/e},o=function(t,e){return i(a(t,e))},s=function(t,e){return n(r(t),e)},t.exports={secondsToVideoTs:i,secondsToAudioTs:n,videoTsToSeconds:r,audioTsToSeconds:a,audioTsToVideoTs:o,videoTsToAudioTs:s}},df3d:function(t,e,i){},e0ad:function(t,e,i){var n,r,a;
/*!
 * uEvent - to make any js object an event emitter
 * Copyright 2011 Jerome Etienne (http://jetienne.com)
 * Copyright 2015-2016 Damien "Mistic" Sorel (http://www.strangeplanet.fr)
 * Licensed under MIT (http://opensource.org/licenses/MIT)
 */
/*!
 * uEvent - to make any js object an event emitter
 * Copyright 2011 Jerome Etienne (http://jetienne.com)
 * Copyright 2015-2016 Damien "Mistic" Sorel (http://www.strangeplanet.fr)
 * Licensed under MIT (http://opensource.org/licenses/MIT)
 */
(function(i,o){t.exports?t.exports=o():(r=[],n=o,a="function"===typeof n?n.apply(e,r):n,void 0===a||(t.exports=a))})(0,function(){"use strict";var t=function(){return!0},e=function(){return!1},i=function(){};return i.Event=function(t,e){var i=t,n=e;Object.defineProperties(this,{type:{get:function(){return i},set:function(t){},enumerable:!0},args:{get:function(){return n},set:function(t){},enumerable:!0}})},i.Event.prototype={constructor:i.Event,isDefaultPrevented:e,isPropagationStopped:e,preventDefault:function(){this.isDefaultPrevented=t},stopPropagation:function(){this.isPropagationStopped=t}},i.prototype={constructor:i,on:function(t,e){if(this.__events=this.__events||{},"object"===typeof t)for(var i in t)t.hasOwnProperty(i)&&(this.__events[i]=this.__events[i]||[],this.__events[i].push(t[i]));else t.split(" ").forEach(function(t){this.__events[t]=this.__events[t]||[],this.__events[t].push(e)},this);return this},off:function(t,e){if(this.__events=this.__events||{},"object"===typeof t){for(var i in t)if(t.hasOwnProperty(i)&&i in this.__events){var n=this.__events[i].indexOf(t[i]);-1!==n&&this.__events[i].splice(n,1)}}else t?t.split(" ").forEach(function(t){if(t in this.__events)if(e){var i=this.__events[t].indexOf(e);-1!==i&&this.__events[t].splice(i,1)}else this.__events[t].length=0},this):this.__events={};return this},once:function(t,e){if(this.__once=this.__once||{},"object"===typeof t)for(var i in t)t.hasOwnProperty(i)&&(this.__once[i]=this.__once[i]||[],this.__once[i].push(t[i]));else t.split(" ").forEach(function(t){this.__once[t]=this.__once[t]||[],this.__once[t].push(e)},this);return this},trigger:function(t){var e,n,r,a=Array.prototype.slice.call(arguments,1),o=new i.Event(t,a);if(a.push(o),this.__events&&t in this.__events)for(e=0,n=this.__events[t].length;e<n;e++)if(r=this.__events[t][e],"object"===typeof r?r.handleEvent(o):r.apply(this,a),o.isPropagationStopped())return o;if(this.__once&&t in this.__once){for(e=0,n=this.__once[t].length;e<n;e++)if(r=this.__once[t][e],"object"===typeof r?r.handleEvent(o):r.apply(this,a),o.isPropagationStopped())return delete this.__once[t],o;delete this.__once[t]}return o},change:function(t,e){var n,r,a,o=Array.prototype.slice.call(arguments,1),s=new i.Event(t,o);if(o.push(s),this.__events&&t in this.__events)for(n=0,r=this.__events[t].length;n<r;n++)if(o[0]=e,a=this.__events[t][n],e="object"===typeof a?a.handleEvent(s):a.apply(this,o),s.isPropagationStopped())return e;return e}},i.mixin=function(t,e){e=e||{},t="function"===typeof t?t.prototype:t,["on","off","once","trigger","change"].forEach(function(n){var r=e[n]||n;t[r]=i.prototype[n]}),Object.defineProperties(t,{__events:{value:null,writable:!0},__once:{value:null,writable:!0}})},i})},e7ea:function(t,e,i){"use strict";var n=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],r=function(t){return t[0]==="I".charCodeAt(0)&&t[1]==="D".charCodeAt(0)&&t[2]==="3".charCodeAt(0)},a=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},o=function(t,e,i){var n,r="";for(n=e;n<i;n++)r+="%"+("00"+t[n].toString(16)).slice(-2);return r},s=function(t,e,i){return unescape(o(t,e,i))},c=function(t,e){var i=t[e+6]<<21|t[e+7]<<14|t[e+8]<<7|t[e+9],n=t[e+5],r=(16&n)>>4;return r?i+20:i+10},l=function(t,e){var i=(224&t[e+5])>>5,n=t[e+4]<<3,r=6144&t[e+3];return r|n|i},u=function(t,e){return t[e]==="I".charCodeAt(0)&&t[e+1]==="D".charCodeAt(0)&&t[e+2]==="3".charCodeAt(0)?"timed-metadata":!0&t[e]&&240===(240&t[e+1])?"audio":null},h=function(t){var e=0;while(e+5<t.length){if(255===t[e]&&240===(246&t[e+1]))return n[(60&t[e+2])>>>2];e++}return null},d=function(t){var e,i,n,r;e=10,64&t[5]&&(e+=4,e+=a(t.subarray(10,14)));do{if(i=a(t.subarray(e+4,e+8)),i<1)return null;if(r=String.fromCharCode(t[e],t[e+1],t[e+2],t[e+3]),"PRIV"===r){n=t.subarray(e+10,e+i+10);for(var o=0;o<n.byteLength;o++)if(0===n[o]){var c=s(n,0,o);if("com.apple.streaming.transportStreamTimestamp"===c){var l=n.subarray(o+1),u=(1&l[3])<<30|l[4]<<22|l[5]<<14|l[6]<<6|l[7]>>>2;return u*=4,u+=3&l[7],u}break}}e+=10,e+=i}while(e<t.byteLength);return null};t.exports={isLikelyAacData:r,parseId3TagSize:c,parseAdtsSize:l,parseType:u,parseSampleRate:h,parseAacTimestamp:d}},eaf9:function(t,e,i){"use strict";var n=i("ecdc"),r=i("836d"),a=i("feb9"),o=i("d7ff");function s(t,e){for(var i=0;i<t.length;i++)e(t[i])}function c(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function l(t,e,i){var n=t;return r(e)?(i=e,"string"===typeof t&&(n={uri:t})):n=o(e,{uri:t}),n.callback=i,n}function u(t,e,i){return e=l(t,e,i),h(e)}function h(t){if("undefined"===typeof t.callback)throw new Error("callback argument missing");var e=!1,i=function(i,n,r){e||(e=!0,t.callback(i,n,r))};function n(){4===p.readyState&&setTimeout(s,0)}function r(){var t=void 0;if(t=p.response?p.response:p.responseText||d(p),b)try{t=JSON.parse(t)}catch(e){}return t}function o(t){return clearTimeout(f),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,i(t,w)}function s(){if(!h){var e;clearTimeout(f),e=t.useXDR&&void 0===p.status?200:1223===p.status?204:p.status;var n=w,o=null;return 0!==e?(n={body:r(),statusCode:e,method:g,headers:{},url:m,rawRequest:p},p.getAllResponseHeaders&&(n.headers=a(p.getAllResponseHeaders()))):o=new Error("Internal XMLHttpRequest Error"),i(o,n,n.body)}}var l,h,p=t.xhr||null;p||(p=t.cors||t.useXDR?new u.XDomainRequest:new u.XMLHttpRequest);var f,m=p.url=t.uri||t.url,g=p.method=t.method||"GET",v=t.body||t.data,y=p.headers=t.headers||{},_=!!t.sync,b=!1,w={body:void 0,headers:{},statusCode:0,method:g,url:m,rawRequest:p};if("json"in t&&!1!==t.json&&(b=!0,y["accept"]||y["Accept"]||(y["Accept"]="application/json"),"GET"!==g&&"HEAD"!==g&&(y["content-type"]||y["Content-Type"]||(y["Content-Type"]="application/json"),v=JSON.stringify(!0===t.json?v:t.json))),p.onreadystatechange=n,p.onload=s,p.onerror=o,p.onprogress=function(){},p.onabort=function(){h=!0},p.ontimeout=o,p.open(g,m,!_,t.username,t.password),_||(p.withCredentials=!!t.withCredentials),!_&&t.timeout>0&&(f=setTimeout(function(){if(!h){h=!0,p.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",o(t)}},t.timeout)),p.setRequestHeader)for(l in y)y.hasOwnProperty(l)&&p.setRequestHeader(l,y[l]);else if(t.headers&&!c(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(p.responseType=t.responseType),"beforeSend"in t&&"function"===typeof t.beforeSend&&t.beforeSend(p),p.send(v||null),p}function d(t){if("document"===t.responseType)return t.responseXML;var e=t.responseXML&&"parsererror"===t.responseXML.documentElement.nodeName;return""!==t.responseType||e?null:t.responseXML}function p(){}t.exports=u,u.XMLHttpRequest=n.XMLHttpRequest||p,u.XDomainRequest="withCredentials"in new u.XMLHttpRequest?u.XMLHttpRequest:n.XDomainRequest,s(["get","put","post","patch","head","delete"],function(t){u["delete"===t?"del":t]=function(e,i,n){return i=l(e,i,n),i.method=t.toUpperCase(),h(i)}})},ecdc:function(t,e,i){(function(e){var i;i="undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{},t.exports=i}).call(this,i("66fa"))},ecf9:function(t,e,i){"use strict";i.r(e);var n,r,a,o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page iot-page"},[i("div",{staticClass:"left-container"},[i("Amount"),i("FM1Charts",{directives:[{name:"show",rawName:"v-show",value:t.currActive.type==t.types.IOT_TYPE_FM1,expression:"currActive.type==types.IOT_TYPE_FM1"}]}),i("FM2Charts",{directives:[{name:"show",rawName:"v-show",value:t.currActive.type==t.types.IOT_TYPE_FM2,expression:"currActive.type==types.IOT_TYPE_FM2"}]}),i("WFCharts",{directives:[{name:"show",rawName:"v-show",value:t.currActive.type==t.types.IOT_TYPE_WF,expression:"currActive.type==types.IOT_TYPE_WF"}]}),i("CameraVideo",{directives:[{name:"show",rawName:"v-show",value:t.currActive.type==t.types.IOT_TYPE_GUN,expression:"currActive.type==types.IOT_TYPE_GUN"}]})],1),i("Map"),i("Search"),i("PhotoViewer",{directives:[{name:"show",rawName:"v-show",value:t.photoViewerFullState,expression:"photoViewerFullState"}]})],1)},s=[],c=i("8e61"),l=i("eb57"),u=i("52c1"),h=i("0706"),d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Plane",{staticClass:"iot-wrap"},[i("div",{staticClass:"plane-container"},[i("div",{staticClass:"iot-item"},[i("div",[i("i",{staticClass:"iconfont"},[t._v("")]),i("div",[t._v("")])]),i("div",[t._v(t._s(t.cameraAmount))])]),i("div",{staticClass:"iot-item"},[i("div",[i("i",{staticClass:"iconfont"},[t._v("")]),i("div",[t._v("")])]),i("div",[t._v(t._s(t.monitorAmount))])]),i("div",{staticClass:"iot-item"},[i("div",[i("i",{staticClass:"iconfont"},[t._v("")]),i("div",[t._v("")])]),i("div",[t._v(t._s(t.waterFertilizerAmount))])])])])},p=[],f=h["a"].IOT,m=Object(u["a"])(f).mapState,g={name:"app-iot",computed:Object(c["a"])({},m(["cameraAmount","monitorAmount","fertilizerAmount","waterFertilizerAmount"]))},v=g,y=i("17cc"),_=Object(y["a"])(v,d,p,!1,null,null,null),b=_.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Plane",{staticClass:"iot-container",attrs:{full:t.fm1.curveChartFullState}},[i("PlaneTitle",[t._v("FM1")]),i("ul",{staticClass:"data-list"},[i("li",{staticClass:"temperature",class:{active:"temperature"==t.fm1.type},on:{click:function(e){return t.switchFm("temperature","")}}},[i("div",[t._v(t._s(t.fm1.data.temperature)+"C")]),i("div",[t._v("")])]),i("li",{staticClass:"humidity",class:{active:"humidity"==t.fm1.type},on:{click:function(e){return t.switchFm("humidity","")}}},[i("div",[t._v(t._s(t.fm1.data.humidity)+"%")]),i("div",[t._v("")])]),i("li",{staticClass:"light",class:{active:"light"==t.fm1.type},on:{click:function(e){return t.switchFm("light","")}}},[i("div",[t._v(t._s(t.fm1.data.light)+"Lux")]),i("div",[t._v("")])]),i("li",{staticClass:"pressure",class:{active:"pressure"==t.fm1.type},on:{click:function(e){return t.switchFm("pressure","")}}},[i("div",[t._v(t._s(t.fm1.data.pressure)+"Pa")]),i("div",[t._v("")])])]),i("ul",{staticClass:"selector"},[i("li",{class:{active:"HOUR"==t.fm1.time},on:{click:function(e){return t.switchFmTimeType("HOUR")}}},[t._v("")]),i("li",{class:{active:"WEEK"==t.fm1.time},on:{click:function(e){return t.switchFmTimeType("WEEK")}}},[t._v("")])]),i("div",{ref:"chart",staticClass:"plane-content"}),i("PlaneTools",{attrs:{full:t.fm1.curveChartFullState},on:{change:t.doFullStateChange}})],1)},T=[],x=(i("612f"),i("0b9e"),i("3a23"),i("44f7")),S=i("3604"),E=h["a"].IOT,M="curveChartFullState",C="chartDatas",A=Object(u["a"])(E).mapState,k="$store.state.".concat(E,".fm1.").concat(C),L="$store.state.".concat(E,".fm1.").concat(M),P="$store.state.windowResizeState",O={name:"iot-fm1-charts",computed:Object(c["a"])({},A(["fm1"])),watch:(n={},Object(x["a"])(n,k,function(){this.doInitOrRefreshChart()}),Object(x["a"])(n,L,function(){this.doInitOrRefreshChart()}),Object(x["a"])(n,P,function(){this.doInitOrRefreshChart()}),n),data:function(){return{container:null,chart:null}},mounted:function(){var t=this;t.$nextTick(function(){t.container=t.$refs.chart,t["fm1"][C].length&&t.initChart()})},methods:{doInitOrRefreshChart:function(){var t=this,e=t.$store.state[E]["fm1"][C];e&&e.length&&t.container&&(t.chart?t.refreshChart(e):t.initChart(e))},switchFm:function(t,e){var i=this,n=i.$store;i.currFm!=t&&(n.commit(E+"/"+l["a"].SWITCH_FM1_TYPE,{value:t,name:e}),setTimeout(function(){n.dispatch(E+"/"+l["a"].GET_FM1_CHART_DATA)},1e3))},switchFmTimeType:function(t){var e=this,i=e.$store;e.fm1.time!=t&&(i.commit(E+"/"+l["a"].SWITCH_FM1_TIME_TYPE,t),i.dispatch(E+"/"+l["a"].GET_FM1_CHART_DATA))},initChart:function(){var t=this,e=t.doHandlerData(t.fm1.chartDatas),i=e.titles,n=(e.barDatas,e.lineDatas);t.chart=S["a"].init(t.container);var r={grid:{top:20,left:10,right:10,bottom:12,containLabel:!0},tooltip:{trigger:"axis",backgroundColor:"rgba(0, 159, 253, 0.5)",axisPointer:{lineStyle:{color:"rgba(238,238,238,0.4)"}},formatter:function(e){return"".concat(e[0].name,"<br/>").concat(t.fm1.name,"").concat(e[0].data.value," ").concat(t.fm1.chartUnit)}},xAxis:[{type:"category",data:i,boundaryGap:!0,axisTick:{show:!1},axisLine:{lineStyle:{color:"rgba(38, 99, 188, 0.5)"}},axisLabel:{margin:15,textStyle:{color:"#fff"}},splitLine:{show:!1,lineStyle:{type:"dosh",color:"rgba(38, 99, 188, 0.15)"}}}],yAxis:[{show:!0,splitLine:{show:!0,lineStyle:{type:"dosh",color:"rgba(38, 99, 188, 0.3)"}},axisTick:{show:!1},axisLine:{show:!0,lineStyle:{color:"rgba(38, 99, 188, 0.5)"}},axisLabel:{show:!0,color:"#fff"}}],color:["rgb(67, 81, 124)"],series:[{type:"line",data:n,symbol:"circle",symbolSize:6,showSymbol:!0,smooth:!0,areaStyle:{normal:{color:new S["a"].graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(67, 81, 124, 0.3)"},{offset:1,color:"rgba(67, 81, 124, 0.1)"}],!1)}}}]};t.chart.setOption(r)},refreshChart:function(){var t=this,e=t.chart,i=t.doHandlerData(t.fm1.chartDatas),n=i.titles,r=(i.barDatas,i.lineDatas),a=e.getOption(),o=a.series,s=a.xAxis,c=a.tooltip;o[0].data=r,s[0].data=n,c.formatter=function(e){return"".concat(e[0].name,"<br/>").concat(t.fm1.name,"").concat(e[0].data.value," ").concat(t.fm1.chartUnit)},e.setOption({series:o,xAxis:s,tooltip:c}),setTimeout(function(){e.resize()},200)},doHandlerData:function(t){var e=[],i=[],n=[];return t.forEach(function(t){e.push(t.title),i.push({name:t.title,value:t.data}),n.push({name:t.title,value:t.data})}),{titles:e,lineDatas:n,barDatas:i}},doFullStateChange:function(t){var e=this;e.$store.commit(E+"/"+l["a"].IOT_CHANGE_FULL_STATE,{fullStateName:M,state:t})}}},R=O,I=Object(y["a"])(R,w,T,!1,null,null,null),D=I.exports,U=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Plane",{staticClass:"iot-container",attrs:{full:t.fm2.curveChartFullState}},[i("PlaneTitle",[t._v("FM2")]),i("ul",{staticClass:"data-list"},[i("li",{staticClass:"wind",class:{active:"wind"==t.fm2.type},on:{click:function(e){return t.switchFm("wind","")}}},[i("div",[t._v(t._s(t.fm2.data.wind)+"m/s")]),i("div",[t._v("")])]),i("li",{staticClass:"rain",class:{active:"rain"==t.fm2.type},on:{click:function(e){return t.switchFm("rain","")}}},[i("div",[t._v(t._s(t.fm2.data.rain)+"mm")]),i("div",[t._v("")])]),i("li",{staticClass:"soil-temperature",class:{active:"temperature"==t.fm2.type},on:{click:function(e){return t.switchFm("temperature","")}}},[i("div",[t._v(t._s(t.fm2.data.temperature)+"C")]),i("div",[t._v("")])]),i("li",{staticClass:"soil-humidity",class:{active:"humidity"==t.fm2.type},on:{click:function(e){return t.switchFm("humidity","")}}},[i("div",[t._v(t._s(t.fm2.data.humidity)+"%")]),i("div",[t._v("")])])]),i("ul",{staticClass:"selector"},[i("li",{class:{active:"HOUR"==t.fm2.time},on:{click:function(e){return t.switchFmTimeType("HOUR")}}},[t._v("")]),i("li",{class:{active:"WEEK"==t.fm2.time},on:{click:function(e){return t.switchFmTimeType("WEEK")}}},[t._v("")])]),i("div",{ref:"chart",staticClass:"plane-content"}),i("PlaneTools",{attrs:{full:t.fm2.curveChartFullState},on:{change:t.doFullStateChange}})],1)},N=[],B=h["a"].IOT,F="curveChartFullState",z="chartDatas",j=Object(u["a"])(B).mapState,H="$store.state.".concat(B,".fm2.").concat(z),G="$store.state.".concat(B,".fm2.").concat(F),V="$store.state.windowResizeState",W={name:"iot-fm2-charts",computed:Object(c["a"])({},j(["fm2"])),watch:(r={},Object(x["a"])(r,H,function(){this.doInitOrRefreshChart()}),Object(x["a"])(r,G,function(){this.doInitOrRefreshChart()}),Object(x["a"])(r,V,function(){this.doInitOrRefreshChart()}),r),data:function(){return{container:null,chart:null}},mounted:function(){var t=this;t.$nextTick(function(){t.container=t.$refs.chart,t["fm2"][z].length&&t.initChart()})},methods:{doInitOrRefreshChart:function(){var t=this,e=t.$store.state[B]["fm2"][z];e&&e.length&&t.container&&(t.chart?t.refreshChart(e):t.initChart(e))},switchFm:function(t,e){var i=this,n=i.$store;i.currFm!=t&&(n.commit(B+"/"+l["a"].SWITCH_FM2_TYPE,{value:t,name:e}),setTimeout(function(){n.dispatch(B+"/"+l["a"].GET_FM2_CHART_DATA)},1e3))},switchFmTimeType:function(t){var e=this,i=e.$store;e.fm2.time!=t&&(i.commit(B+"/"+l["a"].SWITCH_FM2_TIME_TYPE,t),i.dispatch(B+"/"+l["a"].GET_FM2_CHART_DATA))},initChart:function(){var t=this,e=t.doHandlerData(t.fm2.chartDatas),i=e.titles,n=(e.barDatas,e.lineDatas);t.chart=S["a"].init(t.container);var r={grid:{top:20,left:10,right:10,bottom:12,containLabel:!0},tooltip:{trigger:"axis",backgroundColor:"rgba(0, 159, 253, 0.5)",axisPointer:{lineStyle:{color:"rgba(238,238,238,0.4)"}},formatter:function(e){return"".concat(e[0].name,"<br/>").concat(t.fm2.name,"").concat(e[0].data.value," ").concat(t.fm2.chartUnit)}},xAxis:[{type:"category",data:i,boundaryGap:!0,axisTick:{show:!1},axisLine:{lineStyle:{color:"rgba(38, 99, 188, 0.5)"}},axisLabel:{margin:15,textStyle:{color:"#fff"}},splitLine:{show:!1,lineStyle:{type:"dosh",color:"rgba(38, 99, 188, 0.15)"}}}],yAxis:[{show:!0,splitLine:{show:!0,lineStyle:{type:"dosh",color:"rgba(38, 99, 188, 0.3)"}},axisTick:{show:!1},axisLine:{show:!0,lineStyle:{color:"rgba(38, 99, 188, 0.5)"}},axisLabel:{show:!0,color:"#fff"}}],color:["rgb(67, 81, 124)"],series:[{type:"line",data:n,showSymbol:!0,smooth:!0,symbol:"wind"==t.fm2.type?"image://".concat(location.origin,"/images/arrow.png"):"circle",symbolSize:"wind"==t.fm2.type?20:6,areaStyle:{normal:{color:new S["a"].graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(67, 81, 124, 0.3)"},{offset:1,color:"rgba(67, 81, 124, 0.1)"}],!1)}}}]};t.chart.setOption(r)},refreshChart:function(){var t=this,e=t.chart,i=t.doHandlerData(t.fm2.chartDatas),n=i.titles,r=(i.barDatas,i.lineDatas),a=e.getOption(),o=a.series,s=a.xAxis,c=a.tooltip;o[0].data=r,s[0].data=n,c.formatter=function(e){return"".concat(e[0].name,"<br/>").concat(t.fm2.name,"").concat(e[0].data.value," ").concat(t.fm2.chartUnit)},"wind"==t.fm2.type?(o[0].symbol="image://".concat(location.origin,"/images/arrow.png"),o[0].symbolSize=20):(o[0].symbol="circle",o[0].symbolSize=6),e.setOption({series:o,xAxis:s,tooltip:c}),setTimeout(function(){e.resize()},200)},doHandlerData:function(t){var e=this,i=[],n=[],r=[],a=null;return t.forEach(function(t){i.push(t.title),n.push({name:t.title,value:t.data}),a={name:t.title,value:t.data},"wind"==e.fm2.type&&(a.symbolRotate=t.rotate),r.push(a)}),{titles:i,lineDatas:r,barDatas:n}},doFullStateChange:function(t){var e=this;e.$store.commit(B+"/"+l["a"].IOT_CHANGE_FULL_STATE,{fullStateName:F,state:t})}}},q=W,Y=Object(y["a"])(q,U,N,!1,null,null,null),X=Y.exports,$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Plane",{staticClass:"iot-container",attrs:{full:t.wf.curveChartFullState}},[i("PlaneTitle",[t._v("")]),i("ul",{staticClass:"data-list"},[i("li",{staticClass:"ec",class:{active:"ec"==t.wf.type},on:{click:function(e){return t.switchFm("ec","EC")}}},[i("div",[t._v(t._s(t.wf.data.ec)+"mS/cm")]),i("div",[t._v("EC")])]),i("li",{staticClass:"ph",class:{active:"ph"==t.wf.type},on:{click:function(e){return t.switchFm("ph","PH")}}},[i("div",[t._v(t._s(t.wf.data.ph))]),i("div",[t._v("PH")])]),i("li",{staticClass:"water",class:{active:"water"==t.wf.type},on:{click:function(e){return t.switchFm("water","")}}},[i("div",[t._v(t._s(t.wf.data.water)+"L")]),i("div",[t._v("()")])]),i("li",{staticClass:"fertilizer",class:{active:"fertilizer"==t.wf.type},on:{click:function(e){return t.switchFm("fertilizer","")}}},[i("div",[t._v(t._s(t.wf.data.fertilizer)+"kg")]),i("div",[t._v("()")])])]),i("ul",{directives:[{name:"show",rawName:"v-show",value:"ec"==t.wf.type||"ph"==t.wf.type,expression:"wf.type=='ec' || wf.type=='ph'"}],staticClass:"selector"},[i("li",{class:{active:"HOUR"==t.wf.time},on:{click:function(e){return t.switchFmTimeType("HOUR")}}},[t._v("")]),i("li",{class:{active:"WEEK"==t.wf.time},on:{click:function(e){return t.switchFmTimeType("WEEK")}}},[t._v("")])]),i("div",{ref:"chart",staticClass:"plane-content"}),i("PlaneTools",{attrs:{full:t.wf.curveChartFullState},on:{change:t.doFullStateChange}})],1)},Z=[],J=h["a"].IOT,K="curveChartFullState",Q="chartDatas",tt=Object(u["a"])(J).mapState,et="$store.state.".concat(J,".wf.").concat(Q),it="$store.state.".concat(J,".wf.").concat(K),nt="$store.state.windowResizeState",rt={name:"iot-wf-charts",computed:Object(c["a"])({},tt(["wf"])),watch:(a={},Object(x["a"])(a,et,function(){this.doInitOrRefreshChart()}),Object(x["a"])(a,it,function(){this.doInitOrRefreshChart()}),Object(x["a"])(a,nt,function(){this.doInitOrRefreshChart()}),a),data:function(){return{container:null,chart:null}},mounted:function(){var t=this;t.$nextTick(function(){t.container=t.$refs.chart,t["wf"][Q].length&&t.initChart()})},methods:{doInitOrRefreshChart:function(){var t=this,e=t.$store.state[J]["wf"][Q];e&&e.length&&t.container&&(t.chart?t.refreshChart(e):t.initChart(e))},switchFm:function(t,e){var i=this,n=i.$store;i.currFm!=t&&(n.commit(J+"/"+l["a"].SWITCH_WF_TYPE,{value:t,name:e}),setTimeout(function(){n.dispatch(J+"/"+l["a"].GET_WF_CHART_DATA)},1e3))},switchFmTimeType:function(t){var e=this,i=e.$store;e.wf.time!=t&&(i.commit(J+"/"+l["a"].SWITCH_WF_TIME_TYPE,t),i.dispatch(J+"/"+l["a"].GET_WF_CHART_DATA))},initChart:function(){var t=this,e=t.doHandlerData(t.wf.chartDatas),i=e.titles,n=(e.barDatas,e.lineDatas);t.chart=S["a"].init(t.container);var r={grid:{top:20,left:10,right:10,bottom:12,containLabel:!0},tooltip:{trigger:"axis",backgroundColor:"rgba(0, 159, 253, 0.5)",axisPointer:{lineStyle:{color:"rgba(238,238,238,0.4)"}},formatter:function(e){return"".concat(e[0].name,"<br/>").concat(t.wf.name,"").concat(e[0].data.value," ").concat(t.wf.chartUnit)}},xAxis:[{type:"category",data:i,boundaryGap:!0,axisTick:{show:!1},axisLine:{lineStyle:{color:"rgba(38, 99, 188, 0.5)"}},axisLabel:{margin:15,textStyle:{color:"#fff"}},splitLine:{show:!1,lineStyle:{type:"dosh",color:"rgba(38, 99, 188, 0.15)"}}}],yAxis:[{show:!0,splitLine:{show:!0,lineStyle:{type:"dosh",color:"rgba(38, 99, 188, 0.3)"}},axisTick:{show:!1},axisLine:{show:!0,lineStyle:{color:"rgba(38, 99, 188, 0.5)"}},axisLabel:{show:!0,color:"#fff"}}],color:["rgb(67, 81, 124)"],series:[{type:"line",data:n,symbol:"circle",symbolSize:6,showSymbol:!0,smooth:!0,areaStyle:{normal:{color:new S["a"].graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(67, 81, 124, 0.3)"},{offset:1,color:"rgba(67, 81, 124, 0.1)"}],!1)}}}]};t.chart.setOption(r)},refreshChart:function(){var t=this,e=t.chart,i=t.doHandlerData(t.wf.chartDatas),n=i.titles,r=(i.barDatas,i.lineDatas),a=e.getOption(),o=a.series,s=a.xAxis,c=a.tooltip;o[0].data=r,s[0].data=n,c.formatter=function(e){return"".concat(e[0].name,"<br/>").concat(t.wf.name,"").concat(e[0].data.value," ").concat(t.wf.chartUnit)},e.setOption({series:o,xAxis:s,tooltip:c}),setTimeout(function(){e.resize()},200)},doHandlerData:function(t){var e=[],i=[],n=[];return t.forEach(function(t){e.push(t.title),i.push({name:t.title,value:t.data}),n.push({name:t.title,value:t.data})}),{titles:e,lineDatas:n,barDatas:i}},doFullStateChange:function(t){var e=this;e.$store.commit(J+"/"+l["a"].IOT_CHANGE_FULL_STATE,{fullStateName:K,state:t})}}},at=rt,ot=Object(y["a"])(at,$,Z,!1,null,null,null),st=ot.exports,ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Plane",{staticClass:"iot-container camera-video"},[i("PlaneTitle",[t._v("")]),i("div",{staticClass:"plane-content"},[i("div",{ref:"container",staticClass:"video-container",style:{height:t.containerHeight+"px"}},[i("video-js",{staticClass:"vjs-default-skin",attrs:{id:t.videoId,controls:""}})],1)])],1)},lt=[],ut=i("056e"),ht=i.n(ut),dt=i("0630"),pt=i.n(dt),ft=i("0466"),mt=i.n(ft),gt=i("1f90"),vt=i.n(gt),yt=i("eaf9"),_t=i.n(yt),bt=i("fbd3e"),wt=i.n(bt),Tt=i("ecdc"),xt=i.n(Tt),St=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Et=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},Mt=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},Ct=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e},At=function(){function t(){St(this,t),this.listeners={}}return t.prototype.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},t.prototype.off=function(t,e){if(!this.listeners[t])return!1;var i=this.listeners[t].indexOf(e);return this.listeners[t].splice(i,1),i>-1},t.prototype.trigger=function(t){var e=this.listeners[t],i=void 0,n=void 0,r=void 0;if(e)if(2===arguments.length)for(n=e.length,i=0;i<n;++i)e[i].call(this,arguments[1]);else for(r=Array.prototype.slice.call(arguments,1),n=e.length,i=0;i<n;++i)e[i].apply(this,r)},t.prototype.dispose=function(){this.listeners={}},t.prototype.pipe=function(t){this.on("data",function(e){t.push(e)})},t}(),kt=function(t){function e(){St(this,e);var i=Ct(this,t.call(this));return i.buffer="",i}return Mt(e,t),e.prototype.push=function(t){var e=void 0;for(this.buffer+=t,e=this.buffer.indexOf("\n");e>-1;e=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)},e}(At),Lt=function(){var t="[^=]*",e='"[^"]*"|[^,]*',i="(?:"+t+")=(?:"+e+")";return new RegExp("(?:^|,)("+i+")")},Pt=function(t){var e=t.split(Lt()),i={},n=e.length,r=void 0;while(n--)""!==e[n]&&(r=/([^=]*)=(.*)/.exec(e[n]).slice(1),r[0]=r[0].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^['"](.*)['"]$/g,"$1"),i[r[0]]=r[1]);return i},Ot=function(t){function e(){St(this,e);var i=Ct(this,t.call(this));return i.customParsers=[],i}return Mt(e,t),e.prototype.push=function(t){var e=void 0,i=void 0;if(t=t.replace(/^[\u0000\s]+|[\u0000\s]+$/g,""),0!==t.length)if("#"===t[0]){for(var n=0;n<this.customParsers.length;n++)if(this.customParsers[n].call(this,t))return;if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),e=/^#EXTM3U/.exec(t),e)this.trigger("data",{type:"tag",tagType:"m3u"});else{if(e=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t),e)return i={type:"tag",tagType:"inf"},e[1]&&(i.duration=parseFloat(e[1])),e[2]&&(i.title=e[2]),void this.trigger("data",i);if(e=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t),e)return i={type:"tag",tagType:"targetduration"},e[1]&&(i.duration=parseInt(e[1],10)),void this.trigger("data",i);if(e=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t),e)return i={type:"tag",tagType:"totalduration"},e[1]&&(i.duration=parseInt(e[1],10)),void this.trigger("data",i);if(e=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t),e)return i={type:"tag",tagType:"version"},e[1]&&(i.version=parseInt(e[1],10)),void this.trigger("data",i);if(e=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t),e)return i={type:"tag",tagType:"media-sequence"},e[1]&&(i.number=parseInt(e[1],10)),void this.trigger("data",i);if(e=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t),e)return i={type:"tag",tagType:"discontinuity-sequence"},e[1]&&(i.number=parseInt(e[1],10)),void this.trigger("data",i);if(e=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t),e)return i={type:"tag",tagType:"playlist-type"},e[1]&&(i.playlistType=e[1]),void this.trigger("data",i);if(e=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t),e)return i={type:"tag",tagType:"byterange"},e[1]&&(i.length=parseInt(e[1],10)),e[2]&&(i.offset=parseInt(e[2],10)),void this.trigger("data",i);if(e=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t),e)return i={type:"tag",tagType:"allow-cache"},e[1]&&(i.allowed=!/NO/.test(e[1])),void this.trigger("data",i);if(e=/^#EXT-X-MAP:?(.*)$/.exec(t),e){if(i={type:"tag",tagType:"map"},e[1]){var r=Pt(e[1]);if(r.URI&&(i.uri=r.URI),r.BYTERANGE){var a=r.BYTERANGE.split("@"),o=a[0],s=a[1];i.byterange={},o&&(i.byterange.length=parseInt(o,10)),s&&(i.byterange.offset=parseInt(s,10))}}this.trigger("data",i)}else if(e=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t),e){if(i={type:"tag",tagType:"stream-inf"},e[1]){if(i.attributes=Pt(e[1]),i.attributes.RESOLUTION){var c=i.attributes.RESOLUTION.split("x"),l={};c[0]&&(l.width=parseInt(c[0],10)),c[1]&&(l.height=parseInt(c[1],10)),i.attributes.RESOLUTION=l}i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))}this.trigger("data",i)}else{if(e=/^#EXT-X-MEDIA:?(.*)$/.exec(t),e)return i={type:"tag",tagType:"media"},e[1]&&(i.attributes=Pt(e[1])),void this.trigger("data",i);if(e=/^#EXT-X-ENDLIST/.exec(t),e)this.trigger("data",{type:"tag",tagType:"endlist"});else if(e=/^#EXT-X-DISCONTINUITY/.exec(t),e)this.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(e=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(t),e)return i={type:"tag",tagType:"program-date-time"},e[1]&&(i.dateTimeString=e[1],i.dateTimeObject=new Date(e[1])),void this.trigger("data",i);if(e=/^#EXT-X-KEY:?(.*)$/.exec(t),e)return i={type:"tag",tagType:"key"},e[1]&&(i.attributes=Pt(e[1]),i.attributes.IV&&("0x"===i.attributes.IV.substring(0,2).toLowerCase()&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),void this.trigger("data",i);if(e=/^#EXT-X-START:?(.*)$/.exec(t),e)return i={type:"tag",tagType:"start"},e[1]&&(i.attributes=Pt(e[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),void this.trigger("data",i);if(e=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(t),e)return i={type:"tag",tagType:"cue-out-cont"},e[1]?i.data=e[1]:i.data="",void this.trigger("data",i);if(e=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(t),e)return i={type:"tag",tagType:"cue-out"},e[1]?i.data=e[1]:i.data="",void this.trigger("data",i);if(e=/^#EXT-X-CUE-IN:?(.*)?$/.exec(t),e)return i={type:"tag",tagType:"cue-in"},e[1]?i.data=e[1]:i.data="",void this.trigger("data",i);this.trigger("data",{type:"tag",data:t.slice(4)})}}}else this.trigger("data",{type:"comment",text:t.slice(1)})}else this.trigger("data",{type:"uri",uri:t})},e.prototype.addParser=function(t){var e=this,i=t.expression,n=t.customType,r=t.dataParser,a=t.segment;"function"!==typeof r&&(r=function(t){return t}),this.customParsers.push(function(t){var o=i.exec(t);if(o)return e.trigger("data",{type:"custom",data:r(t),customType:n,segment:a}),!0})},e}(At),Rt=function(t){function e(){St(this,e);var i=Ct(this,t.call(this));i.lineStream=new kt,i.parseStream=new Ot,i.lineStream.pipe(i.parseStream);var n=i,r=[],a={},o=void 0,s=void 0,c=function(){},l={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},u=0;return i.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},i.parseStream.on("data",function(t){var e=void 0,i=void 0;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var e={};"length"in t&&(a.byterange=e,e.length=t.length,"offset"in t||(this.trigger("info",{message:"defaulting offset to zero"}),t.offset=0)),"offset"in t&&(a.byterange=e,e.offset=t.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),t.duration>0&&(a.duration=t.duration),0===t.duration&&(a.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=r},key:function(){t.attributes?"NONE"!==t.attributes.METHOD?t.attributes.URI?(t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),s={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},"undefined"!==typeof t.attributes.IV&&(s.iv=t.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):s=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(t.number)?this.manifest.mediaSequence=t.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},"discontinuity-sequence":function(){isFinite(t.number)?(this.manifest.discontinuitySequence=t.number,u=t.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},"playlist-type":function(){/VOD|EVENT/.test(t.playlistType)?this.manifest.playlistType=t.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},map:function(){o={},t.uri&&(o.uri=t.uri),t.byterange&&(o.byterange=t.byterange)},"stream-inf":function(){this.manifest.playlists=r,this.manifest.mediaGroups=this.manifest.mediaGroups||l,t.attributes?(a.attributes||(a.attributes={}),Et(a.attributes,t.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||l,t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME){var n=this.manifest.mediaGroups[t.attributes.TYPE];n[t.attributes["GROUP-ID"]]=n[t.attributes["GROUP-ID"]]||{},e=n[t.attributes["GROUP-ID"]],i={default:/yes/i.test(t.attributes.DEFAULT)},i["default"]?i.autoselect=!0:i.autoselect=/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(i.language=t.attributes.LANGUAGE),t.attributes.URI&&(i.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(i.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(i.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(i.forced=/yes/i.test(t.attributes.FORCED)),e[t.attributes.NAME]=i}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){u+=1,a.discontinuity=!0,this.manifest.discontinuityStarts.push(r.length)},"program-date-time":function(){"undefined"===typeof this.manifest.dateTimeString&&(this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject),a.dateTimeString=t.dateTimeString,a.dateTimeObject=t.dateTimeObject},targetduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration}):this.manifest.targetDuration=t.duration},totalduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+t.duration}):this.manifest.totalDuration=t.duration},start:function(){t.attributes&&!isNaN(t.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:t.attributes["TIME-OFFSET"],precise:t.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){a.cueOut=t.data},"cue-out-cont":function(){a.cueOutCont=t.data},"cue-in":function(){a.cueIn=t.data}}[t.tagType]||c).call(n)},uri:function(){a.uri=t.uri,r.push(a),!this.manifest.targetDuration||"duration"in a||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),a.duration=this.manifest.targetDuration),s&&(a.key=s),a.timeline=u,o&&(a.map=o),a={}},comment:function(){},custom:function(){t.segment?(a.custom=a.custom||{},a.custom[t.customType]=t.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[t.customType]=t.data)}})[t.type].call(n)}),i}return Mt(e,t),e.prototype.push=function(t){this.lineStream.push(t)},e.prototype.end=function(){this.lineStream.push("\n")},e.prototype.addParser=function(t){this.parseStream.addParser(t)},e}(At),It=i("0335"),Dt=i.n(It),Ut=i("3e37"),Nt=i("5498"),Bt=i.n(Nt),Ft=i("82c6"),zt=i("06b9"),jt=i.n(zt);function Ht(t){return t.subarray(0,t.byteLength-t[t.byteLength-1])}var Gt=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Vt=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),Wt=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},qt=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e},Yt=function(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]],e=t[0],i=t[1],n=e[4],r=i[4],a=void 0,o=void 0,s=void 0,c=[],l=[],u=void 0,h=void 0,d=void 0,p=void 0,f=void 0,m=void 0;for(a=0;a<256;a++)l[(c[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!n[o];o^=u||1,s=l[s]||1)for(p=s^s<<1^s<<2^s<<3^s<<4,p=p>>8^255&p^99,n[o]=p,r[p]=o,d=c[h=c[u=c[o]]],m=16843009*d^65537*h^257*u^16843008*o,f=257*c[p]^16843008*p,a=0;a<4;a++)e[a][o]=f=f<<24^f>>>8,i[a][p]=m=m<<24^m>>>8;for(a=0;a<5;a++)e[a]=e[a].slice(0),i[a]=i[a].slice(0);return t},Xt=null,$t=function(){function t(e){Gt(this,t),Xt||(Xt=Yt()),this._tables=[[Xt[0][0].slice(),Xt[0][1].slice(),Xt[0][2].slice(),Xt[0][3].slice(),Xt[0][4].slice()],[Xt[1][0].slice(),Xt[1][1].slice(),Xt[1][2].slice(),Xt[1][3].slice(),Xt[1][4].slice()]];var i=void 0,n=void 0,r=void 0,a=void 0,o=void 0,s=this._tables[0][4],c=this._tables[1],l=e.length,u=1;if(4!==l&&6!==l&&8!==l)throw new Error("Invalid aes key size");for(a=e.slice(0),o=[],this._key=[a,o],i=l;i<4*l+28;i++)r=a[i-1],(i%l===0||8===l&&i%l===4)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[255&r],i%l===0&&(r=r<<8^r>>>24^u<<24,u=u<<1^283*(u>>7))),a[i]=a[i-l]^r;for(n=0;i;n++,i--)r=a[3&n?i:i-4],o[n]=i<=4||n<4?r:c[0][s[r>>>24]]^c[1][s[r>>16&255]]^c[2][s[r>>8&255]]^c[3][s[255&r]]}return t.prototype.decrypt=function(t,e,i,n,r,a){var o=this._key[1],s=t^o[0],c=n^o[1],l=i^o[2],u=e^o[3],h=void 0,d=void 0,p=void 0,f=o.length/4-2,m=void 0,g=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],w=v[3],T=v[4];for(m=0;m<f;m++)h=y[s>>>24]^_[c>>16&255]^b[l>>8&255]^w[255&u]^o[g],d=y[c>>>24]^_[l>>16&255]^b[u>>8&255]^w[255&s]^o[g+1],p=y[l>>>24]^_[u>>16&255]^b[s>>8&255]^w[255&c]^o[g+2],u=y[u>>>24]^_[s>>16&255]^b[c>>8&255]^w[255&l]^o[g+3],g+=4,s=h,c=d,l=p;for(m=0;m<4;m++)r[(3&-m)+a]=T[s>>>24]<<24^T[c>>16&255]<<16^T[l>>8&255]<<8^T[255&u]^o[g++],h=s,s=c,c=l,l=u,u=h},t}(),Zt=function(){function t(){Gt(this,t),this.listeners={}}return t.prototype.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},t.prototype.off=function(t,e){if(!this.listeners[t])return!1;var i=this.listeners[t].indexOf(e);return this.listeners[t].splice(i,1),i>-1},t.prototype.trigger=function(t){var e=this.listeners[t];if(e)if(2===arguments.length)for(var i=e.length,n=0;n<i;++n)e[n].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),a=e.length,o=0;o<a;++o)e[o].apply(this,r)},t.prototype.dispose=function(){this.listeners={}},t.prototype.pipe=function(t){this.on("data",function(e){t.push(e)})},t}(),Jt=function(t){function e(){Gt(this,e);var i=qt(this,t.call(this,Zt));return i.jobs=[],i.delay=1,i.timeout_=null,i}return Wt(e,t),e.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},e.prototype.push=function(t){this.jobs.push(t),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},e}(Zt),Kt=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},Qt=function(t,e,i){var n=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2),r=new $t(Array.prototype.slice.call(e)),a=new Uint8Array(t.byteLength),o=new Int32Array(a.buffer),s=void 0,c=void 0,l=void 0,u=void 0,h=void 0,d=void 0,p=void 0,f=void 0,m=void 0;for(s=i[0],c=i[1],l=i[2],u=i[3],m=0;m<n.length;m+=4)h=Kt(n[m]),d=Kt(n[m+1]),p=Kt(n[m+2]),f=Kt(n[m+3]),r.decrypt(h,d,p,f,o,m),o[m]=Kt(o[m]^s),o[m+1]=Kt(o[m+1]^c),o[m+2]=Kt(o[m+2]^l),o[m+3]=Kt(o[m+3]^u),s=h,c=d,l=p,u=f;return a},te=function(){function t(e,i,n,r){Gt(this,t);var a=t.STEP,o=new Int32Array(e.buffer),s=new Uint8Array(e.byteLength),c=0;for(this.asyncStream_=new Jt,this.asyncStream_.push(this.decryptChunk_(o.subarray(c,c+a),i,n,s)),c=a;c<o.length;c+=a)n=new Uint32Array([Kt(o[c-4]),Kt(o[c-3]),Kt(o[c-2]),Kt(o[c-1])]),this.asyncStream_.push(this.decryptChunk_(o.subarray(c,c+a),i,n,s));this.asyncStream_.push(function(){r(null,Ht(s))})}return t.prototype.decryptChunk_=function(t,e,i,n){return function(){var r=Qt(t,e,i);n.set(r,t.byteOffset)}},Vt(t,null,[{key:"STEP",get:function(){return 32e3}}]),t}(),ee="7.4.1";function ie(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function ne(t,e){return ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ne(t,e)}function re(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function ae(t,e,i){return ae=re()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var r=Function.bind.apply(t,n),a=new r;return i&&ne(a,i.prototype),a},ae.apply(null,arguments)}function oe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function se(t,e){return e||(e=t.slice(0)),t.raw=e,t}var ce=[],le=function(t,e){return function(i,n,r){var a=e.levels[n],o=new RegExp("^("+a+")$");if("log"!==i&&r.unshift(i.toUpperCase()+":"),r.unshift(t+":"),ce&&ce.push([].concat(r)),xt.a.console){var s=xt.a.console[i];s||"debug"!==i||(s=xt.a.console.info||xt.a.console.log),s&&a&&o.test(i)&&s[Array.isArray(r)?"apply":"call"](xt.a.console,r)}}};function ue(t){var e,i="info",n=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];e("log",i,n)};return e=le(t,n),n.createLogger=function(e){return ue(t+": "+e)},n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:i},n.level=function(t){if("string"===typeof t){if(!n.levels.hasOwnProperty(t))throw new Error('"'+t+'" in not a valid log level');i=t}return i},n.history=function(){return ce?[].concat(ce):[]},n.history.filter=function(t){return(ce||[]).filter(function(e){return new RegExp(".*"+t+".*").test(e[0])})},n.history.clear=function(){ce&&(ce.length=0)},n.history.disable=function(){null!==ce&&(ce.length=0,ce=null)},n.history.enable=function(){null===ce&&(ce=[])},n.error=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e("error",i,n)},n.warn=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e("warn",i,n)},n.debug=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e("debug",i,n)},n}var he=ue("VIDEOJS"),de=he.createLogger,pe=Object.prototype.toString,fe=function(t){return ye(t)?Object.keys(t):[]};function me(t,e){fe(t).forEach(function(i){return e(t[i],i)})}function ge(t,e,i){return void 0===i&&(i=0),fe(t).reduce(function(i,n){return e(i,t[n],n)},i)}function ve(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return Object.assign?Object.assign.apply(Object,[t].concat(i)):(i.forEach(function(e){e&&me(e,function(e,i){t[i]=e})}),t)}function ye(t){return!!t&&"object"===typeof t}function _e(t){return ye(t)&&"[object Object]"===pe.call(t)&&t.constructor===Object}function be(t,e){if(!t||!e)return"";if("function"===typeof xt.a.getComputedStyle){var i=xt.a.getComputedStyle(t);return i?i[e]:""}return""}function we(){var t=se(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);return we=function(){return t},t}function Te(t){return"string"===typeof t&&/\S/.test(t)}function xe(t){if(/\s/.test(t))throw new Error("class has illegal whitespace characters")}function Se(t){return new RegExp("(^|\\s)"+t+"($|\\s)")}function Ee(){return Dt.a===xt.a.document}function Me(t){return ye(t)&&1===t.nodeType}function Ce(){try{return xt.a.parent!==xt.a.self}catch(t){return!0}}function Ae(t){return function(e,i){if(!Te(e))return Dt.a[t](null);Te(i)&&(i=Dt.a.querySelector(i));var n=Me(i)?i:Dt.a;return n[t]&&n[t](e)}}function ke(t,e,i,n){void 0===t&&(t="div"),void 0===e&&(e={}),void 0===i&&(i={});var r=Dt.a.createElement(t);return Object.getOwnPropertyNames(e).forEach(function(t){var i=e[t];-1!==t.indexOf("aria-")||"role"===t||"type"===t?(he.warn(vt()(we(),t,i)),r.setAttribute(t,i)):"textContent"===t?Le(r,i):r[t]=i}),Object.getOwnPropertyNames(i).forEach(function(t){r.setAttribute(t,i[t])}),n&&$e(r,n),r}function Le(t,e){return"undefined"===typeof t.textContent?t.innerText=e:t.textContent=e,t}function Pe(t,e){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}function Oe(t,e){return xe(e),t.classList?t.classList.contains(e):Se(e).test(t.className)}function Re(t,e){return t.classList?t.classList.add(e):Oe(t,e)||(t.className=(t.className+" "+e).trim()),t}function Ie(t,e){return t.classList?t.classList.remove(e):(xe(e),t.className=t.className.split(/\s+/).filter(function(t){return t!==e}).join(" ")),t}function De(t,e,i){var n=Oe(t,e);if("function"===typeof i&&(i=i(t,e)),"boolean"!==typeof i&&(i=!n),i!==n)return i?Re(t,e):Ie(t,e),t}function Ue(t,e){Object.getOwnPropertyNames(e).forEach(function(i){var n=e[i];null===n||"undefined"===typeof n||!1===n?t.removeAttribute(i):t.setAttribute(i,!0===n?"":n)})}function Ne(t){var e={},i=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(t&&t.attributes&&t.attributes.length>0)for(var n=t.attributes,r=n.length-1;r>=0;r--){var a=n[r].name,o=n[r].value;"boolean"!==typeof t[a]&&-1===i.indexOf(","+a+",")||(o=null!==o),e[a]=o}return e}function Be(t,e){return t.getAttribute(e)}function Fe(t,e,i){t.setAttribute(e,i)}function ze(t,e){t.removeAttribute(e)}function je(){Dt.a.body.focus(),Dt.a.onselectstart=function(){return!1}}function He(){Dt.a.onselectstart=function(){return!0}}function Ge(t){if(t&&t.getBoundingClientRect&&t.parentNode){var e=t.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(function(t){void 0!==e[t]&&(i[t]=e[t])}),i.height||(i.height=parseFloat(be(t,"height"))),i.width||(i.width=parseFloat(be(t,"width"))),i}}function Ve(t){var e;if(t.getBoundingClientRect&&t.parentNode&&(e=t.getBoundingClientRect()),!e)return{left:0,top:0};var i=Dt.a.documentElement,n=Dt.a.body,r=i.clientLeft||n.clientLeft||0,a=xt.a.pageXOffset||n.scrollLeft,o=e.left+a-r,s=i.clientTop||n.clientTop||0,c=xt.a.pageYOffset||n.scrollTop,l=e.top+c-s;return{left:Math.round(o),top:Math.round(l)}}function We(t,e){var i={},n=Ve(t),r=t.offsetWidth,a=t.offsetHeight,o=n.top,s=n.left,c=e.pageY,l=e.pageX;return e.changedTouches&&(l=e.changedTouches[0].pageX,c=e.changedTouches[0].pageY),i.y=Math.max(0,Math.min(1,(o-c+a)/a)),i.x=Math.max(0,Math.min(1,(l-s)/r)),i}function qe(t){return ye(t)&&3===t.nodeType}function Ye(t){while(t.firstChild)t.removeChild(t.firstChild);return t}function Xe(t){return"function"===typeof t&&(t=t()),(Array.isArray(t)?t:[t]).map(function(t){return"function"===typeof t&&(t=t()),Me(t)||qe(t)?t:"string"===typeof t&&/\S/.test(t)?Dt.a.createTextNode(t):void 0}).filter(function(t){return t})}function $e(t,e){return Xe(e).forEach(function(e){return t.appendChild(e)}),t}function Ze(t,e){return $e(Ye(t),e)}function Je(t){return void 0===t.button&&void 0===t.buttons||(0===t.button&&void 0===t.buttons||0===t.button&&1===t.buttons)}var Ke=Ae("querySelector"),Qe=Ae("querySelectorAll"),ti=Object.freeze({isReal:Ee,isEl:Me,isInFrame:Ce,createEl:ke,textContent:Le,prependTo:Pe,hasClass:Oe,addClass:Re,removeClass:Ie,toggleClass:De,setAttributes:Ue,getAttributes:Ne,getAttribute:Be,setAttribute:Fe,removeAttribute:ze,blockTextSelection:je,unblockTextSelection:He,getBoundingClientRect:Ge,findPosition:Ve,getPointerPosition:We,isTextNode:qe,emptyEl:Ye,normalizeContent:Xe,appendContent:$e,insertContent:Ze,isSingleLeftClick:Je,$:Ke,$$:Qe}),ei=1;function ii(){return ei++}var ni={},ri="vdata"+(new Date).getTime();function ai(t){var e=t[ri];return e||(e=t[ri]=ii()),ni[e]||(ni[e]={}),ni[e]}function oi(t){var e=t[ri];return!!e&&!!Object.getOwnPropertyNames(ni[e]).length}function si(t){var e=t[ri];if(e){delete ni[e];try{delete t[ri]}catch(i){t.removeAttribute?t.removeAttribute(ri):t[ri]=null}}}function ci(t,e){var i=ai(t);0===i.handlers[e].length&&(delete i.handlers[e],t.removeEventListener?t.removeEventListener(e,i.dispatcher,!1):t.detachEvent&&t.detachEvent("on"+e,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),0===Object.getOwnPropertyNames(i).length&&si(t)}function li(t,e,i,n){i.forEach(function(i){t(e,i,n)})}function ui(t){function e(){return!0}function i(){return!1}if(!t||!t.isPropagationStopped){var n=t||xt.a.event;for(var r in t={},n)"layerX"!==r&&"layerY"!==r&&"keyLocation"!==r&&"webkitMovementX"!==r&&"webkitMovementY"!==r&&("returnValue"===r&&n.preventDefault||(t[r]=n[r]));if(t.target||(t.target=t.srcElement||Dt.a),t.relatedTarget||(t.relatedTarget=t.fromElement===t.target?t.toElement:t.fromElement),t.preventDefault=function(){n.preventDefault&&n.preventDefault(),t.returnValue=!1,n.returnValue=!1,t.defaultPrevented=!0},t.defaultPrevented=!1,t.stopPropagation=function(){n.stopPropagation&&n.stopPropagation(),t.cancelBubble=!0,n.cancelBubble=!0,t.isPropagationStopped=e},t.isPropagationStopped=i,t.stopImmediatePropagation=function(){n.stopImmediatePropagation&&n.stopImmediatePropagation(),t.isImmediatePropagationStopped=e,t.stopPropagation()},t.isImmediatePropagationStopped=i,null!==t.clientX&&void 0!==t.clientX){var a=Dt.a.documentElement,o=Dt.a.body;t.pageX=t.clientX+(a&&a.scrollLeft||o&&o.scrollLeft||0)-(a&&a.clientLeft||o&&o.clientLeft||0),t.pageY=t.clientY+(a&&a.scrollTop||o&&o.scrollTop||0)-(a&&a.clientTop||o&&o.clientTop||0)}t.which=t.charCode||t.keyCode,null!==t.button&&void 0!==t.button&&(t.button=1&t.button?0:4&t.button?1:2&t.button?2:0)}return t}var hi=!1;(function(){try{var t=Object.defineProperty({},"passive",{get:function(){hi=!0}});xt.a.addEventListener("test",null,t),xt.a.removeEventListener("test",null,t)}catch(e){}})();var di=["touchstart","touchmove"];function pi(t,e,i){if(Array.isArray(e))return li(pi,t,e,i);var n=ai(t);if(n.handlers||(n.handlers={}),n.handlers[e]||(n.handlers[e]=[]),i.guid||(i.guid=ii()),n.handlers[e].push(i),n.dispatcher||(n.disabled=!1,n.dispatcher=function(e,i){if(!n.disabled){e=ui(e);var r=n.handlers[e.type];if(r)for(var a=r.slice(0),o=0,s=a.length;o<s;o++){if(e.isImmediatePropagationStopped())break;try{a[o].call(t,e,i)}catch(c){he.error(c)}}}}),1===n.handlers[e].length)if(t.addEventListener){var r=!1;hi&&di.indexOf(e)>-1&&(r={passive:!0}),t.addEventListener(e,n.dispatcher,r)}else t.attachEvent&&t.attachEvent("on"+e,n.dispatcher)}function fi(t,e,i){if(oi(t)){var n=ai(t);if(n.handlers){if(Array.isArray(e))return li(fi,t,e,i);var r=function(t,e){n.handlers[e]=[],ci(t,e)};if(void 0!==e){var a=n.handlers[e];if(a)if(i){if(i.guid)for(var o=0;o<a.length;o++)a[o].guid===i.guid&&a.splice(o--,1);ci(t,e)}else r(t,e)}else for(var s in n.handlers)Object.prototype.hasOwnProperty.call(n.handlers||{},s)&&r(t,s)}}}function mi(t,e,i){var n=oi(t)?ai(t):{},r=t.parentNode||t.ownerDocument;if("string"===typeof e?e={type:e,target:t}:e.target||(e.target=t),e=ui(e),n.dispatcher&&n.dispatcher.call(t,e,i),r&&!e.isPropagationStopped()&&!0===e.bubbles)mi.call(null,r,e,i);else if(!r&&!e.defaultPrevented){var a=ai(e.target);e.target[e.type]&&(a.disabled=!0,"function"===typeof e.target[e.type]&&e.target[e.type](),a.disabled=!1)}return!e.defaultPrevented}function gi(t,e,i){if(Array.isArray(e))return li(gi,t,e,i);var n=function n(){fi(t,e,n),i.apply(this,arguments)};n.guid=i.guid=i.guid||ii(),pi(t,e,n)}var vi,yi=Object.freeze({fixEvent:ui,on:pi,off:fi,trigger:mi,one:gi}),_i=!1,bi=function(){if(Ee()&&!1!==vi.options.autoSetup){var t=Array.prototype.slice.call(Dt.a.getElementsByTagName("video")),e=Array.prototype.slice.call(Dt.a.getElementsByTagName("audio")),i=Array.prototype.slice.call(Dt.a.getElementsByTagName("video-js")),n=t.concat(e,i);if(n&&n.length>0)for(var r=0,a=n.length;r<a;r++){var o=n[r];if(!o||!o.getAttribute){wi(1);break}if(void 0===o.player){var s=o.getAttribute("data-setup");null!==s&&vi(o)}}else _i||wi(1)}};function wi(t,e){e&&(vi=e),xt.a.setTimeout(bi,t)}Ee()&&"complete"===Dt.a.readyState?_i=!0:gi(xt.a,"load",function(){_i=!0});var Ti,xi=function(t){var e=Dt.a.createElement("style");return e.className=t,e},Si=function(t,e){t.styleSheet?t.styleSheet.cssText=e:t.textContent=e},Ei=function(t,e,i){e.guid||(e.guid=ii());var n=function(){return e.apply(t,arguments)};return n.guid=i?i+"_"+e.guid:e.guid,n},Mi=function(t,e){var i=Date.now(),n=function(){var n=Date.now();n-i>=e&&(t.apply(void 0,arguments),i=n)};return n},Ci=function(t,e,i,n){var r;void 0===n&&(n=xt.a);var a=function(){n.clearTimeout(r),r=null},o=function(){var a=this,o=arguments,s=function(){r=null,s=null,i||t.apply(a,o)};!r&&i&&t.apply(a,o),n.clearTimeout(r),r=n.setTimeout(s,e)};return o.cancel=a,o},Ai=function(){};Ai.prototype.allowedEvents_={},Ai.prototype.on=function(t,e){var i=this.addEventListener;this.addEventListener=function(){},pi(this,t,e),this.addEventListener=i},Ai.prototype.addEventListener=Ai.prototype.on,Ai.prototype.off=function(t,e){fi(this,t,e)},Ai.prototype.removeEventListener=Ai.prototype.off,Ai.prototype.one=function(t,e){var i=this.addEventListener;this.addEventListener=function(){},gi(this,t,e),this.addEventListener=i},Ai.prototype.trigger=function(t){var e=t.type||t;"string"===typeof t&&(t={type:e}),t=ui(t),this.allowedEvents_[e]&&this["on"+e]&&this["on"+e](t),mi(this,t)},Ai.prototype.dispatchEvent=Ai.prototype.trigger,Ai.prototype.queueTrigger=function(t){var e=this;Ti||(Ti=new Map);var i=t.type||t,n=Ti.get(this);n||(n=new Map,Ti.set(this,n));var r=n.get(i);n.delete(i),xt.a.clearTimeout(r);var a=xt.a.setTimeout(function(){0===n.size&&(n=null,Ti.delete(e)),e.trigger(t)},0);n.set(i,a)};var ki=function(t){return t instanceof Ai||!!t.eventBusEl_&&["on","one","off","trigger"].every(function(e){return"function"===typeof t[e]})},Li=function(t,e){ki(t)?e():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(e))},Pi=function(t){return"string"===typeof t&&/\S/.test(t)||Array.isArray(t)&&!!t.length},Oi=function(t){if(!t.nodeName&&!ki(t))throw new Error("Invalid target; must be a DOM node or evented object.")},Ri=function(t){if(!Pi(t))throw new Error("Invalid event type; must be a non-empty string or array.")},Ii=function(t){if("function"!==typeof t)throw new Error("Invalid listener; must be a function.")},Di=function(t,e){var i,n,r,a=e.length<3||e[0]===t||e[0]===t.eventBusEl_;return a?(i=t.eventBusEl_,e.length>=3&&e.shift(),n=e[0],r=e[1]):(i=e[0],n=e[1],r=e[2]),Oi(i),Ri(n),Ii(r),r=Ei(t,r),{isTargetingSelf:a,target:i,type:n,listener:r}},Ui=function(t,e,i,n){Oi(t),t.nodeName?yi[e](t,i,n):t[e](i,n)},Ni={on:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];var r=Di(this,i),a=r.isTargetingSelf,o=r.target,s=r.type,c=r.listener;if(Ui(o,"on",s,c),!a){var l=function(){return t.off(o,s,c)};l.guid=c.guid;var u=function(){return t.off("dispose",l)};u.guid=c.guid,Ui(this,"on","dispose",l),Ui(o,"on","dispose",u)}},one:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];var r=Di(this,i),a=r.isTargetingSelf,o=r.target,s=r.type,c=r.listener;if(a)Ui(o,"one",s,c);else{var l=function e(){t.off(o,s,e);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];c.apply(null,n)};l.guid=c.guid,Ui(o,"one",s,l)}},off:function(t,e,i){if(!t||Pi(t))fi(this.eventBusEl_,t,e);else{var n=t,r=e;Oi(n),Ri(r),Ii(i),i=Ei(this,i),this.off("dispose",i),n.nodeName?(fi(n,r,i),fi(n,"dispose",i)):ki(n)&&(n.off(r,i),n.off("dispose",i))}},trigger:function(t,e){return mi(this.eventBusEl_,t,e)}};function Bi(t,e){void 0===e&&(e={});var i=e,n=i.eventBusKey;if(n){if(!t[n].nodeName)throw new Error('The eventBusKey "'+n+'" does not refer to an element.');t.eventBusEl_=t[n]}else t.eventBusEl_=ke("span",{className:"vjs-event-bus"});return ve(t,Ni),t.eventedCallbacks&&t.eventedCallbacks.forEach(function(t){t()}),t.on("dispose",function(){t.off(),xt.a.setTimeout(function(){t.eventBusEl_=null},0)}),t}var Fi={state:{},setState:function(t){var e,i=this;return"function"===typeof t&&(t=t()),me(t,function(t,n){i.state[n]!==t&&(e=e||{},e[n]={from:i.state[n],to:t}),i.state[n]=t}),e&&ki(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function zi(t,e){return ve(t,Fi),t.state=ve({},t.state,e),"function"===typeof t.handleStateChanged&&ki(t)&&t.on("statechanged",t.handleStateChanged),t}function ji(t){return"string"!==typeof t?t:t.charAt(0).toUpperCase()+t.slice(1)}function Hi(t,e){return ji(t)===ji(e)}function Gi(){for(var t={},e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return i.forEach(function(e){e&&me(e,function(e,i){_e(e)?(_e(t[i])||(t[i]={}),t[i]=Gi(t[i],e)):t[i]=e})}),t}var Vi=function(){function t(t,e,i){if(!t&&this.play?this.player_=t=this:this.player_=t,this.options_=Gi({},this.options_),e=this.options_=Gi(this.options_,e),this.id_=e.id||e.el&&e.el.id,!this.id_){var n=t&&t.id&&t.id()||"no_player";this.id_=n+"_component_"+ii()}this.name_=e.name||null,e.el?this.el_=e.el:!1!==e.createEl&&(this.el_=this.createEl()),!1!==e.evented&&Bi(this,{eventBusKey:this.el_?"el_":null}),zi(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},!1!==e.initChildren&&this.initChildren(),this.ready(i),!1!==e.reportTouchActivity&&this.enableTouchActivity()}var e=t.prototype;return e.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),si(this.el_),this.el_=null),this.player_=null},e.player=function(){return this.player_},e.options=function(t){return he.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),t?(this.options_=Gi(this.options_,t),this.options_):this.options_},e.el=function(){return this.el_},e.createEl=function(t,e,i){return ke(t,e,i)},e.localize=function(t,e,i){void 0===i&&(i=t);var n=this.player_.language&&this.player_.language(),r=this.player_.languages&&this.player_.languages(),a=r&&r[n],o=n&&n.split("-")[0],s=r&&r[o],c=i;return a&&a[t]?c=a[t]:s&&s[t]&&(c=s[t]),e&&(c=c.replace(/\{(\d+)\}/g,function(t,i){var n=e[i-1],r=n;return"undefined"===typeof n&&(r=t),r})),c},e.contentEl=function(){return this.contentEl_||this.el_},e.id=function(){return this.id_},e.name=function(){return this.name_},e.children=function(){return this.children_},e.getChildById=function(t){return this.childIndex_[t]},e.getChild=function(t){if(t)return t=ji(t),this.childNameIndex_[t]},e.addChild=function(e,i,n){var r,a;if(void 0===i&&(i={}),void 0===n&&(n=this.children_.length),"string"===typeof e){a=ji(e);var o=i.componentClass||a;i.name=a;var s=t.getComponent(o);if(!s)throw new Error("Component "+o+" does not exist");if("function"!==typeof s)return null;r=new s(this.player_||this,i)}else r=e;if(this.children_.splice(n,0,r),"function"===typeof r.id&&(this.childIndex_[r.id()]=r),a=a||r.name&&ji(r.name()),a&&(this.childNameIndex_[a]=r),"function"===typeof r.el&&r.el()){var c=this.contentEl().children,l=c[n]||null;this.contentEl().insertBefore(r.el(),l)}return r},e.removeChild=function(t){if("string"===typeof t&&(t=this.getChild(t)),t&&this.children_){for(var e=!1,i=this.children_.length-1;i>=0;i--)if(this.children_[i]===t){e=!0,this.children_.splice(i,1);break}if(e){this.childIndex_[t.id()]=null,this.childNameIndex_[t.name()]=null;var n=t.el();n&&n.parentNode===this.contentEl()&&this.contentEl().removeChild(t.el())}}},e.initChildren=function(){var e=this,i=this.options_.children;if(i){var n,r=this.options_,a=function(t){var i=t.name,n=t.opts;if(void 0!==r[i]&&(n=r[i]),!1!==n){!0===n&&(n={}),n.playerOptions=e.options_.playerOptions;var a=e.addChild(i,n);a&&(e[i]=a)}},o=t.getComponent("Tech");n=Array.isArray(i)?i:Object.keys(i),n.concat(Object.keys(this.options_).filter(function(t){return!n.some(function(e){return"string"===typeof e?t===e:t===e.name})})).map(function(t){var n,r;return"string"===typeof t?(n=t,r=i[n]||e.options_[n]||{}):(n=t.name,r=t),{name:n,opts:r}}).filter(function(e){var i=t.getComponent(e.opts.componentClass||ji(e.name));return i&&!o.isTech(i)}).forEach(a)}},e.buildCSSClass=function(){return""},e.ready=function(t,e){if(void 0===e&&(e=!1),t)return this.isReady_?void(e?t.call(this):this.setTimeout(t,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(t))},e.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var t=this.readyQueue_;this.readyQueue_=[],t&&t.length>0&&t.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)},e.$=function(t,e){return Ke(t,e||this.contentEl())},e.$$=function(t,e){return Qe(t,e||this.contentEl())},e.hasClass=function(t){return Oe(this.el_,t)},e.addClass=function(t){Re(this.el_,t)},e.removeClass=function(t){Ie(this.el_,t)},e.toggleClass=function(t,e){De(this.el_,t,e)},e.show=function(){this.removeClass("vjs-hidden")},e.hide=function(){this.addClass("vjs-hidden")},e.lockShowing=function(){this.addClass("vjs-lock-showing")},e.unlockShowing=function(){this.removeClass("vjs-lock-showing")},e.getAttribute=function(t){return Be(this.el_,t)},e.setAttribute=function(t,e){Fe(this.el_,t,e)},e.removeAttribute=function(t){ze(this.el_,t)},e.width=function(t,e){return this.dimension("width",t,e)},e.height=function(t,e){return this.dimension("height",t,e)},e.dimensions=function(t,e){this.width(t,!0),this.height(e)},e.dimension=function(t,e,i){if(void 0!==e)return null!==e&&e===e||(e=0),-1!==(""+e).indexOf("%")||-1!==(""+e).indexOf("px")?this.el_.style[t]=e:this.el_.style[t]="auto"===e?"":e+"px",void(i||this.trigger("componentresize"));if(!this.el_)return 0;var n=this.el_.style[t],r=n.indexOf("px");return-1!==r?parseInt(n.slice(0,r),10):parseInt(this.el_["offset"+ji(t)],10)},e.currentDimension=function(t){var e=0;if("width"!==t&&"height"!==t)throw new Error("currentDimension only accepts width or height value");if("function"===typeof xt.a.getComputedStyle){var i=xt.a.getComputedStyle(this.el_);e=i.getPropertyValue(t)||i[t]}if(e=parseFloat(e),0===e){var n="offset"+ji(t);e=this.el_[n]}return e},e.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},e.currentWidth=function(){return this.currentDimension("width")},e.currentHeight=function(){return this.currentDimension("height")},e.focus=function(){this.el_.focus()},e.blur=function(){this.el_.blur()},e.emitTapEvents=function(){var t,e=0,i=null,n=10,r=200;this.on("touchstart",function(n){1===n.touches.length&&(i={pageX:n.touches[0].pageX,pageY:n.touches[0].pageY},e=(new Date).getTime(),t=!0)}),this.on("touchmove",function(e){if(e.touches.length>1)t=!1;else if(i){var r=e.touches[0].pageX-i.pageX,a=e.touches[0].pageY-i.pageY,o=Math.sqrt(r*r+a*a);o>n&&(t=!1)}});var a=function(){t=!1};this.on("touchleave",a),this.on("touchcancel",a),this.on("touchend",function(n){if(i=null,!0===t){var a=(new Date).getTime()-e;a<r&&(n.preventDefault(),this.trigger("tap"))}})},e.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var t,e=Ei(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){e(),this.clearInterval(t),t=this.setInterval(e,250)});var i=function(i){e(),this.clearInterval(t)};this.on("touchmove",e),this.on("touchend",i),this.on("touchcancel",i)}},e.setTimeout=function(t,e){var i,n,r=this;return t=Ei(this,t),i=xt.a.setTimeout(function(){r.off("dispose",n),t()},e),n=function(){return r.clearTimeout(i)},n.guid="vjs-timeout-"+i,this.on("dispose",n),i},e.clearTimeout=function(t){xt.a.clearTimeout(t);var e=function(){};return e.guid="vjs-timeout-"+t,this.off("dispose",e),t},e.setInterval=function(t,e){var i=this;t=Ei(this,t);var n=xt.a.setInterval(t,e),r=function(){return i.clearInterval(n)};return r.guid="vjs-interval-"+n,this.on("dispose",r),n},e.clearInterval=function(t){xt.a.clearInterval(t);var e=function(){};return e.guid="vjs-interval-"+t,this.off("dispose",e),t},e.requestAnimationFrame=function(t){var e,i,n=this;return this.supportsRaf_?(t=Ei(this,t),e=xt.a.requestAnimationFrame(function(){n.off("dispose",i),t()}),i=function(){return n.cancelAnimationFrame(e)},i.guid="vjs-raf-"+e,this.on("dispose",i),e):this.setTimeout(t,1e3/60)},e.cancelAnimationFrame=function(t){if(this.supportsRaf_){xt.a.cancelAnimationFrame(t);var e=function(){};return e.guid="vjs-raf-"+t,this.off("dispose",e),t}return this.clearTimeout(t)},t.registerComponent=function(e,i){if("string"!==typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var n,r=t.getComponent("Tech"),a=r&&r.isTech(i),o=t===i||t.prototype.isPrototypeOf(i.prototype);if(a||!o)throw n=a?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+e+'"; '+n+".");e=ji(e),t.components_||(t.components_={});var s=t.getComponent("Player");if("Player"===e&&s&&s.players){var c=s.players,l=Object.keys(c);if(c&&l.length>0&&l.map(function(t){return c[t]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return t.components_[e]=i,i},t.getComponent=function(e){if(e)return e=ji(e),t.components_&&t.components_[e]?t.components_[e]:void 0},t}();Vi.prototype.supportsRaf_="function"===typeof xt.a.requestAnimationFrame&&"function"===typeof xt.a.cancelAnimationFrame,Vi.registerComponent("Component",Vi);var Wi=xt.a.navigator&&xt.a.navigator.userAgent||"",qi=/AppleWebKit\/([\d.]+)/i.exec(Wi),Yi=qi?parseFloat(qi.pop()):null,Xi=/iPad/i.test(Wi),$i=/iPhone/i.test(Wi)&&!Xi,Zi=/iPod/i.test(Wi),Ji=$i||Xi||Zi,Ki=function(){var t=Wi.match(/OS (\d+)_/i);return t&&t[1]?t[1]:null}(),Qi=/Android/i.test(Wi),tn=function(){var t=Wi.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!t)return null;var e=t[1]&&parseFloat(t[1]),i=t[2]&&parseFloat(t[2]);return e&&i?parseFloat(t[1]+"."+t[2]):e||null}(),en=Qi&&tn<5&&Yi<537,nn=/Firefox/i.test(Wi),rn=/Edge/i.test(Wi),an=!rn&&(/Chrome/i.test(Wi)||/CriOS/i.test(Wi)),on=function(){var t=Wi.match(/(Chrome|CriOS)\/(\d+)/);return t&&t[2]?parseFloat(t[2]):null}(),sn=function(){var t=/MSIE\s(\d+)\.\d/.exec(Wi),e=t&&parseFloat(t[1]);return!e&&/Trident\/7.0/i.test(Wi)&&/rv:11.0/.test(Wi)&&(e=11),e}(),cn=/Safari/i.test(Wi)&&!an&&!Qi&&!rn,ln=(cn||Ji)&&!an,un=Ee()&&("ontouchstart"in xt.a||xt.a.navigator.maxTouchPoints||xt.a.DocumentTouch&&xt.a.document instanceof xt.a.DocumentTouch),hn=Object.freeze({IS_IPAD:Xi,IS_IPHONE:$i,IS_IPOD:Zi,IS_IOS:Ji,IOS_VERSION:Ki,IS_ANDROID:Qi,ANDROID_VERSION:tn,IS_NATIVE_ANDROID:en,IS_FIREFOX:nn,IS_EDGE:rn,IS_CHROME:an,CHROME_VERSION:on,IE_VERSION:sn,IS_SAFARI:cn,IS_ANY_SAFARI:ln,TOUCH_ENABLED:un});function dn(t,e,i){if("number"!==typeof e||e<0||e>i)throw new Error("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+e+") is non-numeric or out of bounds (0-"+i+").")}function pn(t,e,i,n){return dn(t,n,i.length-1),i[n][e]}function fn(t){return void 0===t||0===t.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:t.length,start:pn.bind(null,"start",0,t),end:pn.bind(null,"end",1,t)}}function mn(t,e){return Array.isArray(t)?fn(t):void 0===t||void 0===e?fn():fn([[t,e]])}function gn(t,e){var i,n,r=0;if(!e)return 0;t&&t.length||(t=mn(0,0));for(var a=0;a<t.length;a++)i=t.start(a),n=t.end(a),n>e&&(n=e),r+=n-i;return r/e}for(var vn,yn={},_n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],bn=_n[0],wn=0;wn<_n.length;wn++)if(_n[wn][1]in Dt.a){vn=_n[wn];break}if(vn)for(var Tn=0;Tn<vn.length;Tn++)yn[bn[Tn]]=vn[Tn];function xn(t){if(t instanceof xn)return t;"number"===typeof t?this.code=t:"string"===typeof t?this.message=t:ye(t)&&("number"===typeof t.code&&(this.code=t.code),ve(this,t)),this.message||(this.message=xn.defaultMessages[this.code]||"")}xn.prototype.code=0,xn.prototype.message="",xn.prototype.status=null,xn.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],xn.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Sn=0;Sn<xn.errorTypes.length;Sn++)xn[xn.errorTypes[Sn]]=Sn,xn.prototype[xn.errorTypes[Sn]]=Sn;function En(t){return void 0!==t&&null!==t&&"function"===typeof t.then}function Mn(t){En(t)&&t.then(null,function(t){})}var Cn=function(t){var e=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(e,i,n){return t[i]&&(e[i]=t[i]),e},{cues:t.cues&&Array.prototype.map.call(t.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})});return e},An=function(t){var e=t.$$("track"),i=Array.prototype.map.call(e,function(t){return t.track}),n=Array.prototype.map.call(e,function(t){var e=Cn(t.track);return t.src&&(e.src=t.src),e});return n.concat(Array.prototype.filter.call(t.textTracks(),function(t){return-1===i.indexOf(t)}).map(Cn))},kn=function(t,e){return t.forEach(function(t){var i=e.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach(function(t){return i.addCue(t)})}),e.textTracks()},Ln={textTracksToJson:An,jsonToTextTracks:kn,trackToJson_:Cn},Pn="vjs-modal-dialog",On=27,Rn=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.opened_=n.hasBeenOpened_=n.hasBeenFilled_=!1,n.closeable(!n.options_.uncloseable),n.content(n.options_.content),n.contentEl_=ke("div",{className:Pn+"-content"},{role:"document"}),n.descEl_=ke("p",{className:Pn+"-description vjs-control-text",id:n.el().getAttribute("aria-describedby")}),Le(n.descEl_,n.description()),n.el_.appendChild(n.descEl_),n.el_.appendChild(n.contentEl_),n}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},i.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,t.prototype.dispose.call(this)},i.buildCSSClass=function(){return Pn+" vjs-hidden "+t.prototype.buildCSSClass.call(this)},i.handleKeyPress=function(t){t.which===On&&this.closeable()&&this.close()},i.label=function(){return this.localize(this.options_.label||"Modal Window")},i.description=function(){var t=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(t+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),t},i.open=function(){if(!this.opened_){var t=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!t.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&t.pause(),this.closeable()&&this.on(this.el_.ownerDocument,"keydown",Ei(this,this.handleKeyPress)),this.hadControls_=t.controls(),t.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},i.opened=function(t){return"boolean"===typeof t&&this[t?"open":"close"](),this.opened_},i.close=function(){if(this.opened_){var t=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&t.play(),this.closeable()&&this.off(this.el_.ownerDocument,"keydown",Ei(this,this.handleKeyPress)),this.hadControls_&&t.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},i.closeable=function(t){if("boolean"===typeof t){var e=this.closeable_=!!t,i=this.getChild("closeButton");if(e&&!i){var n=this.contentEl_;this.contentEl_=this.el_,i=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=n,this.on(i,"close",this.close)}!e&&i&&(this.off(i,"close",this.close),this.removeChild(i),i.dispose())}return this.closeable_},i.fill=function(){this.fillWith(this.content())},i.fillWith=function(t){var e=this.contentEl(),i=e.parentNode,n=e.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,i.removeChild(e),this.empty(),Ze(e,t),this.trigger("modalfill"),n?i.insertBefore(e,n):i.appendChild(e);var r=this.getChild("closeButton");r&&i.appendChild(r.el_)},i.empty=function(){this.trigger("beforemodalempty"),Ye(this.contentEl()),this.trigger("modalempty")},i.content=function(t){return"undefined"!==typeof t&&(this.content_=t),this.content_},i.conditionalFocus_=function(){var t=Dt.a.activeElement,e=this.player_.el_;this.previouslyActiveEl_=null,(e.contains(t)||e===t)&&(this.previouslyActiveEl_=t,this.focus(),this.on(Dt.a,"keydown",this.handleKeyDown))},i.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null),this.off(Dt.a,"keydown",this.handleKeyDown)},i.handleKeyDown=function(t){if(9===t.which){for(var e,i=this.focusableEls_(),n=this.el_.querySelector(":focus"),r=0;r<i.length;r++)if(n===i[r]){e=r;break}Dt.a.activeElement===this.el_&&(e=0),t.shiftKey&&0===e?(i[i.length-1].focus(),t.preventDefault()):t.shiftKey||e!==i.length-1||(i[0].focus(),t.preventDefault())}},i.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(t){return(t instanceof xt.a.HTMLAnchorElement||t instanceof xt.a.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof xt.a.HTMLInputElement||t instanceof xt.a.HTMLSelectElement||t instanceof xt.a.HTMLTextAreaElement||t instanceof xt.a.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof xt.a.HTMLIFrameElement||t instanceof xt.a.HTMLObjectElement||t instanceof xt.a.HTMLEmbedElement||t.hasAttribute("tabindex")&&-1!==t.getAttribute("tabindex")||t.hasAttribute("contenteditable")})},e}(Vi);Rn.prototype.options_={pauseOnOpen:!0,temporary:!0},Vi.registerComponent("ModalDialog",Rn);var In=function(t){function e(e){var i;void 0===e&&(e=[]),i=t.call(this)||this,i.tracks_=[],Object.defineProperty(oe(oe(i)),"length",{get:function(){return this.tracks_.length}});for(var n=0;n<e.length;n++)i.addTrack(e[n]);return i}ie(e,t);var i=e.prototype;return i.addTrack=function(t){var e=this.tracks_.length;""+e in this||Object.defineProperty(this,e,{get:function(){return this.tracks_[e]}}),-1===this.tracks_.indexOf(t)&&(this.tracks_.push(t),this.trigger({track:t,type:"addtrack"}))},i.removeTrack=function(t){for(var e,i=0,n=this.length;i<n;i++)if(this[i]===t){e=this[i],e.off&&e.off(),this.tracks_.splice(i,1);break}e&&this.trigger({track:e,type:"removetrack"})},i.getTrackById=function(t){for(var e=null,i=0,n=this.length;i<n;i++){var r=this[i];if(r.id===t){e=r;break}}return e},e}(Ai);for(var Dn in In.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},In.prototype.allowedEvents_)In.prototype["on"+Dn]=null;var Un=function(t,e){for(var i=0;i<t.length;i++)Object.keys(t[i]).length&&e.id!==t[i].id&&(t[i].enabled=!1)},Nn=function(t){function e(e){var i;void 0===e&&(e=[]);for(var n=e.length-1;n>=0;n--)if(e[n].enabled){Un(e,e[n]);break}return i=t.call(this,e)||this,i.changing_=!1,i}ie(e,t);var i=e.prototype;return i.addTrack=function(e){var i=this;e.enabled&&Un(this,e),t.prototype.addTrack.call(this,e),e.addEventListener&&e.addEventListener("enabledchange",function(){i.changing_||(i.changing_=!0,Un(i,e),i.changing_=!1,i.trigger("change"))})},e}(In),Bn=function(t,e){for(var i=0;i<t.length;i++)Object.keys(t[i]).length&&e.id!==t[i].id&&(t[i].selected=!1)},Fn=function(t){function e(e){var i;void 0===e&&(e=[]);for(var n=e.length-1;n>=0;n--)if(e[n].selected){Bn(e,e[n]);break}return i=t.call(this,e)||this,i.changing_=!1,Object.defineProperty(oe(oe(i)),"selectedIndex",{get:function(){for(var t=0;t<this.length;t++)if(this[t].selected)return t;return-1},set:function(){}}),i}ie(e,t);var i=e.prototype;return i.addTrack=function(e){var i=this;e.selected&&Bn(this,e),t.prototype.addTrack.call(this,e),e.addEventListener&&e.addEventListener("selectedchange",function(){i.changing_||(i.changing_=!0,Bn(i,e),i.changing_=!1,i.trigger("change"))})},e}(In),zn=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.addTrack=function(e){t.prototype.addTrack.call(this,e),e.addEventListener("modechange",Ei(this,function(){this.queueTrigger("change")}));var i=["metadata","chapters"];-1===i.indexOf(e.kind)&&e.addEventListener("modechange",Ei(this,function(){this.trigger("selectedlanguagechange")}))},e}(In),jn=function(){function t(t){void 0===t&&(t=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var e=0,i=t.length;e<i;e++)this.addTrackElement_(t[e])}var e=t.prototype;return e.addTrackElement_=function(t){var e=this.trackElements_.length;""+e in this||Object.defineProperty(this,e,{get:function(){return this.trackElements_[e]}}),-1===this.trackElements_.indexOf(t)&&this.trackElements_.push(t)},e.getTrackElementByTrack_=function(t){for(var e,i=0,n=this.trackElements_.length;i<n;i++)if(t===this.trackElements_[i].track){e=this.trackElements_[i];break}return e},e.removeTrackElement_=function(t){for(var e=0,i=this.trackElements_.length;e<i;e++)if(t===this.trackElements_[e]){this.trackElements_.splice(e,1);break}},t}(),Hn=function(){function t(e){t.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var e=t.prototype;return e.setCues_=function(t){var e=this.length||0,i=0,n=t.length;this.cues_=t,this.length_=t.length;var r=function(t){""+t in this||Object.defineProperty(this,""+t,{get:function(){return this.cues_[t]}})};if(e<n)for(i=e;i<n;i++)r.call(this,i)},e.getCueById=function(t){for(var e=null,i=0,n=this.length;i<n;i++){var r=this[i];if(r.id===t){e=r;break}}return e},t}(),Gn={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Vn={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Wn={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},qn={disabled:"disabled",hidden:"hidden",showing:"showing"},Yn=function(t){function e(e){var i;void 0===e&&(e={}),i=t.call(this)||this;var n={id:e.id||"vjs_track_"+ii(),kind:e.kind||"",label:e.label||"",language:e.language||""},r=function(t){Object.defineProperty(oe(oe(i)),t,{get:function(){return n[t]},set:function(){}})};for(var a in n)r(a);return i}return ie(e,t),e}(Ai),Xn=function(t){var e=["protocol","hostname","port","pathname","search","hash","host"],i=Dt.a.createElement("a");i.href=t;var n,r=""===i.host&&"file:"!==i.protocol;r&&(n=Dt.a.createElement("div"),n.innerHTML='<a href="'+t+'"></a>',i=n.firstChild,n.setAttribute("style","display:none; position:absolute;"),Dt.a.body.appendChild(n));for(var a={},o=0;o<e.length;o++)a[e[o]]=i[e[o]];return"http:"===a.protocol&&(a.host=a.host.replace(/:80$/,"")),"https:"===a.protocol&&(a.host=a.host.replace(/:443$/,"")),a.protocol||(a.protocol=xt.a.location.protocol),r&&Dt.a.body.removeChild(n),a},$n=function(t){if(!t.match(/^https?:\/\//)){var e=Dt.a.createElement("div");e.innerHTML='<a href="'+t+'">x</a>',t=e.firstChild.href}return t},Zn=function(t){if("string"===typeof t){var e=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i,i=e.exec(t);if(i)return i.pop().toLowerCase()}return""},Jn=function(t){var e=xt.a.location,i=Xn(t),n=":"===i.protocol?e.protocol:i.protocol,r=n+i.host!==e.protocol+e.host;return r},Kn=Object.freeze({parseUrl:Xn,getAbsoluteURL:$n,getFileExtension:Zn,isCrossOrigin:Jn}),Qn=function(t,e){var i=new xt.a.WebVTT.Parser(xt.a,xt.a.vttjs,xt.a.WebVTT.StringDecoder()),n=[];i.oncue=function(t){e.addCue(t)},i.onparsingerror=function(t){n.push(t)},i.onflush=function(){e.trigger({type:"loadeddata",target:e})},i.parse(t),n.length>0&&(xt.a.console&&xt.a.console.groupCollapsed&&xt.a.console.groupCollapsed("Text Track parsing errors for "+e.src),n.forEach(function(t){return he.error(t)}),xt.a.console&&xt.a.console.groupEnd&&xt.a.console.groupEnd()),i.flush()},tr=function(t,e){var i={uri:t},n=Jn(t);n&&(i.cors=n),_t()(i,Ei(this,function(t,i,n){if(t)return he.error(t,i);if(e.loaded_=!0,"function"!==typeof xt.a.WebVTT){if(e.tech_){var r=function(){return Qn(n,e)};e.tech_.on("vttjsloaded",r),e.tech_.on("vttjserror",function(){he.error("vttjs failed to load, stopping trying to process "+e.src),e.tech_.off("vttjsloaded",r)})}}else Qn(n,e)}))},er=function(t){function e(e){var i;if(void 0===e&&(e={}),!e.tech)throw new Error("A tech was not provided.");var n=Gi(e,{kind:Wn[e.kind]||"subtitles",language:e.language||e.srclang||""}),r=qn[n.mode]||"disabled",a=n.default;"metadata"!==n.kind&&"chapters"!==n.kind||(r="hidden"),i=t.call(this,n)||this,i.tech_=n.tech,i.cues_=[],i.activeCues_=[];var o=new Hn(i.cues_),s=new Hn(i.activeCues_),c=!1,l=Ei(oe(oe(i)),function(){this.activeCues=this.activeCues,c&&(this.trigger("cuechange"),c=!1)});return"disabled"!==r&&i.tech_.ready(function(){i.tech_.on("timeupdate",l)},!0),Object.defineProperties(oe(oe(i)),{default:{get:function(){return a},set:function(){}},mode:{get:function(){return r},set:function(t){var e=this;qn[t]&&(r=t,"disabled"!==r?this.tech_.ready(function(){e.tech_.on("timeupdate",l)},!0):this.tech_.off("timeupdate",l),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?o:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return s;for(var t=this.tech_.currentTime(),e=[],i=0,n=this.cues.length;i<n;i++){var r=this.cues[i];r.startTime<=t&&r.endTime>=t?e.push(r):r.startTime===r.endTime&&r.startTime<=t&&r.startTime+.5>=t&&e.push(r)}if(c=!1,e.length!==this.activeCues_.length)c=!0;else for(var a=0;a<e.length;a++)-1===this.activeCues_.indexOf(e[a])&&(c=!0);return this.activeCues_=e,s.setCues_(this.activeCues_),s},set:function(){}}}),n.src?(i.src=n.src,tr(n.src,oe(oe(i)))):i.loaded_=!0,i}ie(e,t);var i=e.prototype;return i.addCue=function(t){var e=t;if(xt.a.vttjs&&!(t instanceof xt.a.vttjs.VTTCue)){for(var i in e=new xt.a.vttjs.VTTCue(t.startTime,t.endTime,t.text),t)i in e||(e[i]=t[i]);e.id=t.id,e.originalCue_=t}for(var n=this.tech_.textTracks(),r=0;r<n.length;r++)n[r]!==this&&n[r].removeCue(e);this.cues_.push(e),this.cues.setCues_(this.cues_)},i.removeCue=function(t){var e=this.cues_.length;while(e--){var i=this.cues_[e];if(i===t||i.originalCue_&&i.originalCue_===t){this.cues_.splice(e,1),this.cues.setCues_(this.cues_);break}}},e}(Yn);er.prototype.allowedEvents_={cuechange:"cuechange"};var ir=function(t){function e(e){var i;void 0===e&&(e={});var n=Gi(e,{kind:Vn[e.kind]||""});i=t.call(this,n)||this;var r=!1;return Object.defineProperty(oe(oe(i)),"enabled",{get:function(){return r},set:function(t){"boolean"===typeof t&&t!==r&&(r=t,this.trigger("enabledchange"))}}),n.enabled&&(i.enabled=n.enabled),i.loaded_=!0,i}return ie(e,t),e}(Yn),nr=function(t){function e(e){var i;void 0===e&&(e={});var n=Gi(e,{kind:Gn[e.kind]||""});i=t.call(this,n)||this;var r=!1;return Object.defineProperty(oe(oe(i)),"selected",{get:function(){return r},set:function(t){"boolean"===typeof t&&t!==r&&(r=t,this.trigger("selectedchange"))}}),n.selected&&(i.selected=n.selected),i}return ie(e,t),e}(Yn),rr=0,ar=1,or=2,sr=3,cr=function(t){function e(e){var i,n;void 0===e&&(e={}),i=t.call(this)||this;var r=new er(e);return i.kind=r.kind,i.src=r.src,i.srclang=r.language,i.label=r.label,i.default=r.default,Object.defineProperties(oe(oe(i)),{readyState:{get:function(){return n}},track:{get:function(){return r}}}),n=rr,r.addEventListener("loadeddata",function(){n=or,i.trigger({type:"load",target:oe(oe(i))})}),i}return ie(e,t),e}(Ai);cr.prototype.allowedEvents_={load:"load"},cr.NONE=rr,cr.LOADING=ar,cr.LOADED=or,cr.ERROR=sr;var lr={audio:{ListClass:Nn,TrackClass:ir,capitalName:"Audio"},video:{ListClass:Fn,TrackClass:nr,capitalName:"Video"},text:{ListClass:zn,TrackClass:er,capitalName:"Text"}};Object.keys(lr).forEach(function(t){lr[t].getterName=t+"Tracks",lr[t].privateName=t+"Tracks_"});var ur={remoteText:{ListClass:zn,TrackClass:er,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:jn,TrackClass:cr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},hr=Gi(lr,ur);function dr(t,e,i,n,r){void 0===r&&(r={});var a=t.textTracks();r.kind=e,i&&(r.label=i),n&&(r.language=n),r.tech=t;var o=new hr.text.TrackClass(r);return a.addTrack(o),o}ur.names=Object.keys(ur),lr.names=Object.keys(lr),hr.names=[].concat(ur.names).concat(lr.names);var pr=function(t){function e(e,i){var n;return void 0===e&&(e={}),void 0===i&&(i=function(){}),e.reportTouchActivity=!1,n=t.call(this,null,e,i)||this,n.hasStarted_=!1,n.on("playing",function(){this.hasStarted_=!0}),n.on("loadstart",function(){this.hasStarted_=!1}),hr.names.forEach(function(t){var i=hr[t];e&&e[i.getterName]&&(n[i.privateName]=e[i.getterName])}),n.featuresProgressEvents||n.manualProgressOn(),n.featuresTimeupdateEvents||n.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(t){!1===e["native"+t+"Tracks"]&&(n["featuresNative"+t+"Tracks"]=!1)}),!1===e.nativeCaptions||!1===e.nativeTextTracks?n.featuresNativeTextTracks=!1:!0!==e.nativeCaptions&&!0!==e.nativeTextTracks||(n.featuresNativeTextTracks=!0),n.featuresNativeTextTracks||n.emulateTextTracks(),n.autoRemoteTextTracks_=new hr.text.ListClass,n.initTrackListeners(),e.nativeControlsForTouch||n.emitTapEvents(),n.constructor&&(n.name_=n.constructor.name||"Unknown Tech"),n}ie(e,t);var i=e.prototype;return i.triggerSourceset=function(t){var e=this;this.isReady_||this.one("ready",function(){return e.setTimeout(function(){return e.triggerSourceset(t)},1)}),this.trigger({src:t,type:"sourceset"})},i.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},i.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},i.trackProgress=function(t){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Ei(this,function(){var t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,1===t&&this.stopTrackingProgress()}),500)},i.onDurationChange=function(t){this.duration_=this.duration()},i.buffered=function(){return mn(0,0)},i.bufferedPercent=function(){return gn(this.buffered(),this.duration_)},i.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},i.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},i.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},i.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},i.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},i.dispose=function(){this.clearTracks(lr.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},i.clearTracks=function(t){var e=this;t=[].concat(t),t.forEach(function(t){var i=e[t+"Tracks"]()||[],n=i.length;while(n--){var r=i[n];"text"===t&&e.removeRemoteTextTrack(r),i.removeTrack(r)}})},i.cleanupAutoTextTracks=function(){var t=this.autoRemoteTextTracks_||[],e=t.length;while(e--){var i=t[e];this.removeRemoteTextTrack(i)}},i.reset=function(){},i.error=function(t){return void 0!==t&&(this.error_=new xn(t),this.trigger("error")),this.error_},i.played=function(){return this.hasStarted_?mn(0,0):mn()},i.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},i.initTrackListeners=function(){var t=this;lr.names.forEach(function(e){var i=lr[e],n=function(){t.trigger(e+"trackchange")},r=t[i.getterName]();r.addEventListener("removetrack",n),r.addEventListener("addtrack",n),t.on("dispose",function(){r.removeEventListener("removetrack",n),r.removeEventListener("addtrack",n)})})},i.addWebVttScript_=function(){var t=this;if(!xt.a.WebVTT)if(Dt.a.body.contains(this.el())){if(!this.options_["vtt.js"]&&_e(mt.a)&&Object.keys(mt.a).length>0)return void this.trigger("vttjsloaded");var e=Dt.a.createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=function(){t.trigger("vttjsloaded")},e.onerror=function(){t.trigger("vttjserror")},this.on("dispose",function(){e.onload=null,e.onerror=null}),xt.a.WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)},i.emulateTextTracks=function(){var t=this,e=this.textTracks(),i=this.remoteTextTracks(),n=function(t){return e.addTrack(t.track)},r=function(t){return e.removeTrack(t.track)};i.on("addtrack",n),i.on("removetrack",r),this.addWebVttScript_();var a=function(){return t.trigger("texttrackchange")},o=function(){a();for(var t=0;t<e.length;t++){var i=e[t];i.removeEventListener("cuechange",a),"showing"===i.mode&&i.addEventListener("cuechange",a)}};o(),e.addEventListener("change",o),e.addEventListener("addtrack",o),e.addEventListener("removetrack",o),this.on("dispose",function(){i.off("addtrack",n),i.off("removetrack",r),e.removeEventListener("change",o),e.removeEventListener("addtrack",o),e.removeEventListener("removetrack",o);for(var t=0;t<e.length;t++){var s=e[t];s.removeEventListener("cuechange",a)}})},i.addTextTrack=function(t,e,i){if(!t)throw new Error("TextTrack kind is required but was not provided");return dr(this,t,e,i)},i.createRemoteTextTrack=function(t){var e=Gi(t,{tech:this});return new ur.remoteTextEl.TrackClass(e)},i.addRemoteTextTrack=function(t,e){var i=this;void 0===t&&(t={});var n=this.createRemoteTextTrack(t);return!0!==e&&!1!==e&&(he.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),e=!0),this.remoteTextTrackEls().addTrackElement_(n),this.remoteTextTracks().addTrack(n.track),!0!==e&&this.ready(function(){return i.autoRemoteTextTracks_.addTrack(n.track)}),n},i.removeRemoteTextTrack=function(t){var e=this.remoteTextTrackEls().getTrackElementByTrack_(t);this.remoteTextTrackEls().removeTrackElement_(e),this.remoteTextTracks().removeTrack(t),this.autoRemoteTextTracks_.removeTrack(t)},i.getVideoPlaybackQuality=function(){return{}},i.setPoster=function(){},i.playsinline=function(){},i.setPlaysinline=function(){},i.overrideNativeAudioTracks=function(){},i.overrideNativeVideoTracks=function(){},i.canPlayType=function(){return""},e.canPlayType=function(){return""},e.canPlaySource=function(t,i){return e.canPlayType(t.type)},e.isTech=function(t){return t.prototype instanceof e||t instanceof e||t===e},e.registerTech=function(t,i){if(e.techs_||(e.techs_={}),!e.isTech(i))throw new Error("Tech "+t+" must be a Tech");if(!e.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!e.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return t=ji(t),e.techs_[t]=i,"Tech"!==t&&e.defaultTechOrder_.push(t),i},e.getTech=function(t){if(t)return t=ji(t),e.techs_&&e.techs_[t]?e.techs_[t]:xt.a&&xt.a.videojs&&xt.a.videojs[t]?(he.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),xt.a.videojs[t]):void 0},e}(Vi);hr.names.forEach(function(t){var e=hr[t];pr.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}}),pr.prototype.featuresVolumeControl=!0,pr.prototype.featuresMuteControl=!0,pr.prototype.featuresFullscreenResize=!1,pr.prototype.featuresPlaybackRate=!1,pr.prototype.featuresProgressEvents=!1,pr.prototype.featuresSourceset=!1,pr.prototype.featuresTimeupdateEvents=!1,pr.prototype.featuresNativeTextTracks=!1,pr.withSourceHandlers=function(t){t.registerSourceHandler=function(e,i){var n=t.sourceHandlers;n||(n=t.sourceHandlers=[]),void 0===i&&(i=n.length),n.splice(i,0,e)},t.canPlayType=function(e){for(var i,n=t.sourceHandlers||[],r=0;r<n.length;r++)if(i=n[r].canPlayType(e),i)return i;return""},t.selectSourceHandler=function(e,i){for(var n,r=t.sourceHandlers||[],a=0;a<r.length;a++)if(n=r[a].canHandleSource(e,i),n)return r[a];return null},t.canPlaySource=function(e,i){var n=t.selectSourceHandler(e,i);return n?n.canHandleSource(e,i):""};var e=["seekable","seeking","duration"];e.forEach(function(t){var e=this[t];"function"===typeof e&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):e.apply(this,arguments)})},t.prototype),t.prototype.setSource=function(e){var i=t.selectSourceHandler(e,this.options_);i||(t.nativeSourceHandler?i=t.nativeSourceHandler:he.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),i!==t.nativeSourceHandler&&(this.currentSource_=e),this.sourceHandler_=i.handleSource(e,this,this.options_),this.on("dispose",this.disposeSourceHandler)},t.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Vi.registerComponent("Tech",pr),pr.registerTech("Tech",pr),pr.defaultTechOrder_=[];var fr={},mr={},gr={};function vr(t,e){fr[t]=fr[t]||[],fr[t].push(e)}function yr(t,e,i){t.setTimeout(function(){return Lr(e,fr[e.type],i,t)},1)}function _r(t,e){t.forEach(function(t){return t.setTech&&t.setTech(e)})}function br(t,e,i){return t.reduceRight(Mr(i),e[i]())}function wr(t,e,i,n){return e[i](t.reduce(Mr(i),n))}function Tr(t,e,i,n){void 0===n&&(n=null);var r="call"+ji(i),a=t.reduce(Mr(r),n),o=a===gr,s=o?null:e[i](a);return Cr(t,i,s,o),s}var xr={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1},Sr={setCurrentTime:1},Er={play:1,pause:1};function Mr(t){return function(e,i){return e===gr?gr:i[t]?i[t](e):e}}function Cr(t,e,i,n){for(var r=t.length-1;r>=0;r--){var a=t[r];a[e]&&a[e](n,i)}}function Ar(t){mr[t.id()]=null}function kr(t,e){var i=mr[t.id()],n=null;if(void 0===i||null===i)return n=e(t),mr[t.id()]=[[e,n]],n;for(var r=0;r<i.length;r++){var a=i[r],o=a[0],s=a[1];o===e&&(n=s)}return null===n&&(n=e(t),i.push([e,n])),n}function Lr(t,e,i,n,r,a){void 0===t&&(t={}),void 0===e&&(e=[]),void 0===r&&(r=[]),void 0===a&&(a=!1);var o=e,s=o[0],c=o.slice(1);if("string"===typeof s)Lr(t,fr[s],i,n,r,a);else if(s){var l=kr(n,s);if(!l.setSource)return r.push(l),Lr(t,c,i,n,r,a);l.setSource(ve({},t),function(e,o){if(e)return Lr(t,c,i,n,r,a);r.push(l),Lr(o,t.type===o.type?c:fr[o.type],i,n,r,a)})}else c.length?Lr(t,c,i,n,r,a):a?i(t,r):Lr(t,fr["*"],i,n,r,!0)}var Pr={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL"},Or=function(t){void 0===t&&(t="");var e=Zn(t),i=Pr[e.toLowerCase()];return i||""},Rr=function(t,e){if(!e)return"";if(t.cache_.source.src===e&&t.cache_.source.type)return t.cache_.source.type;var i=t.cache_.sources.filter(function(t){return t.src===e});if(i.length)return i[0].type;for(var n=t.$$("source"),r=0;r<n.length;r++){var a=n[r];if(a.type&&a.src&&a.src===e)return a.type}return Or(e)},Ir=function t(e){if(Array.isArray(e)){var i=[];e.forEach(function(e){e=t(e),Array.isArray(e)?i=i.concat(e):ye(e)&&i.push(e)}),e=i}else e="string"===typeof e&&e.trim()?[Dr({src:e})]:ye(e)&&"string"===typeof e.src&&e.src&&e.src.trim()?[Dr(e)]:[];return e};function Dr(t){var e=Or(t.src);return!t.type&&e&&(t.type=e),t}var Ur=function(t){function e(e,i,n){var r,a=Gi({createEl:!1},i);if(r=t.call(this,e,a,n)||this,i.playerOptions.sources&&0!==i.playerOptions.sources.length)e.src(i.playerOptions.sources);else for(var o=0,s=i.playerOptions.techOrder;o<s.length;o++){var c=ji(s[o]),l=pr.getTech(c);if(c||(l=Vi.getComponent(c)),l&&l.isSupported()){e.loadTech_(c);break}}return r}return ie(e,t),e}(Vi);Vi.registerComponent("MediaLoader",Ur);var Nr=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.emitTapEvents(),n.enable(),n}ie(e,t);var i=e.prototype;return i.createEl=function(e,i,n){void 0===e&&(e="div"),void 0===i&&(i={}),void 0===n&&(n={}),i=ve({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},i),"button"===e&&he.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),n=ve({role:"button"},n),this.tabIndex_=i.tabIndex;var r=t.prototype.createEl.call(this,e,i,n);return this.createControlTextEl(r),r},i.dispose=function(){this.controlTextEl_=null,t.prototype.dispose.call(this)},i.createControlTextEl=function(t){return this.controlTextEl_=ke("span",{className:"vjs-control-text"},{"aria-live":"polite"}),t&&t.appendChild(this.controlTextEl_),this.controlText(this.controlText_,t),this.controlTextEl_},i.controlText=function(t,e){if(void 0===e&&(e=this.el()),void 0===t)return this.controlText_||"Need Text";var i=this.localize(t);this.controlText_=t,Le(this.controlTextEl_,i),this.nonIconControl||e.setAttribute("title",i)},i.buildCSSClass=function(){return"vjs-control vjs-button "+t.prototype.buildCSSClass.call(this)},i.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),"undefined"!==typeof this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur))},i.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),"undefined"!==typeof this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off(["tap","click"],this.handleClick),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur)},i.handleClick=function(t){},i.handleFocus=function(t){pi(Dt.a,"keydown",Ei(this,this.handleKeyPress))},i.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.trigger("click")):t.prototype.handleKeyPress&&t.prototype.handleKeyPress.call(this,e)},i.handleBlur=function(t){fi(Dt.a,"keydown",Ei(this,this.handleKeyPress))},e}(Vi);Vi.registerComponent("ClickableComponent",Nr);var Br=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.update(),e.on("posterchange",Ei(oe(oe(n)),n.update)),n}ie(e,t);var i=e.prototype;return i.dispose=function(){this.player().off("posterchange",this.update),t.prototype.dispose.call(this)},i.createEl=function(){var t=ke("div",{className:"vjs-poster",tabIndex:-1});return t},i.update=function(t){var e=this.player().poster();this.setSrc(e),e?this.show():this.hide()},i.setSrc=function(t){var e="";t&&(e='url("'+t+'")'),this.el_.style.backgroundImage=e},i.handleClick=function(t){this.player_.controls()&&(this.player_.paused()?Mn(this.player_.play()):this.player_.pause())},e}(Nr);Vi.registerComponent("PosterImage",Br);var Fr="#222",zr="#ccc",jr={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Hr(t,e){var i;if(4===t.length)i=t[1]+t[1]+t[2]+t[2]+t[3]+t[3];else{if(7!==t.length)throw new Error("Invalid color code provided, "+t+"; must be formatted as e.g. #f0e or #f604e2.");i=t.slice(1)}return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+e+")"}function Gr(t,e,i){try{t.style[e]=i}catch(n){return}}var Vr=function(t){function e(e,i,n){var r;r=t.call(this,e,i,n)||this;var a=Ei(oe(oe(r)),r.updateDisplay);return e.on("loadstart",Ei(oe(oe(r)),r.toggleDisplay)),e.on("texttrackchange",a),e.on("loadedmetadata",Ei(oe(oe(r)),r.preselectTrack)),e.ready(Ei(oe(oe(r)),function(){if(e.tech_&&e.tech_.featuresNativeTextTracks)this.hide();else{e.on("fullscreenchange",a),e.on("playerresize",a),xt.a.addEventListener("orientationchange",a),e.on("dispose",function(){return xt.a.removeEventListener("orientationchange",a)});for(var t=this.options_.playerOptions.tracks||[],i=0;i<t.length;i++)this.player_.addRemoteTextTrack(t[i],!0);this.preselectTrack()}})),r}ie(e,t);var i=e.prototype;return i.preselectTrack=function(){for(var t,e,i,n={captions:1,subtitles:1},r=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,o=0;o<r.length;o++){var s=r[o];a&&a.enabled&&a.language&&a.language===s.language&&s.kind in n?s.kind===a.kind?i=s:i||(i=s):a&&!a.enabled?(i=null,t=null,e=null):s.default&&("descriptions"!==s.kind||t?s.kind in n&&!e&&(e=s):t=s)}i?i.mode="showing":e?e.mode="showing":t&&(t.mode="showing")},i.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},i.clearDisplay=function(){"function"===typeof xt.a.WebVTT&&xt.a.WebVTT.processCues(xt.a,[],this.el_)},i.updateDisplay=function(){var t=this.player_.textTracks();this.clearDisplay();var e=null,i=null,n=t.length;while(n--){var r=t[n];"showing"===r.mode&&("descriptions"===r.kind?e=r:i=r)}i?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(i)):e&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(e))},i.updateForTrack=function(t){if("function"===typeof xt.a.WebVTT&&t.activeCues){for(var e=[],i=0;i<t.activeCues.length;i++)e.push(t.activeCues[i]);if(xt.a.WebVTT.processCues(xt.a,e,this.el_),this.player_.textTrackSettings){var n=this.player_.textTrackSettings.getValues(),r=e.length;while(r--){var a=e[r];if(a){var o=a.displayState;if(n.color&&(o.firstChild.style.color=n.color),n.textOpacity&&Gr(o.firstChild,"color",Hr(n.color||"#fff",n.textOpacity)),n.backgroundColor&&(o.firstChild.style.backgroundColor=n.backgroundColor),n.backgroundOpacity&&Gr(o.firstChild,"backgroundColor",Hr(n.backgroundColor||"#000",n.backgroundOpacity)),n.windowColor&&(n.windowOpacity?Gr(o,"backgroundColor",Hr(n.windowColor,n.windowOpacity)):o.style.backgroundColor=n.windowColor),n.edgeStyle&&("dropshadow"===n.edgeStyle?o.firstChild.style.textShadow="2px 2px 3px "+Fr+", 2px 2px 4px "+Fr+", 2px 2px 5px "+Fr:"raised"===n.edgeStyle?o.firstChild.style.textShadow="1px 1px "+Fr+", 2px 2px "+Fr+", 3px 3px "+Fr:"depressed"===n.edgeStyle?o.firstChild.style.textShadow="1px 1px "+zr+", 0 1px "+zr+", -1px -1px "+Fr+", 0 -1px "+Fr:"uniform"===n.edgeStyle&&(o.firstChild.style.textShadow="0 0 4px "+Fr+", 0 0 4px "+Fr+", 0 0 4px "+Fr+", 0 0 4px "+Fr)),n.fontPercent&&1!==n.fontPercent){var s=xt.a.parseFloat(o.style.fontSize);o.style.fontSize=s*n.fontPercent+"px",o.style.height="auto",o.style.top="auto",o.style.bottom="2px"}n.fontFamily&&"default"!==n.fontFamily&&("small-caps"===n.fontFamily?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=jr[n.fontFamily])}}}}},e}(Vi);Vi.registerComponent("TextTrackDisplay",Vr);var Wr=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.createEl=function(){var e=this.player_.isAudio(),i=this.localize(e?"Audio Player":"Video Player"),n=ke("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[i])}),r=t.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return r.appendChild(n),r},e}(Vi);Vi.registerComponent("LoadingSpinner",Wr);var qr=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.createEl=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i={}),t="button",e=ve({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},e),i=ve({type:"button"},i);var n=Vi.prototype.createEl.call(this,t,e,i);return this.createControlTextEl(n),n},i.addChild=function(t,e){void 0===e&&(e={});var i=this.constructor.name;return he.warn("Adding an actionable (user controllable) child to a Button ("+i+") is not supported; use a ClickableComponent instead."),Vi.prototype.addChild.call(this,t,e)},i.enable=function(){t.prototype.enable.call(this),this.el_.removeAttribute("disabled")},i.disable=function(){t.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},i.handleKeyPress=function(e){32!==e.which&&13!==e.which&&t.prototype.handleKeyPress.call(this,e)},e}(Nr);Vi.registerComponent("Button",qr);var Yr=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.mouseused_=!1,n.on("mousedown",n.handleMouseDown),n}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-big-play-button"},i.handleClick=function(t){var e=this.player_.play();if(this.mouseused_&&t.clientX&&t.clientY)Mn(e);else{var i=this.player_.getChild("controlBar"),n=i&&i.getChild("playToggle");if(n){var r=function(){return n.focus()};En(e)?e.then(r,function(){}):this.setTimeout(r,1)}else this.player_.focus()}},i.handleKeyPress=function(e){this.mouseused_=!1,t.prototype.handleKeyPress.call(this,e)},i.handleMouseDown=function(t){this.mouseused_=!0},e}(qr);Yr.prototype.controlText_="Play Video",Vi.registerComponent("BigPlayButton",Yr);var Xr=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.controlText(i&&i.controlText||n.localize("Close")),n}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-close-button "+t.prototype.buildCSSClass.call(this)},i.handleClick=function(t){this.trigger({type:"close",bubbles:!1})},e}(qr);Vi.registerComponent("CloseButton",Xr);var $r=function(t){function e(e,i){var n;return void 0===i&&(i={}),n=t.call(this,e,i)||this,i.replay=void 0===i.replay||i.replay,n.on(e,"play",n.handlePlay),n.on(e,"pause",n.handlePause),i.replay&&n.on(e,"ended",n.handleEnded),n}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-play-control "+t.prototype.buildCSSClass.call(this)},i.handleClick=function(t){this.player_.paused()?this.player_.play():this.player_.pause()},i.handleSeeked=function(t){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(t):this.handlePlay(t)},i.handlePlay=function(t){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},i.handlePause=function(t){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},i.handleEnded=function(t){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},e}(qr);$r.prototype.controlText_="Play",Vi.registerComponent("PlayToggle",$r);var Zr=function(t,e){t=t<0?0:t;var i=Math.floor(t%60),n=Math.floor(t/60%60),r=Math.floor(t/3600),a=Math.floor(e/60%60),o=Math.floor(e/3600);return(isNaN(t)||t===1/0)&&(r=n=i="-"),r=r>0||o>0?r+":":"",n=((r||a>=10)&&n<10?"0"+n:n)+":",i=i<10?"0"+i:i,r+n+i},Jr=Zr;function Kr(t){Jr=t}function Qr(){Jr=Zr}function ta(t,e){return void 0===e&&(e=t),Jr(t,e)}var ea=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.throttledUpdateContent=Mi(Ei(oe(oe(n)),n.updateContent),25),n.on(e,"timeupdate",n.throttledUpdateContent),n}ie(e,t);var i=e.prototype;return i.createEl=function(e){var i=this.buildCSSClass(),n=t.prototype.createEl.call(this,"div",{className:i+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+"</span>"});return this.contentEl_=ke("span",{className:i+"-display"},{"aria-live":"off",role:"presentation"}),this.updateTextNode_(),n.appendChild(this.contentEl_),n},i.dispose=function(){this.contentEl_=null,this.textNode_=null,t.prototype.dispose.call(this)},i.updateTextNode_=function(){if(this.contentEl_){while(this.contentEl_.firstChild)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=Dt.a.createTextNode(this.formattedTime_||this.formatTime_(0)),this.contentEl_.appendChild(this.textNode_)}},i.formatTime_=function(t){return ta(t)},i.updateFormattedTime_=function(t){var e=this.formatTime_(t);e!==this.formattedTime_&&(this.formattedTime_=e,this.requestAnimationFrame(this.updateTextNode_))},i.updateContent=function(t){},e}(Vi);ea.prototype.labelText_="Time",ea.prototype.controlText_="Time",Vi.registerComponent("TimeDisplay",ea);var ia=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.on(e,"ended",n.handleEnded),n}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-current-time"},i.updateContent=function(t){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(e)},i.handleEnded=function(t){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},e}(ea);ia.prototype.labelText_="Current Time",ia.prototype.controlText_="Current Time",Vi.registerComponent("CurrentTimeDisplay",ia);var na=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.on(e,"durationchange",n.updateContent),n.on(e,"loadstart",n.updateContent),n.on(e,"loadedmetadata",n.throttledUpdateContent),n}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-duration"},i.updateContent=function(t){var e=this.player_.duration();this.duration_!==e&&(this.duration_=e,this.updateFormattedTime_(e))},e}(ea);na.prototype.labelText_="Duration",na.prototype.controlText_="Duration",Vi.registerComponent("DurationDisplay",na);var ra=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},e}(Vi);Vi.registerComponent("TimeDivider",ra);var aa=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.on(e,"durationchange",n.throttledUpdateContent),n.on(e,"ended",n.handleEnded),n}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-remaining-time"},i.formatTime_=function(e){return"-"+t.prototype.formatTime_.call(this,e)},i.updateContent=function(t){this.player_.duration()&&(this.player_.remainingTimeDisplay?this.updateFormattedTime_(this.player_.remainingTimeDisplay()):this.updateFormattedTime_(this.player_.remainingTime()))},i.handleEnded=function(t){this.player_.duration()&&this.updateFormattedTime_(0)},e}(ea);aa.prototype.labelText_="Remaining Time",aa.prototype.controlText_="Remaining Time",Vi.registerComponent("RemainingTimeDisplay",aa);var oa=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.updateShowing(),n.on(n.player(),"durationchange",n.updateShowing),n}ie(e,t);var i=e.prototype;return i.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=ke("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},i.dispose=function(){this.contentEl_=null,t.prototype.dispose.call(this)},i.updateShowing=function(t){this.player().duration()===1/0?this.show():this.hide()},e}(Vi);Vi.registerComponent("LiveDisplay",oa);var sa=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.updateLiveEdgeStatus(),n.player_.liveTracker&&n.on(n.player_.liveTracker,"liveedgechange",n.updateLiveEdgeStatus),n}ie(e,t);var i=e.prototype;return i.createEl=function(){var e=t.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=ke("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e},i.updateLiveEdgeStatus=function(t){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},i.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},i.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,t.prototype.dispose.call(this)},e}(qr);sa.prototype.controlText_="Seek to live, currently playing live",Vi.registerComponent("SeekToLive",sa);var ca=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.bar=n.getChild(n.options_.barName),n.vertical(!!n.options_.vertical),n.enable(),n}ie(e,t);var i=e.prototype;return i.enabled=function(){return this.enabled_},i.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},i.disable=function(){if(this.enabled()){var t=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(t,"mousemove",this.handleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchmove",this.handleMouseMove),this.off(t,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},i.createEl=function(e,i,n){return void 0===i&&(i={}),void 0===n&&(n={}),i.className=i.className+" vjs-slider",i=ve({tabIndex:0},i),n=ve({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},n),t.prototype.createEl.call(this,e,i,n)},i.handleMouseDown=function(t){var e=this.bar.el_.ownerDocument;"mousedown"===t.type&&t.preventDefault(),"touchstart"!==t.type||an||t.preventDefault(),je(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(e,"mousemove",this.handleMouseMove),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchmove",this.handleMouseMove),this.on(e,"touchend",this.handleMouseUp),this.handleMouseMove(t)},i.handleMouseMove=function(t){},i.handleMouseUp=function(){var t=this.bar.el_.ownerDocument;He(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchmove",this.handleMouseMove),this.off(t,"touchend",this.handleMouseUp),this.update()},i.update=function(){if(this.el_){var t=this.getPercent(),e=this.bar;if(e){("number"!==typeof t||t!==t||t<0||t===1/0)&&(t=0);var i=(100*t).toFixed(2)+"%",n=e.el().style;return this.vertical()?n.height=i:n.width=i,t}}},i.calculateDistance=function(t){var e=We(this.el_,t);return this.vertical()?e.y:e.x},i.handleFocus=function(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},i.handleKeyPress=function(t){37===t.which||40===t.which?(t.preventDefault(),this.stepBack()):38!==t.which&&39!==t.which||(t.preventDefault(),this.stepForward())},i.handleBlur=function(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},i.handleClick=function(t){t.stopImmediatePropagation(),t.preventDefault()},i.vertical=function(t){if(void 0===t)return this.vertical_||!1;this.vertical_=!!t,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},e}(Vi);Vi.registerComponent("Slider",ca);var la=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.partEls_=[],n.on(e,"progress",n.update),n}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+'</span>: <span class="vjs-control-text-loaded-percentage">0%</span></span>'})},i.dispose=function(){this.partEls_=null,t.prototype.dispose.call(this)},i.update=function(t){var e=this.player_.liveTracker,i=this.player_.buffered(),n=e&&e.isLive()?e.seekableEnd():this.player_.duration(),r=this.player_.bufferedEnd(),a=this.partEls_,o=this.$(".vjs-control-text-loaded-percentage"),s=function(t,e,i){var n=t/e||0;return n=100*(n>=1?1:n),i&&(n=n.toFixed(2)),n+"%"};this.el_.style.width=s(r,n),Le(o,s(r,n,!0));for(var c=0;c<i.length;c++){var l=i.start(c),u=i.end(c),h=a[c];h||(h=this.el_.appendChild(ke()),a[c]=h),h.style.left=s(l,r),h.style.width=s(u-l,r)}for(var d=a.length;d>i.length;d--)this.el_.removeChild(a[d-1]);a.length=i.length},e}(Vi);Vi.registerComponent("LoadProgressBar",la);var ua=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},i.update=function(t,e,i){var n=Ge(this.el_),r=Ge(this.player_.el()),a=t.width*e;if(r&&n){var o=t.left-r.left+a,s=t.width-a+(r.right-t.right),c=n.width/2;o<c?c+=c-o:s<c&&(c=s),c<0?c=0:c>n.width&&(c=n.width),this.el_.style.right="-"+c+"px",Le(this.el_,i)}},i.updateTime=function(t,e,i,n){var r=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var a,o=r.player_.duration();if(r.player_.liveTracker&&r.player_.liveTracker.isLive()){var s=r.player_.liveTracker.liveWindow(),c=s-e*s;a=(c<1?"":"-")+ta(c,s)}else a=ta(i,o);r.update(t,e,a),n&&n()})},e}(Vi);Vi.registerComponent("TimeTooltip",ua);var ha=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},i.update=function(t,e){var i=this.getChild("timeTooltip");if(i){var n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();i.updateTime(t,e,n)}},e}(Vi);ha.prototype.options_={children:[]},Ji||Qi||ha.prototype.options_.children.push("timeTooltip"),Vi.registerComponent("PlayProgressBar",ha);var da=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.update=Mi(Ei(oe(oe(n)),n.update),25),n}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},i.update=function(t,e){var i=this,n=e*this.player_.duration();this.getChild("timeTooltip").updateTime(t,e,n,function(){i.el_.style.left=t.width*e+"px"})},e}(Vi);da.prototype.options_={children:["timeTooltip"]},Vi.registerComponent("MouseTimeDisplay",da);var pa=5,fa=30,ma=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.setEventHandlers_(),n}ie(e,t);var i=e.prototype;return i.setEventHandlers_=function(){var t=this;this.update=Mi(Ei(this,this.update),fa),this.on(this.player_,"timeupdate",this.update),this.on(this.player_,"ended",this.handleEnded),this.on(this.player_,"durationchange",this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],function(){t.clearInterval(t.updateInterval),t.updateInterval=t.setInterval(function(){t.requestAnimationFrame(function(){t.update()})},fa)}),this.on(this.player_,["ended","pause","waiting"],function(e){t.player_.liveTracker&&t.player_.liveTracker.isLive()&&"ended"!==e.type||t.clearInterval(t.updateInterval)}),this.on(this.player_,["timeupdate","ended"],this.update)},i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},i.update_=function(t,e){var i=this.player_.liveTracker,n=this.player_.duration();i&&i.isLive()&&(n=this.player_.liveTracker.liveCurrentTime()),i&&i.seekableEnd()===1/0?this.disable():this.enable(),this.el_.setAttribute("aria-valuenow",(100*e).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[ta(t,n),ta(n,n)],"{1} of {2}")),this.bar.update(Ge(this.el_),e)},i.update=function(e){var i=t.prototype.update.call(this);return this.update_(this.getCurrentTime_(),i),i},i.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},i.handleEnded=function(t){this.update_(this.player_.duration(),1)},i.getPercent=function(){var t,e=this.getCurrentTime_(),i=this.player_.liveTracker;return i&&i.isLive()?(t=(e-i.seekableStart())/i.liveWindow(),i.atLiveEdge()&&(t=1)):t=e/this.player_.duration(),t>=1?1:t||0},i.handleMouseDown=function(e){Je(e)&&(e.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),t.prototype.handleMouseDown.call(this,e))},i.handleMouseMove=function(t){if(Je(t)){var e,i=this.calculateDistance(t),n=this.player_.liveTracker;if(n&&n.isLive()){var r=n.seekableStart(),a=n.liveCurrentTime();if(e=r+i*n.liveWindow(),e>=a&&(e=a),e<=r&&(e=r+.1),e===1/0)return}else e=i*this.player_.duration(),e===this.player_.duration()&&(e-=.1);this.player_.currentTime(e)}},i.enable=function(){t.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.show()},i.disable=function(){t.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.hide()},i.handleMouseUp=function(e){t.prototype.handleMouseUp.call(this,e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&Mn(this.player_.play())},i.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+pa)},i.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-pa)},i.handleAction=function(t){this.player_.paused()?this.player_.play():this.player_.pause()},i.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.handleAction(e)):t.prototype.handleKeyPress&&t.prototype.handleKeyPress.call(this,e)},e}(ca);ma.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Ji||Qi||ma.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),ma.prototype.playerEvent="timeupdate",Vi.registerComponent("SeekBar",ma);var ga=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.handleMouseMove=Mi(Ei(oe(oe(n)),n.handleMouseMove),25),n.throttledHandleMouseSeek=Mi(Ei(oe(oe(n)),n.handleMouseSeek),25),n.enable(),n}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},i.handleMouseMove=function(t){var e=this.getChild("seekBar");if(e){var i=e.getChild("mouseTimeDisplay"),n=e.el(),r=Ge(n),a=We(n,t).x;a>1?a=1:a<0&&(a=0),i&&i.update(r,a)}},i.handleMouseSeek=function(t){var e=this.getChild("seekBar");e&&e.handleMouseMove(t)},i.enabled=function(){return this.enabled_},i.disable=function(){this.children().forEach(function(t){return t.disable&&t.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},i.enable=function(){this.children().forEach(function(t){return t.enable&&t.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},i.handleMouseDown=function(t){var e=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(t),this.on(e,"mousemove",this.throttledHandleMouseSeek),this.on(e,"touchmove",this.throttledHandleMouseSeek),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchend",this.handleMouseUp)},i.handleMouseUp=function(t){var e=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseUp(t),this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchend",this.handleMouseUp)},e}(Vi);ga.prototype.options_={children:["seekBar"]},Vi.registerComponent("ProgressControl",ga);var va=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.on(e,"fullscreenchange",n.handleFullscreenChange),!1===Dt.a[yn.fullscreenEnabled]&&n.disable(),n}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-fullscreen-control "+t.prototype.buildCSSClass.call(this)},i.handleFullscreenChange=function(t){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},i.handleClick=function(t){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},e}(qr);va.prototype.controlText_="Fullscreen",Vi.registerComponent("FullscreenToggle",va);var ya=function(t,e){e.tech_&&!e.tech_.featuresVolumeControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})},_a=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},e}(Vi);Vi.registerComponent("VolumeLevel",_a);var ba=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.on("slideractive",n.updateLastVolume_),n.on(e,"volumechange",n.updateARIAAttributes),e.ready(function(){return n.updateARIAAttributes()}),n}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},i.handleMouseDown=function(e){Je(e)&&t.prototype.handleMouseDown.call(this,e)},i.handleMouseMove=function(t){Je(t)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(t)))},i.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},i.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},i.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},i.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},i.updateARIAAttributes=function(t){var e=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",e),this.el_.setAttribute("aria-valuetext",e+"%")},i.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},i.updateLastVolume_=function(){var t=this,e=this.player_.volume();this.one("sliderinactive",function(){0===t.player_.volume()&&t.player_.lastVolume_(e)})},e}(ca);ba.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},ba.prototype.playerEvent="volumechange",Vi.registerComponent("VolumeBar",ba);var wa=function(t){function e(e,i){var n;return void 0===i&&(i={}),i.vertical=i.vertical||!1,("undefined"===typeof i.volumeBar||_e(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical),n=t.call(this,e,i)||this,ya(oe(oe(n)),e),n.throttledHandleMouseMove=Mi(Ei(oe(oe(n)),n.handleMouseMove),25),n.on("mousedown",n.handleMouseDown),n.on("touchstart",n.handleMouseDown),n.on(n.volumeBar,["focus","slideractive"],function(){n.volumeBar.addClass("vjs-slider-active"),n.addClass("vjs-slider-active"),n.trigger("slideractive")}),n.on(n.volumeBar,["blur","sliderinactive"],function(){n.volumeBar.removeClass("vjs-slider-active"),n.removeClass("vjs-slider-active"),n.trigger("sliderinactive")}),n}ie(e,t);var i=e.prototype;return i.createEl=function(){var e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),t.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+e})},i.handleMouseDown=function(t){var e=this.el_.ownerDocument;this.on(e,"mousemove",this.throttledHandleMouseMove),this.on(e,"touchmove",this.throttledHandleMouseMove),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchend",this.handleMouseUp)},i.handleMouseUp=function(t){var e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseMove),this.off(e,"touchmove",this.throttledHandleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchend",this.handleMouseUp)},i.handleMouseMove=function(t){this.volumeBar.handleMouseMove(t)},e}(Vi);wa.prototype.options_={children:["volumeBar"]},Vi.registerComponent("VolumeControl",wa);var Ta=function(t,e){e.tech_&&!e.tech_.featuresMuteControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresMuteControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})},xa=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,Ta(oe(oe(n)),e),n.on(e,["loadstart","volumechange"],n.update),n}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-mute-control "+t.prototype.buildCSSClass.call(this)},i.handleClick=function(t){var e=this.player_.volume(),i=this.player_.lastVolume_();if(0===e){var n=i<.1?.1:i;this.player_.volume(n),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},i.update=function(t){this.updateIcon_(),this.updateControlText_()},i.updateIcon_=function(){var t=this.player_.volume(),e=3;Ji&&this.player_.muted(this.player_.tech_.el_.muted),0===t||this.player_.muted()?e=0:t<.33?e=1:t<.67&&(e=2);for(var i=0;i<4;i++)Ie(this.el_,"vjs-vol-"+i);Re(this.el_,"vjs-vol-"+e)},i.updateControlText_=function(){var t=this.player_.muted()||0===this.player_.volume(),e=t?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},e}(qr);xa.prototype.controlText_="Mute",Vi.registerComponent("MuteToggle",xa);var Sa=function(t){function e(e,i){var n;return void 0===i&&(i={}),"undefined"!==typeof i.inline?i.inline=i.inline:i.inline=!0,("undefined"===typeof i.volumeControl||_e(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline),n=t.call(this,e,i)||this,n.on(e,["loadstart"],n.volumePanelState_),n.on(n.volumeControl,["slideractive"],n.sliderActive_),n.on(n.volumeControl,["sliderinactive"],n.sliderInactive_),n}ie(e,t);var i=e.prototype;return i.sliderActive_=function(){this.addClass("vjs-slider-active")},i.sliderInactive_=function(){this.removeClass("vjs-slider-active")},i.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},i.createEl=function(){var e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),t.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+e})},e}(Vi);Sa.prototype.options_={children:["muteToggle","volumeControl"]},Vi.registerComponent("VolumePanel",Sa);var Ea=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,i&&(n.menuButton_=i.menuButton),n.focusedChild_=-1,n.on("keydown",n.handleKeyPress),n}ie(e,t);var i=e.prototype;return i.addItem=function(t){this.addChild(t),t.on("blur",Ei(this,this.handleBlur)),t.on(["tap","click"],Ei(this,function(e){this.menuButton_&&(this.menuButton_.unpressButton(),"CaptionSettingsMenuItem"!==t.name()&&this.menuButton_.focus())}))},i.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=ke(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var i=t.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return i.appendChild(this.contentEl_),pi(i,"click",function(t){t.preventDefault(),t.stopImmediatePropagation()}),i},i.dispose=function(){this.contentEl_=null,t.prototype.dispose.call(this)},i.handleBlur=function(t){var e=t.relatedTarget||Dt.a.activeElement;if(!this.children().some(function(t){return t.el()===e})){var i=this.menuButton_;i&&i.buttonPressed_&&e!==i.el().firstChild&&i.unpressButton()}},i.handleKeyPress=function(t){37===t.which||40===t.which?(t.preventDefault(),this.stepForward()):38!==t.which&&39!==t.which||(t.preventDefault(),this.stepBack())},i.stepForward=function(){var t=0;void 0!==this.focusedChild_&&(t=this.focusedChild_+1),this.focus(t)},i.stepBack=function(){var t=0;void 0!==this.focusedChild_&&(t=this.focusedChild_-1),this.focus(t)},i.focus=function(t){void 0===t&&(t=0);var e=this.children().slice(),i=e.length&&e[0].className&&/vjs-menu-title/.test(e[0].className);i&&e.shift(),e.length>0&&(t<0?t=0:t>=e.length&&(t=e.length-1),this.focusedChild_=t,e[t].el_.focus())},e}(Vi);Vi.registerComponent("Menu",Ea);var Ma=function(t){function e(e,i){var n;void 0===i&&(i={}),n=t.call(this,e,i)||this,n.menuButton_=new qr(e,i),n.menuButton_.controlText(n.controlText_),n.menuButton_.el_.setAttribute("aria-haspopup","true");var r=qr.prototype.buildCSSClass();return n.menuButton_.el_.className=n.buildCSSClass()+" "+r,n.menuButton_.removeClass("vjs-control"),n.addChild(n.menuButton_),n.update(),n.enabled_=!0,n.on(n.menuButton_,"tap",n.handleClick),n.on(n.menuButton_,"click",n.handleClick),n.on(n.menuButton_,"focus",n.handleFocus),n.on(n.menuButton_,"blur",n.handleBlur),n.on(n.menuButton_,"mouseenter",function(){n.menu.show()}),n.on("keydown",n.handleSubmenuKeyPress),n}ie(e,t);var i=e.prototype;return i.update=function(){var t=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=t,this.addChild(t),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},i.createMenu=function(){var t=new Ea(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var e=ke("li",{className:"vjs-menu-title",innerHTML:ji(this.options_.title),tabIndex:-1});this.hideThreshold_+=1,t.children_.unshift(e),Pe(e,t.contentEl())}if(this.items=this.createItems(),this.items)for(var i=0;i<this.items.length;i++)t.addItem(this.items[i]);return t},i.createItems=function(){},i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},i.buildWrapperCSSClass=function(){var e="vjs-menu-button";!0===this.options_.inline?e+="-inline":e+="-popup";var i=qr.prototype.buildCSSClass();return"vjs-menu-button "+e+" "+i+" "+t.prototype.buildCSSClass.call(this)},i.buildCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+t.prototype.buildCSSClass.call(this)},i.controlText=function(t,e){return void 0===e&&(e=this.menuButton_.el()),this.menuButton_.controlText(t,e)},i.handleClick=function(t){this.buttonPressed_?this.unpressButton():this.pressButton()},i.focus=function(){this.menuButton_.focus()},i.blur=function(){this.menuButton_.blur()},i.handleFocus=function(){pi(Dt.a,"keydown",Ei(this,this.handleKeyPress))},i.handleBlur=function(){fi(Dt.a,"keydown",Ei(this,this.handleKeyPress))},i.handleKeyPress=function(t){27===t.which||9===t.which?(this.buttonPressed_&&this.unpressButton(),9!==t.which&&(t.preventDefault(),this.menuButton_.el_.focus())):13!==t.which&&38!==t.which&&40!==t.which||this.buttonPressed_||(this.pressButton(),t.preventDefault())},i.handleSubmenuKeyPress=function(t){27!==t.which&&9!==t.which||(this.buttonPressed_&&this.unpressButton(),9!==t.which&&(t.preventDefault(),this.menuButton_.el_.focus()))},i.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Ji&&Ce())return;this.menu.focus()}},i.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},i.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},i.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},e}(Vi);Vi.registerComponent("MenuButton",Ma);var Ca=function(t){function e(e,i){var n,r=i.tracks;if(n=t.call(this,e,i)||this,n.items.length<=1&&n.hide(),!r)return oe(n);var a=Ei(oe(oe(n)),n.update);return r.addEventListener("removetrack",a),r.addEventListener("addtrack",a),n.player_.on("ready",a),n.player_.on("dispose",function(){r.removeEventListener("removetrack",a),r.removeEventListener("addtrack",a)}),n}return ie(e,t),e}(Ma);Vi.registerComponent("TrackButton",Ca);var Aa=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.selectable=i.selectable,n.isSelected_=i.selected||!1,n.multiSelectable=i.multiSelectable,n.selected(n.isSelected_),n.selectable?n.multiSelectable?n.el_.setAttribute("role","menuitemcheckbox"):n.el_.setAttribute("role","menuitemradio"):n.el_.setAttribute("role","menuitem"),n}ie(e,t);var i=e.prototype;return i.createEl=function(e,i,n){return this.nonIconControl=!0,t.prototype.createEl.call(this,"li",ve({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},i),n)},i.handleClick=function(t){this.selected(!0)},i.selected=function(t){this.selectable&&(t?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},e}(Nr);Vi.registerComponent("MenuItem",Aa);var ka=function(t){function e(e,i){var n,r=i.track,a=e.textTracks();i.label=r.label||r.language||"Unknown",i.selected="showing"===r.mode,n=t.call(this,e,i)||this,n.track=r;var o,s=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];n.handleTracksChange.apply(oe(oe(n)),e)},c=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];n.handleSelectedLanguageChange.apply(oe(oe(n)),e)};(e.on(["loadstart","texttrackchange"],s),a.addEventListener("change",s),a.addEventListener("selectedlanguagechange",c),n.on("dispose",function(){e.off(["loadstart","texttrackchange"],s),a.removeEventListener("change",s),a.removeEventListener("selectedlanguagechange",c)}),void 0===a.onchange)&&n.on(["tap","click"],function(){if("object"!==typeof xt.a.Event)try{o=new xt.a.Event("change")}catch(t){}o||(o=Dt.a.createEvent("Event"),o.initEvent("change",!0,!0)),a.dispatchEvent(o)});return n.handleTracksChange(),n}ie(e,t);var i=e.prototype;return i.handleClick=function(e){var i=this.track.kind,n=this.track.kinds,r=this.player_.textTracks();if(n||(n=[i]),t.prototype.handleClick.call(this,e),r)for(var a=0;a<r.length;a++){var o=r[a];o===this.track&&n.indexOf(o.kind)>-1?"showing"!==o.mode&&(o.mode="showing"):"disabled"!==o.mode&&(o.mode="disabled")}},i.handleTracksChange=function(t){var e="showing"===this.track.mode;e!==this.isSelected_&&this.selected(e)},i.handleSelectedLanguageChange=function(t){if("showing"===this.track.mode){var e=this.player_.cache_.selectedLanguage;if(e&&e.enabled&&e.language===this.track.language&&e.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},i.dispose=function(){this.track=null,t.prototype.dispose.call(this)},e}(Aa);Vi.registerComponent("TextTrackMenuItem",ka);var La=function(t){function e(e,i){return i.track={player:e,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.label?i.track.label=i.label:i.track.label=i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,t.call(this,e,i)||this}ie(e,t);var i=e.prototype;return i.handleTracksChange=function(t){for(var e=this.player().textTracks(),i=!0,n=0,r=e.length;n<r;n++){var a=e[n];if(this.options_.kinds.indexOf(a.kind)>-1&&"showing"===a.mode){i=!1;break}}i!==this.isSelected_&&this.selected(i)},i.handleSelectedLanguageChange=function(t){for(var e=this.player().textTracks(),i=!0,n=0,r=e.length;n<r;n++){var a=e[n];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&"showing"===a.mode){i=!1;break}}i&&(this.player_.cache_.selectedLanguage={enabled:!1})},e}(ka);Vi.registerComponent("OffTextTrackMenuItem",La);var Pa=function(t){function e(e,i){return void 0===i&&(i={}),i.tracks=e.textTracks(),t.call(this,e,i)||this}ie(e,t);var i=e.prototype;return i.createItems=function(t,e){var i;void 0===t&&(t=[]),void 0===e&&(e=ka),this.label_&&(i=this.label_+" off"),t.push(new La(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i})),this.hideThreshold_+=1;var n=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var r=0;r<n.length;r++){var a=n[r];if(this.kinds_.indexOf(a.kind)>-1){var o=new e(this.player_,{track:a,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+a.kind+"-menu-item"),t.push(o)}}return t},e}(Ca);Vi.registerComponent("TextTrackButton",Pa);var Oa=function(t){function e(e,i){var n,r=i.track,a=i.cue,o=e.currentTime();return i.selectable=!0,i.multiSelectable=!1,i.label=a.text,i.selected=a.startTime<=o&&o<a.endTime,n=t.call(this,e,i)||this,n.track=r,n.cue=a,r.addEventListener("cuechange",Ei(oe(oe(n)),n.update)),n}ie(e,t);var i=e.prototype;return i.handleClick=function(e){t.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},i.update=function(t){var e=this.cue,i=this.player_.currentTime();this.selected(e.startTime<=i&&i<e.endTime)},e}(Aa);Vi.registerComponent("ChaptersTrackMenuItem",Oa);var Ra=function(t){function e(e,i,n){return t.call(this,e,i,n)||this}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildWrapperCSSClass.call(this)},i.update=function(e){this.track_&&(!e||"addtrack"!==e.type&&"removetrack"!==e.type)||this.setTrack(this.findChaptersTrack()),t.prototype.update.call(this)},i.setTrack=function(t){if(this.track_!==t){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var e=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);e&&e.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=t,this.track_){this.track_.mode="hidden";var i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_)}}},i.findChaptersTrack=function(){for(var t=this.player_.textTracks()||[],e=t.length-1;e>=0;e--){var i=t[e];if(i.kind===this.kind_)return i}},i.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(ji(this.kind_))},i.createMenu=function(){return this.options_.title=this.getMenuCaption(),t.prototype.createMenu.call(this)},i.createItems=function(){var t=[];if(!this.track_)return t;var e=this.track_.cues;if(!e)return t;for(var i=0,n=e.length;i<n;i++){var r=e[i],a=new Oa(this.player_,{track:this.track_,cue:r});t.push(a)}return t},e}(Pa);Ra.prototype.kind_="chapters",Ra.prototype.controlText_="Chapters",Vi.registerComponent("ChaptersButton",Ra);var Ia=function(t){function e(e,i,n){var r;r=t.call(this,e,i,n)||this;var a=e.textTracks(),o=Ei(oe(oe(r)),r.handleTracksChange);return a.addEventListener("change",o),r.on("dispose",function(){a.removeEventListener("change",o)}),r}ie(e,t);var i=e.prototype;return i.handleTracksChange=function(t){for(var e=this.player().textTracks(),i=!1,n=0,r=e.length;n<r;n++){var a=e[n];if(a.kind!==this.kind_&&"showing"===a.mode){i=!0;break}}i?this.disable():this.enable()},i.buildCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildWrapperCSSClass.call(this)},e}(Pa);Ia.prototype.kind_="descriptions",Ia.prototype.controlText_="Descriptions",Vi.registerComponent("DescriptionsButton",Ia);var Da=function(t){function e(e,i,n){return t.call(this,e,i,n)||this}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildWrapperCSSClass.call(this)},e}(Pa);Da.prototype.kind_="subtitles",Da.prototype.controlText_="Subtitles",Vi.registerComponent("SubtitlesButton",Da);var Ua=function(t){function e(e,i){var n;return i.track={player:e,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",n=t.call(this,e,i)||this,n.addClass("vjs-texttrack-settings"),n.controlText(", opens "+i.kind+" settings dialog"),n}ie(e,t);var i=e.prototype;return i.handleClick=function(t){this.player().getChild("textTrackSettings").open()},e}(ka);Vi.registerComponent("CaptionSettingsMenuItem",Ua);var Na=function(t){function e(e,i,n){return t.call(this,e,i,n)||this}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-captions-button "+t.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-captions-button "+t.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new Ua(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),t.prototype.createItems.call(this,e)},e}(Pa);Na.prototype.kind_="captions",Na.prototype.controlText_="Captions",Vi.registerComponent("CaptionsButton",Na);var Ba=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.createEl=function(e,i,n){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);"captions"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),r+="</span>";var a=t.prototype.createEl.call(this,e,ve({innerHTML:r},i),n);return a},e}(ka);Vi.registerComponent("SubsCapsMenuItem",Ba);var Fa=function(t){function e(e,i){var n;return void 0===i&&(i={}),n=t.call(this,e,i)||this,n.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(n.player_.language_)>-1&&(n.label_="captions"),n.menuButton_.controlText(ji(n.label_)),n}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-subs-caps-button "+t.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+t.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new Ua(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=t.prototype.createItems.call(this,e,Ba),e},e}(Pa);Fa.prototype.kinds_=["captions","subtitles"],Fa.prototype.controlText_="Subtitles",Vi.registerComponent("SubsCapsButton",Fa);var za=function(t){function e(e,i){var n,r=i.track,a=e.audioTracks();i.label=r.label||r.language||"Unknown",i.selected=r.enabled,n=t.call(this,e,i)||this,n.track=r,n.addClass("vjs-"+r.kind+"-menu-item");var o=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];n.handleTracksChange.apply(oe(oe(n)),e)};return a.addEventListener("change",o),n.on("dispose",function(){a.removeEventListener("change",o)}),n}ie(e,t);var i=e.prototype;return i.createEl=function(e,i,n){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);"main-desc"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),r+="</span>";var a=t.prototype.createEl.call(this,e,ve({innerHTML:r},i),n);return a},i.handleClick=function(e){var i=this.player_.audioTracks();t.prototype.handleClick.call(this,e);for(var n=0;n<i.length;n++){var r=i[n];r.enabled=r===this.track}},i.handleTracksChange=function(t){this.selected(this.track.enabled)},e}(Aa);Vi.registerComponent("AudioTrackMenuItem",za);var ja=function(t){function e(e,i){return void 0===i&&(i={}),i.tracks=e.audioTracks(),t.call(this,e,i)||this}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-audio-button "+t.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-audio-button "+t.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(t){void 0===t&&(t=[]),this.hideThreshold_=1;for(var e=this.player_.audioTracks(),i=0;i<e.length;i++){var n=e[i];t.push(new za(this.player_,{track:n,selectable:!0,multiSelectable:!1}))}return t},e}(Ca);ja.prototype.controlText_="Audio Track",Vi.registerComponent("AudioTrackButton",ja);var Ha=function(t){function e(e,i){var n,r=i.rate,a=parseFloat(r,10);return i.label=r,i.selected=1===a,i.selectable=!0,i.multiSelectable=!1,n=t.call(this,e,i)||this,n.label=r,n.rate=a,n.on(e,"ratechange",n.update),n}ie(e,t);var i=e.prototype;return i.handleClick=function(e){t.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},i.update=function(t){this.selected(this.player().playbackRate()===this.rate)},e}(Aa);Ha.prototype.contentElType="button",Vi.registerComponent("PlaybackRateMenuItem",Ha);var Ga=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.updateVisibility(),n.updateLabel(),n.on(e,"loadstart",n.updateVisibility),n.on(e,"ratechange",n.updateLabel),n}ie(e,t);var i=e.prototype;return i.createEl=function(){var e=t.prototype.createEl.call(this);return this.labelEl_=ke("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),e.appendChild(this.labelEl_),e},i.dispose=function(){this.labelEl_=null,t.prototype.dispose.call(this)},i.buildCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildWrapperCSSClass.call(this)},i.createMenu=function(){var t=new Ea(this.player()),e=this.playbackRates();if(e)for(var i=e.length-1;i>=0;i--)t.addChild(new Ha(this.player(),{rate:e[i]+"x"}));return t},i.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},i.handleClick=function(t){for(var e=this.player().playbackRate(),i=this.playbackRates(),n=i[0],r=0;r<i.length;r++)if(i[r]>e){n=i[r];break}this.player().playbackRate(n)},i.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},i.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},i.updateVisibility=function(t){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},i.updateLabel=function(t){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},e}(Ma);Ga.prototype.controlText_="Playback Rate",Vi.registerComponent("PlaybackRateMenuButton",Ga);var Va=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-spacer "+t.prototype.buildCSSClass.call(this)},i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},e}(Vi);Vi.registerComponent("Spacer",Va);var Wa=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},i.createEl=function(){var e=t.prototype.createEl.call(this,{className:this.buildCSSClass()});return e.innerHTML="",e},e}(Va);Vi.registerComponent("CustomControlSpacer",Wa);var qa=function(t){function e(){return t.apply(this,arguments)||this}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},e}(Vi);qa.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},Vi.registerComponent("ControlBar",qa);var Ya=function(t){function e(e,i){var n;return n=t.call(this,e,i)||this,n.on(e,"error",n.open),n}ie(e,t);var i=e.prototype;return i.buildCSSClass=function(){return"vjs-error-display "+t.prototype.buildCSSClass.call(this)},i.content=function(){var t=this.player().error();return t?this.localize(t.message):""},e}(Rn);Ya.prototype.options_=Gi(Rn.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Vi.registerComponent("ErrorDisplay",Ya);var Xa="vjs-text-track-settings",$a=["#000","Black"],Za=["#00F","Blue"],Ja=["#0FF","Cyan"],Ka=["#0F0","Green"],Qa=["#F0F","Magenta"],to=["#F00","Red"],eo=["#FFF","White"],io=["#FF0","Yellow"],no=["1","Opaque"],ro=["0.5","Semi-Transparent"],ao=["0","Transparent"],oo={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[$a,eo,to,Ka,Za,io,Qa,Ja]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[no,ro,ao]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[eo,$a,to,Ka,Za,io,Qa,Ja]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(t){return"1.00"===t?null:Number(t)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[no,ro]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[ao,ro,no]}};function so(t,e){if(e&&(t=e(t)),t&&"none"!==t)return t}function co(t,e){var i=t.options[t.options.selectedIndex].value;return so(i,e)}function lo(t,e,i){if(e)for(var n=0;n<t.options.length;n++)if(so(t.options[n].value,i)===e){t.selectedIndex=n;break}}oo.windowColor.options=oo.backgroundColor.options;var uo=function(t){function e(e,i){var n;return i.temporary=!1,n=t.call(this,e,i)||this,n.updateDisplay=Ei(oe(oe(n)),n.updateDisplay),n.fill(),n.hasBeenOpened_=n.hasBeenFilled_=!0,n.endDialog=ke("p",{className:"vjs-control-text",textContent:n.localize("End of dialog window.")}),n.el().appendChild(n.endDialog),n.setDefaults(),void 0===i.persistTextTrackSettings&&(n.options_.persistTextTrackSettings=n.options_.playerOptions.persistTextTrackSettings),n.on(n.$(".vjs-done-button"),"click",function(){n.saveSettings(),n.close()}),n.on(n.$(".vjs-default-button"),"click",function(){n.setDefaults(),n.updateDisplay()}),me(oo,function(t){n.on(n.$(t.selector),"change",n.updateDisplay)}),n.options_.persistTextTrackSettings&&n.restoreSettings(),n}ie(e,t);var i=e.prototype;return i.dispose=function(){this.endDialog=null,t.prototype.dispose.call(this)},i.createElSelect_=function(t,e,i){var n=this;void 0===e&&(e=""),void 0===i&&(i="label");var r=oo[t],a=r.id.replace("%s",this.id_),o=[e,a].join(" ").trim();return["<"+i+' id="'+a+'" class="'+("label"===i?"vjs-label":"")+'">',this.localize(r.label),"</"+i+">",'<select aria-labelledby="'+o+'">'].concat(r.options.map(function(t){var e=a+"-"+t[1].replace(/\W+/g,"");return['<option id="'+e+'" value="'+t[0]+'" ','aria-labelledby="'+o+" "+e+'">',n.localize(t[1]),"</option>"].join("")})).concat("</select>").join("")},i.createElFgColor_=function(){var t="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",t),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",t),"</span>","</fieldset>"].join("")},i.createElBgColor_=function(){var t="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",t),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",t),"</span>","</fieldset>"].join("")},i.createElWinColor_=function(){var t="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",t),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",t),"</span>","</fieldset>"].join("")},i.createElColors_=function(){return ke("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},i.createElFont_=function(){return ke("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},i.createElControls_=function(){var t=this.localize("restore all settings to the default values");return ke("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+t+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+t+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},i.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},i.label=function(){return this.localize("Caption Settings Dialog")},i.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},i.buildCSSClass=function(){return t.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},i.getValues=function(){var t=this;return ge(oo,function(e,i,n){var r=co(t.$(i.selector),i.parser);return void 0!==r&&(e[n]=r),e},{})},i.setValues=function(t){var e=this;me(oo,function(i,n){lo(e.$(i.selector),t[n],i.parser)})},i.setDefaults=function(){var t=this;me(oo,function(e){var i=e.hasOwnProperty("default")?e.default:0;t.$(e.selector).selectedIndex=i})},i.restoreSettings=function(){var t;try{t=JSON.parse(xt.a.localStorage.getItem(Xa))}catch(e){he.warn(e)}t&&this.setValues(t)},i.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.keys(t).length?xt.a.localStorage.setItem(Xa,JSON.stringify(t)):xt.a.localStorage.removeItem(Xa)}catch(e){he.warn(e)}}},i.updateDisplay=function(){var t=this.player_.getChild("textTrackDisplay");t&&t.updateDisplay()},i.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(Dt.a,"keydown",this.handleKeyDown);var t=this.player_.controlBar,e=t&&t.subsCapsButton,i=t&&t.captionsButton;e?e.focus():i&&i.focus()},e}(Rn);Vi.registerComponent("TextTrackSettings",uo);var ho=function(t){function e(e,i){var n,r=i.ResizeObserver||xt.a.ResizeObserver;null===i.ResizeObserver&&(r=!1);var a=Gi({createEl:!r,reportTouchActivity:!1},i);return n=t.call(this,e,a)||this,n.ResizeObserver=i.ResizeObserver||xt.a.ResizeObserver,n.loadListener_=null,n.resizeObserver_=null,n.debouncedHandler_=Ci(function(){n.resizeHandler()},100,!1,oe(oe(n))),r?(n.resizeObserver_=new n.ResizeObserver(n.debouncedHandler_),n.resizeObserver_.observe(e.el())):(n.loadListener_=function(){n.el_&&n.el_.contentWindow&&pi(n.el_.contentWindow,"resize",n.debouncedHandler_)},n.one("load",n.loadListener_)),n}ie(e,t);var i=e.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager"})},i.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},i.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.el_&&this.el_.contentWindow&&fi(this.el_.contentWindow,"resize",this.debouncedHandler_),this.loadListener_&&this.off("load",this.loadListener_),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null},e}(Vi);Vi.registerComponent("ResizeManager",ho);var po=function(t){function e(e,i){var n,r=Gi({createEl:!1},i);return n=t.call(this,e,r)||this,n.reset_(),n.on(n.player_,"durationchange",n.handleDurationchange),n}ie(e,t);var i=e.prototype;return i.isBehind_=function(){if(!this.timeupdateSeen_)return!1;var t=this.liveCurrentTime(),e=this.player_.currentTime(),i=this.seekableIncrement_,n=2*i+.07;return t!==1/0&&t-n>=e},i.trackLive_=function(){this.pastSeekEnd_=this.pastSeekEnd_;var t=this.player_.seekable();if(t&&t.length){var e=this.seekableEnd();e!==this.lastSeekEnd_&&(this.lastSeekEnd_&&(this.seekableIncrement_=Math.abs(e-this.lastSeekEnd_)),this.pastSeekEnd_=0,this.lastSeekEnd_=e,this.trigger("seekableendchange")),this.pastSeekEnd_=this.pastSeekEnd()+.03,this.isBehind_()!==this.behindLiveEdge()&&(this.behindLiveEdge_=this.isBehind_(),this.trigger("liveedgechange"))}},i.handleDurationchange=function(){this.player_.duration()===1/0?this.startTracking():this.stopTracking()},i.startTracking=function(){var t=this;this.isTracking()||(this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,"play",this.trackLive_),this.on(this.player_,"pause",this.trackLive_),this.one(this.player_,"play",this.handlePlay),this.timeupdateSeen_||(this.handleTimeupdate=function(){t.timeupdateSeen_=!0,t.handleTimeupdate=null},this.one(this.player_,"timeupdate",this.handleTimeupdate)))},i.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},i.reset_=function(){this.pastSeekEnd_=0,this.lastSeekEnd_=null,this.behindLiveEdge_=null,this.timeupdateSeen_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.seekableIncrement_=12,this.off(this.player_,"play",this.trackLive_),this.off(this.player_,"pause",this.trackLive_),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.seekToLiveEdge),this.handleTimeupdate&&(this.off(this.player_,"timeupdate",this.handleTimeupdate),this.handleTimeupdate=null)},i.stopTracking=function(){this.isTracking()&&this.reset_()},i.seekableEnd=function(){var t=this.player_.seekable(),e=[],i=t?t.length:0;while(i--)e.push(t.end(i));return e.length?e.sort()[e.length-1]:1/0},i.seekableStart=function(){var t=this.player_.seekable(),e=[],i=t?t.length:0;while(i--)e.push(t.start(i));return e.length?e.sort()[0]:0},i.liveWindow=function(){var t=this.liveCurrentTime();return t===1/0?1/0:t-this.seekableStart()},i.isLive=function(){return this.isTracking()},i.atLiveEdge=function(){return!this.behindLiveEdge()},i.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},i.pastSeekEnd=function(){return this.pastSeekEnd_},i.behindLiveEdge=function(){return this.behindLiveEdge_},i.isTracking=function(){return"number"===typeof this.trackingInterval_},i.seekToLiveEdge=function(){this.atLiveEdge()||(this.player_.currentTime(this.liveCurrentTime()),this.player_.paused()&&this.player_.play())},i.dispose=function(){this.stopTracking(),t.prototype.dispose.call(this)},e}(Vi);Vi.registerComponent("LiveTracker",po);var fo=function(t){var e=t.el();if(e.hasAttribute("src"))return t.triggerSourceset(e.src),!0;var i=t.$$("source"),n=[],r="";if(!i.length)return!1;for(var a=0;a<i.length;a++){var o=i[a].src;o&&-1===n.indexOf(o)&&n.push(o)}return!!n.length&&(1===n.length&&(r=n[0]),t.triggerSourceset(r),!0)},mo=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(t){var e=Dt.a.createElement(this.nodeName.toLowerCase());e.innerHTML=t;var i=Dt.a.createDocumentFragment();while(e.childNodes.length)i.appendChild(e.childNodes[0]);return this.innerText="",xt.a.Element.prototype.appendChild.call(this,i),this.innerHTML}}),go=function(t,e){for(var i={},n=0;n<t.length;n++)if(i=Object.getOwnPropertyDescriptor(t[n],e),i&&i.set&&i.get)break;return i.enumerable=!0,i.configurable=!0,i},vo=function(t){return go([t.el(),xt.a.HTMLMediaElement.prototype,xt.a.Element.prototype,mo],"innerHTML")},yo=function(t){var e=t.el();if(!e.resetSourceWatch_){var i={},n=vo(t),r=function(i){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=i.apply(e,r);return fo(t),o}};["append","appendChild","insertAdjacentHTML"].forEach(function(t){e[t]&&(i[t]=e[t],e[t]=r(i[t]))}),Object.defineProperty(e,"innerHTML",Gi(n,{set:r(n.set)})),e.resetSourceWatch_=function(){e.resetSourceWatch_=null,Object.keys(i).forEach(function(t){e[t]=i[t]}),Object.defineProperty(e,"innerHTML",n)},t.one("sourceset",e.resetSourceWatch_)}},_o=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?$n(xt.a.Element.prototype.getAttribute.call(this,"src")):""},set:function(t){return xt.a.Element.prototype.setAttribute.call(this,"src",t),t}}),bo=function(t){return go([t.el(),xt.a.HTMLMediaElement.prototype,_o],"src")},wo=function(t){if(t.featuresSourceset){var e=t.el();if(!e.resetSourceset_){var i=bo(t),n=e.setAttribute,r=e.load;Object.defineProperty(e,"src",Gi(i,{set:function(n){var r=i.set.call(e,n);return t.triggerSourceset(e.src),r}})),e.setAttribute=function(i,r){var a=n.call(e,i,r);return/src/i.test(i)&&t.triggerSourceset(e.src),a},e.load=function(){var i=r.call(e);return fo(t)||(t.triggerSourceset(""),yo(t)),i},e.currentSrc?t.triggerSourceset(e.currentSrc):fo(t)||yo(t),e.resetSourceset_=function(){e.resetSourceset_=null,e.load=r,e.setAttribute=n,Object.defineProperty(e,"src",i),e.resetSourceWatch_&&e.resetSourceWatch_()}}}};function To(){var t=se(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);return To=function(){return t},t}var xo=function(t){function e(e,i){var n;n=t.call(this,e,i)||this;var r=e.source,a=!1;if(r&&(n.el_.currentSrc!==r.src||e.tag&&3===e.tag.initNetworkState_)?n.setSource(r):n.handleLateInit_(n.el_),e.enableSourceset&&n.setupSourcesetHandling_(),n.el_.hasChildNodes()){var o=n.el_.childNodes,s=o.length,c=[];while(s--){var l=o[s],u=l.nodeName.toLowerCase();"track"===u&&(n.featuresNativeTextTracks?(n.remoteTextTrackEls().addTrackElement_(l),n.remoteTextTracks().addTrack(l.track),n.textTracks().addTrack(l.track),a||n.el_.hasAttribute("crossorigin")||!Jn(l.src)||(a=!0)):c.push(l))}for(var h=0;h<c.length;h++)n.el_.removeChild(c[h])}return n.proxyNativeTracks_(),n.featuresNativeTextTracks&&a&&he.warn(vt()(To())),n.restoreMetadataTracksInIOSNativePlayer_(),(un||$i||en)&&!0===e.nativeControlsForTouch&&n.setControls(!0),n.proxyWebkitFullscreen_(),n.triggerReady(),n}ie(e,t);var i=e.prototype;return i.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),e.disposeMediaElement(this.el_),this.options_=null,t.prototype.dispose.call(this)},i.setupSourcesetHandling_=function(){wo(this)},i.restoreMetadataTracksInIOSNativePlayer_=function(){var t,e=this.textTracks(),i=function(){t=[];for(var i=0;i<e.length;i++){var n=e[i];"metadata"===n.kind&&t.push({track:n,storedMode:n.mode})}};i(),e.addEventListener("change",i),this.on("dispose",function(){return e.removeEventListener("change",i)});var n=function i(){for(var n=0;n<t.length;n++){var r=t[n];"disabled"===r.track.mode&&r.track.mode!==r.storedMode&&(r.track.mode=r.storedMode)}e.removeEventListener("change",i)};this.on("webkitbeginfullscreen",function(){e.removeEventListener("change",i),e.removeEventListener("change",n),e.addEventListener("change",n)}),this.on("webkitendfullscreen",function(){e.removeEventListener("change",i),e.addEventListener("change",i),e.removeEventListener("change",n)})},i.overrideNative_=function(t,e){var i=this;if(e===this["featuresNative"+t+"Tracks"]){var n=t.toLowerCase();this[n+"TracksListeners_"]&&Object.keys(this[n+"TracksListeners_"]).forEach(function(t){var e=i.el()[n+"Tracks"];e.removeEventListener(t,i[n+"TracksListeners_"][t])}),this["featuresNative"+t+"Tracks"]=!e,this[n+"TracksListeners_"]=null,this.proxyNativeTracksForType_(n)}},i.overrideNativeAudioTracks=function(t){this.overrideNative_("Audio",t)},i.overrideNativeVideoTracks=function(t){this.overrideNative_("Video",t)},i.proxyNativeTracksForType_=function(t){var e=this,i=lr[t],n=this.el()[i.getterName],r=this[i.getterName]();if(this["featuresNative"+i.capitalName+"Tracks"]&&n&&n.addEventListener){var a={change:function(t){r.trigger({type:"change",target:r,currentTarget:r,srcElement:r})},addtrack:function(t){r.addTrack(t.track)},removetrack:function(t){r.removeTrack(t.track)}},o=function(){for(var t=[],e=0;e<r.length;e++){for(var i=!1,a=0;a<n.length;a++)if(n[a]===r[e]){i=!0;break}i||t.push(r[e])}while(t.length)r.removeTrack(t.shift())};this[i.getterName+"Listeners_"]=a,Object.keys(a).forEach(function(t){var i=a[t];n.addEventListener(t,i),e.on("dispose",function(e){return n.removeEventListener(t,i)})}),this.on("loadstart",o),this.on("dispose",function(t){return e.off("loadstart",o)})}},i.proxyNativeTracks_=function(){var t=this;lr.names.forEach(function(e){t.proxyNativeTracksForType_(e)})},i.createEl=function(){var t=this.options_.tag;if(!t||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(t){var i=t.cloneNode(!0);t.parentNode&&t.parentNode.insertBefore(i,t),e.disposeMediaElement(t),t=i}else{t=Dt.a.createElement("video");var n=this.options_.tag&&Ne(this.options_.tag),r=Gi({},n);un&&!0===this.options_.nativeControlsForTouch||delete r.controls,Ue(t,ve(r,{id:this.options_.techId,class:"vjs-tech"}))}t.playerId=this.options_.playerId}"undefined"!==typeof this.options_.preload&&Fe(t,"preload",this.options_.preload);for(var a=["loop","muted","playsinline","autoplay"],o=0;o<a.length;o++){var s=a[o],c=this.options_[s];"undefined"!==typeof c&&(c?Fe(t,s,s):ze(t,s),t[s]=c)}return t},i.handleLateInit_=function(t){if(0!==t.networkState&&3!==t.networkState){if(0===t.readyState){var e=!1,i=function(){e=!0};this.on("loadstart",i);var n=function(){e||this.trigger("loadstart")};return this.on("loadedmetadata",n),void this.ready(function(){this.off("loadstart",i),this.off("loadedmetadata",n),e||this.trigger("loadstart")})}var r=["loadstart"];r.push("loadedmetadata"),t.readyState>=2&&r.push("loadeddata"),t.readyState>=3&&r.push("canplay"),t.readyState>=4&&r.push("canplaythrough"),this.ready(function(){r.forEach(function(t){this.trigger(t)},this)})}},i.setCurrentTime=function(t){try{this.el_.currentTime=t}catch(e){he(e,"Video is not ready. (Video.js)")}},i.duration=function(){var t=this;if(this.el_.duration===1/0&&Qi&&an&&0===this.el_.currentTime){var e=function e(){t.el_.currentTime>0&&(t.el_.duration===1/0&&t.trigger("durationchange"),t.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN},i.width=function(){return this.el_.offsetWidth},i.height=function(){return this.el_.offsetHeight},i.proxyWebkitFullscreen_=function(){var t=this;if("webkitDisplayingFullscreen"in this.el_){var e=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},i=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0}))};this.on("webkitbeginfullscreen",i),this.on("dispose",function(){t.off("webkitbeginfullscreen",i),t.off("webkitendfullscreen",e)})}},i.supportsFullScreen=function(){if("function"===typeof this.el_.webkitEnterFullScreen){var t=xt.a.navigator&&xt.a.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},i.enterFullScreen=function(){var t=this.el_;t.paused&&t.networkState<=t.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){t.pause(),t.webkitEnterFullScreen()},0)):t.webkitEnterFullScreen()},i.exitFullScreen=function(){this.el_.webkitExitFullScreen()},i.src=function(t){if(void 0===t)return this.el_.src;this.setSrc(t)},i.reset=function(){e.resetMediaElement(this.el_)},i.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},i.setControls=function(t){this.el_.controls=!!t},i.addTextTrack=function(e,i,n){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,i,n):t.prototype.addTextTrack.call(this,e,i,n)},i.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return t.prototype.createRemoteTextTrack.call(this,e);var i=Dt.a.createElement("track");return e.kind&&(i.kind=e.kind),e.label&&(i.label=e.label),(e.language||e.srclang)&&(i.srclang=e.language||e.srclang),e.default&&(i.default=e.default),e.id&&(i.id=e.id),e.src&&(i.src=e.src),i},i.addRemoteTextTrack=function(e,i){var n=t.prototype.addRemoteTextTrack.call(this,e,i);return this.featuresNativeTextTracks&&this.el().appendChild(n),n},i.removeRemoteTextTrack=function(e){if(t.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks){var i=this.$$("track"),n=i.length;while(n--)e!==i[n]&&e!==i[n].track||this.el().removeChild(i[n])}},i.getVideoPlaybackQuality=function(){if("function"===typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var t={};return"undefined"!==typeof this.el().webkitDroppedFrameCount&&"undefined"!==typeof this.el().webkitDecodedFrameCount&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),xt.a.performance&&"function"===typeof xt.a.performance.now?t.creationTime=xt.a.performance.now():xt.a.performance&&xt.a.performance.timing&&"number"===typeof xt.a.performance.timing.navigationStart&&(t.creationTime=xt.a.Date.now()-xt.a.performance.timing.navigationStart),t},e}(pr);if(Ee()){xo.TEST_VID=Dt.a.createElement("video");var So=Dt.a.createElement("track");So.kind="captions",So.srclang="en",So.label="English",xo.TEST_VID.appendChild(So)}xo.isSupported=function(){try{xo.TEST_VID.volume=.5}catch(t){return!1}return!(!xo.TEST_VID||!xo.TEST_VID.canPlayType)},xo.canPlayType=function(t){return xo.TEST_VID.canPlayType(t)},xo.canPlaySource=function(t,e){return xo.canPlayType(t.type)},xo.canControlVolume=function(){try{var t=xo.TEST_VID.volume;return xo.TEST_VID.volume=t/2+.1,t!==xo.TEST_VID.volume}catch(e){return!1}},xo.canMuteVolume=function(){try{var t=xo.TEST_VID.muted;return xo.TEST_VID.muted=!t,xo.TEST_VID.muted?Fe(xo.TEST_VID,"muted","muted"):ze(xo.TEST_VID,"muted","muted"),t!==xo.TEST_VID.muted}catch(e){return!1}},xo.canControlPlaybackRate=function(){if(Qi&&an&&on<58)return!1;try{var t=xo.TEST_VID.playbackRate;return xo.TEST_VID.playbackRate=t/2+.1,t!==xo.TEST_VID.playbackRate}catch(e){return!1}},xo.canOverrideAttributes=function(){try{var t=function(){};Object.defineProperty(Dt.a.createElement("video"),"src",{get:t,set:t}),Object.defineProperty(Dt.a.createElement("audio"),"src",{get:t,set:t}),Object.defineProperty(Dt.a.createElement("video"),"innerHTML",{get:t,set:t}),Object.defineProperty(Dt.a.createElement("audio"),"innerHTML",{get:t,set:t})}catch(e){return!1}return!0},xo.supportsNativeTextTracks=function(){return ln||Ji&&an},xo.supportsNativeVideoTracks=function(){return!(!xo.TEST_VID||!xo.TEST_VID.videoTracks)},xo.supportsNativeAudioTracks=function(){return!(!xo.TEST_VID||!xo.TEST_VID.audioTracks)},xo.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],xo.prototype.featuresVolumeControl=xo.canControlVolume(),xo.prototype.featuresMuteControl=xo.canMuteVolume(),xo.prototype.featuresPlaybackRate=xo.canControlPlaybackRate(),xo.prototype.featuresSourceset=xo.canOverrideAttributes(),xo.prototype.movingMediaElementInDOM=!Ji,xo.prototype.featuresFullscreenResize=!0,xo.prototype.featuresProgressEvents=!0,xo.prototype.featuresTimeupdateEvents=!0,xo.prototype.featuresNativeTextTracks=xo.supportsNativeTextTracks(),xo.prototype.featuresNativeVideoTracks=xo.supportsNativeVideoTracks(),xo.prototype.featuresNativeAudioTracks=xo.supportsNativeAudioTracks();var Eo=xo.TEST_VID&&xo.TEST_VID.constructor.prototype.canPlayType,Mo=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;function Co(){var t=se(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]);return Co=function(){return t},t}xo.patchCanPlayType=function(){tn>=4&&!nn&&!an&&(xo.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&Mo.test(t)?"maybe":Eo.call(this,t)})},xo.unpatchCanPlayType=function(){var t=xo.TEST_VID.constructor.prototype.canPlayType;return xo.TEST_VID.constructor.prototype.canPlayType=Eo,t},xo.patchCanPlayType(),xo.disposeMediaElement=function(t){if(t){t.parentNode&&t.parentNode.removeChild(t);while(t.hasChildNodes())t.removeChild(t.firstChild);t.removeAttribute("src"),"function"===typeof t.load&&function(){try{t.load()}catch(e){}}()}},xo.resetMediaElement=function(t){if(t){var e=t.querySelectorAll("source"),i=e.length;while(i--)t.removeChild(e[i]);t.removeAttribute("src"),"function"===typeof t.load&&function(){try{t.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(t){xo.prototype[t]=function(){return this.el_[t]||this.el_.hasAttribute(t)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){xo.prototype["set"+ji(t)]=function(e){this.el_[t]=e,e?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(t){xo.prototype[t]=function(){return this.el_[t]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(t){xo.prototype["set"+ji(t)]=function(e){this.el_[t]=e}}),["pause","load","play"].forEach(function(t){xo.prototype[t]=function(){return this.el_[t]()}}),pr.withSourceHandlers(xo),xo.nativeSourceHandler={},xo.nativeSourceHandler.canPlayType=function(t){try{return xo.TEST_VID.canPlayType(t)}catch(e){return""}},xo.nativeSourceHandler.canHandleSource=function(t,e){if(t.type)return xo.nativeSourceHandler.canPlayType(t.type);if(t.src){var i=Zn(t.src);return xo.nativeSourceHandler.canPlayType("video/"+i)}return""},xo.nativeSourceHandler.handleSource=function(t,e,i){e.setSrc(t.src)},xo.nativeSourceHandler.dispose=function(){},xo.registerSourceHandler(xo.nativeSourceHandler),pr.registerTech("Html5",xo);var Ao=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],ko={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Lo=["tiny","xsmall","small","medium","large","xlarge","huge"],Po={};Lo.forEach(function(t){var e="x"===t.charAt(0)?"x-"+t.substring(1):t;Po[t]="vjs-layout-"+e});var Oo={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Ro=function(t){function e(i,n,r){var a;if(i.id=i.id||n.id||"vjs_video_"+ii(),n=ve(e.getTagSettings(i),n),n.initChildren=!1,n.createEl=!1,n.evented=!1,n.reportTouchActivity=!1,!n.language)if("function"===typeof i.closest){var o=i.closest("[lang]");o&&o.getAttribute&&(n.language=o.getAttribute("lang"))}else{var s=i;while(s&&1===s.nodeType){if(Ne(s).hasOwnProperty("lang")){n.language=s.getAttribute("lang");break}s=s.parentNode}}if(a=t.call(this,null,n,r)||this,a.log=de(a.id_),a.isPosterFromTech_=!1,a.queuedCallbacks_=[],a.isReady_=!1,a.hasStarted_=!1,a.userActive_=!1,!a.options_||!a.options_.techOrder||!a.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(a.tag=i,a.tagAttributes=i&&Ne(i),a.language(a.options_.language),n.languages){var c={};Object.getOwnPropertyNames(n.languages).forEach(function(t){c[t.toLowerCase()]=n.languages[t]}),a.languages_=c}else a.languages_=e.prototype.options_.languages;a.cache_={},a.poster_=n.poster||"",a.controls_=!!n.controls,a.cache_.lastVolume=1,i.controls=!1,i.removeAttribute("controls"),i.hasAttribute("autoplay")?a.options_.autoplay=!0:a.autoplay(a.options_.autoplay),a.scrubbing_=!1,a.el_=a.createEl(),a.cache_.lastPlaybackRate=a.defaultPlaybackRate(),Bi(oe(oe(a)),{eventBusKey:"el_"}),a.fluid_&&a.on("playerreset",a.updateStyleEl_);var l=Gi(a.options_);if(n.plugins){var u=n.plugins;Object.keys(u).forEach(function(t){if("function"!==typeof this[t])throw new Error('plugin "'+t+'" does not exist');this[t](u[t])},oe(oe(a)))}a.options_.playerOptions=l,a.middleware_=[],a.initChildren(),a.isAudio("audio"===i.nodeName.toLowerCase()),a.controls()?a.addClass("vjs-controls-enabled"):a.addClass("vjs-controls-disabled"),a.el_.setAttribute("role","region"),a.isAudio()?a.el_.setAttribute("aria-label",a.localize("Audio Player")):a.el_.setAttribute("aria-label",a.localize("Video Player")),a.isAudio()&&a.addClass("vjs-audio"),a.flexNotSupported_()&&a.addClass("vjs-no-flex"),Ji||a.addClass("vjs-workinghover"),e.players[a.id_]=oe(oe(a));var h=ee.split(".")[0];return a.addClass("vjs-v"+h),a.userActive(!0),a.reportUserActivity(),a.one("play",a.listenForUserActivity_),a.on("fullscreenchange",a.handleFullscreenChange_),a.on("stageclick",a.handleStageClick_),a.breakpoints(a.options_.breakpoints),a.responsive(a.options_.responsive),a.changingSrc_=!1,a.playWaitingForReady_=!1,a.playOnLoadstart_=null,a}ie(e,t);var i=e.prototype;return i.dispose=function(){this.trigger("dispose"),this.off("dispose"),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),e.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Ar(this),t.prototype.dispose.call(this)},i.createEl=function(){var e,i=this.tag,n=this.playerElIngest_=i.parentNode&&i.parentNode.hasAttribute&&i.parentNode.hasAttribute("data-vjs-player"),r="video-js"===this.tag.tagName.toLowerCase();n?e=this.el_=i.parentNode:r||(e=this.el_=t.prototype.createEl.call(this,"div"));var a=Ne(i);if(r){e=this.el_=i,i=this.tag=Dt.a.createElement("video");while(e.children.length)i.appendChild(e.firstChild);Oe(e,"video-js")||Re(e,"video-js"),e.appendChild(i),n=this.playerElIngest_=e,Object.keys(e).forEach(function(t){i[t]=e[t]})}if(i.setAttribute("tabindex","-1"),a.tabindex="-1",sn&&(i.setAttribute("role","application"),a.role="application"),i.removeAttribute("width"),i.removeAttribute("height"),"width"in a&&delete a.width,"height"in a&&delete a.height,Object.getOwnPropertyNames(a).forEach(function(t){r&&"class"===t||e.setAttribute(t,a[t]),r&&i.setAttribute(t,a[t])}),i.playerId=i.id,i.id+="_html5_api",i.className="vjs-tech",i.player=e.player=this,this.addClass("vjs-paused"),!0!==xt.a.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=xi("vjs-styles-dimensions");var o=Ke(".vjs-styles-defaults"),s=Ke("head");s.insertBefore(this.styleEl_,o?o.nextSibling:s.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var c=i.getElementsByTagName("a"),l=0;l<c.length;l++){var u=c.item(l);Re(u,"vjs-hidden"),u.setAttribute("hidden","hidden")}return i.initNetworkState_=i.networkState,i.parentNode&&!n&&i.parentNode.insertBefore(e,i),Pe(i,e),this.children_.unshift(i),this.el_.setAttribute("lang",this.language_),this.el_=e,e},i.width=function(t){return this.dimension("width",t)},i.height=function(t){return this.dimension("height",t)},i.dimension=function(t,e){var i=t+"_";if(void 0===e)return this[i]||0;if(""===e)return this[i]=void 0,void this.updateStyleEl_();var n=parseFloat(e);isNaN(n)?he.error('Improper value "'+e+'" supplied for for '+t):(this[i]=n,this.updateStyleEl_())},i.fluid=function(t){if(void 0===t)return!!this.fluid_;this.fluid_=!!t,ki(this)&&this.off("playerreset",this.updateStyleEl_),t?(this.addClass("vjs-fluid"),this.fill(!1),Li(function(){this.on("playerreset",this.updateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()},i.fill=function(t){if(void 0===t)return!!this.fill_;this.fill_=!!t,t?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},i.aspectRatio=function(t){if(void 0===t)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(t))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=t,this.fluid(!0),this.updateStyleEl_()},i.updateStyleEl_=function(){if(!0!==xt.a.VIDEOJS_NO_DYNAMIC_STYLE){var t,e,i,n;i=void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9";var r=i.split(":"),a=r[1]/r[0];t=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/a:this.videoWidth()||300,e=void 0!==this.height_?this.height_:t*a,n=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(n),Si(this.styleEl_,"\n      ."+n+" {\n        width: "+t+"px;\n        height: "+e+"px;\n      }\n\n      ."+n+".vjs-fluid {\n        padding-top: "+100*a+"%;\n      }\n    ")}else{var o="number"===typeof this.width_?this.width_:this.options_.width,s="number"===typeof this.height_?this.height_:this.options_.height,c=this.tech_&&this.tech_.el();c&&(o>=0&&(c.width=o),s>=0&&(c.height=s))}},i.loadTech_=function(t,e){var i=this;this.tech_&&this.unloadTech_();var n=ji(t),r=t.charAt(0).toLowerCase()+t.slice(1);"Html5"!==n&&this.tag&&(pr.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=n,this.isReady_=!1;var a="string"!==typeof this.autoplay()&&this.autoplay(),o={source:e,autoplay:a,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+r+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};hr.names.forEach(function(t){var e=hr[t];o[e.getterName]=i[e.privateName]}),ve(o,this.options_[n]),ve(o,this.options_[r]),ve(o,this.options_[t.toLowerCase()]),this.tag&&(o.tag=this.tag),e&&e.src===this.cache_.src&&this.cache_.currentTime>0&&(o.startTime=this.cache_.currentTime);var s=pr.getTech(t);if(!s)throw new Error("No Tech named '"+n+"' exists! '"+n+"' should be registered using videojs.registerTech()'");this.tech_=new s(o),this.tech_.ready(Ei(this,this.handleTechReady_),!0),Ln.jsonToTextTracks(this.textTracksJson_||[],this.tech_),Ao.forEach(function(t){i.on(i.tech_,t,i["handleTech"+ji(t)+"_"])}),Object.keys(ko).forEach(function(t){i.on(i.tech_,t,function(e){0===i.tech_.playbackRate()&&i.tech_.seeking()?i.queuedCallbacks_.push({callback:i["handleTech"+ko[t]+"_"].bind(i),event:e}):i["handleTech"+ko[t]+"_"](e)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===n&&this.tag||Pe(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},i.unloadTech_=function(){var t=this;hr.names.forEach(function(e){var i=hr[e];t[i.privateName]=t[i.getterName]()}),this.textTracksJson_=Ln.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},i.tech=function(t){return void 0===t&&he.warn(vt()(Co())),this.tech_},i.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mousedown",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},i.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mousedown",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},i.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},i.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},i.manualAutoplay_=function(t){var e=this;if(this.tech_&&"string"===typeof t){var i,n=function(){var t=e.muted();e.muted(!0);var i=e.play();if(i&&i.then&&i.catch)return i.catch(function(i){e.muted(t)})};if("any"===t?(i=this.play(),i&&i.then&&i.catch&&i.catch(function(){return n()})):i="muted"===t?n():this.play(),i&&i.then&&i.catch)return i.then(function(){e.trigger({type:"autoplay-success",autoplay:t})}).catch(function(i){e.trigger({type:"autoplay-failure",autoplay:t})})}},i.updateSourceCaches_=function(t){void 0===t&&(t="");var e=t,i="";"string"!==typeof e&&(e=t.src,i=t.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],e&&!i&&(i=Rr(this,e)),this.cache_.source=Gi({},t,{src:e,type:i});for(var n=this.cache_.sources.filter(function(t){return t.src&&t.src===e}),r=[],a=this.$$("source"),o=[],s=0;s<a.length;s++){var c=Ne(a[s]);r.push(c),c.src&&c.src===e&&o.push(c.src)}o.length&&!n.length?this.cache_.sources=r:n.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=e},i.handleTechSourceset_=function(t){var e=this;if(!this.changingSrc_){var i=function(t){return e.updateSourceCaches_(t)},n=this.currentSource().src,r=t.src;if(n&&!/^blob:/.test(n)&&/^blob:/.test(r)&&(!this.lastSource_||this.lastSource_.tech!==r&&this.lastSource_.player!==n)&&(i=function(){}),i(r),!t.src){var a=function t(i){if("sourceset"!==i.type){var n=e.techGet("currentSrc");e.lastSource_.tech=n,e.updateSourceCaches_(n)}e.tech_.off(["sourceset","loadstart"],t)};this.tech_.one(["sourceset","loadstart"],a)}}this.lastSource_={player:this.currentSource().src,tech:t.src},this.trigger({src:t.src,type:"sourceset"})},i.hasStarted=function(t){if(void 0===t)return this.hasStarted_;t!==this.hasStarted_&&(this.hasStarted_=t,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},i.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},i.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(t){return t.callback(t.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},i.handleTechWaiting_=function(){var t=this;this.addClass("vjs-waiting"),this.trigger("waiting");var e=this.currentTime(),i=function i(){e!==t.currentTime()&&(t.removeClass("vjs-waiting"),t.off("timeupdate",i))};this.on("timeupdate",i)},i.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},i.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},i.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},i.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},i.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.trigger("seeked")},i.handleTechFirstPlay_=function(){this.options_.starttime&&(he.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},i.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},i.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},i.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},i.handleTechClick_=function(t){Je(t)&&this.controls_&&(this.paused()?Mn(this.play()):this.pause())},i.handleTechDoubleClick_=function(t){if(this.controls_){var e=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(e){return e.contains(t.target)});e||(this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}},i.handleTechTap_=function(){this.userActive(!this.userActive())},i.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},i.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},i.handleTechTouchEnd_=function(t){t.preventDefault()},i.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},i.handleStageClick_=function(){this.reportUserActivity()},i.handleTechFullscreenChange_=function(t,e){e&&this.isFullscreen(e.isFullscreen),this.trigger("fullscreenchange")},i.handleTechError_=function(){var t=this.tech_.error();this.error(t)},i.handleTechTextData_=function(){var t=null;arguments.length>1&&(t=arguments[1]),this.trigger("textdata",t)},i.getCache=function(){return this.cache_},i.techCall_=function(t,e){this.ready(function(){if(t in Sr)return wr(this.middleware_,this.tech_,t,e);if(t in Er)return Tr(this.middleware_,this.tech_,t,e);try{this.tech_&&this.tech_[t](e)}catch(i){throw he(i),i}},!0)},i.techGet_=function(t){if(this.tech_&&this.tech_.isReady_){if(t in xr)return br(this.middleware_,this.tech_,t);if(t in Er)return Tr(this.middleware_,this.tech_,t);try{return this.tech_[t]()}catch(e){if(void 0===this.tech_[t])throw he("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e),e;if("TypeError"===e.name)throw he("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1,e;throw he(e),e}}},i.play=function(){var t=this,e=this.options_.Promise||xt.a.Promise;return e?new e(function(e){t.play_(e)}):this.play_()},i.play_=function(t){var e=this;if(void 0===t&&(t=Mn),this.playOnLoadstart_&&this.off("loadstart",this.playOnLoadstart_),this.isReady_){if(!this.changingSrc_&&(this.src()||this.currentSrc()))return void t(this.techGet_("play"));this.playOnLoadstart_=function(){e.playOnLoadstart_=null,t(e.play())},this.one("loadstart",this.playOnLoadstart_)}else{if(this.playWaitingForReady_)return;this.playWaitingForReady_=!0,this.ready(function(){e.playWaitingForReady_=!1,t(e.play())})}},i.pause=function(){this.techCall_("pause")},i.paused=function(){return!1!==this.techGet_("paused")},i.played=function(){return this.techGet_("played")||mn(0,0)},i.scrubbing=function(t){if("undefined"===typeof t)return this.scrubbing_;this.scrubbing_=!!t,t?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},i.currentTime=function(t){return"undefined"!==typeof t?(t<0&&(t=0),void this.techCall_("setCurrentTime",t)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},i.duration=function(t){if(void 0===t)return void 0!==this.cache_.duration?this.cache_.duration:NaN;t=parseFloat(t),t<0&&(t=1/0),t!==this.cache_.duration&&(this.cache_.duration=t,t===1/0?(this.addClass("vjs-live"),this.options_.liveui&&this.player_.liveTracker&&this.addClass("vjs-liveui")):(this.removeClass("vjs-live"),this.removeClass("vjs-liveui")),isNaN(t)||this.trigger("durationchange"))},i.remainingTime=function(){return this.duration()-this.currentTime()},i.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},i.buffered=function(){var t=this.techGet_("buffered");return t&&t.length||(t=mn(0,0)),t},i.bufferedPercent=function(){return gn(this.buffered(),this.duration())},i.bufferedEnd=function(){var t=this.buffered(),e=this.duration(),i=t.end(t.length-1);return i>e&&(i=e),i},i.volume=function(t){var e;return void 0!==t?(e=Math.max(0,Math.min(1,parseFloat(t))),this.cache_.volume=e,this.techCall_("setVolume",e),void(e>0&&this.lastVolume_(e))):(e=parseFloat(this.techGet_("volume")),isNaN(e)?1:e)},i.muted=function(t){if(void 0===t)return this.techGet_("muted")||!1;this.techCall_("setMuted",t)},i.defaultMuted=function(t){return void 0!==t?this.techCall_("setDefaultMuted",t):this.techGet_("defaultMuted")||!1},i.lastVolume_=function(t){if(void 0===t||0===t)return this.cache_.lastVolume;this.cache_.lastVolume=t},i.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},i.isFullscreen=function(t){if(void 0===t)return!!this.isFullscreen_;this.isFullscreen_=!!t},i.requestFullscreen=function(){var t=yn;this.isFullscreen(!0),t.requestFullscreen?(pi(Dt.a,t.fullscreenchange,Ei(this,function e(i){this.isFullscreen(Dt.a[t.fullscreenElement]),!1===this.isFullscreen()&&fi(Dt.a,t.fullscreenchange,e),this.trigger("fullscreenchange")})),this.el_[t.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},i.exitFullscreen=function(){var t=yn;this.isFullscreen(!1),t.requestFullscreen?Dt.a[t.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},i.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=Dt.a.documentElement.style.overflow,pi(Dt.a,"keydown",Ei(this,this.fullWindowOnEscKey)),Dt.a.documentElement.style.overflow="hidden",Re(Dt.a.body,"vjs-full-window"),this.trigger("enterFullWindow")},i.fullWindowOnEscKey=function(t){27===t.keyCode&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},i.exitFullWindow=function(){this.isFullWindow=!1,fi(Dt.a,"keydown",this.fullWindowOnEscKey),Dt.a.documentElement.style.overflow=this.docOrigOverflow,Ie(Dt.a.body,"vjs-full-window"),this.trigger("exitFullWindow")},i.canPlayType=function(t){for(var e,i=0,n=this.options_.techOrder;i<n.length;i++){var r=n[i],a=pr.getTech(r);if(a||(a=Vi.getComponent(r)),a){if(a.isSupported()&&(e=a.canPlayType(t),e))return e}else he.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return""},i.selectSource=function(t){var e,i=this,n=this.options_.techOrder.map(function(t){return[t,pr.getTech(t)]}).filter(function(t){var e=t[0],i=t[1];return i?i.isSupported():(he.error('The "'+e+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),r=function(t,e,i){var n;return t.some(function(t){return e.some(function(e){if(n=i(t,e),n)return!0})}),n},a=function(t){return function(e,i){return t(i,e)}},o=function(t,e){var n=t[0],r=t[1];if(r.canPlaySource(e,i.options_[n.toLowerCase()]))return{source:e,tech:n}};return e=this.options_.sourceOrder?r(t,n,a(o)):r(n,t,o),e||!1},i.src=function(t){var e=this;if("undefined"===typeof t)return this.cache_.src||"";var i=Ir(t);i.length?(this.changingSrc_=!0,this.cache_.sources=i,this.updateSourceCaches_(i[0]),yr(this,i[0],function(t,n){e.middleware_=n,e.cache_.sources=i,e.updateSourceCaches_(t);var r=e.src_(t);if(r)return i.length>1?e.src(i.slice(1)):(e.changingSrc_=!1,e.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void e.triggerReady());_r(n,e.tech_)})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},i.src_=function(t){var e=this,i=this.selectSource([t]);return!i||(Hi(i.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",t):this.techCall_("src",t.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(function(){e.changingSrc_=!1}),!1))},i.load=function(){this.techCall_("load")},i.reset=function(){this.tech_&&this.tech_.clearTracks("text"),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),ki(this)&&this.trigger("playerreset")},i.currentSources=function(){var t=this.currentSource(),e=[];return 0!==Object.keys(t).length&&e.push(t),this.cache_.sources||e},i.currentSource=function(){return this.cache_.source||{}},i.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},i.currentType=function(){return this.currentSource()&&this.currentSource().type||""},i.preload=function(t){return void 0!==t?(this.techCall_("setPreload",t),void(this.options_.preload=t)):this.techGet_("preload")},i.autoplay=function(t){if(void 0===t)return this.options_.autoplay||!1;var e;"string"===typeof t&&/(any|play|muted)/.test(t)?(this.options_.autoplay=t,this.manualAutoplay_(t),e=!1):this.options_.autoplay=!!t,e=e||this.options_.autoplay,this.tech_&&this.techCall_("setAutoplay",e)},i.playsinline=function(t){return void 0!==t?(this.techCall_("setPlaysinline",t),this.options_.playsinline=t,this):this.techGet_("playsinline")},i.loop=function(t){return void 0!==t?(this.techCall_("setLoop",t),void(this.options_.loop=t)):this.techGet_("loop")},i.poster=function(t){if(void 0===t)return this.poster_;t||(t=""),t!==this.poster_&&(this.poster_=t,this.techCall_("setPoster",t),this.isPosterFromTech_=!1,this.trigger("posterchange"))},i.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var t=this.tech_.poster()||"";t!==this.poster_&&(this.poster_=t,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},i.controls=function(t){if(void 0===t)return!!this.controls_;t=!!t,this.controls_!==t&&(this.controls_=t,this.usingNativeControls()&&this.techCall_("setControls",t),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},i.usingNativeControls=function(t){if(void 0===t)return!!this.usingNativeControls_;t=!!t,this.usingNativeControls_!==t&&(this.usingNativeControls_=t,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},i.error=function(t){return void 0===t?this.error_||null:null===t?(this.error_=t,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close())):(this.error_=new xn(t),this.addClass("vjs-error"),he.error("(CODE:"+this.error_.code+" "+xn.errorTypes[this.error_.code]+")",this.error_.message,this.error_),void this.trigger("error"))},i.reportUserActivity=function(t){this.userActivity_=!0},i.userActive=function(t){if(void 0===t)return this.userActive_;if(t=!!t,t!==this.userActive_){if(this.userActive_=t,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},i.listenForUserActivity_=function(){var t,e,i,n,r=Ei(this,this.reportUserActivity),a=function(t){t.screenX===e&&t.screenY===i||(e=t.screenX,i=t.screenY,r())},o=function(){r(),this.clearInterval(t),t=this.setInterval(r,250)},s=function(e){r(),this.clearInterval(t)};this.on("mousedown",o),this.on("mousemove",a),this.on("mouseup",s),this.on("keydown",r),this.on("keyup",r),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(n);var t=this.options_.inactivityTimeout;t<=0||(n=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},t))}},250)},i.playbackRate=function(t){if(void 0===t)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",t)},i.defaultPlaybackRate=function(t){return void 0!==t?this.techCall_("setDefaultPlaybackRate",t):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},i.isAudio=function(t){if(void 0===t)return!!this.isAudio_;this.isAudio_=!!t},i.addTextTrack=function(t,e,i){if(this.tech_)return this.tech_.addTextTrack(t,e,i)},i.addRemoteTextTrack=function(t,e){if(this.tech_)return this.tech_.addRemoteTextTrack(t,e)},i.removeRemoteTextTrack=function(t){void 0===t&&(t={});var e=t,i=e.track;if(i||(i=t),this.tech_)return this.tech_.removeRemoteTextTrack(i)},i.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},i.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},i.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},i.language=function(t){if(void 0===t)return this.language_;this.language_=String(t).toLowerCase()},i.languages=function(){return Gi(e.prototype.options_.languages,this.languages_)},i.toJSON=function(){var t=Gi(this.options_),e=t.tracks;t.tracks=[];for(var i=0;i<e.length;i++){var n=e[i];n=Gi(n),n.player=void 0,t.tracks[i]=n}return t},i.createModal=function(t,e){var i=this;e=e||{},e.content=t||"";var n=new Rn(this,e);return this.addChild(n),n.on("dispose",function(){i.removeChild(n)}),n.open(),n},i.updateCurrentBreakpoint_=function(){if(this.responsive())for(var t=this.currentBreakpoint(),e=this.currentWidth(),i=0;i<Lo.length;i++){var n=Lo[i],r=this.breakpoints_[n];if(e<=r){if(t===n)return;t&&this.removeClass(Po[t]),this.addClass(Po[n]),this.breakpoint_=n;break}}},i.removeCurrentBreakpoint_=function(){var t=this.currentBreakpointClass();this.breakpoint_="",t&&this.removeClass(t)},i.breakpoints=function(t){return void 0===t?ve(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=ve({},Oo,t),this.updateCurrentBreakpoint_(),ve(this.breakpoints_))},i.responsive=function(t){if(void 0===t)return this.responsive_;t=Boolean(t);var e=this.responsive_;return t!==e?(this.responsive_=t,t?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),t):void 0},i.currentBreakpoint=function(){return this.breakpoint_},i.currentBreakpointClass=function(){return Po[this.breakpoint_]||""},e.getTagSettings=function(t){var e={sources:[],tracks:[]},i=Ne(t),n=i["data-setup"];if(Oe(t,"vjs-fill")&&(i.fill=!0),Oe(t,"vjs-fluid")&&(i.fluid=!0),null!==n){var r=pt()(n||"{}"),a=r[0],o=r[1];a&&he.error(a),ve(i,o)}if(ve(e,i),t.hasChildNodes())for(var s=t.childNodes,c=0,l=s.length;c<l;c++){var u=s[c],h=u.nodeName.toLowerCase();"source"===h?e.sources.push(Ne(u)):"track"===h&&e.tracks.push(Ne(u))}return e},i.flexNotSupported_=function(){var t=Dt.a.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)},e}(Vi);hr.names.forEach(function(t){var e=hr[t];Ro.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}}),Ro.players={};var Io=xt.a.navigator;Ro.prototype.options_={techOrder:pr.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Io&&(Io.languages&&Io.languages[0]||Io.userLanguage||Io.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(t){Ro.prototype[t]=function(){return this.techGet_(t)}}),Ao.forEach(function(t){Ro.prototype["handleTech"+ji(t)+"_"]=function(){return this.trigger(t)}}),Vi.registerComponent("Player",Ro);var Do="plugin",Uo="activePlugins_",No={},Bo=function(t){return No.hasOwnProperty(t)},Fo=function(t){return Bo(t)?No[t]:void 0},zo=function(t,e){t[Uo]=t[Uo]||{},t[Uo][e]=!0},jo=function(t,e,i){var n=(i?"before":"")+"pluginsetup";t.trigger(n,e),t.trigger(n+":"+e.name,e)},Ho=function(t,e){var i=function(){jo(this,{name:t,plugin:e,instance:null},!0);var i=e.apply(this,arguments);return zo(this,t),jo(this,{name:t,plugin:e,instance:i}),i};return Object.keys(e).forEach(function(t){i[t]=e[t]}),i},Go=function(t,e){return e.prototype.name=t,function(){jo(this,{name:t,plugin:e,instance:null},!0);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];var a=ae(e,[this].concat(n));return this[t]=function(){return a},jo(this,a.getEventHash()),a}},Vo=function(){function t(e){if(this.constructor===t)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,Bi(this),delete this.trigger,zi(this,this.constructor.defaultState),zo(e,this.name),this.dispose=Ei(this,this.dispose),e.on("dispose",this.dispose)}var e=t.prototype;return e.version=function(){return this.constructor.VERSION},e.getEventHash=function(t){return void 0===t&&(t={}),t.name=this.name,t.plugin=this.constructor,t.instance=this,t},e.trigger=function(t,e){return void 0===e&&(e={}),mi(this.eventBusEl_,t,this.getEventHash(e))},e.handleStateChanged=function(t){},e.dispose=function(){var t=this.name,e=this.player;this.trigger("dispose"),this.off(),e.off("dispose",this.dispose),e[Uo][t]=!1,this.player=this.state=null,e[t]=Go(t,No[t])},t.isBasic=function(e){var i="string"===typeof e?Fo(e):e;return"function"===typeof i&&!t.prototype.isPrototypeOf(i.prototype)},t.registerPlugin=function(e,i){if("string"!==typeof e)throw new Error('Illegal plugin name, "'+e+'", must be a string, was '+typeof e+".");if(Bo(e))he.warn('A plugin named "'+e+'" already exists. You may want to avoid re-registering plugins!');else if(Ro.prototype.hasOwnProperty(e))throw new Error('Illegal plugin name, "'+e+'", cannot share a name with an existing player method!');if("function"!==typeof i)throw new Error('Illegal plugin for "'+e+'", must be a function, was '+typeof i+".");return No[e]=i,e!==Do&&(t.isBasic(i)?Ro.prototype[e]=Ho(e,i):Ro.prototype[e]=Go(e,i)),i},t.deregisterPlugin=function(t){if(t===Do)throw new Error("Cannot de-register base plugin.");Bo(t)&&(delete No[t],delete Ro.prototype[t])},t.getPlugins=function(t){var e;return void 0===t&&(t=Object.keys(No)),t.forEach(function(t){var i=Fo(t);i&&(e=e||{},e[t]=i)}),e},t.getPluginVersion=function(t){var e=Fo(t);return e&&e.VERSION||""},t}();Vo.getPlugin=Fo,Vo.BASE_PLUGIN_NAME=Do,Vo.registerPlugin(Do,Vo),Ro.prototype.usingPlugin=function(t){return!!this[Uo]&&!0===this[Uo][t]},Ro.prototype.hasPlugin=function(t){return!!Bo(t)};var Wo=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.super_=e)},qo=function(t,e){void 0===e&&(e={});var i=function(){t.apply(this,arguments)},n={};for(var r in"object"===typeof e?(e.constructor!==Object.prototype.constructor&&(i=e.constructor),n=e):"function"===typeof e&&(i=e),Wo(i,t),n)n.hasOwnProperty(r)&&(i.prototype[r]=n[r]);return i},Yo=function(t){return 0===t.indexOf("#")?t.slice(1):t};function Xo(t,e,i){var n=Xo.getPlayer(t);if(n)return e&&he.warn('Player "'+t+'" is already initialised. Options will not be applied.'),i&&n.ready(i),n;var r="string"===typeof t?Ke("#"+Yo(t)):t;if(!Me(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");Dt.a.body.contains(r)||he.warn("The element supplied is not included in the DOM"),e=e||{},Xo.hooks("beforesetup").forEach(function(t){var i=t(r,Gi(e));ye(i)&&!Array.isArray(i)?e=Gi(e,i):he.error("please return an object in beforesetup hooks")});var a=Vi.getComponent("Player");return n=new a(r,e,i),Xo.hooks("setup").forEach(function(t){return t(n)}),n}if(Xo.hooks_={},Xo.hooks=function(t,e){return Xo.hooks_[t]=Xo.hooks_[t]||[],e&&(Xo.hooks_[t]=Xo.hooks_[t].concat(e)),Xo.hooks_[t]},Xo.hook=function(t,e){Xo.hooks(t,e)},Xo.hookOnce=function(t,e){Xo.hooks(t,[].concat(e).map(function(e){var i=function i(){return Xo.removeHook(t,i),e.apply(void 0,arguments)};return i}))},Xo.removeHook=function(t,e){var i=Xo.hooks(t).indexOf(e);return!(i<=-1)&&(Xo.hooks_[t]=Xo.hooks_[t].slice(),Xo.hooks_[t].splice(i,1),!0)},!0!==xt.a.VIDEOJS_NO_DYNAMIC_STYLE&&Ee()){var $o=Ke(".vjs-styles-defaults");if(!$o){$o=xi("vjs-styles-defaults");var Zo=Ke("head");Zo&&Zo.insertBefore($o,Zo.firstChild),Si($o,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}wi(1,Xo),Xo.VERSION=ee,Xo.options=Ro.prototype.options_,Xo.getPlayers=function(){return Ro.players},Xo.getPlayer=function(t){var e,i=Ro.players;if("string"===typeof t){var n=Yo(t),r=i[n];if(r)return r;e=Ke("#"+n)}else e=t;if(Me(e)){var a=e,o=a.player,s=a.playerId;if(o||i[s])return o||i[s]}},Xo.getAllPlayers=function(){return Object.keys(Ro.players).map(function(t){return Ro.players[t]}).filter(Boolean)},Xo.players=Ro.players,Xo.getComponent=Vi.getComponent,Xo.registerComponent=function(t,e){pr.isTech(e)&&he.warn("The "+t+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Vi.registerComponent.call(Vi,t,e)},Xo.getTech=pr.getTech,Xo.registerTech=pr.registerTech,Xo.use=vr,Object.defineProperty(Xo,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Xo.middleware,"TERMINATOR",{value:gr,writeable:!1,enumerable:!0}),Xo.browser=hn,Xo.TOUCH_ENABLED=un,Xo.extend=qo,Xo.mergeOptions=Gi,Xo.bind=Ei,Xo.registerPlugin=Vo.registerPlugin,Xo.deregisterPlugin=Vo.deregisterPlugin,Xo.plugin=function(t,e){return he.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Vo.registerPlugin(t,e)},Xo.getPlugins=Vo.getPlugins,Xo.getPlugin=Vo.getPlugin,Xo.getPluginVersion=Vo.getPluginVersion,Xo.addLanguage=function(t,e){var i;return t=(""+t).toLowerCase(),Xo.options.languages=Gi(Xo.options.languages,(i={},i[t]=e,i)),Xo.options.languages[t]},Xo.log=he,Xo.createLogger=de,Xo.createTimeRange=Xo.createTimeRanges=mn,Xo.formatTime=ta,Xo.setFormatTime=Kr,Xo.resetFormatTime=Qr,Xo.parseUrl=Xn,Xo.isCrossOrigin=Jn,Xo.EventTarget=Ai,Xo.on=pi,Xo.one=gi,Xo.off=fi,Xo.trigger=mi,Xo.xhr=_t.a,Xo.TextTrack=er,Xo.AudioTrack=ir,Xo.VideoTrack=nr,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(t){Xo[t]=function(){return he.warn("videojs."+t+"() is deprecated; use videojs.dom."+t+"() instead"),ti[t].apply(null,arguments)}}),Xo.computedStyle=be,Xo.dom=ti,Xo.url=Kn;
/**
 * @videojs/http-streaming
 * @version 1.5.1
 * @copyright 2018 Brightcove, Inc
 * @license Apache-2.0
 */
var Jo=function(t,e){return/^[a-z]+:/i.test(e)?e:(/\/\//i.test(t)||(t=wt.a.buildAbsoluteURL(xt.a.location.href,t)),wt.a.buildAbsoluteURL(t,e))},Ko=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Qo=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),ts=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,n)}if("value"in r)return r.value;var o=r.get;return void 0!==o?o.call(n):void 0},es=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},is=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e},ns=function(){function t(t,e){var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)if(i.push(o.value),e&&i.length===e)break}catch(c){r=!0,a=c}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw a}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),rs=Xo.mergeOptions,as=Xo.EventTarget,os=Xo.log,ss=function(t,e){["AUDIO","SUBTITLES"].forEach(function(i){for(var n in t.mediaGroups[i])for(var r in t.mediaGroups[i][n]){var a=t.mediaGroups[i][n][r];e(a,i,n,r)}})},cs=function(t,e,i){var n=e.slice();i=i||0;for(var r=Math.min(t.length,e.length+i),a=i;a<r;a++)n[a-i]=rs(t[a],n[a-i]);return n},ls=function(t,e){t.resolvedUri||(t.resolvedUri=Jo(e,t.uri)),t.key&&!t.key.resolvedUri&&(t.key.resolvedUri=Jo(e,t.key.uri)),t.map&&!t.map.resolvedUri&&(t.map.resolvedUri=Jo(e,t.map.uri))},us=function(t,e){var i=rs(t,{}),n=i.playlists[e.uri];if(!n)return null;if(n.segments&&e.segments&&n.segments.length===e.segments.length&&n.mediaSequence===e.mediaSequence)return null;var r=rs(n,e);n.segments&&(r.segments=cs(n.segments,e.segments,e.mediaSequence-n.mediaSequence)),r.segments.forEach(function(t){ls(t,r.resolvedUri)});for(var a=0;a<i.playlists.length;a++)i.playlists[a].uri===e.uri&&(i.playlists[a]=r);return i.playlists[e.uri]=r,i},hs=function(t){var e=t.playlists.length;while(e--){var i=t.playlists[e];t.playlists[i.uri]=i,i.resolvedUri=Jo(t.uri,i.uri),i.id=e,i.attributes||(i.attributes={},os.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}},ds=function(t){ss(t,function(e){e.uri&&(e.resolvedUri=Jo(t.uri,e.uri))})},ps=function(t,e){var i=t.segments[t.segments.length-1],n=void 0;return n=e&&i&&i.duration?1e3*i.duration:500*(t.targetDuration||10),n},fs=function(t){function e(t,i,n){Ko(this,e);var r=is(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(r.srcUrl=t,r.hls_=i,r.withCredentials=n,!r.srcUrl)throw new Error("A non-empty playlist URL is required");return r.state="HAVE_NOTHING",r.on("mediaupdatetimeout",function(){"HAVE_METADATA"===r.state&&(r.state="HAVE_CURRENT_METADATA",r.request=r.hls_.xhr({uri:Jo(r.master.uri,r.media().uri),withCredentials:r.withCredentials},function(t,e){if(r.request)return t?r.playlistRequestError(r.request,r.media().uri,"HAVE_METADATA"):void r.haveMetadata(r.request,r.media().uri)}))}),r}return es(e,t),Qo(e,[{key:"playlistRequestError",value:function(t,e,i){this.request=null,i&&(this.state=i),this.error={playlist:this.master.playlists[e],status:t.status,message:"HLS playlist request error at URL: "+e,responseText:t.responseText,code:t.status>=500?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(t,e){var i=this;this.request=null,this.state="HAVE_METADATA";var n=new Rt;n.push(t.responseText),n.end(),n.manifest.uri=e,n.manifest.attributes=n.manifest.attributes||{};var r=us(this.master,n.manifest);this.targetDuration=n.manifest.targetDuration,r?(this.master=r,this.media_=this.master.playlists[n.manifest.uri]):this.trigger("playlistunchanged"),this.media().endList||(xt.a.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=xt.a.setTimeout(function(){i.trigger("mediaupdatetimeout")},ps(this.media(),!!r))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.stopRequest(),xt.a.clearTimeout(this.mediaUpdateTimeout)}},{key:"stopRequest",value:function(){if(this.request){var t=this.request;this.request=null,t.onreadystatechange=null,t.abort()}}},{key:"media",value:function(t){var e=this;if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var i=this.state;if("string"===typeof t){if(!this.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.master.playlists[t]}var n=!this.media_||t.uri!==this.media_.uri;if(this.master.playlists[t.uri].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=t,void(n&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(n){if(this.state="SWITCHING_MEDIA",this.request){if(Jo(this.master.uri,t.uri)===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:Jo(this.master.uri,t.uri),withCredentials:this.withCredentials},function(n,r){if(e.request){if(n)return e.playlistRequestError(e.request,t.uri,i);e.haveMetadata(r,t.uri),"HAVE_MASTER"===i?e.trigger("loadedmetadata"):e.trigger("mediachange")}})}}},{key:"pause",value:function(){this.stopRequest(),xt.a.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function(t){var e=this;xt.a.clearTimeout(this.mediaUpdateTimeout);var i=this.media();if(t){var n=i?i.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=xt.a.setTimeout(function(){return e.load()},n)}else this.started?i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"start",value:function(){var t=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,i){if(t.request){if(t.request=null,e)return t.error={status:i.status,message:"HLS playlist request error at URL: "+t.srcUrl,responseText:i.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");var n=new Rt;return n.push(i.responseText),n.end(),t.state="HAVE_MASTER",n.manifest.uri=t.srcUrl,n.manifest.playlists?(t.master=n.manifest,hs(t.master),ds(t.master),t.trigger("loadedplaylist"),void(t.request||t.media(n.manifest.playlists[0]))):(t.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:xt.a.location.href,playlists:[{uri:t.srcUrl,id:0}]},t.master.playlists[t.srcUrl]=t.master.playlists[0],t.master.playlists[0].resolvedUri=t.srcUrl,t.master.playlists[0].attributes=t.master.playlists[0].attributes||{},t.haveMetadata(i,t.srcUrl),t.trigger("loadedmetadata"))}})}}]),e}(as),ms=Xo.createTimeRange,gs=function(t,e){var i=0,n=e-t.mediaSequence,r=t.segments[n];if(r){if("undefined"!==typeof r.start)return{result:r.start,precise:!0};if("undefined"!==typeof r.end)return{result:r.end-r.duration,precise:!0}}while(n--){if(r=t.segments[n],"undefined"!==typeof r.end)return{result:i+r.end,precise:!0};if(i+=r.duration,"undefined"!==typeof r.start)return{result:i+r.start,precise:!0}}return{result:i,precise:!1}},vs=function(t,e){for(var i=0,n=void 0,r=e-t.mediaSequence;r<t.segments.length;r++){if(n=t.segments[r],"undefined"!==typeof n.start)return{result:n.start-i,precise:!0};if(i+=n.duration,"undefined"!==typeof n.end)return{result:n.end-i,precise:!0}}return{result:-1,precise:!1}},ys=function(t,e,i){var n=void 0,r=void 0;return"undefined"===typeof e&&(e=t.mediaSequence+t.segments.length),e<t.mediaSequence?0:(n=gs(t,e),n.precise?n.result:(r=vs(t,e),r.precise?r.result:n.result+i))},_s=function(t,e,i){if(!t)return 0;if("number"!==typeof i&&(i=0),"undefined"===typeof e){if(t.totalDuration)return t.totalDuration;if(!t.endList)return xt.a.Infinity}return ys(t,e,i)},bs=function(t,e,i){var n=0;if(e>i){var r=[i,e];e=r[0],i=r[1]}if(e<0){for(var a=e;a<Math.min(0,i);a++)n+=t.targetDuration;e=0}for(var o=e;o<i;o++)n+=t.segments[o].duration;return n},ws=function(t){if(!t.segments.length)return 0;var e=t.segments.length-1,i=t.segments[e].duration||t.targetDuration,n=i+2*t.targetDuration;while(e--)if(i+=t.segments[e].duration,i>=n)break;return Math.max(0,e)},Ts=function(t,e,i){if(!t||!t.segments)return null;if(t.endList)return _s(t);if(null===e)return null;e=e||0;var n=i?ws(t):t.segments.length;return ys(t,t.mediaSequence+n,e)},xs=function(t,e){var i=!0,n=e||0,r=Ts(t,e,i);return null===r?ms():ms(n,r)},Ss=function(t){return t-Math.floor(t)===0},Es=function(t,e){if(Ss(e))return e+.1*t;for(var i=e.toString().split(".")[1].length,n=1;n<=i;n++){var r=Math.pow(10,n),a=e*r;if(Ss(a)||n===i)return(a+t)/r}},Ms=Es.bind(null,1),Cs=Es.bind(null,-1),As=function(t,e,i,n){var r=void 0,a=void 0,o=t.segments.length,s=e-n;if(s<0){if(i>0)for(r=i-1;r>=0;r--)if(a=t.segments[r],s+=Cs(a.duration),s>0)return{mediaIndex:r,startTime:n-bs(t,i,r)};return{mediaIndex:0,startTime:e}}if(i<0){for(r=i;r<0;r++)if(s-=t.targetDuration,s<0)return{mediaIndex:0,startTime:e};i=0}for(r=i;r<o;r++)if(a=t.segments[r],s-=Ms(a.duration),s<0)return{mediaIndex:r,startTime:n+bs(t,i,r)};return{mediaIndex:o-1,startTime:e}},ks=function(t){return t.excludeUntil&&t.excludeUntil>Date.now()},Ls=function(t){return t.excludeUntil&&t.excludeUntil===1/0},Ps=function(t){var e=ks(t);return!t.disabled&&!e},Os=function(t){return t.disabled},Rs=function(t){for(var e=0;e<t.segments.length;e++)if(t.segments[e].key)return!0;return!1},Is=function(t){for(var e=0;e<t.segments.length;e++)if(t.segments[e].map)return!0;return!1},Ds=function(t,e){return e.attributes&&e.attributes[t]},Us=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!Ds("BANDWIDTH",i))return NaN;var r=t*i.attributes.BANDWIDTH;return(r-8*n)/e},Ns=function(t,e){if(1===t.playlists.length)return!0;var i=e.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===t.playlists.filter(function(t){return!!Ps(t)&&(t.attributes.BANDWIDTH||0)<i}).length},Bs={duration:_s,seekable:xs,safeLiveIndex:ws,getMediaInfoForTime:As,isEnabled:Ps,isDisabled:Os,isBlacklisted:ks,isIncompatible:Ls,playlistEnd:Ts,isAes:Rs,isFmp4:Is,hasAttribute:Ds,estimateSegmentRequestTime:Us,isLowestEnabledRendition:Ns},Fs=Xo.xhr,zs=Xo.mergeOptions,js=function(){var t=function t(e,i){e=zs({timeout:45e3},e);var n=t.beforeRequest||Xo.Hls.xhr.beforeRequest;if(n&&"function"===typeof n){var r=n(e);r&&(e=r)}var a=Fs(e,function(t,e){var n=a.response;!t&&n&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=n.byteLength||n.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),e.headers&&(a.responseHeaders=e.headers),t&&"ETIMEDOUT"===t.code&&(a.timedout=!0),t||a.aborted||200===e.statusCode||206===e.statusCode||0===e.statusCode||(t=new Error("XHR Failed with a response of: "+(a&&(n||a.responseText)))),i(t,a)}),o=a.abort;return a.abort=function(){return a.aborted=!0,o.apply(a,arguments)},a.uri=e.uri,a.requestTime=Date.now(),a};return t},Hs=function(t,e){return t.start(e)+"-"+t.end(e)},Gs=function(t,e){var i=t.toString(16);return"00".substring(0,2-i.length)+i+(e%2?" ":"")},Vs=function(t){return t>=32&&t<126?String.fromCharCode(t):"."},Ws=function(t){var e={};return Object.keys(t).forEach(function(i){var n=t[i];ArrayBuffer.isView(n)?e[i]={bytes:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength}:e[i]=n}),e},qs=function(t){var e=t.byterange||{length:1/0,offset:0};return[e.length,e.offset,t.resolvedUri].join(",")},Ys=function(t){for(var e=Array.prototype.slice.call(t),i=16,n="",r=void 0,a=void 0,o=0;o<e.length/i;o++)r=e.slice(o*i,o*i+i).map(Gs).join(""),a=e.slice(o*i,o*i+i).map(Vs).join(""),n+=r+" "+a+"\n";return n},Xs=function(t){var e=t.bytes;return Ys(e)},$s=function(t){var e="",i=void 0;for(i=0;i<t.length;i++)e+=Hs(t,i)+" ";return e},Zs=Object.freeze({createTransferableMessage:Ws,initSegmentId:qs,hexDump:Ys,tagDump:Xs,textRanges:$s}),Js=function(t,e,i,n){var r=void 0;if("stream"===e){r=new Date(1e3*n+i.getTime());var a=t.toISOString(),o=i.toISOString(),s=r.toISOString();return o<=a&&a<=s}if("player"===e)return r=n+i,i<=t&&t<=r},Ks=function(t,e,i){if(!i.segments||0===i.segments.length)return null;if("player"!==e&&"stream"!==e)return null;for(var n=0,r=0;r<i.segments.length;r++){var a=i.segments[r],o=n+a.duration,s=void 0,c=void 0;"player"===e?(s=a.start,c=n):(s=a.dateTimeObject,c=a.dateTimeObject);var l="undefined"!==typeof a.start&&"undefined"!==typeof a.end&&Js(t,e,s,a.end-a.start),u=Js(t,e,c,a.duration);if(l)return{segment:a,estimatedStart:c,type:"accurate"};if(u)return{segment:a,estimatedStart:c,type:"estimate"};n=o}return null},Qs=function(t,e){return Ks(t,"player",e)},tc=function(t,e){var i=void 0;try{i=new Date(t)}catch(n){return null}return Ks(i,"stream",e)},ec=function(t,e){var i=void 0,n=void 0;try{i=new Date(t),n=new Date(e)}catch(o){}var r=i.getTime(),a=n.getTime();return(a-r)/1e3},ic=function(t){if(!t.segments||0===t.segments.length)return!1;for(var e=0;e<t.segments.length;e++){var i=t.segments[e];if(!i.dateTimeObject)return!1}return!0},nc=function(t){var e=t.playlist,i=t.time,n=void 0===i?void 0:i,r=t.callback;if(!r)throw new Error("getStreamTime: callback must be provided");if(!e||void 0===n)return r({message:"getStreamTime: playlist and time must be provided"});var a=Qs(n,e);if(!a)return r({message:"valid streamTime was not found"});if("estimate"===a.type)return r({message:"Accurate streamTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var o={mediaSeconds:n};return a.segment.dateTimeObject&&(o.programDateTime=a.segment.dateTimeObject.toISOString()),r(null,o)},rc=function t(e){var i=e.streamTime,n=e.playlist,r=e.retryCount,a=void 0===r?2:r,o=e.seekTo,s=e.pauseAfterSeek,c=void 0===s||s,l=e.tech,u=e.callback;if(!u)throw new Error("seekToStreamTime: callback must be provided");if("undefined"===typeof i||!n||!o)return u({message:"seekToStreamTime: streamTime, seekTo and playlist must be provided"});if(!n.endList&&!l.hasStarted_)return u({message:"player must be playing a live stream to start buffering"});if(!ic(n))return u({message:"programDateTime tags must be provided in the manifest "+n.resolvedUri});var h=tc(i,n);if(!h)return u({message:i+" was not found in the stream"});if("estimate"===h.type)return 0===a?u({message:i+" is not buffered yet. Try again"}):t({streamTime:i,playlist:n,retryCount:a-1,seekTo:o,pauseAfterSeek:c,tech:l,callback:u});var d=h.segment,p=ec(d.dateTimeObject,i),f=d.start+p,m=function(){return u(null,l.currentTime())};l.one("seeked",m),c&&l.pause(),o(f)},ac=1/30,oc=3*ac,sc=function(t,e){var i=[],n=void 0;if(t&&t.length)for(n=0;n<t.length;n++)e(t.start(n),t.end(n))&&i.push([t.start(n),t.end(n)]);return Xo.createTimeRanges(i)},cc=function(t,e){return sc(t,function(t,i){return t-ac<=e&&i+ac>=e})},lc=function(t,e){return sc(t,function(t){return t-ac>=e})},uc=function(t){if(t.length<2)return Xo.createTimeRanges();for(var e=[],i=1;i<t.length;i++){var n=t.end(i-1),r=t.start(i);e.push([n,r])}return Xo.createTimeRanges(e)},hc=function(t){var e=[];if(!t||!t.length)return"";for(var i=0;i<t.length;i++)e.push(t.start(i)+" => "+t.end(i));return e.join(", ")},dc=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t.length?t.end(t.length-1):0;return(n-e)/i},pc=function(t){for(var e=[],i=0;i<t.length;i++)e.push({start:t.start(i),end:t.end(i)});return e},fc=function(t,e,i){var n=e.player_;if(i.captions&&i.captions.length)for(var r in t.inbandTextTracks_||(t.inbandTextTracks_={}),i.captionStreams)if(!t.inbandTextTracks_[r]){n.tech_.trigger({type:"usage",name:"hls-608"});var a=n.textTracks().getTrackById(r);t.inbandTextTracks_[r]=a||n.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track}i.metadata&&i.metadata.length&&!t.metadataTrack_&&(t.metadataTrack_=n.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,t.metadataTrack_.inBandMetadataTrackDispatchType=i.metadata.dispatchType)},mc=function(t,e,i){var n=void 0,r=void 0;if(i&&i.cues){n=i.cues.length;while(n--)r=i.cues[n],r.startTime<=e&&r.endTime>=t&&i.removeCue(r)}},gc=function(t){Object.defineProperties(t.frame,{id:{get:function(){return Xo.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),t.value.key}},value:{get:function(){return Xo.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),t.value.data}},privateData:{get:function(){return Xo.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),t.value.data}}})},vc=function(t){var e=void 0;return e=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t,e},yc=function(t,e,i){var n=xt.a.WebKitDataCue||xt.a.VTTCue;if(e&&e.forEach(function(t){var e=t.stream;this.inbandTextTracks_[e].addCue(new n(t.startTime+this.timestampOffset,t.endTime+this.timestampOffset,t.text))},t),i){var r=vc(t.mediaSource_.duration);if(i.forEach(function(t){var e=t.cueTime+this.timestampOffset;t.frames.forEach(function(t){var i=new n(e,e,t.value||t.url||t.data||"");i.frame=t,i.value=t,gc(i),this.metadataTrack_.addCue(i)},this)},t),t.metadataTrack_&&t.metadataTrack_.cues&&t.metadataTrack_.cues.length){for(var a=t.metadataTrack_.cues,o=[],s=0;s<a.length;s++)a[s]&&o.push(a[s]);var c=o.reduce(function(t,e){var i=t[e.startTime]||[];return i.push(e),t[e.startTime]=i,t},{}),l=Object.keys(c).sort(function(t,e){return Number(t)-Number(e)});l.forEach(function(t,e){var i=c[t],n=Number(l[e+1])||r;i.forEach(function(t){t.endTime=n})})}}},_c="undefined"!==typeof window?window:{},bc="undefined"===typeof Symbol?"__target":Symbol(),wc="application/javascript",Tc=_c.BlobBuilder||_c.WebKitBlobBuilder||_c.MozBlobBuilder||_c.MSBlobBuilder,xc=_c.URL||_c.webkitURL||xc&&xc.msURL,Sc=_c.Worker;function Ec(t,e){return function(i){var n=this;if(!e)return new Sc(t);if(Sc&&!i){var r=e.toString().replace(/^function.+?{/,"").slice(0,-1),a=kc(r);return this[bc]=new Sc(a),Lc(this[bc],a),this[bc]}var o={postMessage:function(t){n.onmessage&&setTimeout(function(){n.onmessage({data:t,target:o})})}};e.call(o),this.postMessage=function(t){setTimeout(function(){o.onmessage({data:t,target:n})})},this.isThisThread=!0}}if(Sc){var Mc,Cc=kc("self.onmessage = function () {}"),Ac=new Uint8Array(1);try{Mc=new Sc(Cc),Mc.postMessage(Ac,[Ac.buffer])}catch(Ph){Sc=null}finally{xc.revokeObjectURL(Cc),Mc&&Mc.terminate()}}function kc(t){try{return xc.createObjectURL(new Blob([t],{type:wc}))}catch(Ph){var e=new Tc;return e.append(t),xc.createObjectURL(e.getBlob(type))}}function Lc(t,e){if(t&&e){var i=t.terminate;t.objURL=e,t.terminate=function(){t.objURL&&xc.revokeObjectURL(t.objURL),i.call(t)}}}var Pc=new Ec("./transmuxer-worker.worker.js",function(t,e){var i=this;(function(){var t,e,n,r,a,o,s,c,l,u,h,d,p,f,m,g,v,y,_,b,w,T,x,S,E,M,C,A,k,L,P,O,R,I,D,U,N=Math.pow(2,32)-1;(function(){var t;if(x={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!==typeof Uint8Array){for(t in x)x.hasOwnProperty(t)&&(x[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);S=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),M=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),E=new Uint8Array([0,0,0,1]),C=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),A=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),k={video:C,audio:A},O=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),P=new Uint8Array([0,0,0,0,0,0,0,0]),R=new Uint8Array([0,0,0,0,0,0,0,0]),I=R,D=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),U=R,L=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),t=function(t){var e,i,n,r=[],a=0;for(e=1;e<arguments.length;e++)r.push(arguments[e]);e=r.length;while(e--)a+=r[e].byteLength;for(i=new Uint8Array(a+8),n=new DataView(i.buffer,i.byteOffset,i.byteLength),n.setUint32(0,i.byteLength),i.set(t,4),e=0,a=8;e<r.length;e++)i.set(r[e],a),a+=r[e].byteLength;return i},e=function(){return t(x.dinf,t(x.dref,O))},n=function(e){return t(x.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},r=function(){return t(x.ftyp,S,E,S,M)},g=function(e){return t(x.hdlr,k[e])},a=function(e){return t(x.mdat,e)},m=function(e){var i=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(i[12]=e.samplerate>>>24&255,i[13]=e.samplerate>>>16&255,i[14]=e.samplerate>>>8&255,i[15]=255&e.samplerate),t(x.mdhd,i)},f=function(e){return t(x.mdia,m(e),g(e.type),s(e))},o=function(e){return t(x.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},s=function(i){return t(x.minf,"video"===i.type?t(x.vmhd,L):t(x.smhd,P),e(),y(i))},c=function(e,i){var n=[],r=i.length;while(r--)n[r]=b(i[r]);return t.apply(null,[x.moof,o(e)].concat(n))},l=function(e){var i=e.length,n=[];while(i--)n[i]=d(e[i]);return t.apply(null,[x.moov,h(4294967295)].concat(n).concat(u(e)))},u=function(e){var i=e.length,n=[];while(i--)n[i]=w(e[i]);return t.apply(null,[x.mvex].concat(n))},h=function(e){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t(x.mvhd,i)},v=function(e){var i,n,r=e.samples||[],a=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)i=r[n].flags,a[n+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return t(x.sdtp,a)},y=function(e){return t(x.stbl,_(e),t(x.stts,U),t(x.stsc,I),t(x.stsz,D),t(x.stco,R))},function(){var e,i;_=function(n){return t(x.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===n.type?e(n):i(n))},e=function(e){var i,n=e.sps||[],r=e.pps||[],a=[],o=[];for(i=0;i<n.length;i++)a.push((65280&n[i].byteLength)>>>8),a.push(255&n[i].byteLength),a=a.concat(Array.prototype.slice.call(n[i]));for(i=0;i<r.length;i++)o.push((65280&r[i].byteLength)>>>8),o.push(255&r[i].byteLength),o=o.concat(Array.prototype.slice.call(r[i]));return t(x.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t(x.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([n.length]).concat(a).concat([r.length]).concat(o))),t(x.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},i=function(e){return t(x.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),n(e))}}(),p=function(e){var i=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return t(x.tkhd,i)},b=function(e){var i,n,r,a,o,s,c;return i=t(x.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),s=Math.floor(e.baseMediaDecodeTime/(N+1)),c=Math.floor(e.baseMediaDecodeTime%(N+1)),n=t(x.tfdt,new Uint8Array([1,0,0,0,s>>>24&255,s>>>16&255,s>>>8&255,255&s,c>>>24&255,c>>>16&255,c>>>8&255,255&c])),o=92,"audio"===e.type?(r=T(e,o),t(x.traf,i,n,r)):(a=v(e),r=T(e,a.length+o),t(x.traf,i,n,r,a))},d=function(e){return e.duration=e.duration||4294967295,t(x.trak,p(e),f(e))},w=function(e){var i=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(i[i.length-1]=0),t(x.trex,i)},function(){var e,i,n;n=function(t,e){var i=0,n=0,r=0,a=0;return t.length&&(void 0!==t[0].duration&&(i=1),void 0!==t[0].size&&(n=2),void 0!==t[0].flags&&(r=4),void 0!==t[0].compositionTimeOffset&&(a=8)),[0,0,i|n|r|a,1,(4278190080&t.length)>>>24,(16711680&t.length)>>>16,(65280&t.length)>>>8,255&t.length,(4278190080&e)>>>24,(16711680&e)>>>16,(65280&e)>>>8,255&e]},i=function(e,i){var r,a,o,s;for(a=e.samples||[],i+=20+16*a.length,r=n(a,i),s=0;s<a.length;s++)o=a[s],r=r.concat([(4278190080&o.duration)>>>24,(16711680&o.duration)>>>16,(65280&o.duration)>>>8,255&o.duration,(4278190080&o.size)>>>24,(16711680&o.size)>>>16,(65280&o.size)>>>8,255&o.size,o.flags.isLeading<<2|o.flags.dependsOn,o.flags.isDependedOn<<6|o.flags.hasRedundancy<<4|o.flags.paddingValue<<1|o.flags.isNonSyncSample,61440&o.flags.degradationPriority,15&o.flags.degradationPriority,(4278190080&o.compositionTimeOffset)>>>24,(16711680&o.compositionTimeOffset)>>>16,(65280&o.compositionTimeOffset)>>>8,255&o.compositionTimeOffset]);return t(x.trun,new Uint8Array(r))},e=function(e,i){var r,a,o,s;for(a=e.samples||[],i+=20+8*a.length,r=n(a,i),s=0;s<a.length;s++)o=a[s],r=r.concat([(4278190080&o.duration)>>>24,(16711680&o.duration)>>>16,(65280&o.duration)>>>8,255&o.duration,(4278190080&o.size)>>>24,(16711680&o.size)>>>16,(65280&o.size)>>>8,255&o.size]);return t(x.trun,new Uint8Array(r))},T=function(t,n){return"audio"===t.type?e(t,n):i(t,n)}}();var B,F,z,j,H,G={ftyp:r,mdat:a,moof:c,moov:l,initSegment:function(t){var e,i=r(),n=l(t);return e=new Uint8Array(i.byteLength+n.byteLength),e.set(i),e.set(n,i.byteLength),e}},V=function(t){return t>>>0},W={toUnsigned:V},q=W.toUnsigned;B=function(t,e){var i,n,r,a,o,s=[];if(!e.length)return null;for(i=0;i<t.byteLength;)n=q(t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3]),r=F(t.subarray(i+4,i+8)),a=n>1?i+n:t.byteLength,r===e[0]&&(1===e.length?s.push(t.subarray(i+8,a)):(o=B(t.subarray(i+8,a),e.slice(1)),o.length&&(s=s.concat(o)))),i=a;return s},F=function(t){var e="";return e+=String.fromCharCode(t[0]),e+=String.fromCharCode(t[1]),e+=String.fromCharCode(t[2]),e+=String.fromCharCode(t[3]),e},z=function(t){var e={},i=B(t,["moov","trak"]);return i.reduce(function(t,e){var i,n,r,a,o;return i=B(e,["tkhd"])[0],i?(n=i[0],r=0===n?12:20,a=q(i[r]<<24|i[r+1]<<16|i[r+2]<<8|i[r+3]),o=B(e,["mdia","mdhd"])[0],o?(n=o[0],r=0===n?12:20,t[a]=q(o[r]<<24|o[r+1]<<16|o[r+2]<<8|o[r+3]),t):null):null},e)},j=function(t,e){var i,n,r;return i=B(e,["moof","traf"]),n=[].concat.apply([],i.map(function(e){return B(e,["tfhd"]).map(function(i){var n,r,a;return n=q(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),r=t[n]||9e4,a=B(e,["tfdt"]).map(function(t){var e,i;return e=t[0],i=q(t[4]<<24|t[5]<<16|t[6]<<8|t[7]),1===e&&(i*=Math.pow(2,32),i+=q(t[8]<<24|t[9]<<16|t[10]<<8|t[11])),i})[0],a=a||1/0,a/r})})),r=Math.min.apply(null,n),isFinite(r)?r:0},H=function(t){var e=B(t,["moov","trak"]),i=[];return e.forEach(function(t){var e=B(t,["mdia","hdlr"]),n=B(t,["tkhd"]);e.forEach(function(t,e){var r,a,o,s=F(t.subarray(8,12)),c=n[e];"vide"===s&&(r=new DataView(c.buffer,c.byteOffset,c.byteLength),a=r.getUint8(0),o=0===a?r.getUint32(12):r.getUint32(20),i.push(o))})}),i};var Y={findBox:B,parseType:F,timescale:z,startTime:j,videoTrackIds:H},X=function(){this.init=function(){var t={};this.on=function(e,i){t[e]||(t[e]=[]),t[e]=t[e].concat(i)},this.off=function(e,i){var n;return!!t[e]&&(n=t[e].indexOf(i),t[e]=t[e].slice(),t[e].splice(n,1),n>-1)},this.trigger=function(e){var i,n,r,a;if(i=t[e],i)if(2===arguments.length)for(r=i.length,n=0;n<r;++n)i[n].call(this,arguments[1]);else{for(a=[],n=arguments.length,n=1;n<arguments.length;++n)a.push(arguments[n]);for(r=i.length,n=0;n<r;++n)i[n].apply(this,a)}},this.dispose=function(){t={}}}};X.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),t},X.prototype.push=function(t){this.trigger("data",t)},X.prototype.flush=function(t){this.trigger("done",t)};var $,Z,J,K,Q,tt,et=X,it=function(t){var e,i,n=[],r=[];for(n.byteLength=0,e=0;e<t.length;e++)i=t[e],"access_unit_delimiter_rbsp"===i.nalUnitType?(n.length&&(n.duration=i.dts-n.dts,r.push(n)),n=[i],n.byteLength=i.data.byteLength,n.pts=i.pts,n.dts=i.dts):("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(n.keyFrame=!0),n.duration=i.dts-n.dts,n.byteLength+=i.data.byteLength,n.push(i));return r.length&&(!n.duration||n.duration<=0)&&(n.duration=r[r.length-1].duration),r.push(n),r},nt=function(t){var e,i,n=[],r=[];for(n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=t[0].pts,n.dts=t[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=t[0].pts,r.dts=t[0].dts,e=0;e<t.length;e++)i=t[e],i.keyFrame?(n.length&&(r.push(n),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration),n=[i],n.nalCount=i.length,n.byteLength=i.byteLength,n.pts=i.pts,n.dts=i.dts,n.duration=i.duration):(n.duration+=i.duration,n.nalCount+=i.length,n.byteLength+=i.byteLength,n.push(i));return r.length&&n.duration<=0&&(n.duration=r[r.length-1].duration),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration,r.push(n),r},rt=function(t){var e;return!t[0][0].keyFrame&&t.length>1&&(e=t.shift(),t.byteLength-=e.byteLength,t.nalCount-=e.nalCount,t[0][0].dts=e.dts,t[0][0].pts=e.pts,t[0][0].duration+=e.duration),t},at=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},ot=function(t,e){var i=at();return i.dataOffset=e,i.compositionTimeOffset=t.pts-t.dts,i.duration=t.duration,i.size=4*t.length,i.size+=t.byteLength,t.keyFrame&&(i.flags.dependsOn=2,i.flags.isNonSyncSample=0),i},st=function(t,e){var i,n,r,a,o,s=e||0,c=[];for(i=0;i<t.length;i++)for(a=t[i],n=0;n<a.length;n++)o=a[n],r=ot(o,s),s+=r.size,c.push(r);return c},ct=function(t){var e,i,n,r,a,o,s=0,c=t.byteLength,l=t.nalCount,u=c+4*l,h=new Uint8Array(u),d=new DataView(h.buffer);for(e=0;e<t.length;e++)for(r=t[e],i=0;i<r.length;i++)for(a=r[i],n=0;n<a.length;n++)o=a[n],d.setUint32(s,o.data.byteLength),s+=4,h.set(o.data,s),s+=o.data.byteLength;return h},lt={groupNalsIntoFrames:it,groupFramesIntoGops:nt,extendFirstKeyFrame:rt,generateSampleTable:st,concatenateNalData:ct},ut=[33,16,5,32,164,27],ht=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],dt=function(t){var e=[];while(t--)e.push(0);return e},pt=function(t){return Object.keys(t).reduce(function(e,i){return e[i]=new Uint8Array(t[i].reduce(function(t,e){return t.concat(e)},[])),e},{})},ft={96000:[ut,[227,64],dt(154),[56]],88200:[ut,[231],dt(170),[56]],64000:[ut,[248,192],dt(240),[56]],48000:[ut,[255,192],dt(268),[55,148,128],dt(54),[112]],44100:[ut,[255,192],dt(268),[55,163,128],dt(84),[112]],32000:[ut,[255,192],dt(268),[55,234],dt(226),[112]],24000:[ut,[255,192],dt(268),[55,255,128],dt(268),[111,112],dt(126),[224]],16000:[ut,[255,192],dt(268),[55,255,128],dt(268),[111,255],dt(269),[223,108],dt(195),[1,192]],12000:[ht,dt(268),[3,127,248],dt(268),[6,255,240],dt(268),[13,255,224],dt(268),[27,253,128],dt(259),[56]],11025:[ht,dt(268),[3,127,248],dt(268),[6,255,240],dt(268),[13,255,224],dt(268),[27,255,192],dt(268),[55,175,128],dt(108),[112]],8000:[ht,dt(268),[3,121,16],dt(47),[7]]},mt=pt(ft),gt=9e4;$=function(t){return t*gt},Z=function(t,e){return t*e},J=function(t){return t/gt},K=function(t,e){return t/e},Q=function(t,e){return $(K(t,e))},tt=function(t,e){return Z(J(t),e)};var vt={secondsToVideoTs:$,secondsToAudioTs:Z,videoTsToSeconds:J,audioTsToSeconds:K,audioTsToVideoTs:Q,videoTsToAudioTs:tt},yt=9e4,_t=function(t){var e,i,n=0;for(e=0;e<t.length;e++)i=t[e],n+=i.data.byteLength;return n},bt=function(t,e,i,n){var r,a,o,s=0,c=0,l=0,u=0;if(e.length&&(r=vt.audioTsToVideoTs(t.baseMediaDecodeTime,t.samplerate),s=Math.ceil(yt/(t.samplerate/1024)),i&&n&&(c=r-Math.max(i,n),l=Math.floor(c/s),u=l*s),!(l<1||u>yt/2))){for(a=mt[t.samplerate],a||(a=e[0].data),o=0;o<l;o++)e.splice(o,0,{data:a});t.baseMediaDecodeTime-=Math.floor(vt.videoTsToAudioTs(u,t.samplerate))}},wt=function(t,e,i){return e.minSegmentDts>=i?t:(e.minSegmentDts=1/0,t.filter(function(t){return t.dts>=i&&(e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),e.minSegmentPts=e.minSegmentDts,!0)}))},Tt=function(t){var e,i,n=[];for(e=0;e<t.length;e++)i=t[e],n.push({size:i.data.byteLength,duration:1024});return n},xt=function(t){var e,i,n=0,r=new Uint8Array(_t(t));for(e=0;e<t.length;e++)i=t[e],r.set(i.data,n),n+=i.data.byteLength;return r},St={prefixWithSilence:bt,trimAdtsFramesByEarliestDts:wt,generateSampleTable:Tt,concatenateFrameData:xt},Et=9e4,Mt=function(t,e){"number"===typeof e.pts&&(void 0===t.timelineStartInfo.pts&&(t.timelineStartInfo.pts=e.pts),void 0===t.minSegmentPts?t.minSegmentPts=e.pts:t.minSegmentPts=Math.min(t.minSegmentPts,e.pts),void 0===t.maxSegmentPts?t.maxSegmentPts=e.pts:t.maxSegmentPts=Math.max(t.maxSegmentPts,e.pts)),"number"===typeof e.dts&&(void 0===t.timelineStartInfo.dts&&(t.timelineStartInfo.dts=e.dts),void 0===t.minSegmentDts?t.minSegmentDts=e.dts:t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),void 0===t.maxSegmentDts?t.maxSegmentDts=e.dts:t.maxSegmentDts=Math.max(t.maxSegmentDts,e.dts))},Ct=function(t){delete t.minSegmentDts,delete t.maxSegmentDts,delete t.minSegmentPts,delete t.maxSegmentPts},At=function(t,e){var i,n,r=t.minSegmentDts;return e||(r-=t.timelineStartInfo.dts),i=t.timelineStartInfo.baseMediaDecodeTime,i+=r,i=Math.max(0,i),"audio"===t.type&&(n=t.samplerate/Et,i*=n,i=Math.floor(i)),i},kt={clearDtsInfo:Ct,calculateTrackBaseMediaDecodeTime:At,collectDtsInfo:Mt},Lt=4,Pt=128,Ot=function(t){var e=0,i={payloadType:-1,payloadSize:0},n=0,r=0;while(e<t.byteLength){if(t[e]===Pt)break;while(255===t[e])n+=255,e++;n+=t[e++];while(255===t[e])r+=255,e++;if(r+=t[e++],!i.payload&&n===Lt){i.payloadType=n,i.payloadSize=r,i.payload=t.subarray(e,e+r);break}e+=r,n=0,r=0}return i},Rt=function(t){return 181!==t.payload[0]?null:49!==(t.payload[1]<<8|t.payload[2])?null:"GA94"!==String.fromCharCode(t.payload[3],t.payload[4],t.payload[5],t.payload[6])?null:3!==t.payload[7]?null:t.payload.subarray(8,t.payload.length-1)},It=function(t,e){var i,n,r,a,o=[];if(!(64&e[0]))return o;for(n=31&e[0],i=0;i<n;i++)r=3*i,a={type:3&e[r+2],pts:t},4&e[r+2]&&(a.ccData=e[r+3]<<8|e[r+4],o.push(a));return o},Dt=function(t){var e,i,n=t.byteLength,r=[],a=1;while(a<n-2)0===t[a]&&0===t[a+1]&&3===t[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return t;e=n-r.length,i=new Uint8Array(e);var o=0;for(a=0;a<e;o++,a++)o===r[0]&&(o++,r.shift()),i[a]=t[o];return i},Ut={parseSei:Ot,parseUserData:Rt,parseCaptionPackets:It,discardEmulationPreventionBytes:Dt,USER_DATA_REGISTERED_ITU_T_T35:Lt},Nt=function t(){t.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Gt(0,0),new Gt(0,1),new Gt(1,0),new Gt(1,1)],this.reset(),this.ccStreams_.forEach(function(t){t.on("data",this.trigger.bind(this,"data")),t.on("done",this.trigger.bind(this,"done"))},this)};Nt.prototype=new et,Nt.prototype.push=function(t){var e,i,n;if("sei_rbsp"===t.nalUnitType&&(e=Ut.parseSei(t.escapedRBSP),e.payloadType===Ut.USER_DATA_REGISTERED_ITU_T_T35&&(i=Ut.parseUserData(e),i)))if(t.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(t.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));n=Ut.parseCaptionPackets(t.pts,i),this.captionPackets_=this.captionPackets_.concat(n),this.latestDts_!==t.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=t.dts}},Nt.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(t,e){t.presortIndex=e}),this.captionPackets_.sort(function(t,e){return t.pts===e.pts?t.presortIndex-e.presortIndex:t.pts-e.pts}),this.captionPackets_.forEach(function(t){t.type<2&&this.dispatchCea608Packet(t)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(t){t.flush()},this)):this.ccStreams_.forEach(function(t){t.flush()},this)},Nt.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(t){t.reset()})},Nt.prototype.dispatchCea608Packet=function(t){this.setsChannel1Active(t)?this.activeCea608Channel_[t.type]=0:this.setsChannel2Active(t)&&(this.activeCea608Channel_[t.type]=1),null!==this.activeCea608Channel_[t.type]&&this.ccStreams_[(t.type<<1)+this.activeCea608Channel_[t.type]].push(t)},Nt.prototype.setsChannel1Active=function(t){return 4096===(30720&t.ccData)},Nt.prototype.setsChannel2Active=function(t){return 6144===(30720&t.ccData)};var Bt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Ft=function(t){return null===t?"":(t=Bt[t]||t,String.fromCharCode(t))},zt=14,jt=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Ht=function(){var t=[],e=zt+1;while(e--)t.push("");return t},Gt=function t(e,i){t.prototype.init.call(this),this.field_=e||0,this.dataChannel_=i||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(t){var e,i,n,r,a;if(e=32639&t.ccData,e!==this.lastControlCode_){if(4096===(61440&e)?this.lastControlCode_=e:e!==this.PADDING_&&(this.lastControlCode_=null),n=e>>>8,r=255&e,e!==this.PADDING_)if(e===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(e===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(t.pts),this.flushDisplayed(t.pts),i=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=i,this.startPts_=t.pts;else if(e===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(t.pts);else if(e===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(t.pts);else if(e===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(t.pts);else if(e===this.CARRIAGE_RETURN_)this.clearFormatting(t.pts),this.flushDisplayed(t.pts),this.shiftRowsUp_(),this.startPts_=t.pts;else if(e===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(e===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(t.pts),this.displayed_=Ht();else if(e===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Ht();else if(e===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(t.pts),this.displayed_=Ht()),this.mode_="paintOn",this.startPts_=t.pts;else if(this.isSpecialCharacter(n,r))n=(3&n)<<8,a=Ft(n|r),this[this.mode_](t.pts,a),this.column_++;else if(this.isExtCharacter(n,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),n=(3&n)<<8,a=Ft(n|r),this[this.mode_](t.pts,a),this.column_++;else if(this.isMidRowCode(n,r))this.clearFormatting(t.pts),this[this.mode_](t.pts," "),this.column_++,14===(14&r)&&this.addFormatting(t.pts,["i"]),1===(1&r)&&this.addFormatting(t.pts,["u"]);else if(this.isOffsetControlCode(n,r))this.column_+=3&r;else if(this.isPAC(n,r)){var o=jt.indexOf(7968&e);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(t.pts,o)),o!==this.row_&&(this.clearFormatting(t.pts),this.row_=o),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(t.pts,["u"]),16===(16&e)&&(this.column_=4*((14&e)>>1)),this.isColorPAC(r)&&14===(14&r)&&this.addFormatting(t.pts,["i"])}else this.isNormalChar(n)&&(0===r&&(r=null),a=Ft(n),a+=Ft(r),this[this.mode_](t.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Gt.prototype=new et,Gt.prototype.flushDisplayed=function(t){var e=this.displayed_.map(function(t){try{return t.trim()}catch(Ph){return console.error("Skipping malformed caption."),""}}).join("\n").replace(/^\n+|\n+$/g,"");e.length&&this.trigger("data",{startPts:this.startPts_,endPts:t,text:e,stream:this.name_})},Gt.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Ht(),this.nonDisplayed_=Ht(),this.lastControlCode_=null,this.column_=0,this.row_=zt,this.rollUpRows_=2,this.formatting_=[]},Gt.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Gt.prototype.isSpecialCharacter=function(t,e){return t===this.EXT_&&e>=48&&e<=63},Gt.prototype.isExtCharacter=function(t,e){return(t===this.EXT_+1||t===this.EXT_+2)&&e>=32&&e<=63},Gt.prototype.isMidRowCode=function(t,e){return t===this.EXT_&&e>=32&&e<=47},Gt.prototype.isOffsetControlCode=function(t,e){return t===this.OFFSET_&&e>=33&&e<=35},Gt.prototype.isPAC=function(t,e){return t>=this.BASE_&&t<this.BASE_+8&&e>=64&&e<=127},Gt.prototype.isColorPAC=function(t){return t>=64&&t<=79||t>=96&&t<=127},Gt.prototype.isNormalChar=function(t){return t>=32&&t<=127},Gt.prototype.setRollUp=function(t,e){if("rollUp"!==this.mode_&&(this.row_=zt,this.mode_="rollUp",this.flushDisplayed(t),this.nonDisplayed_=Ht(),this.displayed_=Ht()),void 0!==e&&e!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[e-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";void 0===e&&(e=this.row_),this.topRow_=e-this.rollUpRows_+1},Gt.prototype.addFormatting=function(t,e){this.formatting_=this.formatting_.concat(e);var i=e.reduce(function(t,e){return t+"<"+e+">"},"");this[this.mode_](t,i)},Gt.prototype.clearFormatting=function(t){if(this.formatting_.length){var e=this.formatting_.reverse().reduce(function(t,e){return t+"</"+e+">"},"");this.formatting_=[],this[this.mode_](t,e)}},Gt.prototype.popOn=function(t,e){var i=this.nonDisplayed_[this.row_];i+=e,this.nonDisplayed_[this.row_]=i},Gt.prototype.rollUp=function(t,e){var i=this.displayed_[this.row_];i+=e,this.displayed_[this.row_]=i},Gt.prototype.shiftRowsUp_=function(){var t;for(t=0;t<this.topRow_;t++)this.displayed_[t]="";for(t=this.row_+1;t<zt+1;t++)this.displayed_[t]="";for(t=this.topRow_;t<this.row_;t++)this.displayed_[t]=this.displayed_[t+1];this.displayed_[this.row_]=""},Gt.prototype.paintOn=function(t,e){var i=this.displayed_[this.row_];i+=e,this.displayed_[this.row_]=i};var Vt={CaptionStream:Nt,Cea608Stream:Gt},Wt={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},qt=8589934592,Yt=4294967296,Xt=function(t,e){var i=1;t>e&&(i=-1);while(Math.abs(e-t)>Yt)t+=i*qt;return t},$t=function t(e){var i,n;t.prototype.init.call(this),this.type_=e,this.push=function(t){t.type===this.type_&&(void 0===n&&(n=t.dts),t.dts=Xt(t.dts,n),t.pts=Xt(t.pts,n),i=t.dts,this.trigger("data",t))},this.flush=function(){n=i,this.trigger("done")},this.discontinuity=function(){n=void 0,i=void 0}};$t.prototype=new et;var Zt,Jt={TimestampRolloverStream:$t,handleRollover:Xt},Kt=function(t,e,i){var n,r="";for(n=e;n<i;n++)r+="%"+("00"+t[n].toString(16)).slice(-2);return r},Qt=function(t,e,i){return decodeURIComponent(Kt(t,e,i))},te=function(t,e,i){return unescape(Kt(t,e,i))},ee=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},ie={TXXX:function(t){var e;if(3===t.data[0]){for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=Qt(t.data,1,e),t.value=Qt(t.data,e+1,t.data.length).replace(/\0*$/,"");break}t.data=t.value}},WXXX:function(t){var e;if(3===t.data[0])for(e=1;e<t.data.length;e++)if(0===t.data[e]){t.description=Qt(t.data,1,e),t.url=Qt(t.data,e+1,t.data.length);break}},PRIV:function(t){var e;for(e=0;e<t.data.length;e++)if(0===t.data[e]){t.owner=te(t.data,0,e);break}t.privateData=t.data.subarray(e+1),t.data=t.privateData}};Zt=function(t){var e,i={debug:!(!t||!t.debug),descriptor:t&&t.descriptor},n=0,r=[],a=0;if(Zt.prototype.init.call(this),this.dispatchType=Wt.METADATA_STREAM_TYPE.toString(16),i.descriptor)for(e=0;e<i.descriptor.length;e++)this.dispatchType+=("00"+i.descriptor[e].toString(16)).slice(-2);this.push=function(t){var e,o,s,c,l,u;if("timed-metadata"===t.type)if(t.dataAlignmentIndicator&&(a=0,r.length=0),0===r.length&&(t.data.length<10||t.data[0]!=="I".charCodeAt(0)||t.data[1]!=="D".charCodeAt(0)||t.data[2]!=="3".charCodeAt(0)))i.debug&&console.log("Skipping unrecognized metadata packet");else if(r.push(t),a+=t.data.byteLength,1===r.length&&(n=ee(t.data.subarray(6,10)),n+=10),!(a<n)){for(e={data:new Uint8Array(n),frames:[],pts:r[0].pts,dts:r[0].dts},l=0;l<n;)e.data.set(r[0].data.subarray(0,n-l),l),l+=r[0].data.byteLength,a-=r[0].data.byteLength,r.shift();o=10,64&e.data[5]&&(o+=4,o+=ee(e.data.subarray(10,14)),n-=ee(e.data.subarray(16,20)));do{if(s=ee(e.data.subarray(o+4,o+8)),s<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if(u=String.fromCharCode(e.data[o],e.data[o+1],e.data[o+2],e.data[o+3]),c={id:u,data:e.data.subarray(o+10,o+s+10)},c.key=c.id,ie[c.id]&&(ie[c.id](c),"com.apple.streaming.transportStreamTimestamp"===c.owner)){var h=c.data,d=(1&h[3])<<30|h[4]<<22|h[5]<<14|h[6]<<6|h[7]>>>2;d*=4,d+=3&h[7],c.timeStamp=d,void 0===e.pts&&void 0===e.dts&&(e.pts=c.timeStamp,e.dts=c.timeStamp),this.trigger("timestamp",c)}e.frames.push(c),o+=10,o+=s}while(o<n);this.trigger("data",e)}}},Zt.prototype=new et;var ne,re,ae,oe=Zt,se=Jt.TimestampRolloverStream,ce=188,le=71;ne=function(){var t=new Uint8Array(ce),e=0;ne.prototype.init.call(this),this.push=function(i){var n,r=0,a=ce;e?(n=new Uint8Array(i.byteLength+e),n.set(t.subarray(0,e)),n.set(i,e),e=0):n=i;while(a<n.byteLength)n[r]!==le||n[a]!==le?(r++,a++):(this.trigger("data",n.subarray(r,a)),r+=ce,a+=ce);r<n.byteLength&&(t.set(n.subarray(r),0),e=n.byteLength-r)},this.flush=function(){e===ce&&t[0]===le&&(this.trigger("data",t),e=0),this.trigger("done")}},ne.prototype=new et,re=function(){var t,e,i,n;re.prototype.init.call(this),n=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,t=function(t,n){var r=0;n.payloadUnitStartIndicator&&(r+=t[r]+1),"pat"===n.type?e(t.subarray(r),n):i(t.subarray(r),n)},e=function(t,e){e.section_number=t[7],e.last_section_number=t[8],n.pmtPid=(31&t[10])<<8|t[11],e.pmtPid=n.pmtPid},i=function(t,e){var i,r,a,o;if(1&t[5]){n.programMapTable={video:null,audio:null,"timed-metadata":{}},i=(15&t[1])<<8|t[2],r=3+i-4,a=(15&t[10])<<8|t[11],o=12+a;while(o<r){var s=t[o],c=(31&t[o+1])<<8|t[o+2];s===Wt.H264_STREAM_TYPE&&null===n.programMapTable.video?n.programMapTable.video=c:s===Wt.ADTS_STREAM_TYPE&&null===n.programMapTable.audio?n.programMapTable.audio=c:s===Wt.METADATA_STREAM_TYPE&&(n.programMapTable["timed-metadata"][c]=s),o+=5+((15&t[o+3])<<8|t[o+4])}e.programMapTable=n.programMapTable}},this.push=function(e){var i={},n=4;if(i.payloadUnitStartIndicator=!!(64&e[1]),i.pid=31&e[1],i.pid<<=8,i.pid|=e[2],(48&e[3])>>>4>1&&(n+=e[n]+1),0===i.pid)i.type="pat",t(e.subarray(n),i),this.trigger("data",i);else if(i.pid===this.pmtPid){i.type="pmt",t(e.subarray(n),i),this.trigger("data",i);while(this.packetsWaitingForPmt.length)this.processPes_.apply(this,this.packetsWaitingForPmt.shift())}else void 0===this.programMapTable?this.packetsWaitingForPmt.push([e,n,i]):this.processPes_(e,n,i)},this.processPes_=function(t,e,i){i.pid===this.programMapTable.video?i.streamType=Wt.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?i.streamType=Wt.ADTS_STREAM_TYPE:i.streamType=this.programMapTable["timed-metadata"][i.pid],i.type="pes",i.data=t.subarray(e),this.trigger("data",i)}},re.prototype=new et,re.STREAM_TYPES={h264:27,adts:15},ae=function(){var t=this,e={data:[],size:0},i={data:[],size:0},n={data:[],size:0},r=function(t,e){var i;e.packetLength=6+(t[4]<<8|t[5]),e.dataAlignmentIndicator=0!==(4&t[6]),i=t[7],192&i&&(e.pts=(14&t[9])<<27|(255&t[10])<<20|(254&t[11])<<12|(255&t[12])<<5|(254&t[13])>>>3,e.pts*=4,e.pts+=(6&t[13])>>>1,e.dts=e.pts,64&i&&(e.dts=(14&t[14])<<27|(255&t[15])<<20|(254&t[16])<<12|(255&t[17])<<5|(254&t[18])>>>3,e.dts*=4,e.dts+=(6&t[18])>>>1)),e.data=t.subarray(9+t[8])},a=function(e,i,n){var a,o=new Uint8Array(e.size),s={type:i},c=0,l=0,u=!1;if(e.data.length&&!(e.size<9)){for(s.trackId=e.data[0].pid,c=0;c<e.data.length;c++)a=e.data[c],o.set(a.data,l),l+=a.data.byteLength;r(o,s),u="video"===i||s.packetLength<=e.size,(n||u)&&(e.size=0,e.data.length=0),u&&t.trigger("data",s)}};ae.prototype.init.call(this),this.push=function(r){({pat:function(){},pes:function(){var t,o;switch(r.streamType){case Wt.H264_STREAM_TYPE:case Wt.H264_STREAM_TYPE:t=e,o="video";break;case Wt.ADTS_STREAM_TYPE:t=i,o="audio";break;case Wt.METADATA_STREAM_TYPE:t=n,o="timed-metadata";break;default:return}r.payloadUnitStartIndicator&&a(t,o,!0),t.data.push(r),t.size+=r.data.byteLength},pmt:function(){var e={type:"metadata",tracks:[]},i=r.programMapTable;null!==i.video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.video,codec:"avc",type:"video"}),null!==i.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.audio,codec:"adts",type:"audio"}),t.trigger("data",e)}})[r.type]()},this.flush=function(){a(e,"video"),a(i,"audio"),a(n,"timed-metadata"),this.trigger("done")}},ae.prototype=new et;var ue={PAT_PID:0,MP2T_PACKET_LENGTH:ce,TransportPacketStream:ne,TransportParseStream:re,ElementaryStream:ae,TimestampRolloverStream:se,CaptionStream:Vt.CaptionStream,Cea608Stream:Vt.Cea608Stream,MetadataStream:oe};for(var he in Wt)Wt.hasOwnProperty(he)&&(ue[he]=Wt[he]);var de,pe=ue,fe=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];de=function(){var t;de.prototype.init.call(this),this.push=function(e){var i,n,r,a,o,s,c=0,l=0;if("audio"===e.type){t?(a=t,t=new Uint8Array(a.byteLength+e.data.byteLength),t.set(a),t.set(e.data,a.byteLength)):t=e.data;while(c+5<t.length)if(255===t[c]&&240===(246&t[c+1])){if(n=2*(1&~t[c+1]),i=(3&t[c+3])<<11|t[c+4]<<3|(224&t[c+5])>>5,o=1024*(1+(3&t[c+6])),s=9e4*o/fe[(60&t[c+2])>>>2],r=c+i,t.byteLength<r)return;if(this.trigger("data",{pts:e.pts+l*s,dts:e.dts+l*s,sampleCount:o,audioobjecttype:1+(t[c+2]>>>6&3),channelcount:(1&t[c+2])<<2|(192&t[c+3])>>>6,samplerate:fe[(60&t[c+2])>>>2],samplingfrequencyindex:(60&t[c+2])>>>2,samplesize:16,data:t.subarray(c+7+n,r)}),t.byteLength===r)return void(t=void 0);l++,t=t.subarray(r)}else c++}},this.flush=function(){this.trigger("done")}},de.prototype=new et;var me,ge=de;me=function(t){var e=t.byteLength,i=0,n=0;this.length=function(){return 8*e},this.bitsAvailable=function(){return 8*e+n},this.loadWord=function(){var r=t.byteLength-e,a=new Uint8Array(4),o=Math.min(4,e);if(0===o)throw new Error("no bytes available");a.set(t.subarray(r,r+o)),i=new DataView(a.buffer).getUint32(0),n=8*o,e-=o},this.skipBits=function(t){var r;n>t?(i<<=t,n-=t):(t-=n,r=Math.floor(t/8),t-=8*r,e-=r,this.loadWord(),i<<=t,n-=t)},this.readBits=function(t){var r=Math.min(n,t),a=i>>>32-r;return n-=r,n>0?i<<=r:e>0&&this.loadWord(),r=t-r,r>0?a<<r|this.readBits(r):a},this.skipLeadingZeros=function(){var t;for(t=0;t<n;++t)if(0!==(i&2147483648>>>t))return i<<=t,n-=t,t;return this.loadWord(),t+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var t=this.skipLeadingZeros();return this.readBits(t+1)-1},this.readExpGolomb=function(){var t=this.readUnsignedExpGolomb();return 1&t?1+t>>>1:-1*(t>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var ve,ye,_e,be=me;ye=function(){var t,e,i=0;ye.prototype.init.call(this),this.push=function(n){var r;for(e?(r=new Uint8Array(e.byteLength+n.data.byteLength),r.set(e),r.set(n.data,e.byteLength),e=r):e=n.data;i<e.byteLength-3;i++)if(1===e[i+2]){t=i+5;break}while(t<e.byteLength)switch(e[t]){case 0:if(0!==e[t-1]){t+=2;break}if(0!==e[t-2]){t++;break}i+3!==t-2&&this.trigger("data",e.subarray(i+3,t-2));do{t++}while(1!==e[t]&&t<e.length);i=t-2,t+=3;break;case 1:if(0!==e[t-1]||0!==e[t-2]){t+=3;break}this.trigger("data",e.subarray(i+3,t-2)),i=t-2,t+=3;break;default:t+=3;break}e=e.subarray(i),t-=i,i=0},this.flush=function(){e&&e.byteLength>3&&this.trigger("data",e.subarray(i+3)),e=null,i=0,this.trigger("done")}},ye.prototype=new et,_e={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},ve=function(){var t,e,i,n,r,a,o,s=new ye;ve.prototype.init.call(this),t=this,this.push=function(t){"video"===t.type&&(e=t.trackId,i=t.pts,n=t.dts,s.push(t))},s.on("data",function(o){var s={trackId:e,pts:i,dts:n,data:o};switch(31&o[0]){case 5:s.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:s.nalUnitType="sei_rbsp",s.escapedRBSP=r(o.subarray(1));break;case 7:s.nalUnitType="seq_parameter_set_rbsp",s.escapedRBSP=r(o.subarray(1)),s.config=a(s.escapedRBSP);break;case 8:s.nalUnitType="pic_parameter_set_rbsp";break;case 9:s.nalUnitType="access_unit_delimiter_rbsp";break;default:break}t.trigger("data",s)}),s.on("done",function(){t.trigger("done")}),this.flush=function(){s.flush()},o=function(t,e){var i,n,r=8,a=8;for(i=0;i<t;i++)0!==a&&(n=e.readExpGolomb(),a=(r+n+256)%256),r=0===a?r:a},r=function(t){var e,i,n=t.byteLength,r=[],a=1;while(a<n-2)0===t[a]&&0===t[a+1]&&3===t[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return t;e=n-r.length,i=new Uint8Array(e);var o=0;for(a=0;a<e;o++,a++)o===r[0]&&(o++,r.shift()),i[a]=t[o];return i},a=function(t){var e,i,n,r,a,s,c,l,u,h,d,p,f,m,g=0,v=0,y=0,_=0,b=1;if(e=new be(t),i=e.readUnsignedByte(),r=e.readUnsignedByte(),n=e.readUnsignedByte(),e.skipUnsignedExpGolomb(),_e[i]&&(a=e.readUnsignedExpGolomb(),3===a&&e.skipBits(1),e.skipUnsignedExpGolomb(),e.skipUnsignedExpGolomb(),e.skipBits(1),e.readBoolean()))for(d=3!==a?8:12,m=0;m<d;m++)e.readBoolean()&&o(m<6?16:64,e);if(e.skipUnsignedExpGolomb(),s=e.readUnsignedExpGolomb(),0===s)e.readUnsignedExpGolomb();else if(1===s)for(e.skipBits(1),e.skipExpGolomb(),e.skipExpGolomb(),c=e.readUnsignedExpGolomb(),m=0;m<c;m++)e.skipExpGolomb();if(e.skipUnsignedExpGolomb(),e.skipBits(1),l=e.readUnsignedExpGolomb(),u=e.readUnsignedExpGolomb(),h=e.readBits(1),0===h&&e.skipBits(1),e.skipBits(1),e.readBoolean()&&(g=e.readUnsignedExpGolomb(),v=e.readUnsignedExpGolomb(),y=e.readUnsignedExpGolomb(),_=e.readUnsignedExpGolomb()),e.readBoolean()&&e.readBoolean()){switch(f=e.readUnsignedByte(),f){case 1:p=[1,1];break;case 2:p=[12,11];break;case 3:p=[10,11];break;case 4:p=[16,11];break;case 5:p=[40,33];break;case 6:p=[24,11];break;case 7:p=[20,11];break;case 8:p=[32,11];break;case 9:p=[80,33];break;case 10:p=[18,11];break;case 11:p=[15,11];break;case 12:p=[64,33];break;case 13:p=[160,99];break;case 14:p=[4,3];break;case 15:p=[3,2];break;case 16:p=[2,1];break;case 255:p=[e.readUnsignedByte()<<8|e.readUnsignedByte(),e.readUnsignedByte()<<8|e.readUnsignedByte()];break}p&&(b=p[0]/p[1])}return{profileIdc:i,levelIdc:n,profileCompatibility:r,width:Math.ceil((16*(l+1)-2*g-2*v)*b),height:(2-h)*(u+1)*16-2*y-2*_}}},ve.prototype=new et;var we,Te={H264Stream:ve,NalByteStream:ye},xe=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Se=function(t){return t[0]==="I".charCodeAt(0)&&t[1]==="D".charCodeAt(0)&&t[2]==="3".charCodeAt(0)},Ee=function(t){return t[0]<<21|t[1]<<14|t[2]<<7|t[3]},Me=function(t,e,i){var n,r="";for(n=e;n<i;n++)r+="%"+("00"+t[n].toString(16)).slice(-2);return r},Ce=function(t,e,i){return unescape(Me(t,e,i))},Ae=function(t,e){var i=t[e+6]<<21|t[e+7]<<14|t[e+8]<<7|t[e+9],n=t[e+5],r=(16&n)>>4;return r?i+20:i+10},ke=function(t,e){var i=(224&t[e+5])>>5,n=t[e+4]<<3,r=6144&t[e+3];return r|n|i},Le=function(t,e){return t[e]==="I".charCodeAt(0)&&t[e+1]==="D".charCodeAt(0)&&t[e+2]==="3".charCodeAt(0)?"timed-metadata":!0&t[e]&&240===(240&t[e+1])?"audio":null},Pe=function(t){var e=0;while(e+5<t.length){if(255===t[e]&&240===(246&t[e+1]))return xe[(60&t[e+2])>>>2];e++}return null},Oe=function(t){var e,i,n,r;e=10,64&t[5]&&(e+=4,e+=Ee(t.subarray(10,14)));do{if(i=Ee(t.subarray(e+4,e+8)),i<1)return null;if(r=String.fromCharCode(t[e],t[e+1],t[e+2],t[e+3]),"PRIV"===r){n=t.subarray(e+10,e+i+10);for(var a=0;a<n.byteLength;a++)if(0===n[a]){var o=Ce(n,0,a);if("com.apple.streaming.transportStreamTimestamp"===o){var s=n.subarray(a+1),c=(1&s[3])<<30|s[4]<<22|s[5]<<14|s[6]<<6|s[7]>>>2;return c*=4,c+=3&s[7],c}break}}e+=10,e+=i}while(e<t.byteLength);return null},Re={isLikelyAacData:Se,parseId3TagSize:Ae,parseAdtsSize:ke,parseType:Le,parseSampleRate:Pe,parseAacTimestamp:Oe};we=function(){var t=new Uint8Array,e=0;we.prototype.init.call(this),this.setTimestamp=function(t){e=t},this.push=function(i){var n,r,a,o,s=0,c=0;t.length?(o=t.length,t=new Uint8Array(i.byteLength+o),t.set(t.subarray(0,o)),t.set(i,o)):t=i;while(t.length-c>=3)if(t[c]!=="I".charCodeAt(0)||t[c+1]!=="D".charCodeAt(0)||t[c+2]!=="3".charCodeAt(0))if(255!==(255&t[c])||240!==(240&t[c+1]))c++;else{if(t.length-c<7)break;if(s=Re.parseAdtsSize(t,c),c+s>t.length)break;a={type:"audio",data:t.subarray(c,c+s),pts:e,dts:e},this.trigger("data",a),c+=s}else{if(t.length-c<10)break;if(s=Re.parseId3TagSize(t,c),c+s>t.length)break;r={type:"timed-metadata",data:t.subarray(c,c+s)},this.trigger("data",r),c+=s}n=t.length-c,t=n>0?t.subarray(c):new Uint8Array}},we.prototype=new et;var Ie,De,Ue,Ne,Be=we,Fe=Te.H264Stream,ze=Re.isLikelyAacData,je=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],He=["width","height","profileIdc","levelIdc","profileCompatibility"],Ge=function(t,e){var i;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0};De=function(t,e){var i=[],n=0,r=0,a=0,o=1/0;e=e||{},De.prototype.init.call(this),this.push=function(e){kt.collectDtsInfo(t,e),t&&je.forEach(function(i){t[i]=e[i]}),i.push(e)},this.setEarliestDts=function(e){r=e-t.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(t){o=t},this.setAudioAppendStart=function(t){a=t},this.flush=function(){var s,c,l,u;0!==i.length?(s=St.trimAdtsFramesByEarliestDts(i,t,r),t.baseMediaDecodeTime=kt.calculateTrackBaseMediaDecodeTime(t,e.keepOriginalTimestamps),St.prefixWithSilence(t,s,a,o),t.samples=St.generateSampleTable(s),l=G.mdat(St.concatenateFrameData(s)),i=[],c=G.moof(n,[t]),u=new Uint8Array(c.byteLength+l.byteLength),n++,u.set(c),u.set(l,c.byteLength),kt.clearDtsInfo(t),this.trigger("data",{track:t,boxes:u}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")}},De.prototype=new et,Ie=function(t,e){var i,n,r=0,a=[],o=[];e=e||{},Ie.prototype.init.call(this),delete t.minPTS,this.gopCache_=[],this.push=function(e){kt.collectDtsInfo(t,e),"seq_parameter_set_rbsp"!==e.nalUnitType||i||(i=e.config,t.sps=[e.data],He.forEach(function(e){t[e]=i[e]},this)),"pic_parameter_set_rbsp"!==e.nalUnitType||n||(n=e.data,t.pps=[e.data]),a.push(e)},this.flush=function(){var i,n,s,c,l,u;while(a.length){if("access_unit_delimiter_rbsp"===a[0].nalUnitType)break;a.shift()}if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(i=lt.groupNalsIntoFrames(a),s=lt.groupFramesIntoGops(i),s[0][0].keyFrame||(n=this.getGopForFusion_(a[0],t),n?(s.unshift(n),s.byteLength+=n.byteLength,s.nalCount+=n.nalCount,s.pts=n.pts,s.dts=n.dts,s.duration+=n.duration):s=lt.extendFirstKeyFrame(s)),o.length){var h;if(h=e.alignGopsAtEnd?this.alignGopsAtEnd_(s):this.alignGopsAtStart_(s),!h)return this.gopCache_.unshift({gop:s.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");kt.clearDtsInfo(t),s=h}kt.collectDtsInfo(t,s),t.samples=lt.generateSampleTable(s),l=G.mdat(lt.concatenateNalData(s)),t.baseMediaDecodeTime=kt.calculateTrackBaseMediaDecodeTime(t,e.keepOriginalTimestamps),this.trigger("processedGopsInfo",s.map(function(t){return{pts:t.pts,dts:t.dts,byteLength:t.byteLength}})),this.gopCache_.unshift({gop:s.pop(),pps:t.pps,sps:t.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",t.baseMediaDecodeTime),this.trigger("timelineStartInfo",t.timelineStartInfo),c=G.moof(r,[t]),u=new Uint8Array(c.byteLength+l.byteLength),r++,u.set(c),u.set(l,c.byteLength),this.trigger("data",{track:t,boxes:u}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){kt.clearDtsInfo(t),i=void 0,n=void 0},this.getGopForFusion_=function(e){var i,n,r,a,o,s=45e3,c=1e4,l=1/0;for(o=0;o<this.gopCache_.length;o++)a=this.gopCache_[o],r=a.gop,t.pps&&Ge(t.pps[0],a.pps[0])&&t.sps&&Ge(t.sps[0],a.sps[0])&&(r.dts<t.timelineStartInfo.dts||(i=e.dts-r.dts-r.duration,i>=-c&&i<=s&&(!n||l>i)&&(n=a,l=i)));return n?n.gop:null},this.alignGopsAtStart_=function(t){var e,i,n,r,a,s,c,l;a=t.byteLength,s=t.nalCount,c=t.duration,e=i=0;while(e<o.length&&i<t.length){if(n=o[e],r=t[i],n.pts===r.pts)break;r.pts>n.pts?e++:(i++,a-=r.byteLength,s-=r.nalCount,c-=r.duration)}return 0===i?t:i===t.length?null:(l=t.slice(i),l.byteLength=a,l.duration=c,l.nalCount=s,l.pts=l[0].pts,l.dts=l[0].dts,l)},this.alignGopsAtEnd_=function(t){var e,i,n,r,a,s,c;e=o.length-1,i=t.length-1,a=null,s=!1;while(e>=0&&i>=0){if(n=o[e],r=t[i],n.pts===r.pts){s=!0;break}n.pts>r.pts?e--:(e===o.length-1&&(a=i),i--)}if(!s&&null===a)return null;if(c=s?i:a,0===c)return t;var l=t.slice(c),u=l.reduce(function(t,e){return t.byteLength+=e.byteLength,t.duration+=e.duration,t.nalCount+=e.nalCount,t},{byteLength:0,duration:0,nalCount:0});return l.byteLength=u.byteLength,l.duration=u.duration,l.nalCount=u.nalCount,l.pts=l[0].pts,l.dts=l[0].dts,l},this.alignGopsWith=function(t){o=t}},Ie.prototype=new et,Ne=function(t,e){this.numberOfTracks=0,this.metadataStream=e,t=t||{},"undefined"!==typeof t.remux?this.remuxTracks=!!t.remux:this.remuxTracks=!0,"boolean"===typeof t.keepOriginalTimestamps&&(this.keepOriginalTimestamps=t.keepOriginalTimestamps),this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Ne.prototype.init.call(this),this.push=function(t){return t.text?this.pendingCaptions.push(t):t.frames?this.pendingMetadata.push(t):(this.pendingTracks.push(t.track),this.pendingBoxes.push(t.boxes),this.pendingBytes+=t.boxes.byteLength,"video"===t.track.type&&(this.videoTrack=t.track),void("audio"===t.track.type&&(this.audioTrack=t.track)))}},Ne.prototype=new et,Ne.prototype.flush=function(t){var e,i,n,r,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==t&&"AudioSegmentStream"!==t)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,He.forEach(function(t){o.info[t]=this.videoTrack[t]},this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,je.forEach(function(t){o.info[t]=this.audioTrack[t]},this)),1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,n=G.initSegment(this.pendingTracks),o.initSegment=new Uint8Array(n.byteLength),o.initSegment.set(n),o.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)o.data.set(this.pendingBoxes[r],a),a+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)e=this.pendingCaptions[r],e.startTime=e.startPts,this.keepOriginalTimestamps||(e.startTime-=s),e.startTime/=9e4,e.endTime=e.endPts,this.keepOriginalTimestamps||(e.endTime-=s),e.endTime/=9e4,o.captionStreams[e.stream]=!0,o.captions.push(e);for(r=0;r<this.pendingMetadata.length;r++)i=this.pendingMetadata[r],i.cueTime=i.pts,this.keepOriginalTimestamps||(i.cueTime-=s),i.cueTime/=9e4,o.metadata.push(i);o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Ue=function(t){var e,i,n=this,r=!0;Ue.prototype.init.call(this),t=t||{},this.baseMediaDecodeTime=t.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var e={};this.transmuxPipeline_=e,e.type="aac",e.metadataStream=new pe.MetadataStream,e.aacStream=new Be,e.audioTimestampRolloverStream=new pe.TimestampRolloverStream("audio"),e.timedMetadataTimestampRolloverStream=new pe.TimestampRolloverStream("timed-metadata"),e.adtsStream=new ge,e.coalesceStream=new Ne(t,e.metadataStream),e.headOfPipeline=e.aacStream,e.aacStream.pipe(e.audioTimestampRolloverStream).pipe(e.adtsStream),e.aacStream.pipe(e.timedMetadataTimestampRolloverStream).pipe(e.metadataStream).pipe(e.coalesceStream),e.metadataStream.on("timestamp",function(t){e.aacStream.setTimestamp(t.timeStamp)}),e.aacStream.on("data",function(r){"timed-metadata"!==r.type||e.audioSegmentStream||(i=i||{timelineStartInfo:{baseMediaDecodeTime:n.baseMediaDecodeTime},codec:"adts",type:"audio"},e.coalesceStream.numberOfTracks++,e.audioSegmentStream=new De(i,t),e.adtsStream.pipe(e.audioSegmentStream).pipe(e.coalesceStream))}),e.coalesceStream.on("data",this.trigger.bind(this,"data")),e.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var r={};this.transmuxPipeline_=r,r.type="ts",r.metadataStream=new pe.MetadataStream,r.packetStream=new pe.TransportPacketStream,r.parseStream=new pe.TransportParseStream,r.elementaryStream=new pe.ElementaryStream,r.videoTimestampRolloverStream=new pe.TimestampRolloverStream("video"),r.audioTimestampRolloverStream=new pe.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new pe.TimestampRolloverStream("timed-metadata"),r.adtsStream=new ge,r.h264Stream=new Fe,r.captionStream=new pe.CaptionStream,r.coalesceStream=new Ne(t,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream),r.elementaryStream.pipe(r.videoTimestampRolloverStream).pipe(r.h264Stream),r.elementaryStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.elementaryStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",function(a){var o;if("metadata"===a.type){o=a.tracks.length;while(o--)e||"video"!==a.tracks[o].type?i||"audio"!==a.tracks[o].type||(i=a.tracks[o],i.timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime):(e=a.tracks[o],e.timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime);e&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new Ie(e,t),r.videoSegmentStream.on("timelineStartInfo",function(t){i&&(i.timelineStartInfo=t,r.audioSegmentStream.setEarliestDts(t.dts))}),r.videoSegmentStream.on("processedGopsInfo",n.trigger.bind(n,"gopInfo")),r.videoSegmentStream.on("baseMediaDecodeTime",function(t){i&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(t)}),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),i&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new De(i,t),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream))}}),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(n){var r=this.transmuxPipeline_;t.keepOriginalTimestamps||(this.baseMediaDecodeTime=n),i&&(i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,kt.clearDtsInfo(i),t.keepOriginalTimestamps||(i.timelineStartInfo.baseMediaDecodeTime=n),r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity()),e&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[],r.videoTimestampRolloverStream.discontinuity()),e.timelineStartInfo.dts=void 0,e.timelineStartInfo.pts=void 0,kt.clearDtsInfo(e),r.captionStream.reset(),t.keepOriginalTimestamps||(e.timelineStartInfo.baseMediaDecodeTime=n)),r.timedMetadataTimestampRolloverStream&&r.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(t){i&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(t)},this.alignGopsWith=function(t){e&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(t)},this.push=function(t){if(r){var e=ze(t);e&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():e||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(t)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Ue.prototype=new et;var Ve,We,qe={Transmuxer:Ue,VideoSegmentStream:Ie,AudioSegmentStream:De,AUDIO_PROPERTIES:je,VIDEO_PROPERTIES:He},Ye=Y.parseType,Xe=function(t){return new Date(1e3*t-20828448e5)},$e=function(t){return{isLeading:(12&t[0])>>>2,dependsOn:3&t[0],isDependedOn:(192&t[1])>>>6,hasRedundancy:(48&t[1])>>>4,paddingValue:(14&t[1])>>>1,isNonSyncSample:1&t[1],degradationPriority:t[2]<<8|t[3]}},Ze=function(t){var e,i,n=new DataView(t.buffer,t.byteOffset,t.byteLength),r=[];for(e=0;e+4<t.length;e+=i)if(i=n.getUint32(e),e+=4,i<=0)r.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&t[e]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+t[e]&31);break}return r},Je={avc1:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{dataReferenceIndex:e.getUint16(6),width:e.getUint16(24),height:e.getUint16(26),horizresolution:e.getUint16(28)+e.getUint16(30)/16,vertresolution:e.getUint16(32)+e.getUint16(34)/16,frameCount:e.getUint16(40),depth:e.getUint16(74),config:Ve(t.subarray(78,t.byteLength))}},avcC:function(t){var e,i,n,r,a=new DataView(t.buffer,t.byteOffset,t.byteLength),o={configurationVersion:t[0],avcProfileIndication:t[1],profileCompatibility:t[2],avcLevelIndication:t[3],lengthSizeMinusOne:3&t[4],sps:[],pps:[]},s=31&t[5];for(n=6,r=0;r<s;r++)i=a.getUint16(n),n+=2,o.sps.push(new Uint8Array(t.subarray(n,n+i))),n+=i;for(e=t[n],n++,r=0;r<e;r++)i=a.getUint16(n),n+=2,o.pps.push(new Uint8Array(t.subarray(n,n+i))),n+=i;return o},btrt:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{bufferSizeDB:e.getUint32(0),maxBitrate:e.getUint32(4),avgBitrate:e.getUint32(8)}},esds:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),esId:t[6]<<8|t[7],streamPriority:31&t[8],decoderConfig:{objectProfileIndication:t[11],streamType:t[12]>>>2&63,bufferSize:t[13]<<16|t[14]<<8|t[15],maxBitrate:t[16]<<24|t[17]<<16|t[18]<<8|t[19],avgBitrate:t[20]<<24|t[21]<<16|t[22]<<8|t[23],decoderConfigDescriptor:{tag:t[24],length:t[25],audioObjectType:t[26]>>>3&31,samplingFrequencyIndex:(7&t[26])<<1|t[27]>>>7&1,channelConfiguration:t[27]>>>3&15}}}},ftyp:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={majorBrand:Ye(t.subarray(0,4)),minorVersion:e.getUint32(4),compatibleBrands:[]},n=8;while(n<t.byteLength)i.compatibleBrands.push(Ye(t.subarray(n,n+4))),n+=4;return i},dinf:function(t){return{boxes:Ve(t)}},dref:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),dataReferences:Ve(t.subarray(8))}},hdlr:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),handlerType:Ye(t.subarray(8,12)),name:""},n=8;for(n=24;n<t.byteLength;n++){if(0===t[n]){n++;break}i.name+=String.fromCharCode(t[n])}return i.name=decodeURIComponent(escape(i.name)),i},mdat:function(t){return{byteLength:t.byteLength,nals:Ze(t)}},mdhd:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n=4,r={version:i.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),language:""};return 1===r.version?(n+=4,r.creationTime=Xe(i.getUint32(n)),n+=8,r.modificationTime=Xe(i.getUint32(n)),n+=4,r.timescale=i.getUint32(n),n+=8,r.duration=i.getUint32(n)):(r.creationTime=Xe(i.getUint32(n)),n+=4,r.modificationTime=Xe(i.getUint32(n)),n+=4,r.timescale=i.getUint32(n),n+=4,r.duration=i.getUint32(n)),n+=4,e=i.getUint16(n),r.language+=String.fromCharCode(96+(e>>10)),r.language+=String.fromCharCode(96+((992&e)>>5)),r.language+=String.fromCharCode(96+(31&e)),r},mdia:function(t){return{boxes:Ve(t)}},mfhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sequenceNumber:t[4]<<24|t[5]<<16|t[6]<<8|t[7]}},minf:function(t){return{boxes:Ve(t)}},mp4a:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i={dataReferenceIndex:e.getUint16(6),channelcount:e.getUint16(16),samplesize:e.getUint16(18),samplerate:e.getUint16(24)+e.getUint16(26)/65536};return t.byteLength>28&&(i.streamDescriptor=Ve(t.subarray(28))[0]),i},moof:function(t){return{boxes:Ve(t)}},moov:function(t){return{boxes:Ve(t)}},mvex:function(t){return{boxes:Ve(t)}},mvhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,n={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return 1===n.version?(i+=4,n.creationTime=Xe(e.getUint32(i)),i+=8,n.modificationTime=Xe(e.getUint32(i)),i+=4,n.timescale=e.getUint32(i),i+=8,n.duration=e.getUint32(i)):(n.creationTime=Xe(e.getUint32(i)),i+=4,n.modificationTime=Xe(e.getUint32(i)),i+=4,n.timescale=e.getUint32(i),i+=4,n.duration=e.getUint32(i)),i+=4,n.rate=e.getUint16(i)+e.getUint16(i+2)/16,i+=4,n.volume=e.getUint8(i)+e.getUint8(i+1)/8,i+=2,i+=2,i+=8,n.matrix=new Uint32Array(t.subarray(i,i+36)),i+=36,i+=24,n.nextTrackId=e.getUint32(i),n},pdin:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4)),rate:e.getUint32(4),initialDelay:e.getUint32(8)}},sdtp:function(t){var e,i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]};for(e=4;e<t.byteLength;e++)i.samples.push({dependsOn:(48&t[e])>>4,isDependedOn:(12&t[e])>>2,hasRedundancy:3&t[e]});return i},sidx:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},r=i.getUint16(22);for(e=24;r;e+=12,r--)n.references.push({referenceType:(128&t[e])>>>7,referencedSize:2147483647&i.getUint32(e),subsegmentDuration:i.getUint32(e+4),startsWithSap:!!(128&t[e+8]),sapType:(112&t[e+8])>>>4,sapDeltaTime:268435455&i.getUint32(e+8)});return n},smhd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),balance:t[4]+t[5]/256}},stbl:function(t){return{boxes:Ve(t)}},stco:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),chunkOffsets:[]},r=i.getUint32(4);for(e=8;r;e+=4,r--)n.chunkOffsets.push(i.getUint32(e));return n},stsc:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n=i.getUint32(4),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleToChunks:[]};for(e=8;n;e+=12,n--)r.sampleToChunks.push({firstChunk:i.getUint32(e),samplesPerChunk:i.getUint32(e+4),sampleDescriptionIndex:i.getUint32(e+8)});return r},stsd:function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleDescriptions:Ve(t.subarray(8))}},stsz:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]};for(e=12;e<t.byteLength;e+=4)n.entries.push(i.getUint32(e));return n},stts:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),timeToSamples:[]},r=i.getUint32(4);for(e=8;r;e+=8,r--)n.timeToSamples.push({sampleCount:i.getUint32(e),sampleDelta:i.getUint32(e+4)});return n},styp:function(t){return Je.ftyp(t)},tfdt:function(t){var e={version:t[0],flags:new Uint8Array(t.subarray(1,4)),baseMediaDecodeTime:t[4]<<24|t[5]<<16|t[6]<<8|t[7]};return 1===e.version&&(e.baseMediaDecodeTime*=Math.pow(2,32),e.baseMediaDecodeTime+=t[8]<<24|t[9]<<16|t[10]<<8|t[11]),e},tfhd:function(t){var e,i=new DataView(t.buffer,t.byteOffset,t.byteLength),n={version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:i.getUint32(4)},r=1&n.flags[2],a=2&n.flags[2],o=8&n.flags[2],s=16&n.flags[2],c=32&n.flags[2],l=65536&n.flags[0],u=131072&n.flags[0];return e=8,r&&(e+=4,n.baseDataOffset=i.getUint32(12),e+=4),a&&(n.sampleDescriptionIndex=i.getUint32(e),e+=4),o&&(n.defaultSampleDuration=i.getUint32(e),e+=4),s&&(n.defaultSampleSize=i.getUint32(e),e+=4),c&&(n.defaultSampleFlags=i.getUint32(e)),l&&(n.durationIsEmpty=!0),!r&&u&&(n.baseDataOffsetIsMoof=!0),n},tkhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),i=4,n={version:e.getUint8(0),flags:new Uint8Array(t.subarray(1,4))};return 1===n.version?(i+=4,n.creationTime=Xe(e.getUint32(i)),i+=8,n.modificationTime=Xe(e.getUint32(i)),i+=4,n.trackId=e.getUint32(i),i+=4,i+=8,n.duration=e.getUint32(i)):(n.creationTime=Xe(e.getUint32(i)),i+=4,n.modificationTime=Xe(e.getUint32(i)),i+=4,n.trackId=e.getUint32(i),i+=4,i+=4,n.duration=e.getUint32(i)),i+=4,i+=8,n.layer=e.getUint16(i),i+=2,n.alternateGroup=e.getUint16(i),i+=2,n.volume=e.getUint8(i)+e.getUint8(i+1)/8,i+=2,i+=2,n.matrix=new Uint32Array(t.subarray(i,i+36)),i+=36,n.width=e.getUint16(i)+e.getUint16(i+2)/16,i+=4,n.height=e.getUint16(i)+e.getUint16(i+2)/16,n},traf:function(t){return{boxes:Ve(t)}},trak:function(t){return{boxes:Ve(t)}},trex:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),trackId:e.getUint32(4),defaultSampleDescriptionIndex:e.getUint32(8),defaultSampleDuration:e.getUint32(12),defaultSampleSize:e.getUint32(16),sampleDependsOn:3&t[20],sampleIsDependedOn:(192&t[21])>>6,sampleHasRedundancy:(48&t[21])>>4,samplePaddingValue:(14&t[21])>>1,sampleIsDifferenceSample:!!(1&t[21]),sampleDegradationPriority:e.getUint16(22)}},trun:function(t){var e,i={version:t[0],flags:new Uint8Array(t.subarray(1,4)),samples:[]},n=new DataView(t.buffer,t.byteOffset,t.byteLength),r=1&i.flags[2],a=4&i.flags[2],o=1&i.flags[1],s=2&i.flags[1],c=4&i.flags[1],l=8&i.flags[1],u=n.getUint32(4),h=8;r&&(i.dataOffset=n.getInt32(h),h+=4),a&&u&&(e={flags:$e(t.subarray(h,h+4))},h+=4,o&&(e.duration=n.getUint32(h),h+=4),s&&(e.size=n.getUint32(h),h+=4),l&&(e.compositionTimeOffset=n.getUint32(h),h+=4),i.samples.push(e),u--);while(u--)e={},o&&(e.duration=n.getUint32(h),h+=4),s&&(e.size=n.getUint32(h),h+=4),c&&(e.flags=$e(t.subarray(h,h+4)),h+=4),l&&(e.compositionTimeOffset=n.getUint32(h),h+=4),i.samples.push(e);return i},"url ":function(t){return{version:t[0],flags:new Uint8Array(t.subarray(1,4))}},vmhd:function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength);return{version:t[0],flags:new Uint8Array(t.subarray(1,4)),graphicsmode:e.getUint16(4),opcolor:new Uint16Array([e.getUint16(6),e.getUint16(8),e.getUint16(10)])}}};Ve=function(t){for(var e,i,n,r,a,o=0,s=[],c=new ArrayBuffer(t.length),l=new Uint8Array(c),u=0;u<t.length;++u)l[u]=t[u];e=new DataView(c);while(o<t.byteLength)i=e.getUint32(o),n=Ye(t.subarray(o+4,o+8)),r=i>1?o+i:t.byteLength,a=(Je[n]||function(t){return{data:t}})(t.subarray(o+8,r)),a.size=i,a.type=n,s.push(a),o=r;return s},We=function(t,e){var i;return e=e||0,i=new Array(2*e+1).join(" "),t.map(function(t,n){return i+t.type+"\n"+Object.keys(t).filter(function(t){return"type"!==t&&"boxes"!==t}).map(function(e){var n=i+"  "+e+": ",r=t[e];if(r instanceof Uint8Array||r instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(t){return" "+("00"+t.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return a?1===a.length?n+"<"+a.join("").slice(1)+">":n+"<\n"+a.map(function(t){return i+"  "+t}).join("\n")+"\n"+i+"  >":n+"<>"}return n+JSON.stringify(r,null,2).split("\n").map(function(t,e){return 0===e?t:i+"  "+t}).join("\n")}).join("\n")+(t.boxes?"\n"+We(t.boxes,e+1):"")}).join("\n")};var Ke={inspect:Ve,textify:We,parseTfdt:Je.tfdt,parseHdlr:Je.hdlr,parseTfhd:Je.tfhd,parseTrun:Je.trun},Qe=Ut.discardEmulationPreventionBytes,ti=Vt.CaptionStream,ei=function(t,e){for(var i=t,n=0;n<e.length;n++){var r=e[n];if(i<r.size)return r;i-=r.size}return null},ii=function(t,e,i){var n,r,a,o,s=new DataView(t.buffer,t.byteOffset,t.byteLength),c=[];for(r=0;r+4<t.length;r+=a)if(a=s.getUint32(r),r+=4,!(a<=0))switch(31&t[r]){case 6:var l=t.subarray(r+1,r+1+a),u=ei(r,e);n={nalUnitType:"sei_rbsp",size:a,data:l,escapedRBSP:Qe(l),trackId:i},u?(n.pts=u.pts,n.dts=u.dts,o=u):(n.pts=o.pts,n.dts=o.dts),c.push(n);break;default:break}return c},ni=function(t,e,i){var n=e,r=i.defaultSampleDuration||0,a=i.defaultSampleSize||0,o=i.trackId,s=[];return t.forEach(function(t){var e=Ke.parseTrun(t),i=e.samples;i.forEach(function(t){void 0===t.duration&&(t.duration=r),void 0===t.size&&(t.size=a),t.trackId=o,t.dts=n,void 0===t.compositionTimeOffset&&(t.compositionTimeOffset=0),t.pts=n+t.compositionTimeOffset,n+=t.duration}),s=s.concat(i)}),s},ri=function(t,e){var i=Y.findBox(t,["moof","traf"]),n=Y.findBox(t,["mdat"]),r={},a=[];return n.forEach(function(t,e){var n=i[e];a.push({mdat:t,traf:n})}),a.forEach(function(t){var i,n,a=t.mdat,o=t.traf,s=Y.findBox(o,["tfhd"]),c=Ke.parseTfhd(s[0]),l=c.trackId,u=Y.findBox(o,["tfdt"]),h=u.length>0?Ke.parseTfdt(u[0]).baseMediaDecodeTime:0,d=Y.findBox(o,["trun"]);e===l&&d.length>0&&(i=ni(d,h,c),n=ii(a,i,l),r[l]||(r[l]=[]),r[l]=r[l].concat(n))}),r},ai=function(t,e,i){var n;return e?(n=ri(t,e),{seiNals:n[e],timescale:i}):null},oi=function(){var t,e,i,n,r,a=!1;this.isInitialized=function(){return a},this.init=function(){t=new ti,a=!0,t.on("data",function(t){t.startTime=t.startPts/n,t.endTime=t.endPts/n,r.captions.push(t),r.captionStreams[t.stream]=!0})},this.isNewInit=function(t,e){return!(t&&0===t.length||e&&"object"===typeof e&&0===Object.keys(e).length)&&(i!==t[0]||n!==e[i])},this.parse=function(t,a,o){var s;if(!this.isInitialized())return null;if(!a||!o)return null;if(this.isNewInit(a,o))i=a[0],n=o[i];else if(!i||!n)return e.push(t),null;while(e.length>0){var c=e.shift();this.parse(c,a,o)}return s=ai(t,i,n),null!==s&&s.seiNals?(this.pushNals(s.seiNals),this.flushStream(),r):null},this.pushNals=function(e){if(!this.isInitialized()||!e||0===e.length)return null;e.forEach(function(e){t.push(e)})},this.flushStream=function(){if(!this.isInitialized())return null;t.flush()},this.clearParsedCaptions=function(){r.captions=[],r.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;t.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){e=[],i=null,n=null,r?this.clearParsedCaptions():r={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()},si=oi,ci={generator:G,probe:Y,Transmuxer:qe.Transmuxer,AudioSegmentStream:qe.AudioSegmentStream,VideoSegmentStream:qe.VideoSegmentStream,CaptionParser:si},li=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},ui=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),hi=function(t,e){e.on("data",function(e){var i=e.initSegment;e.initSegment={data:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength};var n=e.data;e.data=n.buffer,t.postMessage({action:"data",segment:e,byteOffset:n.byteOffset,byteLength:n.byteLength},[e.data])}),e.captionStream&&e.captionStream.on("data",function(e){t.postMessage({action:"caption",data:e})}),e.on("done",function(e){t.postMessage({action:"done"})}),e.on("gopInfo",function(e){t.postMessage({action:"gopInfo",gopInfo:e})})},di=function(){function t(e,i){li(this,t),this.options=i||{},this.self=e,this.init()}return ui(t,[{key:"init",value:function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new ci.Transmuxer(this.options),hi(this.self,this.transmuxer)}},{key:"push",value:function(t){var e=new Uint8Array(t.data,t.byteOffset,t.byteLength);this.transmuxer.push(e)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(t){var e=t.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*e))}},{key:"setAudioAppendStart",value:function(t){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*t.appendStart))}},{key:"flush",value:function(t){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(t){this.transmuxer.alignGopsWith(t.gopsToAlignWith.slice())}}]),t}(),pi=function(t){t.onmessage=function(e){"init"===e.data.action&&e.data.options?this.messageHandlers=new di(t,e.data.options):(this.messageHandlers||(this.messageHandlers=new di(t)),e.data&&e.data.action&&"init"!==e.data.action&&this.messageHandlers[e.data.action]&&this.messageHandlers[e.data.action](e.data))}},fi=new pi(i)})()}),Oc={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},Rc=function(t){return t.map(function(t){return t.replace(/avc1\.(\d+)\.(\d+)/i,function(t,e,i){var n=("00"+Number(e).toString(16)).slice(-2),r=("00"+Number(i).toString(16)).slice(-2);return"avc1."+n+"00"+r})})},Ic=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e={codecCount:0},i=void 0;return e.codecCount=t.split(",").length,e.codecCount=e.codecCount||2,i=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(t),i&&(e.videoCodec=i[2],e.videoObjectTypeIndicator=i[3]),e.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(t),e.audioProfile=e.audioProfile&&e.audioProfile[2],e},Dc=function(t){return t.replace(/avc1\.(\d+)\.(\d+)/i,function(t){return Rc([t])[0]})},Uc=function(t,e,i){return t+"/"+e+'; codecs="'+i.filter(function(t){return!!t}).join(", ")+'"'},Nc=function(t){return t.segments&&t.segments.length&&t.segments[0].map?"mp4":"mp2t"},Bc=function(t){var e=t.attributes||{};return e.CODECS?Ic(e.CODECS):Oc},Fc=function(t,e){if(!t.mediaGroups.AUDIO||!e)return null;var i=t.mediaGroups.AUDIO[e];if(!i)return null;for(var n in i){var r=i[n];if(r.default&&r.playlists)return Ic(r.playlists[0].attributes.CODECS).audioProfile}return null},zc=function(t,e){var i=Nc(e),n=Bc(e),r=e.attributes||{},a=!0,o=!1;if(!e)return[];if(t.mediaGroups.AUDIO&&r.AUDIO){var s=t.mediaGroups.AUDIO[r.AUDIO];if(s)for(var c in o=!0,a=!1,s)if(!s[c].uri&&!s[c].playlists){a=!0;break}}o&&!n.audioProfile&&(a||(n.audioProfile=Fc(t,r.AUDIO)),n.audioProfile||(Xo.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),n.audioProfile=Oc.audioProfile));var l={};n.videoCodec&&(l.video=""+n.videoCodec+n.videoObjectTypeIndicator),n.audioProfile&&(l.audio="mp4a.40."+n.audioProfile);var u=Uc("audio",i,[l.audio]),h=Uc("video",i,[l.video]),d=Uc("video",i,[l.video,l.audio]);return o?!a&&l.video?[h,u]:a||l.video?[d,u]:[u,u]:l.video?[d]:[u]},jc=function(t){var e={type:"",parameters:{}},i=t.trim().split(";");return e.type=i.shift().trim(),i.forEach(function(t){var i=t.trim().split("=");if(i.length>1){var n=i[0].replace(/"/g,"").trim(),r=i[1].replace(/"/g,"").trim();e.parameters[n]=r}}),e},Hc=function(t){return/mp4a\.\d+.\d+/i.test(t)},Gc=function(t){return/avc1\.[\da-f]+/i.test(t)},Vc=function(t,e,i){if("undefined"===typeof e||null===e||!t.length)return[];var n=Math.ceil(9e4*(e-i+3)),r=void 0;for(r=0;r<t.length;r++)if(t[r].pts>n)break;return t.slice(r)},Wc=function(t,e,i){if(!e.length)return t;if(i)return e.slice();var n=e[0].pts,r=0;for(r;r<t.length;r++)if(t[r].pts>=n)break;return t.slice(0,r).concat(e)},qc=function(t,e,i,n){var r=Math.ceil(9e4*(e-n)),a=Math.ceil(9e4*(i-n)),o=t.slice(),s=t.length;while(s--)if(t[s].pts<=a)break;if(-1===s)return o;var c=s+1;while(c--)if(t[c].pts<=r)break;return c=Math.max(c,0),o.splice(c,s-c+1),o},Yc=function(t,e,i){var n=null,r=null,a=0,o=[],s=[];if(!t&&!e)return Xo.createTimeRange();if(!t)return e.buffered;if(!e)return t.buffered;if(i)return t.buffered;if(0===t.buffered.length&&0===e.buffered.length)return Xo.createTimeRange();var c=t.buffered,l=e.buffered,u=c.length;while(u--)o.push({time:c.start(u),type:"start"}),o.push({time:c.end(u),type:"end"});u=l.length;while(u--)o.push({time:l.start(u),type:"start"}),o.push({time:l.end(u),type:"end"});for(o.sort(function(t,e){return t.time-e.time}),u=0;u<o.length;u++)"start"===o[u].type?(a++,2===a&&(n=o[u].time)):"end"===o[u].type&&(a--,1===a&&(r=o[u].time)),null!==n&&null!==r&&(s.push([n,r]),n=null,r=null);return Xo.createTimeRanges(s)},Xc=function(t,e){var i=t.addSourceBuffer(e),n=Object.create(null);n.updating=!1,n.realBuffer_=i;var r=function(t){"function"===typeof i[t]?n[t]=function(){return i[t].apply(i,arguments)}:"undefined"===typeof n[t]&&Object.defineProperty(n,t,{get:function(){return i[t]},set:function(e){return i[t]=e}})};for(var a in i)r(a);return n},$c=function(t){function e(t,i){Ko(this,e);var n=is(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,Xo.EventTarget));n.timestampOffset_=0,n.pendingBuffers_=[],n.bufferUpdating_=!1,n.mediaSource_=t,n.codecs_=i,n.audioCodec_=null,n.videoCodec_=null,n.audioDisabled_=!1,n.appendAudioInitSegment_=!0,n.gopBuffer_=[],n.timeMapping_=0,n.safeAppend_=Xo.browser.IE_VERSION>=11;var r={remux:!1,alignGopsAtEnd:n.safeAppend_};return n.codecs_.forEach(function(t){Hc(t)?n.audioCodec_=t:Gc(t)&&(n.videoCodec_=t)}),n.transmuxer_=new Pc,n.transmuxer_.postMessage({action:"init",options:r}),n.transmuxer_.onmessage=function(t){return"data"===t.data.action?n.data_(t):"done"===t.data.action?n.done_(t):"gopInfo"===t.data.action?n.appendGopInfo_(t):void 0},Object.defineProperty(n,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(t){"number"===typeof t&&t>=0&&(this.timestampOffset_=t,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:t}))}}),Object.defineProperty(n,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(t){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=t),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=t)}}),Object.defineProperty(n,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(n,"buffered",{get:function(){return Yc(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),n}return es(e,t),Qo(e,[{key:"data_",value:function(t){var e=t.data.segment;e.data=new Uint8Array(e.data,t.data.byteOffset,t.data.byteLength),e.initSegment=new Uint8Array(e.initSegment.data,e.initSegment.byteOffset,e.initSegment.byteLength),fc(this,this.mediaSource_,e),this.pendingBuffers_.push(e)}},{key:"done_",value:function(t){"closed"!==this.mediaSource_.readyState?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"createRealSourceBuffers_",value:function(){var t=this,e=["audio","video"];e.forEach(function(i){if(t[i+"Codec_"]&&!t[i+"Buffer_"]){var n=null;if(t.mediaSource_[i+"Buffer_"])n=t.mediaSource_[i+"Buffer_"],n.updating=!1;else{var r=i+"Codec_",a=i+'/mp4;codecs="'+t[r]+'"';n=Xc(t.mediaSource_.nativeMediaSource_,a),t.mediaSource_[i+"Buffer_"]=n}t[i+"Buffer_"]=n,["update","updatestart","updateend"].forEach(function(r){n.addEventListener(r,function(){if("audio"!==i||!t.audioDisabled_){"updateend"===r&&(t[i+"Buffer_"].updating=!1);var n=e.every(function(e){return!("audio"!==e||!t.audioDisabled_)||(i===e||!t[e+"Buffer_"]||!t[e+"Buffer_"].updating)});return n?t.trigger(r):void 0}})})}})}},{key:"appendBuffer",value:function(t){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var e=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:e.end(e.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:Vc(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength},[t.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(t){this.gopBuffer_=Wc(this.gopBuffer_,t.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(t,e){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(t,e),this.gopBuffer_=qc(this.gopBuffer_,t,e,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(t,e)),mc(t,e,this.metadataTrack_),this.inbandTextTracks_)for(var i in this.inbandTextTracks_)mc(t,e,this.inbandTextTracks_[i])}},{key:"processPendingSegments_",value:function(){var t={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};t=this.pendingBuffers_.reduce(function(t,e){var i=e.type,n=e.data,r=e.initSegment;return t[i].segments.push(n),t[i].bytes+=n.byteLength,t[i].initSegment=r,e.captions&&(t.captions=t.captions.concat(e.captions)),e.info&&(t[i].info=e.info),e.metadata&&(t.metadata=t.metadata.concat(e.metadata)),t},t),this.videoBuffer_||this.audioBuffer_||(0===t.video.bytes&&(this.videoCodec_=null),0===t.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),t.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:t.audio.info}),t.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:t.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(t.audio.segments.unshift(t.audio.initSegment),t.audio.bytes+=t.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var e=!1;this.videoBuffer_&&t.video.bytes?(t.video.segments.unshift(t.video.initSegment),t.video.bytes+=t.video.initSegment.byteLength,this.concatAndAppendSegments_(t.video,this.videoBuffer_),yc(this,t.captions,t.metadata)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(e=!0),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(t.audio,this.audioBuffer_),this.pendingBuffers_.length=0,e&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(t,e){var i=0,n=void 0;if(t.bytes){n=new Uint8Array(t.bytes),t.segments.forEach(function(t){n.set(t,i),i+=t.byteLength});try{e.updating=!0,e.appendBuffer(n)}catch(r){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:r.message,originalError:r})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),e}(Xo.EventTarget),Zc=function(t){function e(){Ko(this,e);var t=is(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),i=void 0;for(i in t.nativeMediaSource_=new xt.a.MediaSource,t.nativeMediaSource_)i in e.prototype||"function"!==typeof t.nativeMediaSource_[i]||(t[i]=t.nativeMediaSource_[i].bind(t.nativeMediaSource_));return t.duration_=NaN,Object.defineProperty(t,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(t){this.duration_=t,t===1/0||(this.nativeMediaSource_.duration=t)}}),Object.defineProperty(t,"seekable",{get:function(){return this.duration_===1/0?Xo.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(t,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(t,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),t.sourceBuffers=[],t.activeSourceBuffers_=[],t.updateActiveSourceBuffers_=function(){if(t.activeSourceBuffers_.length=0,1===t.sourceBuffers.length){var e=t.sourceBuffers[0];return e.appendAudioInitSegment_=!0,e.audioDisabled_=!e.audioCodec_,void t.activeSourceBuffers_.push(e)}for(var i=!1,n=!0,r=0;r<t.player_.audioTracks().length;r++){var a=t.player_.audioTracks()[r];if(a.enabled&&"main"!==a.kind){i=!0,n=!1;break}}t.sourceBuffers.forEach(function(e,r){if(e.appendAudioInitSegment_=!0,e.videoCodec_&&e.audioCodec_)e.audioDisabled_=i;else if(e.videoCodec_&&!e.audioCodec_)e.audioDisabled_=!0,n=!1;else if(!e.videoCodec_&&e.audioCodec_&&(e.audioDisabled_=r?n:!n,e.audioDisabled_))return;t.activeSourceBuffers_.push(e)})},t.onPlayerMediachange_=function(){t.sourceBuffers.forEach(function(t){t.appendAudioInitSegment_=!0})},t.onHlsReset_=function(){t.sourceBuffers.forEach(function(t){t.transmuxer_&&t.transmuxer_.postMessage({action:"resetCaptions"})})},t.onHlsSegmentTimeMapping_=function(e){t.sourceBuffers.forEach(function(t){return t.timeMapping_=e.mapping})},["sourceopen","sourceclose","sourceended"].forEach(function(t){this.nativeMediaSource_.addEventListener(t,this.trigger.bind(this))},t),t.on("sourceopen",function(e){var i=Dt.a.querySelector('[src="'+t.url_+'"]');i&&(t.player_=Xo(i.parentNode),t.player_&&(t.player_.tech_.on("hls-reset",t.onHlsReset_),t.player_.tech_.on("hls-segment-time-mapping",t.onHlsSegmentTimeMapping_),t.player_.audioTracks&&t.player_.audioTracks()&&(t.player_.audioTracks().on("change",t.updateActiveSourceBuffers_),t.player_.audioTracks().on("addtrack",t.updateActiveSourceBuffers_),t.player_.audioTracks().on("removetrack",t.updateActiveSourceBuffers_)),t.player_.on("mediachange",t.onPlayerMediachange_)))}),t.on("sourceended",function(e){for(var i=vc(t.duration),n=0;n<t.sourceBuffers.length;n++){var r=t.sourceBuffers[n],a=r.metadataTrack_&&r.metadataTrack_.cues;a&&a.length&&(a[a.length-1].endTime=i)}}),t.on("sourceclose",function(t){this.sourceBuffers.forEach(function(t){t.transmuxer_&&t.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_&&this.player_.tech_.el_&&(this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))}),t}return es(e,t),Qo(e,[{key:"addSeekableRange_",value:function(t,e){var i=void 0;if(this.duration!==1/0)throw i=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity"),i.name="InvalidStateError",i.code=11,i;(e>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=e)}},{key:"addSourceBuffer",value:function(t){var e=void 0,i=jc(t);if(/^(video|audio)\/mp2t$/i.test(i.type)){var n=[];i.parameters&&i.parameters.codecs&&(n=i.parameters.codecs.split(","),n=Rc(n),n=n.filter(function(t){return Hc(t)||Gc(t)})),0===n.length&&(n=["avc1.4d400d","mp4a.40.2"]),e=new $c(this,n),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),e.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else e=this.nativeMediaSource_.addSourceBuffer(t);return this.sourceBuffers.push(e),e}}]),e}(Xo.EventTarget),Jc=0;Xo.mediaSources={};var Kc=function(t,e){var i=Xo.mediaSources[t];if(!i)throw new Error("Media Source not found (Video.js)");i.trigger({type:"sourceopen",swfId:e})},Qc=function(){return!!xt.a.MediaSource&&!!xt.a.MediaSource.isTypeSupported&&xt.a.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},tl=function(){if(this.MediaSource={open:Kc,supportsNativeMediaSources:Qc},Qc())return new Zc;throw new Error("Cannot use create a virtual MediaSource for this video")};tl.open=Kc,tl.supportsNativeMediaSources=Qc;var el={createObjectURL:function(t){var e="blob:vjs-media-source/",i=void 0;return t instanceof Zc?(i=xt.a.URL.createObjectURL(t.nativeMediaSource_),t.url_=i,i):t instanceof Zc?(i=e+Jc,Jc++,Xo.mediaSources[i]=t,i):(i=xt.a.URL.createObjectURL(t),t.url_=i,i)}};Xo.MediaSource=tl,Xo.URL=el;var il=Xo.EventTarget,nl=Xo.mergeOptions,rl=function(t,e){for(var i=nl(t,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod}),n=0;n<e.playlists.length;n++){var r=us(i,e.playlists[n]);r&&(i=r)}return ss(e,function(t,e,n,r){if(t.playlists&&t.playlists.length){var a=t.playlists[0].uri,o=us(i,t.playlists[0]);o&&(i=o,i.mediaGroups[e][n][r].playlists[0]=i.playlists[a])}}),i},al=function(t){function e(t,i,n,r){Ko(this,e);var a=is(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(a.hls_=i,a.withCredentials=n,!t)throw new Error("A non-empty playlist URL or playlist is required");return a.on("minimumUpdatePeriod",function(){a.refreshXml_()}),a.on("mediaupdatetimeout",function(){a.refreshMedia_()}),"string"===typeof t?(a.srcUrl=t,a.state="HAVE_NOTHING",is(a)):(a.masterPlaylistLoader_=r,a.state="HAVE_METADATA",a.started=!0,a.media(t),xt.a.setTimeout(function(){a.trigger("loadedmetadata")},0),a)}return es(e,t),Qo(e,[{key:"dispose",value:function(){this.stopRequest(),xt.a.clearTimeout(this.mediaUpdateTimeout)}},{key:"stopRequest",value:function(){if(this.request){var t=this.request;this.request=null,t.onreadystatechange=null,t.abort()}}},{key:"media",value:function(t){if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var e=this.state;if("string"===typeof t){if(!this.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.master.playlists[t]}var i=!this.media_||t.uri!==this.media_.uri;this.state="HAVE_METADATA",i&&(this.media_&&this.trigger("mediachanging"),this.media_=t,this.refreshMedia_(),"HAVE_MASTER"!==e&&this.trigger("mediachange"))}},{key:"pause",value:function(){this.stopRequest(),xt.a.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1)}},{key:"load",value:function(t){var e=this;xt.a.clearTimeout(this.mediaUpdateTimeout);var i=this.media();if(t){var n=i?i.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=xt.a.setTimeout(function(){return e.load()},n)}else this.started?this.trigger("loadedplaylist"):this.start()}},{key:"parseMasterXml",value:function(){var t=Object(Ut["a"])(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_});t.uri=this.srcUrl;for(var e=0;e<t.playlists.length;e++){var i="placeholder-uri-"+e;t.playlists[e].uri=i,t.playlists[i]=t.playlists[e]}return ss(t,function(e,i,n,r){if(e.playlists&&e.playlists.length){var a="placeholder-uri-"+i+"-"+n+"-"+r;e.playlists[0].uri=a,t.playlists[a]=e.playlists[0]}}),hs(t),ds(t),t}},{key:"start",value:function(){var t=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,i){if(t.request){if(t.request=null,e)return t.error={status:i.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:i.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");t.masterXml_=i.responseText,i.responseHeaders&&i.responseHeaders.date?t.masterLoaded_=Date.parse(i.responseHeaders.date):t.masterLoaded_=Date.now(),t.syncClientServerClock_(t.onClientServerClockSync_.bind(t))}})}},{key:"syncClientServerClock_",value:function(t){var e=this,i=Object(Ut["b"])(this.masterXml_);return null===i?(this.clientOffset_=this.masterLoaded_-Date.now(),t()):"DIRECT"===i.method?(this.clientOffset_=i.value-Date.now(),t()):void(this.request=this.hls_.xhr({uri:Jo(this.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials},function(n,r){if(e.request){if(n)return e.clientOffset_=e.masterLoaded_-Date.now(),t();var a=void 0;a="HEAD"===i.method?r.responseHeaders&&r.responseHeaders.date?Date.parse(r.responseHeaders.date):e.masterLoaded_:Date.parse(r.responseText),e.clientOffset_=a-Date.now(),t()}}))}},{key:"onClientServerClockSync_",value:function(){var t=this;this.master=this.parseMasterXml(),this.state="HAVE_MASTER",this.trigger("loadedplaylist"),this.media_||this.media(this.master.playlists[0]),xt.a.setTimeout(function(){t.trigger("loadedmetadata")},0),this.master.minimumUpdatePeriod&&xt.a.setTimeout(function(){t.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod)}},{key:"refreshXml_",value:function(){var t=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,i){if(t.request){if(t.request=null,e)return t.error={status:i.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:i.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");t.masterXml_=i.responseText;var n=t.parseMasterXml();t.master=rl(t.master,n),xt.a.setTimeout(function(){t.trigger("minimumUpdatePeriod")},t.master.minimumUpdatePeriod)}})}},{key:"refreshMedia_",value:function(){var t=this,e=void 0,i=void 0;this.masterPlaylistLoader_?(e=this.masterPlaylistLoader_.master,i=this.masterPlaylistLoader_.parseMasterXml()):(e=this.master,i=this.parseMasterXml());var n=rl(e,i);n?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=n:this.master=n,this.media_=n.playlists[this.media_.uri]):this.trigger("playlistunchanged"),this.media().endList||(this.mediaUpdateTimeout=xt.a.setTimeout(function(){t.trigger("mediaupdatetimeout")},ps(this.media(),!!n))),this.trigger("loadedplaylist")}}]),e}(il),ol=function(t){return Xo.log.debug?Xo.log.debug.bind(Xo,"VHS:",t+" >"):function(){}};function sl(){}var cl=function(){function t(e,i,n,r){Ko(this,t),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=e,this.processedAppend_=!1,this.type_=n,this.mimeType_=i,this.logger_=ol("SourceUpdater["+n+"]["+i+"]"),"closed"===e.readyState?e.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,i,r)):this.createSourceBuffer_(i,r)}return Qo(t,[{key:"createSourceBuffer_",value:function(t,e){var i=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(t),this.logger_("created SourceBuffer"),e&&(e.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)?e.on("sourcebufferadded",function(){i.start_()}):this.start_()}},{key:"start_",value:function(){var t=this;this.started_=!0,this.onUpdateendCallback_=function(){var e=t.pendingCallback_;t.pendingCallback_=null,t.logger_("buffered ["+hc(t.buffered())+"]"),e&&e(),t.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(t){var e=this;this.processedAppend_&&this.queueCallback_(function(){e.sourceBuffer_.abort()},t)}},{key:"appendBuffer",value:function(t,e){var i=this;this.processedAppend_=!0,this.queueCallback_(function(){i.sourceBuffer_.appendBuffer(t)},e)}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:Xo.createTimeRanges()}},{key:"remove",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:sl;this.processedAppend_&&this.queueCallback_(function(){i.logger_("remove ["+t+" => "+e+"]"),i.sourceBuffer_.remove(t,e)},n)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||this.pendingCallback_}},{key:"timestampOffset",value:function(t){var e=this;return"undefined"!==typeof t&&(this.queueCallback_(function(){e.sourceBuffer_.timestampOffset=t}),this.timestampOffset_=t),this.timestampOffset_}},{key:"queueCallback_",value:function(t,e){this.callbacks_.push([t.bind(this),e]),this.runCallback_()}},{key:"runCallback_",value:function(){var t=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(t=this.callbacks_.shift(),this.pendingCallback_=t[1],t[0]())}},{key:"dispose",value:function(){this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_&&"open"===this.mediaSource.readyState&&this.sourceBuffer_.abort()}}]),t}(),ll={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},ul={FAILURE:2,TIMEOUT:-101,ABORTED:-102},hl=function(t){var e=void 0,i=void 0;return i=t.offset+t.length-1,e=t.offset,"bytes="+e+"-"+i},dl=function(t){var e={};return t.byterange&&(e.Range=hl(t.byterange)),e},pl=function(t){t.forEach(function(t){t.abort()})},fl=function(t){return{bandwidth:t.bandwidth,bytesReceived:t.bytesReceived||0,roundTripTime:t.roundTripTime||0}},ml=function(t){var e=t.target,i=Date.now()-e.requestTime,n={bandwidth:1/0,bytesReceived:0,roundTripTime:i||0};return n.bytesReceived=t.loaded,n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3),n},gl=function(t,e){return e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:ul.TIMEOUT,xhr:e}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:ul.ABORTED,xhr:e}:t?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:ul.FAILURE,xhr:e}:null},vl=function(t,e){return function(i,n){var r=n.response,a=gl(i,n);if(a)return e(a,t);if(16!==r.byteLength)return e({status:n.status,message:"Invalid HLS key at URL: "+n.uri,code:ul.FAILURE,xhr:n},t);var o=new DataView(r);return t.key.bytes=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]),e(null,t)}},yl=function(t,e,i){return function(n,r){var a=r.response,o=gl(n,r);return o?i(o,t):0===a.byteLength?i({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:ul.FAILURE,xhr:r},t):(t.map.bytes=new Uint8Array(r.response),e.isInitialized()||e.init(),t.map.timescales=Bt.a.timescale(t.map.bytes),t.map.videoTrackIds=Bt.a.videoTrackIds(t.map.bytes),i(null,t))}},_l=function(t,e,i){return function(n,r){var a=r.response,o=gl(n,r),s=void 0;return o?i(o,t):0===a.byteLength?i({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:ul.FAILURE,xhr:r},t):(t.stats=fl(r),t.key?t.encryptedBytes=new Uint8Array(r.response):t.bytes=new Uint8Array(r.response),t.map&&t.map.bytes&&(e.isInitialized()||e.init(),s=e.parse(t.bytes,t.map.videoTrackIds,t.map.timescales),s&&s.captions&&(t.captionStreams=s.captionStreams,t.fmp4Captions=s.captions)),i(null,t))}},bl=function(t,e,i){var n=function n(r){if(r.data.source===e.requestId){t.removeEventListener("message",n);var a=r.data.decrypted;return e.bytes=new Uint8Array(a.bytes,a.byteOffset,a.byteLength),i(null,e)}};t.addEventListener("message",n),t.postMessage(Ws({source:e.requestId,encrypted:e.encryptedBytes,key:e.key.bytes,iv:e.key.iv}),[e.encryptedBytes.buffer,e.key.bytes.buffer])},wl=function(t,e,i){var n=0,r=!1;return function(a,o){if(!r)return a?(r=!0,pl(t),i(a,o)):(n+=1,n===t.length?(o.endOfAllRequests=Date.now(),o.encryptedBytes?bl(e,o,i):i(null,o)):void 0)}},Tl=function(t,e){return function(i){return t.stats=Xo.mergeOptions(t.stats,ml(i)),!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived&&(t.stats.firstBytesReceivedAt=Date.now()),e(i,t)}},xl=function(t,e,i,n,r,a,o){var s=[],c=wl(s,i,o);if(r.key){var l=Xo.mergeOptions(e,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),u=vl(r,c),h=t(l,u);s.push(h)}if(r.map&&!r.map.bytes){var d=Xo.mergeOptions(e,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:dl(r.map)}),p=yl(r,n,c),f=t(d,p);s.push(f)}var m=Xo.mergeOptions(e,{uri:r.resolvedUri,responseType:"arraybuffer",headers:dl(r)}),g=_l(r,n,c),v=t(m,g);return v.addEventListener("progress",Tl(r,a)),s.push(v),function(){return pl(s)}},Sl=function(t,e){var i=void 0;return t?(i=xt.a.getComputedStyle(t),i?i[e]:""):""},El=function(t,e){var i=t.slice();t.sort(function(t,n){var r=e(t,n);return 0===r?i.indexOf(t)-i.indexOf(n):r})},Ml=function(t,e){var i=void 0,n=void 0;return t.attributes.BANDWIDTH&&(i=t.attributes.BANDWIDTH),i=i||xt.a.Number.MAX_VALUE,e.attributes.BANDWIDTH&&(n=e.attributes.BANDWIDTH),n=n||xt.a.Number.MAX_VALUE,i-n},Cl=function(t,e){var i=void 0,n=void 0;return t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(i=t.attributes.RESOLUTION.width),i=i||xt.a.Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(n=e.attributes.RESOLUTION.width),n=n||xt.a.Number.MAX_VALUE,i===n&&t.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?t.attributes.BANDWIDTH-e.attributes.BANDWIDTH:i-n},Al=function(t,e,i,n,r){var a=t.playlists.map(function(t){var e=void 0,i=void 0,n=void 0;return e=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width,i=t.attributes.RESOLUTION&&t.attributes.RESOLUTION.height,n=t.attributes.BANDWIDTH,n=n||xt.a.Number.MAX_VALUE,{bandwidth:n,width:e,height:i,playlist:t}});El(a,function(t,e){return t.bandwidth-e.bandwidth}),a=a.filter(function(t){return!Bs.isIncompatible(t.playlist)});var o=a.filter(function(t){return Bs.isEnabled(t.playlist)});o.length||(o=a.filter(function(t){return!Bs.isDisabled(t.playlist)}));var s=o.filter(function(t){return t.bandwidth*ll.BANDWIDTH_VARIANCE<e}),c=s[s.length-1],l=s.filter(function(t){return t.bandwidth===c.bandwidth})[0];if(!1===r){var u=l||o[0]||a[0];return u?u.playlist:null}var h=s.filter(function(t){return t.width&&t.height});El(h,function(t,e){return t.width-e.width});var d=h.filter(function(t){return t.width===i&&t.height===n});c=d[d.length-1];var p=d.filter(function(t){return t.bandwidth===c.bandwidth})[0],f=void 0,m=void 0,g=void 0;p||(f=h.filter(function(t){return t.width>i||t.height>n}),m=f.filter(function(t){return t.width===f[0].width&&t.height===f[0].height}),c=m[m.length-1],g=m.filter(function(t){return t.bandwidth===c.bandwidth})[0]);var v=g||p||l||o[0]||a[0];return v?v.playlist:null},kl=function(){return Al(this.playlists.master,this.systemBandwidth,parseInt(Sl(this.tech_.el(),"width"),10),parseInt(Sl(this.tech_.el(),"height"),10),this.limitRenditionByPlayerDimensions)},Ll=function(t){var e=t.master,i=t.currentTime,n=t.bandwidth,r=t.duration,a=t.segmentDuration,o=t.timeUntilRebuffer,s=t.currentTimeline,c=t.syncController,l=e.playlists.filter(function(t){return!Bs.isIncompatible(t)}),u=l.filter(Bs.isEnabled);u.length||(u=l.filter(function(t){return!Bs.isDisabled(t)}));var h=u.filter(Bs.hasAttribute.bind(null,"BANDWIDTH")),d=h.map(function(t){var e=c.getSyncPoint(t,r,s,i),l=e?1:2,u=Bs.estimateSegmentRequestTime(a,n,t),h=u*l-o;return{playlist:t,rebufferingImpact:h}}),p=d.filter(function(t){return t.rebufferingImpact<=0});return El(p,function(t,e){return Ml(e.playlist,t.playlist)}),p.length?p[0]:(El(d,function(t,e){return t.rebufferingImpact-e.rebufferingImpact}),d[0]||null)},Pl=function(){var t=this.playlists.master.playlists.filter(Bs.isEnabled);El(t,function(t,e){return Ml(t,e)});var e=t.filter(function(t){return Ic(t.attributes.CODECS).videoCodec});return e[0]||null},Ol=function(t,e,i){for(var n in i)if(!t[n]){e.trigger({type:"usage",name:"hls-608"});var r=e.textTracks().getTrackById(n);t[n]=r||e.addRemoteTextTrack({kind:"captions",id:n,label:n},!1).track}},Rl=function(t){var e=t.inbandTextTracks,i=t.captionArray,n=t.timestampOffset;if(i){var r=window.WebKitDataCue||window.VTTCue;i.forEach(function(t){var i=t.stream,a=t.startTime,o=t.endTime;e[i]&&(a+=n,o+=n,e[i].addCue(new r(a,o,t.text)))})}},Il=500,Dl=function(t,e,i){if(!t||!e)return!1;var n=t.segments,r=i===n.length;return t.endList&&"open"===e.readyState&&r},Ul=function(t){return"number"===typeof t&&isFinite(t)},Nl=function(t,e,i){return"main"===t&&e&&i?i.containsAudio||i.containsVideo?e.containsVideo&&!i.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.containsVideo&&i.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null},Bl=function(t,e,i){var n=void 0;return n=t.length&&t.start(0)>0&&t.start(0)<e?t.start(0):e-30,Math.min(n,e-i)},Fl=function(t){var e=t.segment,i=e.start,n=e.end,r=t.playlist,a=r.mediaSequence,o=r.id,s=r.segments,c=void 0===s?[]:s,l=t.mediaIndex,u=t.timeline;return["appending ["+l+"] of ["+a+", "+(a+c.length)+"] from playlist ["+o+"]","["+i+" => "+n+"] in timeline ["+u+"]"].join(" ")},zl=function(t){function e(t){Ko(this,e);var i=is(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(!t)throw new TypeError("Initialization settings are required");if("function"!==typeof t.currentTime)throw new TypeError("No currentTime getter specified");if(!t.mediaSource)throw new TypeError("No MediaSource specified");return i.bandwidth=t.bandwidth,i.throughput={rate:0,count:0},i.roundTrip=NaN,i.resetStats_(),i.mediaIndex=null,i.hasPlayed_=t.hasPlayed,i.currentTime_=t.currentTime,i.seekable_=t.seekable,i.seeking_=t.seeking,i.duration_=t.duration,i.mediaSource_=t.mediaSource,i.hls_=t.hls,i.loaderType_=t.loaderType,i.startingMedia_=void 0,i.segmentMetadataTrack_=t.segmentMetadataTrack,i.goalBufferLength_=t.goalBufferLength,i.sourceType_=t.sourceType,i.inbandTextTracks_=t.inbandTextTracks,i.state_="INIT",i.checkBufferTimeout_=null,i.error_=void 0,i.currentTimeline_=-1,i.pendingSegment_=null,i.mimeType_=null,i.sourceUpdater_=null,i.xhrOptions_=null,i.activeInitSegmentId_=null,i.initSegments_={},i.captionParser_=new Ft["CaptionParser"],i.decrypter_=t.decrypter,i.syncController_=t.syncController,i.syncPoint_={segmentIndex:0,time:0},i.syncController_.on("syncinfoupdate",function(){return i.trigger("syncinfoupdate")}),i.mediaSource_.addEventListener("sourceopen",function(){return i.ended_=!1}),i.fetchAtBuffer_=!1,i.logger_=ol("SegmentLoader["+i.loaderType_+"]"),Object.defineProperty(i,"state",{get:function(){return this.state_},set:function(t){t!==this.state_&&(this.logger_(this.state_+" -> "+t),this.state_=t)}}),i}return es(e,t),Qo(e,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_(),this.captionParser_.reset()}},{key:"abort",value:function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(t){return"undefined"!==typeof t&&(this.error_=t),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():Xo.createTimeRanges()}},{key:"initSegment",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return null;var i=qs(t),n=this.initSegments_[i];return e&&!n&&t.bytes&&(this.initSegments_[i]=n={resolvedUri:t.resolvedUri,byterange:t.byterange,bytes:t.bytes,timescales:t.timescales,videoTrackIds:t.videoTrackIds}),n||t}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new cl(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t){var i=this.playlist_,n=this.pendingSegment_;this.playlist_=t,this.xhrOptions_=e,this.hasPlayed_()||(t.syncInfo={mediaSequence:t.mediaSequence,time:0});var r=i?i.id:null;if(this.logger_("playlist update ["+r+" => "+t.id+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(i&&i.uri===t.uri){var a=t.mediaSequence-i.mediaSequence;this.logger_("live window shift ["+a+"]"),null!==this.mediaIndex&&(this.mediaIndex-=a),n&&(n.mediaIndex-=a,n.mediaIndex>=0&&(n.segment=t.segments[n.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(i,t)}else null!==this.mediaIndex&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(xt.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(t,e){this.mimeType_||(this.mimeType_=t,this.sourceBufferEmitter_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(t){this.ended_=!1,this.resetLoader(),this.remove(0,this.duration_(),t),this.captionParser_.clearAllCaptions(),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(t,e,i){if(this.sourceUpdater_&&this.sourceUpdater_.remove(t,e,i),mc(t,e,this.segmentMetadataTrack_),this.inbandTextTracks_)for(var n in this.inbandTextTracks_)mc(t,e,this.inbandTextTracks_[n])}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&xt.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=xt.a.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&xt.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=xt.a.setTimeout(this.monitorBufferTick_.bind(this),Il)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t){var e=Dl(this.playlist_,this.mediaSource_,t.mediaIndex);e?this.endOfStream():(t.mediaIndex!==this.playlist_.segments.length-1||"ended"!==this.mediaSource_.readyState||this.seeking_())&&((t.timeline!==this.currentTimeline_||null!==t.startOfSegment&&t.startOfSegment<this.sourceUpdater_.timestampOffset())&&(this.syncController_.reset(),t.timestampOffset=t.startOfSegment,this.captionParser_.clearAllCaptions()),this.loadSegment_(t))}}}},{key:"checkBuffer_",value:function(t,e,i,n,r,a){var o=0,s=void 0;t.length&&(o=t.end(t.length-1));var c=Math.max(0,o-r);if(!e.segments.length)return null;if(c>=this.goalBufferLength_())return null;if(!n&&c>=1)return null;if(null===a)return i=this.getSyncSegmentCandidate_(e),this.generateSegmentInfo_(e,i,null,!0);if(null!==i){var l=e.segments[i];return s=l&&l.end?l.end:o,this.generateSegmentInfo_(e,i+1,s,!1)}if(this.fetchAtBuffer_){var u=Bs.getMediaInfoForTime(e,o,a.segmentIndex,a.time);i=u.mediaIndex,s=u.startTime}else{var h=Bs.getMediaInfoForTime(e,r,a.segmentIndex,a.time);i=h.mediaIndex,s=h.startTime}return this.generateSegmentInfo_(e,i,s,!1)}},{key:"getSyncSegmentCandidate_",value:function(t){var e=this;if(-1===this.currentTimeline_)return 0;var i=t.segments.map(function(t,e){return{timeline:t.timeline,segmentIndex:e}}).filter(function(t){return t.timeline===e.currentTimeline_});return i.length?i[Math.min(i.length-1,1)].segmentIndex:Math.max(t.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(t,e,i,n){if(e<0||e>=t.segments.length)return null;var r=t.segments[e];return{requestId:"segment-loader-"+Math.random(),uri:r.resolvedUri,mediaIndex:e,isSyncRequest:n,startOfSegment:i,playlist:t,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:r.timeline,duration:r.duration,segment:r}}},{key:"abortRequestEarly_",value:function(t){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(t.firstBytesReceivedAt||Date.now())<1e3)return!1;var e=this.currentTime_(),i=t.bandwidth,n=this.pendingSegment_.duration,r=Bs.estimateSegmentRequestTime(n,i,this.playlist_,t.bytesReceived),a=dc(this.buffered_(),e,this.hls_.tech_.playbackRate())-1;if(r<=a)return!1;var o=Ll({master:this.hls_.playlists.master,currentTime:e,bandwidth:i,duration:this.duration_(),segmentDuration:n,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(o){var s=r-a,c=s-o.rebufferingImpact,l=.5;return a<=ac&&(l=1),!o.playlist||o.playlist.uri===this.playlist_.uri||c<l?!1:(this.bandwidth=o.playlist.attributes.BANDWIDTH*ll.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),!0)}}},{key:"handleProgress_",value:function(t,e){this.pendingSegment_&&e.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(e.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(t){this.state="WAITING",this.pendingSegment_=t,this.trimBackBuffer_(t),t.abortRequests=xl(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(t),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(t){var e=Bl(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);e>0&&this.remove(0,e)}},{key:"createSimplifiedSegmentObj_",value:function(t){var e=t.segment,i={resolvedUri:e.resolvedUri,byterange:e.byterange,requestId:t.requestId};if(e.key){var n=e.key.iv||new Uint32Array([0,0,0,t.mediaIndex+t.playlist.mediaSequence]);i.key={resolvedUri:e.key.resolvedUri,iv:n}}return e.map&&(i.map=this.initSegment(e.map)),i}},{key:"segmentRequestFinished_",value:function(t,e){if(this.mediaRequests+=1,e.stats&&(this.mediaBytesTransferred+=e.stats.bytesReceived,this.mediaTransferDuration+=e.stats.roundTripTime),this.pendingSegment_){if(e.requestId===this.pendingSegment_.requestId){if(t)return this.pendingSegment_=null,this.state="READY",t.code===ul.ABORTED?void(this.mediaRequestsAborted+=1):(this.pause(),t.code===ul.TIMEOUT?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(t),void this.trigger("error")));this.bandwidth=e.stats.bandwidth,this.roundTrip=e.stats.roundTripTime,e.map&&(e.map=this.initSegment(e.map,!0)),this.processSegmentResponse_(e)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(t){var e=this.pendingSegment_;e.bytes=t.bytes,t.map&&(e.segment.map.bytes=t.map.bytes),e.endOfAllRequests=t.endOfAllRequests,t.fmp4Captions&&(Ol(this.inbandTextTracks_,this.hls_.tech_,t.captionStreams),Rl({inbandTextTracks:this.inbandTextTracks_,captionArray:t.fmp4Captions,timestampOffset:0}),this.captionParser_.clearParsedCaptions()),this.handleSegment_()}},{key:"handleSegment_",value:function(){var t=this;if(this.pendingSegment_){var e=this.pendingSegment_,i=e.segment,n=this.syncController_.probeSegmentInfo(e);"undefined"===typeof this.startingMedia_&&n&&(n.containsAudio||n.containsVideo)&&(this.startingMedia_={containsAudio:n.containsAudio,containsVideo:n.containsVideo});var r=Nl(this.loaderType_,this.startingMedia_,n);if(r)return this.error({message:r,blacklistDuration:1/0}),void this.trigger("error");if(e.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");null!==e.timestampOffset&&e.timestampOffset!==this.sourceUpdater_.timestampOffset()&&(this.sourceUpdater_.timestampOffset(e.timestampOffset),this.trigger("timestampoffset"));var a=this.syncController_.mappingForTimeline(e.timeline);if(null!==a&&this.trigger({type:"segmenttimemapping",mapping:a}),this.state="APPENDING",i.map){var o=qs(i.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==o){var s=this.initSegment(i.map);this.sourceUpdater_.appendBuffer(s.bytes,function(){t.activeInitSegmentId_=o})}}e.byteLength=e.bytes.byteLength,"number"===typeof i.start&&"number"===typeof i.end?this.mediaSecondsLoaded+=i.end-i.start:this.mediaSecondsLoaded+=i.duration,this.logger_(Fl(e)),this.sourceUpdater_.appendBuffer(e.bytes,this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var t=this.pendingSegment_,e=t.segment,i=null!==this.mediaIndex;if(this.pendingSegment_=null,this.recordThroughput_(t),this.addSegmentMetadataCue_(t),this.state="READY",this.mediaIndex=t.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=t.timeline,this.trigger("syncinfoupdate"),e.end&&this.currentTime_()-e.end>3*t.playlist.targetDuration)this.resetEverything();else{i&&this.trigger("bandwidthupdate"),this.trigger("progress");var n=Dl(t.playlist,this.mediaSource_,t.mediaIndex+1);n&&this.endOfStream(),this.paused()||this.monitorBuffer_()}}},{key:"recordThroughput_",value:function(t){var e=this.throughput.rate,i=Date.now()-t.endOfAllRequests+1,n=Math.floor(t.byteLength/i*8*1e3);this.throughput.rate+=(n-e)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(t){if(this.segmentMetadataTrack_){var e=t.segment,i=e.start,n=e.end;if(Ul(i)&&Ul(n)){mc(i,n,this.segmentMetadataTrack_);var r=xt.a.WebKitDataCue||xt.a.VTTCue,a={dateTimeObject:e.dateTimeObject,dateTimeString:e.dateTimeString,bandwidth:t.playlist.attributes.BANDWIDTH,resolution:t.playlist.attributes.RESOLUTION,codecs:t.playlist.attributes.CODECS,byteLength:t.byteLength,uri:t.uri,timeline:t.timeline,playlist:t.playlist.uri,start:i,end:n},o=JSON.stringify(a),s=new r(i,n,o);s.value=a,this.segmentMetadataTrack_.addCue(s)}}}}]),e}(Xo.EventTarget),jl=function(t){return decodeURIComponent(escape(String.fromCharCode.apply(null,t)))},Hl=new Uint8Array("\n\n".split("").map(function(t){return t.charCodeAt(0)})),Gl=function(t){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ko(this,e);var n=is(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return n.mediaSource_=null,n.subtitlesTrack_=null,n}return es(e,t),Qo(e,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return Xo.createTimeRanges();var t=this.subtitlesTrack_.cues,e=t[0].startTime,i=t[t.length-1].startTime;return Xo.createTimeRanges([[e,i]])}},{key:"initSegment",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return null;var i=qs(t),n=this.initSegments_[i];if(e&&!n&&t.bytes){var r=Hl.byteLength+t.bytes.byteLength,a=new Uint8Array(r);a.set(t.bytes),a.set(Hl,t.bytes.byteLength),this.initSegments_[i]=n={resolvedUri:t.resolvedUri,byterange:t.byterange,bytes:a}}return n||t}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(t){return"undefined"===typeof t?this.subtitlesTrack_:(this.subtitlesTrack_=t,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}},{key:"remove",value:function(t,e){mc(t,e,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var t=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(e=this.skipEmptySegments_(e),e){if(null===this.syncController_.timestampOffsetForTimeline(e.timeline)){var i=function(){t.state="READY",t.paused()||t.monitorBuffer_()};return this.syncController_.one("timestampoffset",i),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(e)}}},{key:"skipEmptySegments_",value:function(t){while(t&&t.segment.empty)t=this.generateSegmentInfo_(t.playlist,t.mediaIndex+1,t.startOfSegment+t.duration,t.isSyncRequest);return t}},{key:"handleSegment_",value:function(){var t=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var e=this.pendingSegment_,i=e.segment;if("function"!==typeof xt.a.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var n=function(){t.handleSegment_()};return this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",n),void this.subtitlesTrack_.tech_.one("vttjserror",function(){t.subtitlesTrack_.tech_.off("vttjsloaded",n),t.error({message:"Error loading vtt.js"}),t.state="READY",t.pause(),t.trigger("error")})}i.requested=!0;try{this.parseVTTCues_(e)}catch(Ph){return this.error({message:Ph.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(e,this.syncController_.timelines[e.timeline],this.playlist_),e.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");e.byteLength=e.bytes.byteLength,this.mediaSecondsLoaded+=i.duration,e.cues.length&&this.remove(e.cues[0].endTime,e.cues[e.cues.length-1].endTime),e.cues.forEach(function(e){t.subtitlesTrack_.addCue(e)}),this.handleUpdateEnd_()}else this.state="READY"}},{key:"parseVTTCues_",value:function(t){var e=void 0,i=!1;"function"===typeof xt.a.TextDecoder?e=new xt.a.TextDecoder("utf8"):(e=xt.a.WebVTT.StringDecoder(),i=!0);var n=new xt.a.WebVTT.Parser(xt.a,xt.a.vttjs,e);if(t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},n.oncue=t.cues.push.bind(t.cues),n.ontimestampmap=function(e){return t.timestampmap=e},n.onparsingerror=function(t){Xo.log.warn("Error encountered when parsing cues: "+t.message)},t.segment.map){var r=t.segment.map.bytes;i&&(r=jl(r)),n.parse(r)}var a=t.bytes;i&&(a=jl(a)),n.parse(a),n.flush()}},{key:"updateTimeMapping_",value:function(t,e,i){var n=t.segment;if(e)if(t.cues.length){var r=t.timestampmap,a=r.MPEGTS/9e4-r.LOCAL+e.mapping;if(t.cues.forEach(function(t){t.startTime+=a,t.endTime+=a}),!i.syncInfo){var o=t.cues[0].startTime,s=t.cues[t.cues.length-1].startTime;i.syncInfo={mediaSequence:i.mediaSequence+t.mediaIndex,time:Math.min(o,s-n.duration)}}}else n.empty=!0}}]),e}(zl),Vl=function(t,e){for(var i=t.cues,n=0;n<i.length;n++){var r=i[n];if(e>=r.adStartTime&&e<=r.adEndTime)return r}return null},Wl=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t.segments)for(var n=i,r=void 0,a=0;a<t.segments.length;a++){var o=t.segments[a];if(r||(r=Vl(e,n+o.duration/2)),r){if("cueIn"in o){r.endTime=n,r.adEndTime=n,n+=o.duration,r=null;continue}if(n<r.endTime){n+=o.duration;continue}r.endTime+=o.duration}else if("cueOut"in o&&(r=new xt.a.VTTCue(n,n+o.duration,o.cueOut),r.adStartTime=n,r.adEndTime=n+parseFloat(o.cueOut),e.addCue(r)),"cueOutCont"in o){var s=void 0,c=void 0,l=o.cueOutCont.split("/").map(parseFloat),u=ns(l,2);s=u[0],c=u[1],r=new xt.a.VTTCue(n,n+o.duration,""),r.adStartTime=n-s,r.adEndTime=r.adStartTime+c,e.addCue(r)}n+=o.duration}},ql=jt.a.inspect,Yl=[{name:"VOD",run:function(t,e,i,n,r){if(i!==1/0){var a={time:0,segmentIndex:0};return a}return null}},{name:"ProgramDateTime",run:function(t,e,i,n,r){if(!t.datetimeToDisplayTime)return null;var a=e.segments||[],o=null,s=null;r=r||0;for(var c=0;c<a.length;c++){var l=a[c];if(l.dateTimeObject){var u=l.dateTimeObject.getTime()/1e3,h=u+t.datetimeToDisplayTime,d=Math.abs(r-h);if(null!==s&&s<d)break;s=d,o={time:h,segmentIndex:c}}}return o}},{name:"Segment",run:function(t,e,i,n,r){var a=e.segments||[],o=null,s=null;r=r||0;for(var c=0;c<a.length;c++){var l=a[c];if(l.timeline===n&&"undefined"!==typeof l.start){var u=Math.abs(r-l.start);if(null!==s&&s<u)break;(!o||null===s||s>=u)&&(s=u,o={time:l.start,segmentIndex:c})}}return o}},{name:"Discontinuity",run:function(t,e,i,n,r){var a=null;if(r=r||0,e.discontinuityStarts&&e.discontinuityStarts.length)for(var o=null,s=0;s<e.discontinuityStarts.length;s++){var c=e.discontinuityStarts[s],l=e.discontinuitySequence+s+1,u=t.discontinuities[l];if(u){var h=Math.abs(r-u.time);if(null!==o&&o<h)break;(!a||null===o||o>=h)&&(o=h,a={time:u.time,segmentIndex:c})}}return a}},{name:"Playlist",run:function(t,e,i,n,r){if(e.syncInfo){var a={time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence};return a}return null}}],Xl=function(t){function e(){Ko(this,e);var t=is(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.inspectCache_=void 0,t.timelines=[],t.discontinuities=[],t.datetimeToDisplayTime=null,t.logger_=ol("SyncController"),t}return es(e,t),Qo(e,[{key:"getSyncPoint",value:function(t,e,i,n){var r=this.runStrategies_(t,e,i,n);return r.length?this.selectSyncPoint_(r,{key:"time",value:n}):null}},{key:"getExpiredTime",value:function(t,e){if(!t||!t.segments)return null;var i=this.runStrategies_(t,e,t.discontinuitySequence,0);if(!i.length)return null;var n=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});return n.segmentIndex>0&&(n.time*=-1),Math.abs(n.time+bs(t,n.segmentIndex,0))}},{key:"runStrategies_",value:function(t,e,i,n){for(var r=[],a=0;a<Yl.length;a++){var o=Yl[a],s=o.run(this,t,e,i,n);s&&(s.strategy=o.name,r.push({strategy:o.name,syncPoint:s}))}return r}},{key:"selectSyncPoint_",value:function(t,e){for(var i=t[0].syncPoint,n=Math.abs(t[0].syncPoint[e.key]-e.value),r=t[0].strategy,a=1;a<t.length;a++){var o=Math.abs(t[a].syncPoint[e.key]-e.value);o<n&&(n=o,i=t[a].syncPoint,r=t[a].strategy)}return this.logger_("syncPoint for ["+e.key+": "+e.value+"] chosen with strategy ["+r+"]: [time:"+i.time+", segmentIndex:"+i.segmentIndex+"]"),i}},{key:"saveExpiredSegmentInfo",value:function(t,e){for(var i=e.mediaSequence-t.mediaSequence,n=i-1;n>=0;n--){var r=t.segments[n];if(r&&"undefined"!==typeof r.start){e.syncInfo={mediaSequence:t.mediaSequence+n,time:r.start},this.logger_("playlist refresh sync: [time:"+e.syncInfo.time+", mediaSequence: "+e.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(t){if(!this.datetimeToDisplayTime&&t.segments&&t.segments.length&&t.segments[0].dateTimeObject){var e=t.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-e}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(t){var e=t.segment,i=t.playlist,n=void 0;return n=e.map?this.probeMp4Segment_(t):this.probeTsSegment_(t),n&&this.calculateSegmentTimeMapping_(t,n)&&(this.saveDiscontinuitySyncInfo_(t),i.syncInfo||(i.syncInfo={mediaSequence:i.mediaSequence+t.mediaIndex,time:e.start})),n}},{key:"probeMp4Segment_",value:function(t){var e=t.segment,i=Bt.a.timescale(e.map.bytes),n=Bt.a.startTime(i,t.bytes);return null!==t.timestampOffset&&(t.timestampOffset-=n),{start:n,end:n+e.duration}}},{key:"probeTsSegment_",value:function(t){var e=ql(t.bytes,this.inspectCache_),i=void 0,n=void 0;return e?(e.video&&2===e.video.length?(this.inspectCache_=e.video[1].dts,i=e.video[0].dtsTime,n=e.video[1].dtsTime):e.audio&&2===e.audio.length&&(this.inspectCache_=e.audio[1].dts,i=e.audio[0].dtsTime,n=e.audio[1].dtsTime),{start:i,end:n,containsVideo:e.video&&2===e.video.length,containsAudio:e.audio&&2===e.audio.length}):null}},{key:"timestampOffsetForTimeline",value:function(t){return"undefined"===typeof this.timelines[t]?null:this.timelines[t].time}},{key:"mappingForTimeline",value:function(t){return"undefined"===typeof this.timelines[t]?null:this.timelines[t].mapping}},{key:"calculateSegmentTimeMapping_",value:function(t,e){var i=t.segment,n=this.timelines[t.timeline];if(null!==t.timestampOffset)n={time:t.startOfSegment,mapping:t.startOfSegment-e.start},this.timelines[t.timeline]=n,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+t.timeline+": [time: "+n.time+"] [mapping: "+n.mapping+"]"),i.start=t.startOfSegment,i.end=e.end+n.mapping;else{if(!n)return!1;i.start=e.start+n.mapping,i.end=e.end+n.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(t){var e=t.playlist,i=t.segment;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(e.discontinuityStarts&&e.discontinuityStarts.length)for(var n=0;n<e.discontinuityStarts.length;n++){var r=e.discontinuityStarts[n],a=e.discontinuitySequence+n+1,o=r-t.mediaIndex,s=Math.abs(o);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>s){var c=void 0;c=o<0?i.start-bs(e,t.mediaIndex,r):i.end+bs(e,t.mediaIndex+1,r),this.discontinuities[a]={time:c,accuracy:s}}}}}]),e}(Xo.EventTarget),$l=new Ec("./decrypter-worker.worker.js",function(t,e){var i=this;(function(){function t(t){return t.subarray(0,t.byteLength-t[t.byteLength-1])}var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e},o=function(){var t=[[[],[],[],[],[]],[[],[],[],[],[]]],e=t[0],i=t[1],n=e[4],r=i[4],a=void 0,o=void 0,s=void 0,c=[],l=[],u=void 0,h=void 0,d=void 0,p=void 0,f=void 0,m=void 0;for(a=0;a<256;a++)l[(c[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!n[o];o^=u||1,s=l[s]||1)for(p=s^s<<1^s<<2^s<<3^s<<4,p=p>>8^255&p^99,n[o]=p,r[p]=o,d=c[h=c[u=c[o]]],m=16843009*d^65537*h^257*u^16843008*o,f=257*c[p]^16843008*p,a=0;a<4;a++)e[a][o]=f=f<<24^f>>>8,i[a][p]=m=m<<24^m>>>8;for(a=0;a<5;a++)e[a]=e[a].slice(0),i[a]=i[a].slice(0);return t},s=null,c=function(){function t(i){e(this,t),s||(s=o()),this._tables=[[s[0][0].slice(),s[0][1].slice(),s[0][2].slice(),s[0][3].slice(),s[0][4].slice()],[s[1][0].slice(),s[1][1].slice(),s[1][2].slice(),s[1][3].slice(),s[1][4].slice()]];var n=void 0,r=void 0,a=void 0,c=void 0,l=void 0,u=this._tables[0][4],h=this._tables[1],d=i.length,p=1;if(4!==d&&6!==d&&8!==d)throw new Error("Invalid aes key size");for(c=i.slice(0),l=[],this._key=[c,l],n=d;n<4*d+28;n++)a=c[n-1],(n%d===0||8===d&&n%d===4)&&(a=u[a>>>24]<<24^u[a>>16&255]<<16^u[a>>8&255]<<8^u[255&a],n%d===0&&(a=a<<8^a>>>24^p<<24,p=p<<1^283*(p>>7))),c[n]=c[n-d]^a;for(r=0;n;r++,n--)a=c[3&r?n:n-4],l[r]=n<=4||r<4?a:h[0][u[a>>>24]]^h[1][u[a>>16&255]]^h[2][u[a>>8&255]]^h[3][u[255&a]]}return t.prototype.decrypt=function(t,e,i,n,r,a){var o=this._key[1],s=t^o[0],c=n^o[1],l=i^o[2],u=e^o[3],h=void 0,d=void 0,p=void 0,f=o.length/4-2,m=void 0,g=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],w=v[3],T=v[4];for(m=0;m<f;m++)h=y[s>>>24]^_[c>>16&255]^b[l>>8&255]^w[255&u]^o[g],d=y[c>>>24]^_[l>>16&255]^b[u>>8&255]^w[255&s]^o[g+1],p=y[l>>>24]^_[u>>16&255]^b[s>>8&255]^w[255&c]^o[g+2],u=y[u>>>24]^_[s>>16&255]^b[c>>8&255]^w[255&l]^o[g+3],g+=4,s=h,c=d,l=p;for(m=0;m<4;m++)r[(3&-m)+a]=T[s>>>24]<<24^T[c>>16&255]<<16^T[l>>8&255]<<8^T[255&u]^o[g++],h=s,s=c,c=l,l=u,u=h},t}(),l=function(){function t(){e(this,t),this.listeners={}}return t.prototype.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},t.prototype.off=function(t,e){if(!this.listeners[t])return!1;var i=this.listeners[t].indexOf(e);return this.listeners[t].splice(i,1),i>-1},t.prototype.trigger=function(t){var e=this.listeners[t];if(e)if(2===arguments.length)for(var i=e.length,n=0;n<i;++n)e[n].call(this,arguments[1]);else for(var r=Array.prototype.slice.call(arguments,1),a=e.length,o=0;o<a;++o)e[o].apply(this,r)},t.prototype.dispose=function(){this.listeners={}},t.prototype.pipe=function(t){this.on("data",function(e){t.push(e)})},t}(),u=function(t){function i(){e(this,i);var n=a(this,t.call(this,l));return n.jobs=[],n.delay=1,n.timeout_=null,n}return r(i,t),i.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},i.prototype.push=function(t){this.jobs.push(t),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},i}(l),h=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},d=function(t,e,i){var n=new Int32Array(t.buffer,t.byteOffset,t.byteLength>>2),r=new c(Array.prototype.slice.call(e)),a=new Uint8Array(t.byteLength),o=new Int32Array(a.buffer),s=void 0,l=void 0,u=void 0,d=void 0,p=void 0,f=void 0,m=void 0,g=void 0,v=void 0;for(s=i[0],l=i[1],u=i[2],d=i[3],v=0;v<n.length;v+=4)p=h(n[v]),f=h(n[v+1]),m=h(n[v+2]),g=h(n[v+3]),r.decrypt(p,f,m,g,o,v),o[v]=h(o[v]^s),o[v+1]=h(o[v+1]^l),o[v+2]=h(o[v+2]^u),o[v+3]=h(o[v+3]^d),s=p,l=f,u=m,d=g;return a},p=function(){function i(n,r,a,o){e(this,i);var s=i.STEP,c=new Int32Array(n.buffer),l=new Uint8Array(n.byteLength),d=0;for(this.asyncStream_=new u,this.asyncStream_.push(this.decryptChunk_(c.subarray(d,d+s),r,a,l)),d=s;d<c.length;d+=s)a=new Uint32Array([h(c[d-4]),h(c[d-3]),h(c[d-2]),h(c[d-1])]),this.asyncStream_.push(this.decryptChunk_(c.subarray(d,d+s),r,a,l));this.asyncStream_.push(function(){o(null,t(l))})}return i.prototype.decryptChunk_=function(t,e,i,n){return function(){var r=d(t,e,i);n.set(r,t.byteOffset)}},n(i,null,[{key:"STEP",get:function(){return 32e3}}]),i}(),f=function(t){var e={};return Object.keys(t).forEach(function(i){var n=t[i];ArrayBuffer.isView(n)?e[i]={bytes:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength}:e[i]=n}),e},m=function(t){t.onmessage=function(e){var i=e.data,n=new Uint8Array(i.encrypted.bytes,i.encrypted.byteOffset,i.encrypted.byteLength),r=new Uint32Array(i.key.bytes,i.key.byteOffset,i.key.byteLength/4),a=new Uint32Array(i.iv.bytes,i.iv.byteOffset,i.iv.byteLength/4);new p(n,r,a,function(e,n){t.postMessage(f({source:i.source,decrypted:n}),[n.buffer])})}},g=new m(i)})()}),Zl=function(t){var e=t.default?"main":"alternative";return t.characteristics&&t.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},Jl=function(t,e){t.abort(),t.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},Kl=function(t,e){e.activePlaylistLoader=t,t.load()},Ql=function(t,e){return function(){var i=e.segmentLoaders,n=i[t],r=i.main,a=e.mediaTypes[t],o=a.activeTrack(),s=a.activeGroup(o),c=a.activePlaylistLoader;Jl(n,a),s&&(s.playlistLoader?(n.resyncLoader(),Kl(s.playlistLoader,a)):c&&r.resetEverything())}},tu=function(t,e){return function(){var i=e.segmentLoaders,n=i[t],r=i.main,a=e.mediaTypes[t],o=a.activeTrack(),s=a.activeGroup(o),c=a.activePlaylistLoader;Jl(n,a),s&&(s.playlistLoader?c!==s.playlistLoader?(n.track&&n.track(o),n.resetEverything(),Kl(s.playlistLoader,a)):Kl(s.playlistLoader,a):r.resetEverything())}},eu={AUDIO:function(t,e){return function(){var i=e.segmentLoaders[t],n=e.mediaTypes[t],r=e.blacklistCurrentPlaylist;Jl(i,n);var a=n.activeTrack(),o=n.activeGroup(),s=(o.filter(function(t){return t.default})[0]||o[0]).id,c=n.tracks[s];if(a!==c){for(var l in Xo.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),n.tracks)n.tracks[l].enabled=n.tracks[l]===c;n.onTrackChanged()}else r({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(t,e){return function(){var i=e.segmentLoaders[t],n=e.mediaTypes[t];Xo.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),Jl(i,n);var r=n.activeTrack();r&&(r.mode="disabled"),n.onTrackChanged()}}},iu={AUDIO:function(t,e,i){if(e){var n=i.tech,r=i.requestOptions,a=i.segmentLoaders[t];e.on("loadedmetadata",function(){var t=e.media();a.playlist(t,r),(!n.paused()||t.endList&&"none"!==n.preload())&&a.load()}),e.on("loadedplaylist",function(){a.playlist(e.media(),r),n.paused()||a.load()}),e.on("error",eu[t](t,i))}},SUBTITLES:function(t,e,i){var n=i.tech,r=i.requestOptions,a=i.segmentLoaders[t],o=i.mediaTypes[t];e.on("loadedmetadata",function(){var t=e.media();a.playlist(t,r),a.track(o.activeTrack()),(!n.paused()||t.endList&&"none"!==n.preload())&&a.load()}),e.on("loadedplaylist",function(){a.playlist(e.media(),r),n.paused()||a.load()}),e.on("error",eu[t](t,i))}},nu=function(t,e){return function(i){return i.attributes[t]===e}},ru=function(t){return function(e){return e.resolvedUri===t}},au={AUDIO:function(t,e){var i=e.hls,n=e.sourceType,r=e.segmentLoaders[t],a=e.requestOptions.withCredentials,o=e.master,s=o.mediaGroups,c=o.playlists,l=e.mediaTypes[t],u=l.groups,h=l.tracks,d=e.masterPlaylistLoader;for(var p in s[t]&&0!==Object.keys(s[t]).length||(s[t]={main:{default:{default:!0}}}),s[t]){u[p]||(u[p]=[]);var f=c.filter(nu(t,p));for(var m in s[t][p]){var g=s[t][p][m],v=f.filter(ru(g.resolvedUri));v.length&&delete g.resolvedUri;var y=void 0;if(y=g.resolvedUri?new fs(g.resolvedUri,i,a):g.playlists&&"dash"===n?new al(g.playlists[0],i,a,d):null,g=Xo.mergeOptions({id:m,playlistLoader:y},g),iu[t](t,g.playlistLoader,e),u[p].push(g),"undefined"===typeof h[m]){var _=new Xo.AudioTrack({id:m,kind:Zl(g),enabled:!1,language:g.language,default:g.default,label:m});h[m]=_}}}r.on("error",eu[t](t,e))},SUBTITLES:function(t,e){var i=e.tech,n=e.hls,r=e.sourceType,a=e.segmentLoaders[t],o=e.requestOptions.withCredentials,s=e.master.mediaGroups,c=e.mediaTypes[t],l=c.groups,u=c.tracks,h=e.masterPlaylistLoader;for(var d in s[t])for(var p in l[d]||(l[d]=[]),s[t][d])if(!s[t][d][p].forced){var f=s[t][d][p],m=void 0;if("hls"===r?m=new fs(f.resolvedUri,n,o):"dash"===r&&(m=new al(f.playlists[0],n,o,h)),f=Xo.mergeOptions({id:p,playlistLoader:m},f),iu[t](t,f.playlistLoader,e),l[d].push(f),"undefined"===typeof u[p]){var g=i.addRemoteTextTrack({id:p,kind:"subtitles",default:f.default&&f.autoselect,language:f.language,label:p},!1).track;u[p]=g}}a.on("error",eu[t](t,e))},"CLOSED-CAPTIONS":function(t,e){var i=e.tech,n=e.master.mediaGroups,r=e.mediaTypes[t],a=r.groups,o=r.tracks;for(var s in n[t])for(var c in a[s]||(a[s]=[]),n[t][s]){var l=n[t][s][c];if(l.instreamId.match(/CC\d/)&&(a[s].push(Xo.mergeOptions({id:c},l)),"undefined"===typeof o[c])){var u=i.addRemoteTextTrack({id:l.instreamId,kind:"captions",default:l.default&&l.autoselect,language:l.language,label:c},!1).track;o[c]=u}}}},ou=function(t,e){return function(i){var n=e.masterPlaylistLoader,r=e.mediaTypes[t].groups,a=n.media();if(!a)return null;var o=null;return a.attributes[t]&&(o=r[a.attributes[t]]),o=o||r.main,"undefined"===typeof i?o:null===i?null:o.filter(function(t){return t.id===i.id})[0]||null}},su={AUDIO:function(t,e){return function(){var i=e.mediaTypes[t].tracks;for(var n in i)if(i[n].enabled)return i[n];return null}},SUBTITLES:function(t,e){return function(){var i=e.mediaTypes[t].tracks;for(var n in i)if("showing"===i[n].mode)return i[n];return null}}},cu=function(t){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){au[e](e,t)});var e=t.mediaTypes,i=t.masterPlaylistLoader,n=t.tech,r=t.hls;["AUDIO","SUBTITLES"].forEach(function(i){e[i].activeGroup=ou(i,t),e[i].activeTrack=su[i](i,t),e[i].onGroupChanged=Ql(i,t),e[i].onTrackChanged=tu(i,t)});var a=e.AUDIO.activeGroup(),o=(a.filter(function(t){return t.default})[0]||a[0]).id;e.AUDIO.tracks[o].enabled=!0,e.AUDIO.onTrackChanged(),i.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(t){return e[t].onGroupChanged()})});var s=function(){e.AUDIO.onTrackChanged(),n.trigger({type:"usage",name:"hls-audio-change"})};for(var c in n.audioTracks().addEventListener("change",s),n.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),r.on("dispose",function(){n.audioTracks().removeEventListener("change",s),n.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),n.clearTracks("audio"),e.AUDIO.tracks)n.audioTracks().addTrack(e.AUDIO.tracks[c])},lu=function(){var t={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:sl,activeTrack:sl,onGroupChanged:sl,onTrackChanged:sl}}),t},uu=120,hu=void 0,du=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],pu=function(t){return this.audioSegmentLoader_[t]+this.mainSegmentLoader_[t]},fu=function(t){function e(t){Ko(this,e);var i=is(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),n=t.url,r=t.withCredentials,a=t.tech,o=t.bandwidth,s=t.externHls,c=t.useCueTags,l=t.blacklistDuration,u=t.enableLowInitialPlaylist,h=t.sourceType,d=t.seekTo;if(!n)throw new Error("A non-empty playlist URL is required");hu=s,i.withCredentials=r,i.tech_=a,i.hls_=a.hls,i.seekTo_=d,i.sourceType_=h,i.useCueTags_=c,i.blacklistDuration=l,i.enableLowInitialPlaylist=u,i.useCueTags_&&(i.cueTagsTrack_=i.tech_.addTextTrack("metadata","ad-cues"),i.cueTagsTrack_.inBandMetadataTrackDispatchType=""),i.requestOptions_={withCredentials:i.withCredentials,timeout:null},i.mediaTypes_=lu(),i.mediaSource=new Xo.MediaSource,i.mediaSource.addEventListener("sourceopen",i.handleSourceOpen_.bind(i)),i.seekable_=Xo.createTimeRanges(),i.hasPlayed_=function(){return!1},i.syncController_=new Xl(t),i.segmentMetadataTrack_=a.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,i.decrypter_=new $l,i.inbandTextTracks_={};var p={hls:i.hls_,mediaSource:i.mediaSource,currentTime:i.tech_.currentTime.bind(i.tech_),seekable:function(){return i.seekable()},seeking:function(){return i.tech_.seeking()},duration:function(){return i.mediaSource.duration},hasPlayed:function(){return i.hasPlayed_()},goalBufferLength:function(){return i.goalBufferLength()},bandwidth:o,syncController:i.syncController_,decrypter:i.decrypter_,sourceType:i.sourceType_,inbandTextTracks:i.inbandTextTracks_};return i.masterPlaylistLoader_="dash"===i.sourceType_?new al(n,i.hls_,i.withCredentials):new fs(n,i.hls_,i.withCredentials),i.setupMasterPlaylistLoaderListeners_(),i.mainSegmentLoader_=new zl(Xo.mergeOptions(p,{segmentMetadataTrack:i.segmentMetadataTrack_,loaderType:"main"}),t),i.audioSegmentLoader_=new zl(Xo.mergeOptions(p,{loaderType:"audio"}),t),i.subtitleSegmentLoader_=new Gl(Xo.mergeOptions(p,{loaderType:"vtt"}),t),i.setupSegmentLoaderListeners_(),du.forEach(function(t){i[t+"_"]=pu.bind(i,t)}),i.logger_=ol("MPC"),i.masterPlaylistLoader_.load(),i}return es(e,t),Qo(e,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var t=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var e=t.masterPlaylistLoader_.media(),i=1.5*t.masterPlaylistLoader_.targetDuration*1e3;Ns(t.masterPlaylistLoader_.master,t.masterPlaylistLoader_.media())?t.requestOptions_.timeout=0:t.requestOptions_.timeout=i,e.endList&&"none"!==t.tech_.preload()&&(t.mainSegmentLoader_.playlist(e,t.requestOptions_),t.mainSegmentLoader_.load()),cu({sourceType:t.sourceType_,segmentLoaders:{AUDIO:t.audioSegmentLoader_,SUBTITLES:t.subtitleSegmentLoader_,main:t.mainSegmentLoader_},tech:t.tech_,requestOptions:t.requestOptions_,masterPlaylistLoader:t.masterPlaylistLoader_,hls:t.hls_,master:t.master(),mediaTypes:t.mediaTypes_,blacklistCurrentPlaylist:t.blacklistCurrentPlaylist.bind(t)}),t.triggerPresenceUsage_(t.master(),e);try{t.setupSourceBuffers_()}catch(Ph){return Xo.log.warn("Failed to create SourceBuffers",Ph),t.mediaSource.endOfStream("decode")}t.setupFirstPlay(),t.trigger("selectedinitialmedia")}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var e=t.masterPlaylistLoader_.media();if(!e){t.excludeUnsupportedVariants_();var i=void 0;return t.enableLowInitialPlaylist&&(i=t.selectInitialPlaylist()),i||(i=t.selectPlaylist()),t.initialMedia_=i,void t.masterPlaylistLoader_.media(t.initialMedia_)}if(t.useCueTags_&&t.updateAdCues_(e),t.mainSegmentLoader_.playlist(e,t.requestOptions_),t.updateDuration(),t.tech_.paused()||(t.mainSegmentLoader_.load(),t.audioSegmentLoader_&&t.audioSegmentLoader_.load()),!e.endList){var n=function(){var e=t.seekable();0!==e.length&&t.mediaSource.addSeekableRange_(e.start(0),e.end(0))};if(t.duration()!==1/0){var r=function e(){t.duration()===1/0?n():t.tech_.one("durationchange",e)};t.tech_.one("durationchange",r)}else n()}}),this.masterPlaylistLoader_.on("error",function(){t.blacklistCurrentPlaylist(t.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){t.mainSegmentLoader_.abort(),t.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var e=t.masterPlaylistLoader_.media(),i=1.5*t.masterPlaylistLoader_.targetDuration*1e3;Ns(t.masterPlaylistLoader_.master,t.masterPlaylistLoader_.media())?t.requestOptions_.timeout=0:t.requestOptions_.timeout=i,t.mainSegmentLoader_.playlist(e,t.requestOptions_),t.mainSegmentLoader_.load(),t.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var e=t.masterPlaylistLoader_.media(),i=t.stuckAtPlaylistEnd_(e);i&&(t.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),t.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){t.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){t.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(t,e){var i=t.mediaGroups||{},n=!0,r=Object.keys(i.AUDIO);for(var a in i.AUDIO)for(var o in i.AUDIO[a]){var s=i.AUDIO[a][o];s.uri||(n=!1)}n&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(i.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),hu.Playlist.isAes(e)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),hu.Playlist.isFmp4(e)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),r.length&&Object.keys(i.AUDIO[r[0]]).length>1&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var t=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var e=t.selectPlaylist(),i=t.masterPlaylistLoader_.media(),n=t.tech_.buffered(),r=n.length?n.end(n.length-1)-t.tech_.currentTime():0,a=t.bufferLowWaterLine();(!i.endList||t.duration()<ll.MAX_BUFFER_LOW_WATER_LINE||e.attributes.BANDWIDTH<i.attributes.BANDWIDTH||r>=a)&&t.masterPlaylistLoader_.media(e),t.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){t.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){t.blacklistCurrentPlaylist(t.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("syncinfoupdate",function(){t.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){t.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){t.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("ended",function(){t.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(){t.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},uu)}),this.mainSegmentLoader_.on("reseteverything",function(){t.tech_.trigger("hls-reset")}),this.mainSegmentLoader_.on("segmenttimemapping",function(e){t.tech_.trigger({type:"hls-segment-time-mapping",mapping:e.mapping})}),this.audioSegmentLoader_.on("ended",function(){t.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"smoothQualityChange_",value:function(){var t=this.selectPlaylist();t!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.resetLoader())}},{key:"fastQualityChange_",value:function(){var t=this,e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetEverything(function(){Xo.browser.IE_VERSION||Xo.browser.IS_EDGE?t.tech_.setCurrentTime(t.tech_.currentTime()+.04):t.tech_.setCurrentTime(t.tech_.currentTime())}))}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.seekTo_(0),this.hasPlayed_()&&this.load();var t=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<t.start(0)?this.seekTo_(t.end(t.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var t=this,e=this.masterPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_())return!1;if(!e.endList){var i=this.seekable();if(!i.length)return!1;if(Xo.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",function(){t.trigger("firstplay"),t.seekTo_(i.end(0)),t.hasPlayed_=function(){return!0}}),!1;this.trigger("firstplay"),this.seekTo_(i.end(0))}return this.hasPlayed_=function(){return!0},this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(Ph){return Xo.log.warn("Failed to create Source Buffers",Ph),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var t=this.tech_.play();"undefined"!==typeof t&&"function"===typeof t.then&&t.then(null,function(t){})}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var t=this.mainSegmentLoader_.ended_;this.mediaTypes_.AUDIO.activePlaylistLoader&&(t=!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?t&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),t&&this.mediaSource.endOfStream()}},{key:"stuckAtPlaylistEnd_",value:function(t){var e=this.seekable();if(!e.length)return!1;var i=this.syncController_.getExpiredTime(t,this.mediaSource.duration);if(null===i)return!1;var n=hu.Playlist.playlistEnd(t,i),r=this.tech_.currentTime(),a=this.tech_.buffered();if(!a.length)return n-r<=oc;var o=a.end(a.length-1);return o-r<=oc&&n-o<=oc}},{key:"blacklistCurrentPlaylist",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],i=void 0,n=void 0;if(i=t.playlist||this.masterPlaylistLoader_.media(),e=e||t.blacklistDuration||this.blacklistDuration,!i){this.error=t;try{return this.mediaSource.endOfStream("network")}catch(Ph){return this.trigger("error")}}var r=1===this.masterPlaylistLoader_.master.playlists.filter(Ps).length;return r?(Xo.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the final playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(r)):(i.excludeUntil=Date.now()+1e3*e,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),n=this.selectPlaylist(),Xo.log.warn("Problem encountered with the current HLS playlist."+(t.message?" "+t.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(n))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(t){var e=cc(this.tech_.buffered(),t);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?e&&e.length?t:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:hu.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var t=void 0,e=void 0;if(this.masterPlaylistLoader_){var i=this.masterPlaylistLoader_.media();if(i){var n=this.syncController_.getExpiredTime(i,this.mediaSource.duration);if(null!==n&&(t=hu.Playlist.seekable(i,n),0!==t.length)){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(i=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),n=this.syncController_.getExpiredTime(i,this.mediaSource.duration),null===n)return;if(e=hu.Playlist.seekable(i,n),0===e.length)return}e?e.start(0)>t.end(0)||t.start(0)>e.end(0)?this.seekable_=t:this.seekable_=Xo.createTimeRanges([[e.start(0)>t.start(0)?e.start(0):t.start(0),e.end(0)<t.end(0)?e.end(0):t.end(0)]]):this.seekable_=t,this.logger_("seekable updated ["+hc(this.seekable_)+"]"),this.tech_.trigger("seekablechanged")}}}}},{key:"updateDuration",value:function(){var t=this,e=this.mediaSource.duration,i=hu.Playlist.duration(this.masterPlaylistLoader_.media()),n=this.tech_.buffered(),r=function e(){t.mediaSource.duration=i,t.tech_.trigger("durationchange"),t.mediaSource.removeEventListener("sourceopen",e)};n.length>0&&(i=Math.max(i,n.end(n.length-1))),e!==i&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",r):r())}},{key:"dispose",value:function(){var t=this;this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach(function(e){var i=t.mediaTypes_[e].groups;for(var n in i)i[n].forEach(function(t){t.playlistLoader&&t.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var t=this.masterPlaylistLoader_.media(),e=void 0;if(t&&"open"===this.mediaSource.readyState){if(e=zc(this.masterPlaylistLoader_.master,t),e.length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+t.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(e),this.excludeIncompatibleVariants_(t)}}},{key:"configureLoaderMimeTypes_",value:function(t){var e=t.length>1&&-1===t[0].indexOf(",")&&t[0]!==t[1]?new Xo.EventTarget:null;this.mainSegmentLoader_.mimeType(t[0],e),t[1]&&this.audioSegmentLoader_.mimeType(t[1],e)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach(function(t){t.attributes.CODECS&&xt.a.MediaSource&&xt.a.MediaSource.isTypeSupported&&!xt.a.MediaSource.isTypeSupported('video/mp4; codecs="'+Dc(t.attributes.CODECS)+'"')&&(t.excludeUntil=1/0)})}},{key:"excludeIncompatibleVariants_",value:function(t){var e=2,i=null,n=void 0;t.attributes.CODECS&&(n=Ic(t.attributes.CODECS),i=n.videoCodec,e=n.codecCount),this.master().playlists.forEach(function(t){var n={codecCount:2,videoCodec:null};t.attributes.CODECS&&(n=Ic(t.attributes.CODECS)),n.codecCount!==e&&(t.excludeUntil=1/0),n.videoCodec!==i&&(t.excludeUntil=1/0)})}},{key:"updateAdCues_",value:function(t){var e=0,i=this.seekable();i.length&&(e=i.start(0)),Wl(t,this.cueTagsTrack_,e)}},{key:"goalBufferLength",value:function(){var t=this.tech_.currentTime(),e=ll.GOAL_BUFFER_LENGTH,i=ll.GOAL_BUFFER_LENGTH_RATE,n=Math.max(e,ll.MAX_GOAL_BUFFER_LENGTH);return Math.min(e+t*i,n)}},{key:"bufferLowWaterLine",value:function(){var t=this.tech_.currentTime(),e=ll.BUFFER_LOW_WATER_LINE,i=ll.BUFFER_LOW_WATER_LINE_RATE,n=Math.max(e,ll.MAX_BUFFER_LOW_WATER_LINE);return Math.min(e+t*i,n)}}]),e}(Xo.EventTarget),mu=function(t,e,i){return function(n){var r=t.master.playlists[e],a=Ls(r),o=Ps(r);return"undefined"===typeof n?o:(n?delete r.disabled:r.disabled=!0,n===o||a||(i(),n?t.trigger("renditionenabled"):t.trigger("renditiondisabled")),n)}},gu=function t(e,i,n){Ko(this,t);var r=e.masterPlaylistController_,a=e.options_.smoothQualityChange,o=a?"smooth":"fast",s=r[o+"QualityChange_"].bind(r);if(i.attributes.RESOLUTION){var c=i.attributes.RESOLUTION;this.width=c.width,this.height=c.height}this.bandwidth=i.attributes.BANDWIDTH,this.id=n,this.enabled=mu(e.playlists,i.uri,s)},vu=function(t){var e=t.playlists;t.representations=function(){return e.master.playlists.filter(function(t){return!Ls(t)}).map(function(e,i){return new gu(t,e,e.uri)})}},yu=["seeking","seeked","pause","playing","error"],_u=function(){function t(e){var i=this;Ko(this,t),this.tech_=e.tech,this.seekable=e.seekable,this.seekTo=e.seekTo,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=ol("PlaybackWatcher"),this.logger_("initialize");var n=function(){return i.monitorCurrentTime_()},r=function(){return i.techWaiting_()},a=function(){return i.cancelTimer_()},o=function(){return i.fixesBadSeeks_()};this.tech_.on("seekablechanged",o),this.tech_.on("waiting",r),this.tech_.on(yu,a),this.tech_.on("canplay",n),this.dispose=function(){i.logger_("dispose"),i.tech_.off("seekablechanged",o),i.tech_.off("waiting",r),i.tech_.off(yu,a),i.tech_.off("canplay",n),i.checkCurrentTimeTimeout_&&xt.a.clearTimeout(i.checkCurrentTimeTimeout_),i.cancelTimer_()}}return Qo(t,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&xt.a.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=xt.a.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var t=this.tech_.currentTime(),e=this.tech_.buffered();if(this.lastRecordedTime===t&&(!e.length||t+oc>=e.end(e.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&t===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):t===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=t)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){var t=this.tech_.seeking(),e=this.seekable(),i=this.tech_.currentTime(),n=void 0;if(t&&this.afterSeekableWindow_(e,i)){var r=e.end(e.length-1);n=r}if(t&&this.beforeSeekableWindow_(e,i)){var a=e.start(0);n=a+oc}return"undefined"!==typeof n&&(this.logger_("Trying to seek outside of seekable at time "+i+" with seekable range "+hc(e)+". Seeking to "+n+"."),this.seekTo(n),!0)}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var t=this.tech_.currentTime(),e=this.tech_.buffered(),i=cc(e,t);return i.length&&t+3<=i.end(0)?(this.cancelTimer_(),this.seekTo(t),this.logger_("Stopped at "+t+" while inside a buffered region ["+i.start(0)+" -> "+i.end(0)+"]. Attempting to resume playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function(){var t=this.seekable(),e=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(t,e)){var i=t.end(t.length-1);return this.logger_("Fell out of live window at time "+e+". Seeking to live point (seekable end) "+i),this.cancelTimer_(),this.seekTo(i),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var n=this.tech_.buffered(),r=lc(n,e);if(this.videoUnderflow_(r,n,e))return this.cancelTimer_(),this.seekTo(e),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(r.length>0){var a=r.start(0)-e;return this.logger_("Stopped at "+e+", setting timer for "+a+", seeking to "+r.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*a,e),!0}return!1}},{key:"afterSeekableWindow_",value:function(t,e){return!!t.length&&e>t.end(t.length-1)+oc}},{key:"beforeSeekableWindow_",value:function(t,e){return!!(t.length&&t.start(0)>0&&e<t.start(0)-oc)}},{key:"videoUnderflow_",value:function(t,e,i){if(0===t.length){var n=this.gapFromVideoUnderflow_(e,i);if(n)return this.logger_("Encountered a gap in video from "+n.start+" to "+n.end+". Seeking to current time "+i),!0}return!1}},{key:"skipTheGap_",value:function(t){var e=this.tech_.buffered(),i=this.tech_.currentTime(),n=lc(e,i);this.cancelTimer_(),0!==n.length&&i===t&&(this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",t,"nextRange start:",n.start(0)),this.seekTo(n.start(0)+ac),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(t,e){for(var i=uc(t),n=0;n<i.length;n++){var r=i.start(n),a=i.end(n);if(e-r<4&&e-r>2)return{start:r,end:a}}return null}}]),t}(),bu={errorInterval:30,getSource:function(t){var e=this.tech({IWillNotUseThisInPlugins:!0}),i=e.currentSource_;return t(i)}},wu=function t(e,i){var n=0,r=0,a=Xo.mergeOptions(bu,i);e.ready(function(){e.trigger({type:"usage",name:"hls-error-reload-initialized"})});var o=function(){r&&e.currentTime(r)},s=function(t){null!==t&&void 0!==t&&(r=e.duration()!==1/0&&e.currentTime()||0,e.one("loadedmetadata",o),e.src(t),e.trigger({type:"usage",name:"hls-error-reload"}),e.play())},c=function(){if(Date.now()-n<1e3*a.errorInterval)e.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(a.getSource&&"function"===typeof a.getSource)return n=Date.now(),a.getSource.call(e,s);Xo.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},l=function t(){e.off("loadedmetadata",o),e.off("error",c),e.off("dispose",t)},u=function(i){l(),t(e,i)};e.on("error",c),e.on("dispose",l),e.reloadSourceOnError=u},Tu=function(t){wu(this,t)},xu="1.5.1";Xo.use("*",function(t){return{setSource:function(t,e){e(null,t)},setCurrentTime:function(e){return t.vhs&&t.currentSource().src===t.vhs.source_.src&&t.vhs.setCurrentTime(e),e},play:function(){t.vhs&&t.currentSource().src===t.vhs.source_.src&&t.vhs.setCurrentTime(t.currentTime())}}});var Su={PlaylistLoader:fs,Playlist:Bs,Decrypter:te,AsyncStream:Jt,decrypt:Qt,utils:Zs,STANDARD_PLAYLIST_SELECTOR:kl,INITIAL_PLAYLIST_SELECTOR:Pl,comparePlaylistBandwidth:Ml,comparePlaylistResolution:Cl,xhr:js()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(t){Object.defineProperty(Su,t,{get:function(){return Xo.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),ll[t]},set:function(e){Xo.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),"number"!==typeof e||e<0?Xo.log.warn("value of Hls."+t+" must be greater than or equal to 0"):ll[t]=e}})});var Eu="videojs-vhs",Mu=function(t){var e=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i;if(e.test(t))return"hls";var i=/^application\/dash\+xml/i;return i.test(t)?"dash":null},Cu=function(t,e){for(var i=e.media(),n=-1,r=0;r<t.length;r++)if(t[r].id===i.uri){n=r;break}t.selectedIndex_=n,t.trigger({selectedIndex:n,type:"change"})},Au=function(t,e){e.representations().forEach(function(e){t.addQualityLevel(e)}),Cu(t,e.playlists)};Su.canPlaySource=function(){return Xo.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var ku=function(t,e,i){if(!t)return t;var n={};for(var r in t)n[r]={audioContentType:'audio/mp4; codecs="'+i.attributes.CODECS+'"',videoContentType:'video/mp4; codecs="'+e.attributes.CODECS+'"'},e.contentProtection&&e.contentProtection[r]&&e.contentProtection[r].pssh&&(n[r].pssh=e.contentProtection[r].pssh),"string"===typeof t[r]&&(n[r].url=t[r]);return Xo.mergeOptions(t,n)},Lu=function(t){if("dash"===t.options_.sourceType){var e=Xo.players[t.tech_.options_.playerId];if(e.eme){var i=ku(t.source_.keySystems,t.playlists.media(),t.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());i&&(e.currentSource().keySystems=i,e.eme.initializeMediaKeys&&e.eme.initializeMediaKeys())}}},Pu=function(){if(!window.localStorage)return null;var t=window.localStorage.getItem(Eu);if(!t)return null;try{return JSON.parse(t)}catch(Ph){return null}},Ou=function(t){if(!window.localStorage)return!1;var e=Pu();e=e?Xo.mergeOptions(e,t):t;try{window.localStorage.setItem(Eu,JSON.stringify(e))}catch(Ph){return!1}return e};Su.supportsNativeHls=function(){var t=Dt.a.createElement("video");if(!Xo.getTech("Html5").isSupported())return!1;var e=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return e.some(function(e){return/maybe|probably/i.test(t.canPlayType(e))})}(),Su.supportsNativeDash=function(){return!!Xo.getTech("Html5").isSupported()&&/maybe|probably/i.test(Dt.a.createElement("video").canPlayType("application/dash+xml"))}(),Su.supportsTypeNatively=function(t){return"hls"===t?Su.supportsNativeHls:"dash"===t&&Su.supportsNativeDash},Su.isSupported=function(){return Xo.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Ru=Xo.getComponent("Component"),Iu=function(t){function e(t,i,n){Ko(this,e);var r=is(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i,n.hls));if(i.options_&&i.options_.playerId){var a=Xo(i.options_.playerId);a.hasOwnProperty("hls")||Object.defineProperty(a,"hls",{get:function(){return Xo.log.warn("player.hls is deprecated. Use player.tech().hls instead."),i.trigger({type:"usage",name:"hls-player-access"}),r},configurable:!0}),a.vhs=r,a.dash=r,r.player_=a}if(r.tech_=i,r.source_=t,r.stats={},r.setOptions_(),r.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(r.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return r.on(Dt.a,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(t){var e=Dt.a.fullscreenElement||Dt.a.webkitFullscreenElement||Dt.a.mozFullScreenElement||Dt.a.msFullscreenElement;e&&e.contains(r.tech_.el())&&r.masterPlaylistController_.smoothQualityChange_()}),r.on(r.tech_,"seeking",function(){this.tech_.seeking()&&0===this.tech_.currentTime()&&this.tech_.player_.loop()&&this.setCurrentTime(0)}),r.on(r.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),r.on(r.tech_,"play",r.play),r}return es(e,t),Qo(e,[{key:"setOptions_",value:function(){var t=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage="undefined"!==typeof this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,"number"!==typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!==typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var e=Pu();e&&e.bandwidth&&(this.options_.bandwidth=e.bandwidth,this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),e&&e.throughput&&(this.options_.throughput=e.throughput,this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!==typeof this.options_.bandwidth&&(this.options_.bandwidth=ll.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===ll.INITIAL_BANDWIDTH,["withCredentials","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange"].forEach(function(e){"undefined"!==typeof t.source_[e]&&(t.options_[e]=t.source_[e])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions}},{key:"src",value:function(t,e){var i=this;t&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=Su,this.options_.sourceType=Mu(e),this.options_.seekTo=function(t){i.tech_.setCurrentTime(t),i.setCurrentTime(t)},this.masterPlaylistController_=new fu(this.options_),this.playbackWatcher_=new _u(Xo.mergeOptions(this.options_,{seekable:function(){return i.seekable()}})),this.masterPlaylistController_.on("error",function(){var t=Xo.players[i.tech_.options_.playerId];t.error(i.masterPlaylistController_.error)}),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):Su.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Su.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(t){this.masterPlaylistController_.selectPlaylist=t.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(t){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=t,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(t){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=t,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var t=1/(this.bandwidth||1),e=void 0;e=this.throughput>0?1/this.throughput:0;var i=Math.floor(1/(t+e));return i},set:function(){Xo.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return i.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return i.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return i.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return i.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return i.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return i.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return i.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return i.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return pc(i.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return i.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return i.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return i.tech_.name_},enumerable:!0},duration:{get:function(){return i.tech_.duration()},enumerable:!0},master:{get:function(){return i.playlists.master},enumerable:!0},playerDimensions:{get:function(){return i.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return pc(i.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return i.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){i.options_.useBandwidthFromLocalStorage&&Ou({bandwidth:i.bandwidth,throughput:Math.round(i.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){vu(i),Lu(i)}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.tech_.ready(function(){return i.setupQualityLevels_()}),this.tech_.el()&&this.tech_.src(Xo.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var t=this,e=Xo.players[this.tech_.options_.playerId];e&&e.qualityLevels&&(this.qualityLevels_=e.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){Au(t.qualityLevels_,t)}),this.playlists.on("mediachange",function(){Cu(t.qualityLevels_,t.playlists)}))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(t){this.masterPlaylistController_.setCurrentTime(t)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.hls&&delete this.tech_.hls,ts(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"dispose",this).call(this)}},{key:"convertToStreamTime",value:function(t,e){return nc({playlist:this.masterPlaylistController_.media(),time:t,callback:e})}},{key:"seekToStreamTime",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return rc({streamTime:t,playlist:this.masterPlaylistController_.media(),retryCount:n,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:e})}}]),e}(Ru),Du={name:"videojs-http-streaming",VERSION:xu,canHandleSource:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Xo.mergeOptions(Xo.options,e);return Du.canPlayType(t.type,i)},handleSource:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Xo.mergeOptions(Xo.options,i);return e.hls=new Iu(t,e,n),e.hls.xhr=js(),e.hls.src(t.src,t.type),e.hls},canPlayType:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Xo.mergeOptions(Xo.options,e),n=i.hls.overrideNative,r=Mu(t),a=r&&(!Su.supportsTypeNatively(r)||n);return a?"maybe":""}};"undefined"!==typeof Xo.MediaSource&&"undefined"!==typeof Xo.URL||(Xo.MediaSource=tl,Xo.URL=el),tl.supportsNativeMediaSources()&&Xo.getTech("Html5").registerSourceHandler(Du,0),Xo.HlsHandler=Iu,Xo.HlsSourceHandler=Du,Xo.Hls=Su,Xo.use||Xo.registerComponent("Hls",Su),Xo.options.hls=Xo.options.hls||{},Xo.registerPlugin?Xo.registerPlugin("reloadSourceOnError",Tu):Xo.plugin("reloadSourceOnError",Tu);var Uu=Xo,Nu={name:"ProductionCameraVideo",props:{url:{type:String}},mounted:function(){var t=this;t.$nextTick(function(){t.init()})},data:function(){return{videoId:"v"+Math.random(),ready:!1,player:null,containerHeight:0,width:0,height:0,playerOptions:{autoplay:!0,width:388,height:211,preload:"auto",language:"zh-CN",sources:[{type:"application/x-mpegURL",src:"http://hls01open.ys7.com/openlive/3cb95e485da24838ae7d65b99ff6cc27.m3u8"}],notSupportedMessage:"",html5:{hls:{withCredentials:!1}},controlBar:{fullscreenToggle:!0,remainingTimeDisplay:!1,timeDivider:!1,durationDisplay:!1}}}},methods:{init:function(){var t=this,e=t.getSize(),i=e.w,n=e.h;n<200?setTimeout(function(){t.init()},1200):t.initVideo(i,n)},initVideo:function(t,e){var i=this;i.containerHeight=e,i.width=t-10,i.height=e-10;var n=i.playerOptions;n.width=t-10,n.height=e-10;var r=document.getElementById(i.videoId);r.style.width=n.width+"px",r.style.height=n.height+"px",console.log("playerOptions....",n),i.$nextTick(function(){Uu(r,n)})},getSize:function(){var t=this,e=t.$refs.container,i=getComputedStyle(e,null),n=ht()(i.width)||0,r=.75*n;return{w:n,h:r}}}},Bu=Nu,Fu=Object(y["a"])(Bu,ct,lt,!1,null,null,null),zu=Fu.exports,ju=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"map-container",attrs:{id:"map-container"}})},Hu=[],Gu=(i("44a2"),{mapStyle:"amap://styles/darkblue",socketUrl:"",fm1MarkerImgUrl:{normal:"./images/fm1.png",active:"./images/fm1_active.png"},fm2MarkerImgUrl:{normal:"./images/fm2.png",active:"./images/fm2_active.png"},gunMarkerImgUrl:{normal:"./images/gun.png",active:"./images/gun_active.png"},wfMarkerImgUrl:{normal:"./images/wf.png",active:"./images/wf_active.png"},sphereMarkerImgUrl:{normal:"./images/sphere.png"},photoMarkerImgUrl:{normal:"./images/360.png"},iotMonitorMap:{center:[114.9,25.807761],zoom:9}}),Vu=[{featureType:"water",elementType:"all",stylers:{color:"#241c43"}},{featureType:"highway",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"highway",elementType:"geometry.stroke",stylers:{color:"#147a92"}},{featureType:"arterial",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"arterial",elementType:"geometry.stroke",stylers:{color:"#0b3d51"}},{featureType:"local",elementType:"geometry",stylers:{color:"#000000"}},{featureType:"land",elementType:"all",stylers:{color:"#102d56"}},{featureType:"railway",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"railway",elementType:"geometry.stroke",stylers:{color:"#08304b"}},{featureType:"subway",elementType:"geometry",stylers:{lightness:-70}},{featureType:"building",elementType:"geometry.fill",stylers:{color:"#000000"}},{featureType:"all",elementType:"labels.text.fill",stylers:{color:"#857f7f"}},{featureType:"all",elementType:"labels.text.stroke",stylers:{color:"#000000"}},{featureType:"building",elementType:"geometry",stylers:{color:"#022338"}},{featureType:"green",elementType:"geometry",stylers:{color:"#062032"}},{featureType:"boundary",elementType:"all",stylers:{color:"#1e1c1c"}},{featureType:"manmade",elementType:"geometry",stylers:{color:"#022338"}},{featureType:"poi",elementType:"all",stylers:{visibility:"off"}},{featureType:"all",elementType:"labels.icon",stylers:{visibility:"off"}},{featureType:"all",elementType:"labels.text.fill",stylers:{color:"#ffffff",visibility:"on"}}],Wu=h["a"].IOT,qu=Object(u["a"])(Wu).mapState,Yu="$store.state.".concat(Wu,".iotDatas"),Xu=null,$u=null,Zu=null,Ju=null,Ku=null,Qu=null,th=null,eh=null,ih=null,nh=null,rh={name:"ProductionMonitorMap",data:function(){return{map:null,mapReady:!1,markers:[]}},computed:Object(c["a"])({},qu(["iotDatas","currActive"])),watch:Object(x["a"])({},Yu,function(){this.addMarkers()}),mounted:function(){var t=this;t.$nextTick(function(){var e=new BMap.Map("map-container"),i=new BMap.Point(Gu.iotMonitorMap.center[0],Gu.iotMonitorMap.center[1]);e.centerAndZoom(i,Gu.iotMonitorMap.zoom),e.enableScrollWheelZoom(!0),e.setMapStyle({styleJson:Vu});var n=new BMap.Size(25,25);Xu=new BMap.Icon(Gu.fm1MarkerImgUrl.normal,n,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),$u=new BMap.Icon(Gu.fm1MarkerImgUrl.active,n,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),Zu=new BMap.Icon(Gu.fm2MarkerImgUrl.normal,n,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),Ju=new BMap.Icon(Gu.fm2MarkerImgUrl.active,n,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),Ku=new BMap.Icon(Gu.gunMarkerImgUrl.normal,n,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),Qu=new BMap.Icon(Gu.gunMarkerImgUrl.active,n,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),th=new BMap.Icon(Gu.wfMarkerImgUrl.normal,n,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),eh=new BMap.Icon(Gu.wfMarkerImgUrl.active,n,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),ih=new BMap.Icon(Gu.sphereMarkerImgUrl.normal,n,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),nh=new BMap.Icon(Gu.photoMarkerImgUrl.normal,n,{anchor:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),t.map=e,t.mapReady=!0,0!=t.iotDatas.length&&t.addMarkers()})},methods:{addMarkers:function(){var t=this,e=t.map;e&&(t.markers.length&&t.markers.forEach(function(t){e.removeOverlay(t)}),t.markers=t.iotDatas.map(function(e){return t.createMarker(e)}))},createMarker:function(t){var e=this,i=t.lng,n=t.lat,r=(t.id,t.type),a=new BMap.Point(i,n),o=null;r==l["a"].IOT_TYPE_FM1?o=t.isActive?$u:Xu:r==l["a"].IOT_TYPE_FM2?o=t.isActive?Ju:Zu:r==l["a"].IOT_TYPE_GUN?o=t.isActive?Qu:Ku:r==l["a"].IOT_TYPE_WF?o=t.isActive?eh:th:r==l["a"].IOT_TYPE_SPHERE?o=ih:r==l["a"].IOT_TYPE_360&&(o=nh);var s=new BMap.Marker(a,{icon:o});return e.map.addOverlay(s),s.self=t,s.addEventListener("click",function(t){e.doHandlerClickMarker(t.target.self,t.target)}),s},doHandlerClickMarker:function(t,e){var i=this,n=i.$store;if(!t.isActive){if(t.type==l["a"].IOT_TYPE_SPHERE||t.type==l["a"].IOT_TYPE_360)return n.commit("".concat(Wu,"/").concat(l["a"].IOT_CHANGE_FULL_STATE),{fullStateName:"photoViewerFullState",state:!0}),void n.commit(Wu+"/"+l["a"].CHANGE_PHOTO_VIEW_URL,t.photoViewUrl);for(var r=i.map,a=i.markers,o=i.currActive,s=null,c=null,u=0;u<a.length;)s=a[u].self.id,s==o.id||s==t.id?(s==o.id&&(c=a[u].self),r.removeOverlay(a[u]),a.splice(u,1)):u++;n.commit(Wu+"/"+l["a"].CHANGE_ACTIVE_MARKER,{id:t.id,type:t.type});var h=i.createMarker(c),d=i.createMarker(t);i.markers.push(h),i.markers.push(d),t.type==l["a"].IOT_TYPE_FM1?(n.dispatch(Wu+"/"+l["a"].GET_FM1_DATA),n.dispatch(Wu+"/"+l["a"].GET_FM1_CHART_DATA)):t.type==l["a"].IOT_TYPE_FM2?(n.dispatch(Wu+"/"+l["a"].GET_FM2_DATA),n.dispatch(Wu+"/"+l["a"].GET_FM2_CHART_DATA)):t.type==l["a"].IOT_TYPE_WF&&(n.dispatch(Wu+"/"+l["a"].GET_WF_DATA),n.dispatch(Wu+"/"+l["a"].GET_WF_CHART_DATA))}}}},ah=rh,oh=Object(y["a"])(ah,ju,Hu,!1,null,null,null),sh=oh.exports,ch=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search-wrap"},[n("div",{staticClass:"search-input"},[n("i",{staticClass:"iconfont"},[t._v("")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.curr,expression:"curr"}],attrs:{placeholder:"",type:"text",maxlength:"30"},domProps:{value:t.curr},on:{focus:function(e){return t.doFocusInput()},input:function(e){e.target.composing||(t.curr=e.target.value)}}}),n("button",{on:{click:function(e){return t.doSearch()}}},[t._v("")])]),n("div",{staticClass:"search-list",class:{active:t.showSearchList}},[n("div",{staticClass:"search-type"},[n("div",{class:{active:"FM1"==t.type},on:{click:function(e){return t.doSelectType("FM1")}}},[n("img",{attrs:{src:i("1edb")}}),t._v("FM1")]),n("div",{class:{active:"CAMERA"==t.type},on:{click:function(e){return t.doSelectType("CAMERA")}}},[n("img",{attrs:{src:i("75b6")}}),t._v("")])]),n("ul",{directives:[{name:"show",rawName:"v-show",value:t.cacheSearchList.length,expression:"cacheSearchList.length"}],staticClass:"search-history"},t._l(t.cacheSearchList,function(e){return n("li",{key:e},[t._v(t._s(e))])}),0),n("div",{directives:[{name:"show",rawName:"v-show",value:t.cacheSearchList.length,expression:"cacheSearchList.length"}],staticClass:"search-history-delete",on:{click:function(e){return t.doDel()}}},[t._v("")])])])},lh=[],uh={name:"ProductionMonitorSearch",data:function(){return{curr:"",type:"",showSearchList:!1,cacheSearchList:[]}},created:function(){},methods:{doSelectType:function(t){var e=this;e.type==t?e.type="":e.type=t},doFocusInput:function(){this.showSearchList=!1},doDel:function(){var t=this;t.cacheSearchList=[]},doSearch:function(){var t=this;t.showSearchList=!1}}},hh=uh,dh=Object(y["a"])(hh,ch,lh,!1,null,null,null),ph=dh.exports,fh=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Plane",{staticClass:"photo-viewer",attrs:{full:t.photoViewerFullState}},[i("PlaneTitle",[t._v("")]),i("div",{ref:"container",staticClass:"plane-content"}),i("PlaneTools",{attrs:{full:t.photoViewerFullState},on:{change:t.doFullStateChange}})],1)},mh=[],gh=i("b30d"),vh=i.n(gh),yh=h["a"].IOT,_h="photoViewerFullState",bh=Object(u["a"])(yh).mapState,wh=("$store.state.".concat(yh,".").concat(_h),"$store.state.".concat(yh,".photoViewUrl")),Th={name:"iot-photo-viewer",computed:Object(c["a"])({},bh(["photoViewerFullState","photoViewUrl"])),watch:Object(x["a"])({},wh,function(){this.doRefresh()}),data:function(){return{container:null,viewer:null}},mounted:function(){var t=this;t.$nextTick(function(){t.container=t.$refs.container,t.init()})},methods:{init:function(){var t=this,e=getComputedStyle(t.container,null),i=ht()(e.width),n=ht()(e.height);isNaN(i)||isNaN(n)?setTimeout(function(){t.init()},1e3):t.viewer=new vh.a({panorama:t.photoViewUrl,container:t.container,time_anim:!1,navbar:!0})},doRefresh:function(){var t=this;t.viewer&&t.viewer.setPanorama(t.photoViewUrl)},doFullStateChange:function(t){var e=this;e.$store.commit(yh+"/"+l["a"].IOT_CHANGE_FULL_STATE,{fullStateName:_h,state:t})}}},xh=Th,Sh=Object(y["a"])(xh,fh,mh,!1,null,null,null),Eh=Sh.exports,Mh=h["a"].IOT,Ch=Object(u["a"])(Mh).mapState,Ah={name:"iot-index",computed:Object(c["a"])({},Ch(["currActive","photoViewerFullState"])),components:{FM1Charts:D,FM2Charts:X,WFCharts:st,Map:sh,Search:ph,CameraVideo:zu,Amount:b,PhotoViewer:Eh},data:function(){return{types:l["a"]}},created:function(){var t=this,e=t.$store;e.commit(l["a"].SWITCH_LOADING,!1),e.dispatch(Mh+"/"+l["a"].GET_IOT_DATA)},beforeDestroy:function(){var t=this.$store;t.commit("".concat(Mh,"/").concat(l["a"].IOT_CHANGE_FULL_STATE),{fullStateName:"photoViewerFullState",state:!1})}},kh=Ah,Lh=(i("65dd"),Object(y["a"])(kh,o,s,!1,null,null,null));e["default"]=Lh.exports},f07d:function(t,e){var i="auto",n={"":1,lr:1,rl:1},r={start:1,middle:1,end:1,left:1,right:1};function a(t){if("string"!==typeof t)return!1;var e=n[t.toLowerCase()];return!!e&&t.toLowerCase()}function o(t){if("string"!==typeof t)return!1;var e=r[t.toLowerCase()];return!!e&&t.toLowerCase()}function s(t,e,n){this.hasBeenReset=!1;var r="",s=!1,c=t,l=e,u=n,h=null,d="",p=!0,f="auto",m="start",g=50,v="middle",y=50,_="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return r},set:function(t){r=""+t}},pauseOnExit:{enumerable:!0,get:function(){return s},set:function(t){s=!!t}},startTime:{enumerable:!0,get:function(){return c},set:function(t){if("number"!==typeof t)throw new TypeError("Start time must be set to a number.");c=t,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return l},set:function(t){if("number"!==typeof t)throw new TypeError("End time must be set to a number.");l=t,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return u},set:function(t){u=""+t,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return h},set:function(t){h=t,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return d},set:function(t){var e=a(t);if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");d=e,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return p},set:function(t){p=!!t,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return f},set:function(t){if("number"!==typeof t&&t!==i)throw new SyntaxError("An invalid number or illegal string was specified.");f=t,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return m},set:function(t){var e=o(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");m=e,this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return g},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");g=t,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return v},set:function(t){var e=o(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");v=e,this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return y},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");y=t,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return _},set:function(t){var e=o(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");_=e,this.hasBeenReset=!0}}}),this.displayState=void 0}s.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},t.exports=s},f41e:function(t,e,i){"use strict";var n,r,a,o,s,c,l,u,h,d,p,f,m,g,v,y,_,b,w,T,x,S,E,M,C,A,k,L,P,O,R,I,D,U,N,B,F=Math.pow(2,32)-1;(function(){var t;if(E={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!==typeof Uint8Array){for(t in E)E.hasOwnProperty(t)&&(E[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);M=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),A=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),C=new Uint8Array([0,0,0,1]),k=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),L=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),P={video:k,audio:L},I=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),R=new Uint8Array([0,0,0,0,0,0,0,0]),D=new Uint8Array([0,0,0,0,0,0,0,0]),U=D,N=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),B=D,O=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),n=function(t){var e,i,n,r=[],a=0;for(e=1;e<arguments.length;e++)r.push(arguments[e]);e=r.length;while(e--)a+=r[e].byteLength;for(i=new Uint8Array(a+8),n=new DataView(i.buffer,i.byteOffset,i.byteLength),n.setUint32(0,i.byteLength),i.set(t,4),e=0,a=8;e<r.length;e++)i.set(r[e],a),a+=r[e].byteLength;return i},r=function(){return n(E.dinf,n(E.dref,I))},a=function(t){return n(E.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))},o=function(){return n(E.ftyp,M,C,M,A)},y=function(t){return n(E.hdlr,P[t])},s=function(t){return n(E.mdat,t)},v=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);return t.samplerate&&(e[12]=t.samplerate>>>24&255,e[13]=t.samplerate>>>16&255,e[14]=t.samplerate>>>8&255,e[15]=255&t.samplerate),n(E.mdhd,e)},g=function(t){return n(E.mdia,v(t),y(t.type),l(t))},c=function(t){return n(E.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},l=function(t){return n(E.minf,"video"===t.type?n(E.vmhd,O):n(E.smhd,R),r(),b(t))},u=function(t,e){var i=[],r=e.length;while(r--)i[r]=T(e[r]);return n.apply(null,[E.moof,c(t)].concat(i))},h=function(t){var e=t.length,i=[];while(e--)i[e]=f(t[e]);return n.apply(null,[E.moov,p(4294967295)].concat(i).concat(d(t)))},d=function(t){var e=t.length,i=[];while(e--)i[e]=x(t[e]);return n.apply(null,[E.mvex].concat(i))},p=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return n(E.mvhd,e)},_=function(t){var e,i,r=t.samples||[],a=new Uint8Array(4+r.length);for(i=0;i<r.length;i++)e=r[i].flags,a[i+4]=e.dependsOn<<4|e.isDependedOn<<2|e.hasRedundancy;return n(E.sdtp,a)},b=function(t){return n(E.stbl,w(t),n(E.stts,B),n(E.stsc,U),n(E.stsz,N),n(E.stco,D))},function(){var t,e;w=function(i){return n(E.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===i.type?t(i):e(i))},t=function(t){var e,i=t.sps||[],r=t.pps||[],a=[],o=[];for(e=0;e<i.length;e++)a.push((65280&i[e].byteLength)>>>8),a.push(255&i[e].byteLength),a=a.concat(Array.prototype.slice.call(i[e]));for(e=0;e<r.length;e++)o.push((65280&r[e].byteLength)>>>8),o.push(255&r[e].byteLength),o=o.concat(Array.prototype.slice.call(r[e]));return n(E.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),n(E.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([i.length]).concat(a).concat([r.length]).concat(o))),n(E.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},e=function(t){return n(E.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelcount)>>8,255&t.channelcount,(65280&t.samplesize)>>8,255&t.samplesize,0,0,0,0,(65280&t.samplerate)>>8,255&t.samplerate,0,0]),a(t))}}(),m=function(t){var e=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return n(E.tkhd,e)},T=function(t){var e,i,r,a,o,s,c;return e=n(E.tfhd,new Uint8Array([0,0,0,58,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),s=Math.floor(t.baseMediaDecodeTime/(F+1)),c=Math.floor(t.baseMediaDecodeTime%(F+1)),i=n(E.tfdt,new Uint8Array([1,0,0,0,s>>>24&255,s>>>16&255,s>>>8&255,255&s,c>>>24&255,c>>>16&255,c>>>8&255,255&c])),o=92,"audio"===t.type?(r=S(t,o),n(E.traf,e,i,r)):(a=_(t),r=S(t,a.length+o),n(E.traf,e,i,r,a))},f=function(t){return t.duration=t.duration||4294967295,n(E.trak,m(t),g(t))},x=function(t){var e=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==t.type&&(e[e.length-1]=0),n(E.trex,e)},function(){var t,e,i;i=function(t,e){var i=0,n=0,r=0,a=0;return t.length&&(void 0!==t[0].duration&&(i=1),void 0!==t[0].size&&(n=2),void 0!==t[0].flags&&(r=4),void 0!==t[0].compositionTimeOffset&&(a=8)),[0,0,i|n|r|a,1,(4278190080&t.length)>>>24,(16711680&t.length)>>>16,(65280&t.length)>>>8,255&t.length,(4278190080&e)>>>24,(16711680&e)>>>16,(65280&e)>>>8,255&e]},e=function(t,e){var r,a,o,s;for(a=t.samples||[],e+=20+16*a.length,r=i(a,e),s=0;s<a.length;s++)o=a[s],r=r.concat([(4278190080&o.duration)>>>24,(16711680&o.duration)>>>16,(65280&o.duration)>>>8,255&o.duration,(4278190080&o.size)>>>24,(16711680&o.size)>>>16,(65280&o.size)>>>8,255&o.size,o.flags.isLeading<<2|o.flags.dependsOn,o.flags.isDependedOn<<6|o.flags.hasRedundancy<<4|o.flags.paddingValue<<1|o.flags.isNonSyncSample,61440&o.flags.degradationPriority,15&o.flags.degradationPriority,(4278190080&o.compositionTimeOffset)>>>24,(16711680&o.compositionTimeOffset)>>>16,(65280&o.compositionTimeOffset)>>>8,255&o.compositionTimeOffset]);return n(E.trun,new Uint8Array(r))},t=function(t,e){var r,a,o,s;for(a=t.samples||[],e+=20+8*a.length,r=i(a,e),s=0;s<a.length;s++)o=a[s],r=r.concat([(4278190080&o.duration)>>>24,(16711680&o.duration)>>>16,(65280&o.duration)>>>8,255&o.duration,(4278190080&o.size)>>>24,(16711680&o.size)>>>16,(65280&o.size)>>>8,255&o.size]);return n(E.trun,new Uint8Array(r))},S=function(i,n){return"audio"===i.type?t(i,n):e(i,n)}}(),t.exports={ftyp:o,mdat:s,moof:u,moov:h,initSegment:function(t){var e,i=o(),n=h(t);return e=new Uint8Array(i.byteLength+n.byteLength),e.set(i),e.set(n,i.byteLength),e}}},f45a:function(t,e){var i=9e4,n=function(t,e){"number"===typeof e.pts&&(void 0===t.timelineStartInfo.pts&&(t.timelineStartInfo.pts=e.pts),void 0===t.minSegmentPts?t.minSegmentPts=e.pts:t.minSegmentPts=Math.min(t.minSegmentPts,e.pts),void 0===t.maxSegmentPts?t.maxSegmentPts=e.pts:t.maxSegmentPts=Math.max(t.maxSegmentPts,e.pts)),"number"===typeof e.dts&&(void 0===t.timelineStartInfo.dts&&(t.timelineStartInfo.dts=e.dts),void 0===t.minSegmentDts?t.minSegmentDts=e.dts:t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),void 0===t.maxSegmentDts?t.maxSegmentDts=e.dts:t.maxSegmentDts=Math.max(t.maxSegmentDts,e.dts))},r=function(t){delete t.minSegmentDts,delete t.maxSegmentDts,delete t.minSegmentPts,delete t.maxSegmentPts},a=function(t,e){var n,r,a=t.minSegmentDts;return e||(a-=t.timelineStartInfo.dts),n=t.timelineStartInfo.baseMediaDecodeTime,n+=a,n=Math.max(0,n),"audio"===t.type&&(r=t.samplerate/i,n*=r,n=Math.floor(n)),n};t.exports={clearDtsInfo:r,calculateTrackBaseMediaDecodeTime:a,collectDtsInfo:n}},fb81:function(t,e,i){"use strict";var n=i("3cea");t.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},fbd3e:function(t,e,i){(function(e){var i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,n=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(t,e,i){if(i=i||{},t=t.trim(),e=e.trim(),!e){if(!i.alwaysNormalize)return t;var r=o.parseURL(t);if(!r)throw new Error("Error trying to parse base URL.");return r.path=o.normalizePath(r.path),o.buildURLFromParts(r)}var a=o.parseURL(e);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):e;var s=o.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var c=n.exec(s.path);s.netLoc=c[1],s.path=c[2]}s.netLoc&&!s.path&&(s.path="/");var l={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var u=s.path,h=u.substring(0,u.lastIndexOf("/")+1)+a.path;l.path=o.normalizePath(h)}else l.path=s.path,a.params||(l.params=s.params,a.query||(l.query=s.query));return null===l.path&&(l.path=i.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(l)},parseURL:function(t){var e=i.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){t=t.split("").reverse().join("").replace(r,"");while(t.length!==(t=t.replace(a,"")).length);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=o})()},fda1:function(t,e,i){"use strict";var n=i("2b42"),r=Object.prototype.toString,a=Object.prototype.hasOwnProperty,o=function(t,e,i){for(var n=0,r=t.length;n<r;n++)a.call(t,n)&&(null==i?e(t[n],n,t):e.call(i,t[n],n,t))},s=function(t,e,i){for(var n=0,r=t.length;n<r;n++)null==i?e(t.charAt(n),n,t):e.call(i,t.charAt(n),n,t)},c=function(t,e,i){for(var n in t)a.call(t,n)&&(null==i?e(t[n],n,t):e.call(i,t[n],n,t))},l=function(t,e,i){if(!n(e))throw new TypeError("iterator must be a function");var a;arguments.length>=3&&(a=i),"[object Array]"===r.call(t)?o(t,e,a):"string"===typeof t?s(t,e,a):c(t,e,a)};t.exports=l},feb9:function(t,e,i){var n=i("3a5b"),r=i("fda1"),a=function(t){return"[object Array]"===Object.prototype.toString.call(t)};t.exports=function(t){if(!t)return{};var e={};return r(n(t).split("\n"),function(t){var i=t.indexOf(":"),r=n(t.slice(0,i)).toLowerCase(),o=n(t.slice(i+1));"undefined"===typeof e[r]?e[r]=o:a(e[r])?e[r].push(o):e[r]=[e[r],o]}),e}}}]);