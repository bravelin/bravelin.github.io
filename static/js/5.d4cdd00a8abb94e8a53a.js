webpackJsonp([5],{gqMk:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={extends:n("3ErM").a,data:function(){return{offScreenCanvas:null}},mounted:function(){var e=this;e.$nextTick(function(){e.drawImg(),e.drawMagnifier()})},methods:{drawImg:function(){var e=this.$refs.c1,t=e.getContext("2d"),n=e.width,a=e.height,i=new Image;i.onload=function(){t.drawImage(i,0,0,n,a)},i.src="./static/img/1.jpeg"},drawMagnifier:function(){var e=this,t=e.$refs.c2,n=t.getContext("2d"),a=t.width,i=t.height;e.offScreenCanvas=document.createElement("canvas");var s=e.offScreenCanvas.getContext("2d");e.offScreenCanvas.width=a,e.offScreenCanvas.height=i;var o=new Image;o.onload=function(){n.drawImage(o,0,0,a,i),s.drawImage(o,0,0,a,i),e.addMagnifier(n,a,i,a/2,i/2,o)},o.src="./static/img/1.jpeg"},addMagnifier:function(e,t,n,a,i,s){e.save(),e.beginPath(),e.strokeStyle="#ffffff",e.lineWidth=2,e.shadowColor="rgba(0,0,0,0.8)",e.shadowOffsetX=8,e.shadowOffsetY=8,e.shadowBlur=10,e.arc(a,i,20,0,2*Math.PI,!0),e.stroke(),e.clip(),e.drawImage(this.offScreenCanvas,a-20/1.8,i-20/1.8,20/1.8*2,20/1.8*2,a-20,i-20,40,40),e.restore()},windowToCanvas:function(e,t,n){var a=e.getBoundingClientRect();return{x:(t-a.left)*(e.width/a.width),y:(n-a.top)*(e.height/a.height)}},doMouseMoveForMagnifier:function(e){var t=this,n=t.$refs.c2,a=n.getContext("2d"),i=n.width,s=n.height,o=new Image,r=t.windowToCanvas(n,e.clientX,e.clientY);o.onload=function(){a.clearRect(0,0,i,s),a.drawImage(o,0,0,i,s),t.addMagnifier(a,i,s,r.x,r.y,t.offScreenCanvas,o)},o.src="./static/img/1.jpeg"}}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page article"},[n("h2",{staticClass:"title"},[e._v("Canvas学习笔记之四：图像与视频")]),e._v(" "),n("div",{staticClass:"content"},[e._m(0),e._v(" "),n("h3",{staticClass:"title"},[e._v("图像的绘制")]),e._v(" "),n("p",[e._v("必须等待图片加载完成之后才能对其进行绘制，如果尚未完成加载，drawImage()方法将会失败，并且没有任何提示。通常绘制的方法会放在onload()回调函数中。")]),e._v(" "),n("p",[e._v("图像的绘制效果受制于阴影、剪辑区域、图像合成等因素。")]),e._v(" "),n("p",[e._v("drawImage()方法会将一幅图像绘制到canvas中，所绘的图像称之为“源图像”，绘制到的地方称之为“目标canvas”。drawImage()可以接收以下3套参数：")]),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),n("p",[e._v("第一个参数可以是图像对象，也可以是一个canvas对象，或者video视频对象。")]),e._v(" "),n("div",{staticClass:"exp"},[n("canvas",{ref:"c1",attrs:{width:"300",height:"200"}})]),e._v(" "),e._m(4),e._v(" "),e._m(5),e._v(" "),n("h3",{staticClass:"title"},[e._v("离屏Canvas")]),e._v(" "),n("p",[e._v("离屏Canavs通常用来存放临时性的图像信息：")]),e._v(" "),n("p",[e._v("1、创建用做离屏Canvas的元素；")]),e._v(" "),n("p",[e._v("2、设置离屏Canvas的宽度与高度；")]),e._v(" "),n("p",[e._v("3、在离屏Canvas中进行绘制；")]),e._v(" "),n("p",[e._v("4、将离屏Canvas的全部或者一部分内容复制到正在显示的Canvas中。")]),e._v(" "),n("div",{staticClass:"exp"},[n("canvas",{ref:"c2",attrs:{width:"300",height:"200"},on:{mousemove:e.doMouseMoveForMagnifier,touchmove:e.doMouseMoveForMagnifier}})]),e._v(" "),e._m(6),e._v(" "),n("p",[e._v("DOM结构：")]),e._v(" "),e._m(7),e._v(" "),n("p",[e._v("mousemove事件与touchmove事件处理：")]),e._v(" "),e._m(8)]),e._v(" "),n("footer",[e._v("2016年06月30日")]),e._v(" "),n("Comments"),e._v(" "),n("Catalog",{attrs:{catalog:e.catalog}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Canvas环境对象提供了4个用于绘制及操作图像的方法："),t("strong",[this._v("drawImage、putImageData、getImageData、createImageData")]),this._v("。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("drawImage(image, dx, dy)")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("drawImage(image, dx, dy, dw, dh)")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("drawImage(image, sx, sy, sw, sh, dx, dy, dw, dh)")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("pre",[t("code",[this._v("let that = this\nlet el = that.$refs.c1\nlet context = el.getContext('2d')\nlet w = el.width\nlet h = el.height\nlet img = new Image()\nimg.onload = function () { // 在image的onload事件中绘制\n    context.drawImage(img, 0, 0, w, h)\n}\nimg.src = './static/img/1.jpeg'")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("在使用drawImage方法时，务必保证所绘图片已经加载好了。")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("pre",[t("code",[this._v("drawMagnifier () {\n    let that = this\n    let el = that.$refs.c2\n    let context = el.getContext('2d')\n    let w = el.width\n    let h = el.height\n    that.offScreenCanvas = document.createElement('canvas')\n    let offScreenContext = that.offScreenCanvas.getContext('2d')\n    that.offScreenCanvas.width = w\n    that.offScreenCanvas.height = h\n    let img = new Image()\n    img.onload = function () {\n        context.drawImage(img, 0, 0, w, h)\n        offScreenContext.drawImage(img, 0, 0, w, h)\n        that.addMagnifier(context, w, h, w / 2, h / 2, img)\n    }\n    img.src = './static/img/1.jpeg'\n}\n// 绘制放大镜\naddMagnifier (context, w, h, x, y, img) {\n    const that = this\n    let scale = 1.8\n    let radius = 20\n    context.save()\n    context.beginPath()\n    context.strokeStyle = '#ffffff'\n    context.lineWidth = 2\n    context.shadowColor = 'rgba(0,0,0,0.8)'\n    context.shadowOffsetX = 8\n    context.shadowOffsetY = 8\n    context.shadowBlur = 10\n    context.arc(x, y, radius, 0, 2 * Math.PI, true)\n    context.stroke()\n    context.clip()\n    context.drawImage(that.offScreenCanvas, x - radius / scale, y - radius / scale, (radius / scale) * 2, (radius / scale) * 2, x - radius, y - radius, radius * 2, radius * 2)\n    context.restore()\n}")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("pre",[t("code",[this._v('<canvas ref="c2" width="300" height="200" @mousemove="doMouseMoveForMagnifier" @touchmove="doMouseMoveForMagnifier"></canvas>')])])},function(){var e=this.$createElement,t=this._self._c||e;return t("pre",[t("code",[this._v("doMouseMoveForMagnifier (e) {\n    const that = this\n    let el = that.$refs.c2\n    let context = el.getContext('2d')\n    let w = el.width\n    let h = el.height\n    let img = new Image()\n    let pos = that.windowToCanvas(el, e.clientX, e.clientY)\n    img.onload = function () {\n        context.clearRect(0, 0, w, h)\n        context.drawImage(img, 0, 0, w, h)\n        that.addMagnifier(context, w, h, pos.x, pos.y, that.offScreenCanvas, img)\n    }\n    img.src = './static/img/1.jpeg'\n}")])])}]};var s=n("Z0/y")(a,i,!1,function(e){n("oWBG")},"data-v-4deca1f8",null);t.default=s.exports},oWBG:function(e,t,n){var a=n("pSnk");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("FIqI")("3aeabfda",a,!0,{})},pSnk:function(e,t,n){(e.exports=n("UTlt")(!1)).push([e.i,"\n.exp[data-v-4deca1f8]{\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n}\ncanvas[data-v-4deca1f8]{\n    width: 300px;\n    height: 200px;\n    border: 1px solid #e0e0e0;\n    border-radius: 4px;\n}\n",""])}});