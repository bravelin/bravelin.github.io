webpackJsonp([4,42],{1:function(t,e){"use strict";t.exports={mounted:function(){this.$nextTick(function(){var t=document.querySelectorAll("code");if(t.length>0)for(var e=0;e<t.length;e++)hljs.highlightBlock(t[e])})}}},2:function(t,e,n){var r,i;r=n(1);var a=n(3);i=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(i=r=r.default),"function"==typeof i&&(i=i.options),i.render=a.render,i.staticRenderFns=a.staticRenderFns,t.exports=r},3:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},staticRenderFns:[]}},18:function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var i=n(2),a=r(i);t.exports={extends:a.default,data:function(){return{context:null,centerX:0,centerY:0,ringInnerRadius:150,ringOuterRadius:170,hourTickLen:10,minTickLen:5,lastTime:0}},mounted:function(){var t=this;t.$nextTick(function(){t.init()})},methods:{init:function(){var t=this,e=t.$refs,n=e.clock,r=e.grid,i=r.getBoundingClientRect(),a=.95*(i.right-i.left);a<400&&(n.style.width=a+"px",n.style.height=a+"px");var o=n.getAttribute("width"),c=n.getAttribute("height");t.centerX=o/2,t.centerY=c/2,t.context=n.getContext("2d"),t.startTimer()},startTimer:function(){var t=this,e=window.requestAnimationFrame||window.webkitRequestAnimationFrame;e(function(){t.drawClock(),t.startTimer()})},drawClock:function(){var t=this;parseInt(t.lastTime/1e3)!=parseInt(+new Date/1e3)&&(t.drawGrid(),t.drawCentroid(),t.drawRing(),t.drawTicks(),t.drawPoints())},drawGrid:function(){var t=this,e=t.context,n=e.canvas,r=n.width,i=n.height,a=10,o=10;e.clearRect(0,0,r,i),e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,0.05)",e.lineWidth=.5;for(var c=a+.5;c<r;c+=a)e.beginPath(),e.moveTo(c,0),e.lineTo(c,i),e.stroke();for(var s=o+.5;s<i;s+=o)e.beginPath(),e.moveTo(0,s),e.lineTo(r,s),e.stroke();e.restore()},drawCentroid:function(){var t=this,e=t.context;e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,0.3)",e.fillStyle="rgba(0,0,0,0.25)",e.arc(t.centerX,t.centerY,10,0,2*Math.PI,!0),e.stroke(),e.fill(),e.restore()},drawRing:function(){var t=this,e=t.context;e.save(),e.beginPath(),e.shadowColor="rgba(0,0,0,0.7)",e.shadowOffsetX=4,e.shadowOffsetY=4,e.shadowBlur=8,e.fillStyle="rgba(0,0,0,0.16)",e.strokeStyle="rgba(0,0,0,0.25)",e.arc(t.centerX,t.centerY,t.ringOuterRadius,0,2*Math.PI,!1),e.stroke(),e.strokeStyle="rgba(0,0,0,0.2)",e.arc(t.centerX,t.centerY,t.ringInnerRadius,0,2*Math.PI,!0),e.fill(),e.beginPath(),e.arc(t.centerX,t.centerY,t.ringInnerRadius,0,2*Math.PI,!0),e.stroke(),e.restore()},drawTicks:function(){var t=this,e=t.context,n=t.ringInnerRadius-t.hourTickLen,r=t.ringInnerRadius-t.minTickLen,i=Math.PI,a=-(i/2),o=2*i/48,c=0,s=0,l=0,h=0,d=a,u=void 0,x=void 0;e.save(),e.lineWidth=1,e.textAlign="center",e.textBaseline="middle",e.font="normal 12px 微软雅黑";for(var g=0;g<48;g++)u=g%4==0?n:r,e.lineWidth=g%4==0?2:1,e.strokeStyle="rgba(0,0,0,0.2)",c=t.centerX+Math.cos(d)*u,s=t.centerY+Math.sin(d)*u,l=t.centerX+Math.cos(d)*t.ringInnerRadius,h=t.centerY+Math.sin(d)*t.ringInnerRadius,e.beginPath(),e.moveTo(c,s),e.lineTo(l,h),e.stroke(),g%4==0&&(x=g/4,x=0==x?12:x,e.strokeStyle="rgba(0,0,0,0.5)",e.strokeText(x,t.centerX+Math.cos(d)*(u-10),t.centerY+Math.sin(d)*(u-10))),d+=o;e.restore()},drawPoints:function(){var t=this,e=t.context,n=Math.PI,r=new Date,i=r.getHours(),a=r.getMinutes(),o=r.getSeconds(),c=55,s=-(n/2)+2*n/12*(i%12),l=85,h=-(n/2)+2*n/60*a,d=115,u=-(n/2)+2*n/60*o;t.lastTime=r.getTime(),e.save(),e.lineCap="round",e.strokeStyle="rgba(0,0,0,0.5)",e.lineWidth=4,e.beginPath(),e.moveTo(t.centerX,t.centerY),e.lineTo(t.centerX+c*Math.cos(s),t.centerY+c*Math.sin(s)),e.stroke(),e.lineWidth=3,e.beginPath(),e.moveTo(t.centerX,t.centerY),e.lineTo(t.centerX+l*Math.cos(h),t.centerY+l*Math.sin(h)),e.stroke(),e.lineWidth=2,e.beginPath(),e.moveTo(t.centerX,t.centerY),e.lineTo(t.centerX+d*Math.cos(u),t.centerY+d*Math.sin(u)),e.stroke();var x=(i<10?"0"+i:i)+" : "+(a<10?"0"+a:a)+" : "+(o<10?"0"+o:o);e.font="normal 14px 微软雅黑",e.textAlign="center",e.textBaseline="middle",e.strokeStyle="rgba(0,0,0,0.5)",e.lineWidth=1,e.strokeText(x,t.centerX,t.centerY+45);var g=r.getMonth()+1,v=r.getDate(),f=r.getDay(),m=["日","一","二","三","四","五","六"];x=r.getFullYear()+" / "+(g<10?"0"+g:g)+" / "+(v<10?"0"+v:v)+" 星期"+m[f],e.strokeText(x,t.centerX,t.centerY+75),e.restore()}}}},62:function(t,e,n){e=t.exports=n(5)(),e.push([t.id,".exp[data-v-a3c29206]{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}div.exp>canvas.clock[data-v-a3c29206]{height:400px;width:400px;background:#fff}",""])},71:function(t,e,n){var r=n(62);"string"==typeof r&&(r=[[t.id,r,""]]);n(6)(r,{});r.locals&&(t.exports=r.locals)},80:function(t,e,n){var r,i;n(71),r=n(18);var a=n(160);i=r=r||{},"object"!=typeof r.default&&"function"!=typeof r.default||(i=r=r.default),"function"==typeof i&&(i=i.options),i.render=a.render,i.staticRenderFns=a.staticRenderFns,i._scopeId="data-v-a3c29206",t.exports=r},160:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page article"},[n("iframe",{staticStyle:{display:"none"},attrs:{frameborder:"no",border:"0",marginwidth:"0",marginheight:"0",width:"0",height:"0",src:"//music.163.com/outchain/player?type=2&id=25638325&auto=1&height=66"}}),t._v(" "),n("h2",{staticClass:"title"},[t._v("Canvas绘制的时钟")]),t._v(" "),n("div",{staticClass:"content"},[n("div",{ref:"grid",staticClass:"exp"},[n("canvas",{ref:"clock",staticClass:"clock",attrs:{width:"400",height:"400"}})]),t._v(" "),n("h3",{staticClass:"title"},[t._v("The Code")]),t._v(" "),n("p",[t._v("data定义：")]),t._v(" "),t._m(0),t._v(" "),n("p",[t._v("初始化部分：")]),t._v(" "),t._m(1),t._v(" "),n("p",[t._v("绘制整个时钟的方法：")]),t._v(" "),t._m(2),t._v(" "),n("p",[t._v("随着时间重绘：")]),t._v(" "),t._m(3),t._v(" "),n("p",[t._v("绘制底层网格：")]),t._v(" "),t._m(4),t._v(" "),n("p",[t._v("绘制中心点：")]),t._v(" "),t._m(5),t._v(" "),n("p",[t._v("绘制圆环：")]),t._v(" "),t._m(6),t._v(" "),n("p",[t._v("绘制刻度：")]),t._v(" "),t._m(7),t._v(" "),n("p",[t._v("绘制指针以及时间文本：")]),t._v(" "),t._m(8)]),t._v(" "),n("footer",[t._v("2017年06月17日")]),t._v(" "),n("comments")],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("data () {\n    return {\n        context: null,\n        centerX: 0, // 中心点\n        centerY: 0,\n        ringInnerRadius: 150, // 内圆环半径\n        ringOuterRadius: 170, // 外圆环半径\n        hourTickLen: 10, // 大刻度长度\n        minTickLen: 5, // 小刻度长度\n        lastTime: 0 // 上次的时间\n    }\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("init () {\n    let that = this\n    let refs = that.$refs\n    let el = refs.clock\n    let box = refs.grid\n    let rect = box.getBoundingClientRect()\n    let w = (rect.right - rect.left) * 0.95\n    if (w < 400) {\n        el.style.width = w + 'px'\n        el.style.height = w + 'px'\n    }\n    let canvasWidth = el.getAttribute('width')\n    let canvasHeight = el.getAttribute('height')\n    that.centerX = canvasWidth / 2\n    that.centerY = canvasHeight / 2\n    that.context = el.getContext('2d')\n    that.startTimer()\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawClock () {\n    let that = this\n    if (parseInt(that.lastTime / 1000) != parseInt((+new Date()) / 1000)) {\n        that.drawGrid()\n        that.drawCentroid()\n        that.drawRing()\n        that.drawTicks()\n        that.drawPoints()\n    }\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("startTimer () {\n    let that = this\n    let requestAnimationFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame\n    requestAnimationFrame(function () {\n        that.drawClock()\n        that.startTimer()\n    })\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawGrid () {\n    let that = this\n    let context = that.context\n    let el = context.canvas\n    let w = el.width\n    let h = el.height\n    let stepX = 10\n    let stepY = 10\n\n    context.clearRect(0, 0, w, h)\n    context.save()\n    context.beginPath()\n    context.strokeStyle = 'rgba(0,0,0,0.05)'\n    context.lineWidth = 0.5\n    for (let i = stepX + 0.5; i < w; i += stepX) {\n        context.beginPath()\n        context.moveTo(i, 0)\n        context.lineTo(i, h)\n        context.stroke()\n    }\n\n    for (let j = stepY + 0.5; j < h; j += stepY) {\n        context.beginPath()\n        context.moveTo(0, j)\n        context.lineTo(w, j)\n        context.stroke()\n    }\n    context.restore()\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawCentroid () {\n    let that = this\n    let context = that.context\n    context.save()\n    context.beginPath()\n    context.strokeStyle = 'rgba(0,0,0,0.3)'\n    context.fillStyle = 'rgba(0,0,0,0.25)'\n    context.arc(that.centerX, that.centerY, 10, 0, 2 * Math.PI, true)\n    context.stroke()\n    context.fill()\n    context.restore()\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawRing () {\n    let that = this\n    let context = that.context\n    context.save()\n    context.beginPath()\n\n    // 外侧的圆\n    context.shadowColor = 'rgba(0,0,0,0.7)'\n    context.shadowOffsetX = 4\n    context.shadowOffsetY = 4\n    context.shadowBlur = 8\n    context.fillStyle = 'rgba(0,0,0,0.16)'\n    context.strokeStyle = 'rgba(0,0,0,0.25)'\n    context.arc(that.centerX, that.centerY, that.ringOuterRadius, 0, 2 * Math.PI, false)\n    context.stroke()\n    // 内侧的圆\n    context.strokeStyle = 'rgba(0,0,0,0.2)'\n    context.arc(that.centerX, that.centerY, that.ringInnerRadius, 0, 2 * Math.PI, true)\n    context.fill()\n    context.beginPath()\n    context.arc(that.centerX, that.centerY, that.ringInnerRadius, 0, 2 * Math.PI, true)\n    context.stroke()\n    context.restore()\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawTicks () {\n    let that = this\n    let context = that.context\n    let hourTickRadius = that.ringInnerRadius - that.hourTickLen\n    let minTickRadius = that.ringInnerRadius - that.minTickLen\n    let pi = Math.PI\n    let startEngle = -(pi / 2)\n    let deltEngle = 2 * pi / (4 * 12)\n    let startPointX = 0\n    let startPointY = 0\n    let endPointX = 0\n    let endPointY = 0\n    let currEngle = startEngle\n    let currTickLen\n    let num\n\n    context.save()\n    context.lineWidth = 1\n    context.textAlign = 'center'\n    context.textBaseline = 'middle'\n    context.font = '12px 微软雅黑 normal'\n    for (let i = 0; i < 48; i++) {\n        currTickLen = (i % 4 == 0 ? hourTickRadius : minTickRadius)\n        context.lineWidth = (i % 4 == 0 ? 2 : 1)\n        context.strokeStyle = 'rgba(0,0,0,0.2)'\n        startPointX = that.centerX + Math.cos(currEngle) * currTickLen\n        startPointY = that.centerY + Math.sin(currEngle) * currTickLen\n        endPointX = that.centerX + Math.cos(currEngle) * that.ringInnerRadius\n        endPointY = that.centerY + Math.sin(currEngle) * that.ringInnerRadius\n        context.beginPath()\n        context.moveTo(startPointX, startPointY)\n        context.lineTo(endPointX, endPointY)\n        context.stroke()\n        if (i % 4 == 0) { // 绘制数字\n            num = i / 4\n            num = (num == 0 ? 12 : num)\n            context.strokeStyle = 'rgba(0,0,0,0.5)'\n            context.strokeText(num, that.centerX + Math.cos(currEngle) * (currTickLen - 10), that.centerY + Math.sin(currEngle) * (currTickLen - 10))\n        }\n        currEngle += deltEngle\n    }\n    context.restore()\n}")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("pre",[n("code",[t._v("drawPoints () {\n    let that = this\n    let context = that.context\n    let pi = Math.PI\n    let currDate = new Date()\n    let hour = currDate.getHours()\n    let min = currDate.getMinutes()\n    let second = currDate.getSeconds()\n    let hourPointLen = 55\n    let hourEngle = -(pi / 2) + (2 * pi / 12) * (hour % 12)\n    let minPointLen = 85\n    let minEngle = -(pi / 2) + (2 * pi / 60) * min\n    let secondPointLen = 115\n    let secondEngle = -(pi / 2) + (2 * pi / 60) * second\n    that.lastTime = currDate.getTime()\n    context.save()\n    context.lineCap = 'round'\n    context.strokeStyle = 'rgba(0,0,0,0.5)'\n    // 小时的指针\n    context.lineWidth = 4\n    context.beginPath()\n    context.moveTo(that.centerX, that.centerY)\n    context.lineTo(that.centerX + hourPointLen * Math.cos(hourEngle), that.centerY + hourPointLen * Math.sin(hourEngle))\n    context.stroke()\n\n    // 分钟的指针\n    context.lineWidth = 3\n    context.beginPath()\n    context.moveTo(that.centerX, that.centerY)\n    context.lineTo(that.centerX + minPointLen * Math.cos(minEngle), that.centerY + minPointLen * Math.sin(minEngle))\n    context.stroke()\n\n    // 秒的指针\n    context.lineWidth = 2\n    context.beginPath()\n    context.moveTo(that.centerX, that.centerY)\n    context.lineTo(that.centerX + secondPointLen * Math.cos(secondEngle), that.centerY + secondPointLen * Math.sin(secondEngle))\n    context.stroke()\n\n    // 当前时间文本\n    let timeStr = (hour < 10 ? '0' + hour : hour) + ' : ' + (min < 10 ? '0' + min : min) + ' : ' + (second < 10 ? '0' + second : second)\n    context.font = '14px 微软雅黑 normal'\n    context.textAlign = 'center'\n    context.textBaseline = 'middle'\n    context.strokeStyle = 'rgba(0,0,0,0.5)'\n    context.lineWidth = 1\n    context.strokeText(timeStr, that.centerX, that.centerY + 45)\n    let month = currDate.getMonth() + 1\n    let date = currDate.getDate()\n    let day = currDate.getDay()\n    let weekObj = ['日', '一', '二', '三', '四', '五', '六']\n    timeStr = currDate.getFullYear() + ' / ' + (month < 10 ? '0' + month : month) + ' / ' + (date < 10 ? '0' + date : date) + ' 星期' + weekObj[day]\n    context.strokeText(timeStr, that.centerX, that.centerY + 75)\n    context.restore()\n}")])])}]}}});