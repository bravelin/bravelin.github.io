webpackJsonp([8],{"Dw/G":function(t,e,n){var r=n("grWY");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);n("vK0y")("183fe4cb",r,!0,{})},OB68:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={extends:n("3ErM").a,data:function(){return{context:null,centerX:0,centerY:0,ringInnerRadius:150,ringOuterRadius:170,hourTickLen:10,minTickLen:5,lastTime:0}},mounted:function(){var t=this;t.$nextTick(function(){t.init()})},methods:{init:function(){var t=this.$refs,e=t.clock,n=t.grid.getBoundingClientRect(),r=.95*(n.right-n.left);r<400&&(e.style.width=r+"px",e.style.height=r+"px");var i=e.getAttribute("width"),a=e.getAttribute("height");this.centerX=i/2,this.centerY=a/2,this.context=e.getContext("2d"),this.startTimer()},startTimer:function(){var t=this;(window.requestAnimationFrame||window.webkitRequestAnimationFrame)(function(){t.drawClock(),t.startTimer()})},drawClock:function(){parseInt(this.lastTime/1e3)!=parseInt(+new Date/1e3)&&(this.drawGrid(),this.drawCentroid(),this.drawRing(),this.drawTicks(),this.drawPoints())},drawGrid:function(){var t=this.context,e=t.canvas,n=e.width,r=e.height;t.clearRect(0,0,n,r),t.save(),t.beginPath(),t.strokeStyle="rgba(0,0,0,0.05)",t.lineWidth=.5;for(var i=10.5;i<n;i+=10)t.beginPath(),t.moveTo(i,0),t.lineTo(i,r),t.stroke();for(var a=10.5;a<r;a+=10)t.beginPath(),t.moveTo(0,a),t.lineTo(n,a),t.stroke();t.restore()},drawCentroid:function(){var t=this.context;t.save(),t.beginPath(),t.strokeStyle="rgba(0,0,0,0.3)",t.fillStyle="rgba(0,0,0,0.25)",t.arc(this.centerX,this.centerY,10,0,2*Math.PI,!0),t.stroke(),t.fill(),t.restore()},drawRing:function(){var t=this.context;t.save(),t.beginPath(),t.shadowColor="rgba(0,0,0,0.7)",t.shadowOffsetX=4,t.shadowOffsetY=4,t.shadowBlur=8,t.fillStyle="rgba(0,0,0,0.16)",t.strokeStyle="rgba(0,0,0,0.25)",t.arc(this.centerX,this.centerY,this.ringOuterRadius,0,2*Math.PI,!1),t.stroke(),t.strokeStyle="rgba(0,0,0,0.2)",t.arc(this.centerX,this.centerY,this.ringInnerRadius,0,2*Math.PI,!0),t.fill(),t.beginPath(),t.arc(this.centerX,this.centerY,this.ringInnerRadius,0,2*Math.PI,!0),t.stroke(),t.restore()},drawTicks:function(){var t=this.context,e=this.ringInnerRadius-this.hourTickLen,n=this.ringInnerRadius-this.minTickLen,r=Math.PI,i=2*r/48,a=0,o=0,c=0,s=0,h=-r/2,l=void 0,d=void 0;t.save(),t.lineWidth=1,t.textAlign="center",t.textBaseline="middle",t.font="normal 12px 微软雅黑";for(var u=0;u<48;u++)l=u%4==0?e:n,t.lineWidth=u%4==0?2:1,t.strokeStyle="rgba(0,0,0,0.2)",a=this.centerX+Math.cos(h)*l,o=this.centerY+Math.sin(h)*l,c=this.centerX+Math.cos(h)*this.ringInnerRadius,s=this.centerY+Math.sin(h)*this.ringInnerRadius,t.beginPath(),t.moveTo(a,o),t.lineTo(c,s),t.stroke(),u%4==0&&(d=0==(d=u/4)?12:d,t.strokeStyle="rgba(0,0,0,0.5)",t.strokeText(d,this.centerX+Math.cos(h)*(l-10),this.centerY+Math.sin(h)*(l-10))),h+=i;t.restore()},drawPoints:function(){var t=this.context,e=Math.PI,n=new Date,r=n.getHours(),i=n.getMinutes(),a=n.getSeconds(),o=-e/2+2*e/12*(r%12),c=-e/2+2*e/60*i,s=-e/2+2*e/60*a;this.lastTime=n.getTime(),t.save(),t.lineCap="round",t.strokeStyle="rgba(0,0,0,0.5)",t.lineWidth=4,t.beginPath(),t.moveTo(this.centerX,this.centerY),t.lineTo(this.centerX+55*Math.cos(o),this.centerY+55*Math.sin(o)),t.stroke(),t.lineWidth=3,t.beginPath(),t.moveTo(this.centerX,this.centerY),t.lineTo(this.centerX+85*Math.cos(c),this.centerY+85*Math.sin(c)),t.stroke(),t.lineWidth=2,t.beginPath(),t.moveTo(this.centerX,this.centerY),t.lineTo(this.centerX+115*Math.cos(s),this.centerY+115*Math.sin(s)),t.stroke();var h=(r<10?"0"+r:r)+" : "+(i<10?"0"+i:i)+" : "+(a<10?"0"+a:a);t.font="normal 14px 微软雅黑",t.textAlign="center",t.textBaseline="middle",t.strokeStyle="rgba(0,0,0,0.5)",t.lineWidth=1,t.strokeText(h,this.centerX,this.centerY+45);var l=n.getMonth()+1,d=n.getDate(),u=n.getDay();h=n.getFullYear()+" / "+(l<10?"0"+l:l)+" / "+(d<10?"0"+d:d)+" 星期"+["日","一","二","三","四","五","六"][u],t.strokeText(h,this.centerX,this.centerY+75),t.restore()}}},i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page article"},[n("iframe",{staticStyle:{display:"none"},attrs:{frameborder:"no",border:"0",marginwidth:"0",marginheight:"0",width:"0",height:"0",src:"//music.163.com/outchain/player?type=2&id=32685948&auto=1&height=66"}}),t._v(" "),n("h2",{staticClass:"title"},[t._v("Canvas绘制的时钟")]),t._v(" "),n("div",{staticClass:"content"},[n("div",{ref:"grid",staticClass:"exp"},[n("canvas",{ref:"clock",staticClass:"clock",attrs:{width:"400",height:"400"}})]),t._v(" "),n("h3",{staticClass:"title"},[t._v("The Code")]),t._v(" "),n("p",[t._v("data定义：")]),t._v(" "),t._m(0),t._v(" "),n("p",[t._v("初始化部分：")]),t._v(" "),t._m(1),t._v(" "),n("p",[t._v("绘制整个时钟的方法：")]),t._v(" "),t._m(2),t._v(" "),n("p",[t._v("随着时间重绘：")]),t._v(" "),t._m(3),t._v(" "),n("p",[t._v("绘制底层网格：")]),t._v(" "),t._m(4),t._v(" "),n("p",[t._v("绘制中心点：")]),t._v(" "),t._m(5),t._v(" "),n("p",[t._v("绘制圆环：")]),t._v(" "),t._m(6),t._v(" "),n("p",[t._v("绘制刻度：")]),t._v(" "),t._m(7),t._v(" "),n("p",[t._v("绘制指针以及时间文本：")]),t._v(" "),t._m(8)]),t._v(" "),n("footer",[t._v("2017年06月17日")]),t._v(" "),n("Comments"),t._v(" "),n("Catalog",{attrs:{catalog:t.catalog}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("data () {\n    return {\n        context: null,\n        centerX: 0, // 中心点\n        centerY: 0,\n        ringInnerRadius: 150, // 内圆环半径\n        ringOuterRadius: 170, // 外圆环半径\n        hourTickLen: 10, // 大刻度长度\n        minTickLen: 5, // 小刻度长度\n        lastTime: 0 // 上次的时间\n    }\n}")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("init () {\n    let that = this\n    let refs = that.$refs\n    let el = refs.clock\n    let box = refs.grid\n    let rect = box.getBoundingClientRect()\n    let w = (rect.right - rect.left) * 0.95\n    if (w < 400) {\n        el.style.width = w + 'px'\n        el.style.height = w + 'px'\n    }\n    let canvasWidth = el.getAttribute('width')\n    let canvasHeight = el.getAttribute('height')\n    that.centerX = canvasWidth / 2\n    that.centerY = canvasHeight / 2\n    that.context = el.getContext('2d')\n    that.startTimer()\n}")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("drawClock () {\n    let that = this\n    if (parseInt(that.lastTime / 1000) != parseInt((+new Date()) / 1000)) {\n        that.drawGrid()\n        that.drawCentroid()\n        that.drawRing()\n        that.drawTicks()\n        that.drawPoints()\n    }\n}")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("startTimer () {\n    let that = this\n    let requestAnimationFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame\n    requestAnimationFrame(function () {\n        that.drawClock()\n        that.startTimer()\n    })\n}")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("drawGrid () {\n    let that = this\n    let context = that.context\n    let el = context.canvas\n    let w = el.width\n    let h = el.height\n    let stepX = 10\n    let stepY = 10\n\n    context.clearRect(0, 0, w, h)\n    context.save()\n    context.beginPath()\n    context.strokeStyle = 'rgba(0,0,0,0.05)'\n    context.lineWidth = 0.5\n    for (let i = stepX + 0.5; i < w; i += stepX) {\n        context.beginPath()\n        context.moveTo(i, 0)\n        context.lineTo(i, h)\n        context.stroke()\n    }\n\n    for (let j = stepY + 0.5; j < h; j += stepY) {\n        context.beginPath()\n        context.moveTo(0, j)\n        context.lineTo(w, j)\n        context.stroke()\n    }\n    context.restore()\n}")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("drawCentroid () {\n    let that = this\n    let context = that.context\n    context.save()\n    context.beginPath()\n    context.strokeStyle = 'rgba(0,0,0,0.3)'\n    context.fillStyle = 'rgba(0,0,0,0.25)'\n    context.arc(that.centerX, that.centerY, 10, 0, 2 * Math.PI, true)\n    context.stroke()\n    context.fill()\n    context.restore()\n}")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("drawRing () {\n    let that = this\n    let context = that.context\n    context.save()\n    context.beginPath()\n\n    // 外侧的圆\n    context.shadowColor = 'rgba(0,0,0,0.7)'\n    context.shadowOffsetX = 4\n    context.shadowOffsetY = 4\n    context.shadowBlur = 8\n    context.fillStyle = 'rgba(0,0,0,0.16)'\n    context.strokeStyle = 'rgba(0,0,0,0.25)'\n    context.arc(that.centerX, that.centerY, that.ringOuterRadius, 0, 2 * Math.PI, false)\n    context.stroke()\n    // 内侧的圆\n    context.strokeStyle = 'rgba(0,0,0,0.2)'\n    context.arc(that.centerX, that.centerY, that.ringInnerRadius, 0, 2 * Math.PI, true)\n    context.fill()\n    context.beginPath()\n    context.arc(that.centerX, that.centerY, that.ringInnerRadius, 0, 2 * Math.PI, true)\n    context.stroke()\n    context.restore()\n}")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("drawTicks () {\n    let that = this\n    let context = that.context\n    let hourTickRadius = that.ringInnerRadius - that.hourTickLen\n    let minTickRadius = that.ringInnerRadius - that.minTickLen\n    let pi = Math.PI\n    let startEngle = -(pi / 2)\n    let deltEngle = 2 * pi / (4 * 12)\n    let startPointX = 0\n    let startPointY = 0\n    let endPointX = 0\n    let endPointY = 0\n    let currEngle = startEngle\n    let currTickLen\n    let num\n\n    context.save()\n    context.lineWidth = 1\n    context.textAlign = 'center'\n    context.textBaseline = 'middle'\n    context.font = '12px 微软雅黑 normal'\n    for (let i = 0; i < 48; i++) {\n        currTickLen = (i % 4 == 0 ? hourTickRadius : minTickRadius)\n        context.lineWidth = (i % 4 == 0 ? 2 : 1)\n        context.strokeStyle = 'rgba(0,0,0,0.2)'\n        startPointX = that.centerX + Math.cos(currEngle) * currTickLen\n        startPointY = that.centerY + Math.sin(currEngle) * currTickLen\n        endPointX = that.centerX + Math.cos(currEngle) * that.ringInnerRadius\n        endPointY = that.centerY + Math.sin(currEngle) * that.ringInnerRadius\n        context.beginPath()\n        context.moveTo(startPointX, startPointY)\n        context.lineTo(endPointX, endPointY)\n        context.stroke()\n        if (i % 4 == 0) { // 绘制数字\n            num = i / 4\n            num = (num == 0 ? 12 : num)\n            context.strokeStyle = 'rgba(0,0,0,0.5)'\n            context.strokeText(num, that.centerX + Math.cos(currEngle) * (currTickLen - 10), that.centerY + Math.sin(currEngle) * (currTickLen - 10))\n        }\n        currEngle += deltEngle\n    }\n    context.restore()\n}")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("drawPoints () {\n    let that = this\n    let context = that.context\n    let pi = Math.PI\n    let currDate = new Date()\n    let hour = currDate.getHours()\n    let min = currDate.getMinutes()\n    let second = currDate.getSeconds()\n    let hourPointLen = 55\n    let hourEngle = -(pi / 2) + (2 * pi / 12) * (hour % 12)\n    let minPointLen = 85\n    let minEngle = -(pi / 2) + (2 * pi / 60) * min\n    let secondPointLen = 115\n    let secondEngle = -(pi / 2) + (2 * pi / 60) * second\n    that.lastTime = currDate.getTime()\n    context.save()\n    context.lineCap = 'round'\n    context.strokeStyle = 'rgba(0,0,0,0.5)'\n    // 小时的指针\n    context.lineWidth = 4\n    context.beginPath()\n    context.moveTo(that.centerX, that.centerY)\n    context.lineTo(that.centerX + hourPointLen * Math.cos(hourEngle), that.centerY + hourPointLen * Math.sin(hourEngle))\n    context.stroke()\n\n    // 分钟的指针\n    context.lineWidth = 3\n    context.beginPath()\n    context.moveTo(that.centerX, that.centerY)\n    context.lineTo(that.centerX + minPointLen * Math.cos(minEngle), that.centerY + minPointLen * Math.sin(minEngle))\n    context.stroke()\n\n    // 秒的指针\n    context.lineWidth = 2\n    context.beginPath()\n    context.moveTo(that.centerX, that.centerY)\n    context.lineTo(that.centerX + secondPointLen * Math.cos(secondEngle), that.centerY + secondPointLen * Math.sin(secondEngle))\n    context.stroke()\n\n    // 当前时间文本\n    let timeStr = (hour < 10 ? '0' + hour : hour) + ' : ' + (min < 10 ? '0' + min : min) + ' : ' + (second < 10 ? '0' + second : second)\n    context.font = '14px 微软雅黑 normal'\n    context.textAlign = 'center'\n    context.textBaseline = 'middle'\n    context.strokeStyle = 'rgba(0,0,0,0.5)'\n    context.lineWidth = 1\n    context.strokeText(timeStr, that.centerX, that.centerY + 45)\n    let month = currDate.getMonth() + 1\n    let date = currDate.getDate()\n    let day = currDate.getDay()\n    let weekObj = ['日', '一', '二', '三', '四', '五', '六']\n    timeStr = currDate.getFullYear() + ' / ' + (month < 10 ? '0' + month : month) + ' / ' + (date < 10 ? '0' + date : date) + ' 星期' + weekObj[day]\n    context.strokeText(timeStr, that.centerX, that.centerY + 75)\n    context.restore()\n}")])])}]};var a=n("rAbc")(r,i,!1,function(t){n("Dw/G")},"data-v-321abc06",null);e.default=a.exports},grWY:function(t,e,n){(t.exports=n("iQ/U")(!1)).push([t.i,"\n.exp[data-v-321abc06]{\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n}\ndiv.exp>canvas.clock[data-v-321abc06]{\n    height: 400px;\n    width: 400px;\n    background: #fff;\n}\n",""])}});