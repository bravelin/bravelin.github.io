webpackJsonp([3],{D0N8:function(t,e,n){var i=n("L+1m");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n("FIqI")("207fd98e",i,!0,{})},"L+1m":function(t,e,n){(t.exports=n("UTlt")(!1)).push([t.i,"\n.exp[data-v-d74a35f8]{\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n}\ncanvas[data-v-d74a35f8]{\n    width: 300px;\n    height: 200px;\n    border: 1px solid #e0e0e0;\n    border-radius: 4px;\n}\n",""])},WaOl:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={extends:n("3ErM").a,data:function(){return{discs:[{x:150,y:80,lastX:150,lastY:80,velocityX:-3.2,velocityY:3.5,radius:20,innerColor:"rgba(255,255,0,1)",middleColor:"rgba(255,255,0,0.7)",outerColor:"rgba(255,255,0,0.5)",strokeStyle:"gray"},{x:50,y:150,lastX:50,lastY:150,velocityX:2.2,velocityY:2.5,radius:20,innerColor:"rgba(100,145,230,1)",middleColor:"rgba(100,145,230,0.7)",outerColor:"rgba(100,145,230,0.5)",strokeStyle:"blue"},{x:150,y:75,lastX:150,lastY:75,velocityX:1.2,velocityY:1.5,radius:20,innerColor:"rgba(255,0,0,1)",middleColor:"rgba(255,0,0,0.7)",outerColor:"rgba(255,0,0,0.5)",strokeStyle:"orange"}],ctx:null}},mounted:function(){var t=this;t.$nextTick(function(){t.startAnimation()})},methods:{init:function(){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){var n,i,a=this;window.setTimeout(function(){n=+new Date,t(n),i=+new Date,a.timeout=1e3/60-(i-n)},a.timeout)}},startAnimation:function(){this.ctx=this.$refs.c1.getContext("2d"),this.animate()},animate:function(){this.update(),this.draw(),window.requestAnimationFrame(this.animate)},draw:function(){var t=this.$refs.c1,e=this.ctx,n=void 0;e.fillStyle="#ffffff",e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height),this.discs.forEach(function(t){(n=e.createRadialGradient(t.x,t.y,0,t.x,t.y,t.radius)).addColorStop(.3,t.innerColor),n.addColorStop(.5,t.middleColor),n.addColorStop(1,t.outerColor),e.save(),e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI,!1),e.fillStyle=n,e.strokeStyle=t.strokeStyle,e.fill(),e.stroke(),e.restore()})},update:function(){var t=this;t.discs.forEach(function(e){(e.x+e.velocityX+e.radius>t.ctx.canvas.width||e.x+e.velocityX-e.radius<0)&&(e.velocityX=-e.velocityX),(e.y+e.velocityY+e.radius>t.ctx.canvas.height||e.y+e.velocityY-e.radius<0)&&(e.velocityY=-e.velocityY),e.x+=e.velocityX,e.y+=e.velocityY})}}},a={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page article"},[n("h2",{staticClass:"title"},[t._v("Canvas学习笔记之五：动画")]),t._v(" "),n("div",{staticClass:"content"},[n("h3",{staticClass:"title"},[t._v("动画循环")]),t._v(" "),t._m(0),t._v(" "),n("p",[t._v("不需要指定帧速率，浏览器会自行决定最佳的帧速率。cancelRequestAnimationFrame()可以取消回调函数。")]),t._v(" "),n("p",[t._v("使用requestAnimationFrame的polyfill代码：")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),n("div",{staticClass:"exp"},[n("canvas",{ref:"c1",staticStyle:{height:"400px"},attrs:{width:"300",height:"400"}})]),t._v(" "),n("p",[t._v("定义数据结构：")]),t._v(" "),t._m(3),t._v(" "),n("p",[t._v("绘制的方法：")]),t._v(" "),t._m(4),t._v(" "),n("p",[t._v("更新位置的方法：")]),t._v(" "),t._m(5),t._v(" "),n("p",[t._v("动画方法：")]),t._v(" "),t._m(6),t._v(" "),n("h3",{staticClass:"title"},[t._v("帧速率的计算")])]),t._v(" "),n("footer",[t._v("2016年07月10日")]),t._v(" "),n("Comments"),t._v(" "),n("Catalog",{attrs:{catalog:t.catalog}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("实现动画循环的首选方式，是使用"),e("strong",[this._v("requestAnimationFrame()")]),this._v("方法，而不是使用setInterval和setTimeout方法。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("window.requestAnimationFrame = (function () {\n    return window.requestAnimationFrame ||\n        window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame ||\n        function (callback, element) {\n            var self = this\n            var start\n            var finish\n            window.setTimeout(function () {\n                start = +new Date()\n                callback(start)\n                finish = +new Date()\n                self.timeout = 1000 / 60 - (finish - start) // 大约60fps\n            }, self.timeout)\n        }\n})()")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("em",[this._v("3个小球的匀速运动：")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("discs: [\n    {\n        x: 150,\n        y: 80,\n        lastX: 150,\n        lastY: 80,\n        velocityX: -3.2,\n        velocityY: 3.5,\n        radius: 25,\n        innerColor: 'rgba(255,255,0,1)',\n        middleColor: 'rgba(255,255,0,0.7)',\n        outerColor: 'rgba(255,255,0,0.5)',\n        strokeStyle: 'gray'\n    },\n    {\n        x: 50,\n        y: 150,\n        lastX: 50,\n        lastY: 150,\n        velocityX: 2.2,\n        velocityY: 2.5,\n        radius: 25,\n        innerColor: 'rgba(100,145,230,1)',\n        middleColor: 'rgba(100,145,230,0.7)',\n        outerColor: 'rgba(100,145,230,0.5)',\n        strokeStyle: 'blue'\n    },\n    {\n        x: 150,\n        y: 75,\n        lastX: 150,\n        lastY: 75,\n        velocityX: 1.2,\n        velocityY: 1.5,\n        radius: 25,\n        innerColor: 'rgba(255,0,0,1)',\n        middleColor: 'rgba(255,0,0,0.7)',\n        outerColor: 'rgba(255,0,0,0.5)',\n        strokeStyle: 'orange'\n    }\n]")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("draw () {\n    const that = this\n    const canvas = that.$refs.c1\n    const ctx = that.ctx\n    let gradient\n    ctx.fillStyle = '#ffffff'\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\n    ctx.fillRect(0, 0, canvas.width, canvas.height)\n    that.discs.forEach(disc => {\n        gradient = ctx.createRadialGradient(disc.x, disc.y, 0, disc.x, disc.y, disc.radius)\n        gradient.addColorStop(0.3, disc.innerColor)\n        gradient.addColorStop(0.5, disc.middleColor)\n        gradient.addColorStop(1, disc.outerColor)\n        ctx.save()\n        ctx.beginPath()\n        ctx.arc(disc.x, disc.y, disc.radius, 0, Math.PI * 2, false)\n        ctx.fillStyle = gradient\n        ctx.strokeStyle = disc.strokeStyle\n        ctx.fill()\n        ctx.stroke()\n        ctx.restore()\n      })\n    }")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("update () {\n    const that = this\n    that.discs.forEach(disc => {\n        if (disc.x + disc.velocityX + disc.radius > that.ctx.canvas.width || disc.x + disc.velocityX - disc.radius < 0) {\n            disc.velocityX = -disc.velocityX\n        }\n        if (disc.y + disc.velocityY + disc.radius > that.ctx.canvas.height || disc.y + disc.velocityY - disc.radius < 0) {\n            disc.velocityY = -disc.velocityY\n        }\n        disc.x += disc.velocityX\n        disc.y += disc.velocityY\n    })\n}")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("pre",[e("code",[this._v("animate () {\n    const that = this\n    that.update()\n    that.draw()\n    window.requestAnimationFrame(that.animate)\n}")])])}]};var s=n("Z0/y")(i,a,!1,function(t){n("D0N8")},"data-v-d74a35f8",null);e.default=s.exports}});