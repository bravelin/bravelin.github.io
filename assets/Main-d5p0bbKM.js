import{_ as D,c as M,f as o,w as u,O as f,v as k,D as C,m as b,p as U,r as d,o as x}from"./index-CxcENImR.js";const B={setup(){const c=U(),t=d(5),i=d("t1");let e=null,l=d(!1),n=null,a=d(0);const p=d("webm"),y=async()=>{const T={video:{cursor:"always"},audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}},S=await navigator.mediaDevices.getDisplayMedia(T),_={mimeType:"video/webm;codecs=vp9"};e=new MediaRecorder(S,_);const m=[];e.ondataavailable=r=>{r.data.size>0&&m.push(r.data)},e.onstart=()=>{i.value=="t1"&&(a.value=t.value,n=setInterval(()=>{a.value--,a.value<=0&&v()},1e3))},e.onstop=()=>{const r=new Blob(m,{type:"video/webm"}),g=`screen_recording_${Date.now()}`;if(p.value!="mp4"){const R=URL.createObjectURL(r),s=document.createElement("a");s.href=R,s.download=`${g}.webm`,document.body.appendChild(s),s.click(),document.body.removeChild(s)}},e.start()},w=async()=>{if(i.value=="t1"&&(!t.value||t.value<1)){c.warning("录制时长必须大于0");return}l.value=!0,y()},v=()=>{e&&e.state!=="inactive"&&e.stop(),l.value=!1,a.value=0,n&&(clearInterval(n),n=null)};return{duration:t,recordType:i,doHandle:()=>{l.value?v():w()},isStart:l,surplusTime:a,fileType:p}}},V={class:"tools-video-record-page _page"},E={class:"wrap"},H={class:"option-item"},O=["disabled"],I=["disabled"],L={class:"option-item"},N=["disabled"];function j(c,t,i,e,l,n){return x(),M("div",V,[o("div",E,[o("div",H,[t[6]||(t[6]=o("label",null,"录制类型：",-1)),o("div",null,[u(o("input",{disabled:e.isStart,type:"radio",id:"t1",value:"t1","onUpdate:modelValue":t[0]||(t[0]=a=>e.recordType=a)},null,8,O),[[f,e.recordType]]),t[4]||(t[4]=o("label",{for:"t1"},"定时录制",-1)),u(o("input",{disabled:e.isStart,type:"radio",id:"t2",value:"t2","onUpdate:modelValue":t[1]||(t[1]=a=>e.recordType=a)},null,8,I),[[f,e.recordType]]),t[5]||(t[5]=o("label",{for:"t2"},"手动结束",-1))])]),u(o("div",L,[t[7]||(t[7]=o("label",null,"录制时长：",-1)),u(o("input",{disabled:e.isStart,type:"number","onUpdate:modelValue":t[2]||(t[2]=a=>e.duration=a)},null,8,N),[[C,e.duration,void 0,{trim:!0}]]),t[8]||(t[8]=o("span",null,"秒",-1))],512),[[k,e.recordType=="t1"]]),o("button",{onClick:t[3]||(t[3]=a=>e.doHandle())},b(e.isStart?"结束":"开始")+"录制"+b(e.recordType=="t1"&&e.isStart?"("+e.surplusTime+"s)":""),1)])])}const A=D(B,[["render",j]]);export{A as default};
